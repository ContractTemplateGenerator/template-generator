<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Professional Token Vesting Agreement Generator</title>
  <meta name="description" content="Create comprehensive, attorney-quality token vesting agreements with cliff periods, acceleration provisions, and full legal protections.">

  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=ASmwKug6zVE_78S-152YKAzzh2iH8VgSjs-P6RkrWcfqdznNjeE_UYwKJkuJ3BvIJrxCotS8GtXEJ2fx&currency=USD"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #2c3e50;
      background-color: #f5f7fa;
      padding: 20px;
    }

    .vesting-container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 12px 12px 0 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .header p {
      font-size: 16px;
      opacity: 0.95;
    }

    .main-grid {
      display: grid;
      grid-template-columns: 1fr 500px;
      gap: 0;
      background: white;
      border-radius: 0 0 12px 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      overflow: hidden;
      min-height: 900px;
    }

    .form-column {
      padding: 30px;
      overflow-y: auto;
      max-height: 2000px;
      border-right: 1px solid #e2e8f0;
    }

    .preview-column {
      padding: 30px;
      background: #f8fafc;
      overflow-y: auto;
      max-height: 2000px;
      position: sticky;
      top: 0;
    }

    .form-section {
      margin-bottom: 30px;
      padding-bottom: 25px;
      border-bottom: 2px solid #e2e8f0;
    }

    .form-section:last-child {
      border-bottom: none;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-icon {
      font-size: 20px;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      color: #334155;
      font-size: 14px;
    }

    .required {
      color: #ef4444;
      margin-left: 2px;
    }

    .form-input,
    .form-select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #cbd5e1;
      border-radius: 6px;
      font-size: 14px;
      color: #1e293b;
      transition: all 0.2s;
    }

    .form-input:focus,
    .form-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-input[type="number"] {
      -moz-appearance: auto;
    }

    .form-input[type="number"]::-webkit-inner-spin-button,
    .form-input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: auto;
      opacity: 1;
    }

    .help-text {
      font-size: 12px;
      color: #64748b;
      margin-top: 4px;
      font-style: italic;
    }

    .help-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      background: #667eea;
      color: white;
      border-radius: 50%;
      font-size: 12px;
      font-weight: bold;
      cursor: help;
      margin-left: 6px;
      position: relative;
    }

    .help-icon:hover {
      background: #764ba2;
    }

    .tooltip {
      position: relative;
      display: inline-block;
    }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: 280px;
      background-color: #1e293b;
      color: #fff;
      text-align: left;
      border-radius: 8px;
      padding: 12px;
      position: absolute;
      z-index: 1000;
      bottom: 125%;
      left: 50%;
      margin-left: -140px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      line-height: 1.5;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #1e293b transparent transparent transparent;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    .expandable-help {
      background: #f8f9ff;
      border: 1px solid #e0e7ff;
      border-radius: 8px;
      margin-bottom: 20px;
      overflow: hidden;
    }

    .expandable-help-header {
      padding: 12px 15px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: #667eea;
      font-size: 14px;
      user-select: none;
    }

    .expandable-help-header:hover {
      background: #f0f4ff;
    }

    .expandable-help-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      padding: 0 15px;
    }

    .expandable-help-content.active {
      max-height: 1000px;
      padding: 15px;
      border-top: 1px solid #e0e7ff;
    }

    .expand-icon {
      transition: transform 0.3s;
      font-size: 12px;
    }

    .expandable-help.active .expand-icon {
      transform: rotate(180deg);
    }

    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .radio-option {
      display: flex;
      align-items: flex-start;
      padding: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .radio-option:hover {
      border-color: #667eea;
      background-color: #f8f9ff;
    }

    .radio-option.selected {
      border-color: #667eea;
      background-color: #f0f4ff;
    }

    .radio-option input[type="radio"] {
      margin-right: 10px;
      margin-top: 2px;
      accent-color: #667eea;
      cursor: pointer;
    }

    .radio-content {
      flex: 1;
    }

    .radio-label {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 3px;
      display: block;
    }

    .radio-description {
      font-size: 12px;
      color: #64748b;
      line-height: 1.4;
    }

    .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .checkbox-option {
      display: flex;
      align-items: center;
      padding: 10px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .checkbox-option:hover {
      background-color: #f8fafc;
    }

    .checkbox-option input[type="checkbox"] {
      margin-right: 10px;
      accent-color: #667eea;
      cursor: pointer;
      width: 18px;
      height: 18px;
    }

    .checkbox-label {
      font-size: 14px;
      color: #334155;
      cursor: pointer;
    }

    .info-box {
      background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
      border-left: 4px solid #667eea;
      padding: 14px;
      border-radius: 6px;
      margin-bottom: 15px;
    }

    .info-box-title {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 6px;
      font-size: 13px;
    }

    .info-box-content {
      font-size: 12px;
      color: #475569;
      line-height: 1.5;
    }

    .alert-box {
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      font-size: 13px;
      border-left: 4px solid;
    }

    .alert-warning {
      background-color: #fffbeb;
      border-color: #f59e0b;
      color: #92400e;
    }

    .alert-success {
      background-color: #f0fdf4;
      border-color: #10b981;
      color: #065f46;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 25px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      text-align: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .btn-secondary {
      background-color: #f1f5f9;
      color: #475569;
    }

    .btn-secondary:hover {
      background-color: #e2e8f0;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Preview Styles */
    .preview-header {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e2e8f0;
    }

    .preview-title {
      font-size: 18px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }

    .preview-subtitle {
      font-size: 12px;
      color: #64748b;
      font-style: italic;
    }

    .preview-box {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 25px;
      min-height: 700px;
      font-size: 13px;
      line-height: 1.8;
      color: #1e293b;
      position: relative;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    .doc-title {
      text-align: center;
      font-size: 20px;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 25px;
      text-transform: uppercase;
    }

    .doc-section {
      margin-bottom: 25px;
    }

    .doc-section-title {
      font-size: 15px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 12px;
    }

    .doc-paragraph {
      margin-bottom: 12px;
      text-align: justify;
    }

    .doc-list {
      margin-left: 25px;
      margin-bottom: 12px;
    }

    .doc-list li {
      margin-bottom: 6px;
    }

    .highlight {
      background-color: #fef3c7;
      padding: 2px 4px;
      border-radius: 3px;
    }

    .highlight-flash {
      background-color: #fef08a;
      padding: 4px 6px;
      border-radius: 4px;
      transition: background-color 0.5s ease-out;
      animation: flash 0.5s ease-in-out;
    }

    @keyframes flash {
      0%, 100% { background-color: #fef08a; }
      50% { background-color: #fde047; }
    }

    /* Vesting Calculator */
    .vesting-calculator {
      background: white;
      border: 2px solid #667eea;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .calculator-title {
      font-size: 16px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 15px;
      text-align: center;
    }

    .vesting-timeline {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .timeline-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: #f8fafc;
      border-radius: 6px;
    }

    .timeline-date {
      font-weight: 600;
      color: #1e293b;
      font-size: 12px;
    }

    .timeline-amount {
      font-weight: 700;
      color: #667eea;
      font-size: 13px;
    }

    .vesting-chart {
      margin-top: 15px;
      height: 200px;
      background: linear-gradient(to top, #f0f4ff 0%, transparent 100%);
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      position: relative;
      padding: 10px;
    }

    .chart-bar {
      position: absolute;
      bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 4px 4px 0 0;
      transition: all 0.3s;
    }

    /* PayPal Button Container */
    .paypal-container {
      margin-top: 30px;
      padding: 25px;
      background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
      border: 2px solid #667eea;
      border-radius: 12px;
    }

    .paypal-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .paypal-title {
      font-size: 20px;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 8px;
    }

    .paypal-price {
      font-size: 36px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }

    .paypal-description {
      font-size: 13px;
      color: #64748b;
    }

    #paypalButtonContainer {
      margin-top: 20px;
    }

    .payment-disabled {
      background: #f1f5f9;
      color: #64748b;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-size: 14px;
      font-weight: 600;
    }

    .payment-success {
      background: #f0fdf4;
      border: 2px solid #10b981;
      color: #065f46;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      font-size: 14px;
      margin-top: 20px;
    }

    .payment-success-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .main-grid {
        grid-template-columns: 1fr;
      }

      .form-column {
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
        max-height: none;
      }

      .preview-column {
        max-height: 600px;
        position: relative;
      }
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 22px;
      }

      .btn-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <div class="vesting-container">
    <!-- Header -->
    <div class="header">
      <h1>Professional Token Vesting Agreement Generator</h1>
      <p>Create comprehensive, attorney-quality token vesting agreements with advanced provisions</p>
    </div>

    <div class="main-grid">
      <!-- Form Column -->
      <div class="form-column">
        <form id="vestingForm">

          <!-- Company Information -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">üè¢</span>
              <span>Company Information</span>
            </div>

            <div class="form-group">
              <label class="form-label">Company/Project Name <span class="required">*</span></label>
              <input type="text" class="form-input" id="companyName" value="BlockChain Innovations LLC" required>
            </div>

            <div class="form-group">
              <label class="form-label">Company Address <span class="required">*</span></label>
              <input type="text" class="form-input" id="companyAddress" value="251 Little Falls Drive, Wilmington, DE 19808" required>
            </div>

            <div class="form-group">
              <label class="form-label">Authorized Signatory Name <span class="required">*</span></label>
              <input type="text" class="form-input" id="signatoryName" value="Jane Smith" required>
              <div class="help-text">Person authorized to sign on behalf of the company</div>
            </div>

            <div class="form-group">
              <label class="form-label">Signatory Title <span class="required">*</span></label>
              <input type="text" class="form-input" id="signatoryTitle" value="Chief Executive Officer" required>
            </div>
          </div>

          <!-- Recipient Information -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">üë§</span>
              <span>Recipient Information</span>
            </div>

            <div class="form-group">
              <label class="form-label">Recipient Name <span class="required">*</span></label>
              <input type="text" class="form-input" id="recipientName" value="John Anderson" required>
            </div>

            <div class="form-group">
              <label class="form-label">Recipient Address <span class="required">*</span></label>
              <input type="text" class="form-input" id="recipientAddress" value="123 Main Street, San Francisco, CA 94102" required>
            </div>

            <div class="form-group">
              <label class="form-label">Recipient Role/Position <span class="required">*</span></label>
              <input type="text" class="form-input" id="recipientRole" value="Chief Technology Officer" required>
            </div>

            <div class="form-group">
              <label class="form-label">Relationship to Company <span class="required">*</span></label>
              <select class="form-select" id="relationship" required>
                <option value="employee">Employee</option>
                <option value="founder" selected>Founder</option>
                <option value="advisor">Advisor</option>
                <option value="consultant">Consultant</option>
                <option value="investor">Investor</option>
                <option value="partner">Strategic Partner</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">
                Recipient Wallet Address
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext">Enter the blockchain wallet address where tokens will be delivered. Leave blank if not yet known. Must match the token standard (e.g., ERC-20 address for Ethereum tokens).</span>
                </span>
              </label>
              <input type="text" class="form-input" id="walletAddress" placeholder="0x... or blockchain address">
              <div class="help-text">Recipient's wallet address for token delivery (if known)</div>
            </div>

            <div class="form-group">
              <label class="form-label">
                Recipient Status
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext"><strong>U.S. Person:</strong> U.S. citizens, residents, or entities. Requires accredited investor status.<br><br><strong>Non-U.S. Person:</strong> Foreign individuals/entities. Different securities law applies (Reg S).</span>
                </span>
              </label>
              <select class="form-select" id="recipientStatus">
                <option value="us-person">U.S. Person</option>
                <option value="non-us-person">Non-U.S. Person</option>
              </select>
              <div class="help-text">For securities law compliance purposes</div>
            </div>
          </div>

          <!-- Token Details -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">ü™ô</span>
              <span>Token Details</span>
            </div>

            <div class="form-group">
              <label class="form-label">Token Name <span class="required">*</span></label>
              <input type="text" class="form-input" id="tokenName" value="Innovation Token" required>
            </div>

            <div class="form-group">
              <label class="form-label">Token Symbol <span class="required">*</span></label>
              <input type="text" class="form-input" id="tokenSymbol" value="INNOV" required>
            </div>

            <div class="form-group">
              <label class="form-label">Total Token Amount <span class="required">*</span></label>
              <input type="number" class="form-input" id="tokenAmount" value="1000000" min="1" required>
              <div class="help-text">Total number of tokens subject to this vesting agreement</div>
            </div>

            <div class="form-group">
              <label class="form-label">Token Standard</label>
              <select class="form-select" id="tokenStandard">
                <option value="ERC-20" selected>ERC-20 (Ethereum)</option>
                <option value="BEP-20">BEP-20 (Binance Smart Chain)</option>
                <option value="SPL">SPL (Solana)</option>
                <option value="TRC-20">TRC-20 (Tron)</option>
                <option value="NEP-141">NEP-141 (NEAR)</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Smart Contract Address</label>
              <input type="text" class="form-input" id="contractAddress" placeholder="0x... (if deployed)">
              <div class="help-text">Leave blank if contract not yet deployed</div>
            </div>

            <div class="form-group">
              <label class="form-label">Token Price per Unit (USD)</label>
              <input type="number" class="form-input" id="tokenPrice" placeholder="0.50" step="0.01" min="0">
              <div class="help-text">Optional: For reference and potential tax reporting</div>
            </div>
          </div>

          <!-- Vesting Schedule -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">üìÖ</span>
              <span>Vesting Schedule</span>
            </div>

            <div class="expandable-help">
              <div class="expandable-help-header" onclick="toggleHelp(this)">
                <span>üí° Understanding Vesting Schedules</span>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="expandable-help-content">
                <p><strong>Cliff Period:</strong> Initial waiting period with NO vesting. Common: 12 months for founders, 6 months for advisors, 0-3 for consultants.</p>
                <p><strong>Total Vesting Period:</strong> Includes cliff. Example: 12-month cliff + 48-month total = vesting starts month 12, complete month 48.</p>
                <p><strong>Linear:</strong> Tokens vest daily. Fairest option. Common for founders.</p>
                <p><strong>Monthly:</strong> Equal portions monthly. Standard for employees.</p>
                <p><strong>Quarterly:</strong> Every 3 months. Good for advisors (less admin).</p>
                <p><strong>Yearly:</strong> Annual chunks. Rare, used for long-term advisors.</p>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Start Date <span class="required">*</span></label>
              <input type="date" class="form-input" id="startDate" required>
            </div>

            <div class="form-group">
              <label class="form-label">
                Cliff Period (months)
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext">Initial period where NO tokens vest. If terminated during cliff, recipient gets zero tokens. After cliff, they get all tokens from the cliff date forward. Use 12 months for founders, 6 for advisors, 0-3 for consultants.</span>
                </span>
              </label>
              <input type="number" class="form-input" id="cliffMonths" value="12" min="0" max="48">
              <div class="help-text">Period before any tokens vest (0 for no cliff)</div>
            </div>

            <div class="form-group">
              <label class="form-label">
                Total Vesting Period (months) <span class="required">*</span>
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext">Total duration from start date until all tokens vest, INCLUDING the cliff period. Standard: 48 months for founders/employees, 24 months for advisors, 12-24 months for consultants.</span>
                </span>
              </label>
              <input type="number" class="form-input" id="totalMonths" value="48" min="1" max="120" required>
              <div class="help-text">Total duration including cliff period</div>
            </div>

            <div class="form-group">
              <label class="form-label">
                Vesting Type <span class="required">*</span>
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext">How tokens are released after cliff. Linear = daily (most fair), Monthly = same day each month (standard), Quarterly = every 3 months (less admin), Yearly = annual (rare).</span>
                </span>
              </label>
              <div class="radio-group">
                <label class="radio-option selected">
                  <input type="radio" name="vestingType" value="linear" checked>
                  <div class="radio-content">
                    <span class="radio-label">Linear (Continuous)</span>
                    <span class="radio-description">Tokens vest continuously every day after cliff</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="vestingType" value="monthly">
                  <div class="radio-content">
                    <span class="radio-label">Monthly Intervals</span>
                    <span class="radio-description">Equal portions vest monthly after cliff</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="vestingType" value="quarterly">
                  <div class="radio-content">
                    <span class="radio-label">Quarterly Intervals</span>
                    <span class="radio-description">Equal portions vest quarterly after cliff</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="vestingType" value="yearly">
                  <div class="radio-content">
                    <span class="radio-label">Yearly Intervals</span>
                    <span class="radio-description">Equal portions vest annually after cliff</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <!-- Advanced Provisions -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">‚öôÔ∏è</span>
              <span>Advanced Provisions</span>
            </div>

            <div class="expandable-help">
              <div class="expandable-help-header" onclick="toggleHelp(this)">
                <span>üí° Termination & Change of Control</span>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="expandable-help-content">
                <p><strong>Standard Termination:</strong> Unvested forfeited, vested kept. Most common and balanced.</p>
                <p><strong>For-Cause Forfeiture:</strong> ALL tokens forfeited (even vested) if fired for fraud/theft/gross misconduct. Harsh but protective.</p>
                <p><strong>Partial Acceleration:</strong> 50% of unvested vest on termination without cause. "Good leaver" provision for founders.</p>
                <hr style="margin: 10px 0; border: 0; border-top: 1px solid #e0e7ff;">
                <p><strong>Double-Trigger:</strong> Vest only if acquired AND terminated within 12 months. Most balanced for acquisitions.</p>
                <p><strong>Full Acceleration:</strong> All vest on acquisition. Generous to team, may reduce acquisition value.</p>
                <p><strong>No Acceleration:</strong> Vesting continues unchanged. Favors acquirer.</p>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">
                Termination Provisions
                <span class="tooltip">
                  <span class="help-icon">?</span>
                  <span class="tooltiptext">What happens to tokens if service relationship ends. Standard = keep vested, lose unvested. For-Cause = lose everything if terminated for misconduct. Partial = 50% of unvested vest if terminated without cause.</span>
                </span>
              </label>
              <div class="radio-group">
                <label class="radio-option selected">
                  <input type="radio" name="termination" value="standard" checked>
                  <div class="radio-content">
                    <span class="radio-label">Standard Termination</span>
                    <span class="radio-description">Vesting stops on termination; vested tokens remain with recipient</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="termination" value="for-cause">
                  <div class="radio-content">
                    <span class="radio-label">For-Cause Forfeiture</span>
                    <span class="radio-description">All tokens (vested & unvested) forfeited if terminated for cause</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="termination" value="partial">
                  <div class="radio-content">
                    <span class="radio-label">Partial Acceleration</span>
                    <span class="radio-description">50% of unvested tokens vest on termination without cause</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Change of Control Acceleration</label>
              <div class="radio-group">
                <label class="radio-option selected">
                  <input type="radio" name="changeControl" value="double-trigger" checked>
                  <div class="radio-content">
                    <span class="radio-label">Double Trigger Acceleration</span>
                    <span class="radio-description">100% vesting if change of control AND subsequent termination</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="changeControl" value="full">
                  <div class="radio-content">
                    <span class="radio-label">Full Acceleration</span>
                    <span class="radio-description">All unvested tokens vest immediately on change of control</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="changeControl" value="none">
                  <div class="radio-content">
                    <span class="radio-label">No Acceleration</span>
                    <span class="radio-description">Vesting continues as scheduled</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Transfer Restrictions (Post-Vesting)</label>
              <div class="checkbox-group">
                <label class="checkbox-option">
                  <input type="checkbox" id="lockupPeriod">
                  <span class="checkbox-label">Include lockup period after vesting</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="companyConsent">
                  <span class="checkbox-label">Require company consent for transfers</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="rightFirstRefusal">
                  <span class="checkbox-label">Company right of first refusal on sales</span>
                </label>
              </div>
            </div>

            <div class="form-group" id="lockupMonthsGroup" style="display: none;">
              <label class="form-label">Lockup Period (months)</label>
              <input type="number" class="form-input" id="lockupMonths" value="6" min="1" max="24">
              <div class="help-text">Additional restriction period after tokens vest</div>
            </div>
          </div>

          <!-- Legal Provisions -->
          <div class="form-section">
            <div class="section-title">
              <span class="section-icon">‚öñÔ∏è</span>
              <span>Legal Provisions</span>
            </div>

            <div class="expandable-help">
              <div class="expandable-help-header" onclick="toggleHelp(this)">
                <span>üí° Legal & Compliance Provisions</span>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="expandable-help-content">
                <p><strong>KYC/AML/Sanctions:</strong> Required for regulatory compliance. Recipients must prove identity and confirm they're not on sanctions lists. HIGHLY RECOMMENDED.</p>
                <p><strong>TGE Conditions:</strong> Makes token delivery conditional on tokens actually being created and complying with securities laws. CRITICAL for pre-launch agreements.</p>
                <p><strong>On-Chain Mechanics:</strong> Addresses gas fees, forks, airdrops, wallet security. Prevents disputes about technical implementation. RECOMMENDED.</p>
                <p><strong>No Employment Rights:</strong> Clarifies agreement doesn't guarantee continued employment. Standard risk management clause.</p>
                <p><strong>Securities Law Reps:</strong> Required if tokens may be securities. Different language for U.S. vs Non-U.S. persons.</p>
                <p><strong>Tax Provisions:</strong> Includes 83(b) election notice and withholding rights. REQUIRED for U.S. employees/founders.</p>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Governing Law <span class="required">*</span></label>
              <select class="form-select" id="governingLaw" required>
                <option value="Delaware" selected>Delaware</option>
                <option value="California">California</option>
                <option value="New York">New York</option>
                <option value="Texas">Texas</option>
                <option value="Wyoming">Wyoming</option>
                <option value="Nevada">Nevada</option>
                <option value="Florida">Florida</option>
                <option value="Washington">Washington</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Dispute Resolution</label>
              <div class="radio-group">
                <label class="radio-option selected">
                  <input type="radio" name="disputes" value="arbitration" checked>
                  <div class="radio-content">
                    <span class="radio-label">Binding Arbitration (AAA)</span>
                    <span class="radio-description">Private, efficient dispute resolution</span>
                  </div>
                </label>
                <label class="radio-option">
                  <input type="radio" name="disputes" value="litigation">
                  <div class="radio-content">
                    <span class="radio-label">Court Litigation</span>
                    <span class="radio-description">Traditional court proceedings</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Additional Provisions</label>
              <div class="checkbox-group">
                <label class="checkbox-option">
                  <input type="checkbox" id="confidentiality" checked>
                  <span class="checkbox-label">Confidentiality provisions</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="securities" checked>
                  <span class="checkbox-label">Securities law representations</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="taxProvisions" checked>
                  <span class="checkbox-label">Tax acknowledgments (83(b) election notice)</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="assignmentRestriction" checked>
                  <span class="checkbox-label">Anti-assignment provisions</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="kycAml" checked>
                  <span class="checkbox-label">KYC/AML/Sanctions compliance</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="tgeConditions" checked>
                  <span class="checkbox-label">Token Generation Event (TGE) conditions</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="onchainMechanics" checked>
                  <span class="checkbox-label">On-chain implementation mechanics</span>
                </label>
                <label class="checkbox-option">
                  <input type="checkbox" id="noEmploymentRights" checked>
                  <span class="checkbox-label">No employment/engagement guarantee</span>
                </label>
              </div>
            </div>

            <div class="alert-box alert-warning">
              <strong>‚ö†Ô∏è Legal Notice:</strong> This generator creates a template agreement. Always have your final agreement reviewed by a qualified attorney familiar with securities law and digital assets in your jurisdiction.
            </div>
          </div>

          <!-- PayPal Payment Section -->
          <div class="paypal-container">
            <div class="paypal-header">
              <div class="paypal-title">üîê Unlock Your Token Vesting Agreement</div>
              <div class="paypal-price">$19.95</div>
              <div class="paypal-description">One-time payment ‚Ä¢ Instant download</div>
            </div>
            <div id="paypalButtonContainer">
              <div class="payment-disabled">Complete all required fields above to proceed to payment</div>
            </div>
            <div id="paymentSuccess" style="display: none;"></div>
          </div>

          <div class="btn-group">
            <button type="reset" class="btn btn-secondary">
              üîÑ Reset Form
            </button>
          </div>
        </form>
      </div>

      <!-- Preview Column -->
      <div class="preview-column">
        <div class="preview-header">
          <div class="preview-title">üìã Agreement Preview</div>
          <div class="preview-subtitle">Live preview of your vesting agreement</div>
        </div>

        <div class="preview-box" id="previewBox">
          <div class="doc-title">Token Vesting Agreement</div>
          <p style="text-align: center; color: #64748b; font-size: 12px; margin-bottom: 25px;">
            Complete the form to generate your customized agreement
          </p>
        </div>

        <!-- Vesting Calculator -->
        <div class="vesting-calculator">
          <div class="calculator-title">üìä Vesting Schedule Calculator</div>
          <div id="vestingTimeline"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <script>
    // Set today's date as default
    document.getElementById('startDate').valueAsDate = new Date();

    // Handle radio option selection
    document.querySelectorAll('.radio-option').forEach(option => {
      option.addEventListener('click', function() {
        const radio = this.querySelector('input[type="radio"]');
        if (radio) {
          radio.checked = true;

          // Update visual selection
          this.closest('.radio-group').querySelectorAll('.radio-option').forEach(opt => {
            opt.classList.remove('selected');
          });
          this.classList.add('selected');

          updatePreview();
        }
      });
    });

    // Handle lockup period visibility
    document.getElementById('lockupPeriod').addEventListener('change', function() {
      document.getElementById('lockupMonthsGroup').style.display =
        this.checked ? 'block' : 'none';
    });

    // Update preview on form changes
    const formInputs = document.querySelectorAll('.form-input, .form-select, input[type="radio"], input[type="checkbox"]');
    formInputs.forEach(input => {
      input.addEventListener('change', updatePreview);
      input.addEventListener('input', updatePreview);
    });

    // Track previous values for highlighting
    let previousValues = {};

    function updatePreview() {
      const companyName = document.getElementById('companyName').value || '[Company Name]';
      const companyAddress = document.getElementById('companyAddress').value || '[Company Address]';
      const signatoryName = document.getElementById('signatoryName').value || '[Signatory Name]';
      const signatoryTitle = document.getElementById('signatoryTitle').value || '[Signatory Title]';
      const tokenName = document.getElementById('tokenName').value || '[Token Name]';
      const tokenSymbol = document.getElementById('tokenSymbol').value || '[SYMBOL]';
      const recipientName = document.getElementById('recipientName').value || '[Recipient Name]';
      const recipientAddress = document.getElementById('recipientAddress').value || '[Recipient Address]';
      const recipientRole = document.getElementById('recipientRole').value || '[Role]';
      const relationship = document.getElementById('relationship').value;
      const walletAddress = document.getElementById('walletAddress').value || '';
      const recipientStatus = document.getElementById('recipientStatus').value;
      const tokenAmount = document.getElementById('tokenAmount').value || '[Amount]';
      const contractAddress = document.getElementById('contractAddress').value || '';
      const tokenPrice = document.getElementById('tokenPrice').value || '';
      const startDate = document.getElementById('startDate').value || '[Date]';
      const cliffMonths = document.getElementById('cliffMonths').value || '0';
      const totalMonths = document.getElementById('totalMonths').value || '48';
      const governingLaw = document.getElementById('governingLaw').value;
      const lockupPeriod = document.getElementById('lockupPeriod').checked;
      const companyConsent = document.getElementById('companyConsent').checked;
      const rightFirstRefusal = document.getElementById('rightFirstRefusal').checked;
      const confidentiality = document.getElementById('confidentiality').checked;
      const securities = document.getElementById('securities').checked;
      const taxProvisions = document.getElementById('taxProvisions').checked;
      const assignmentRestriction = document.getElementById('assignmentRestriction').checked;
      const kycAml = document.getElementById('kycAml').checked;
      const tgeConditions = document.getElementById('tgeConditions').checked;
      const onchainMechanics = document.getElementById('onchainMechanics').checked;
      const noEmploymentRights = document.getElementById('noEmploymentRights').checked;

      // Get radio button values
      let terminationType = '';
      document.querySelectorAll('input[name="termination"]').forEach(radio => {
        if (radio.checked) terminationType = radio.value;
      });

      let changeControlType = '';
      document.querySelectorAll('input[name="changeControl"]').forEach(radio => {
        if (radio.checked) changeControlType = radio.value;
      });

      let disputeType = '';
      document.querySelectorAll('input[name="disputes"]').forEach(radio => {
        if (radio.checked) disputeType = radio.value;
      });

      // Track what changed
      const changedFields = [];
      if (previousValues.companyName !== companyName) changedFields.push('company-name');
      if (previousValues.companyAddress !== companyAddress) changedFields.push('company-address');
      if (previousValues.signatoryName !== signatoryName) changedFields.push('signatory-name');
      if (previousValues.signatoryTitle !== signatoryTitle) changedFields.push('signatory-title');
      if (previousValues.recipientName !== recipientName) changedFields.push('recipient-name');
      if (previousValues.recipientAddress !== recipientAddress) changedFields.push('recipient-address');
      if (previousValues.recipientRole !== recipientRole) changedFields.push('recipient-role');
      if (previousValues.relationship !== relationship) changedFields.push('relationship');
      if (previousValues.tokenAmount !== tokenAmount) changedFields.push('token-amount');
      if (previousValues.tokenSymbol !== tokenSymbol) changedFields.push('token-symbol');
      if (previousValues.contractAddress !== contractAddress) changedFields.push('contract-address');
      if (previousValues.tokenPrice !== tokenPrice) changedFields.push('token-price');
      if (previousValues.startDate !== startDate) changedFields.push('start-date');
      if (previousValues.cliffMonths !== cliffMonths) changedFields.push('cliff-months');
      if (previousValues.totalMonths !== totalMonths) changedFields.push('total-months');
      if (previousValues.governingLaw !== governingLaw) changedFields.push('governing-law');
      if (previousValues.vestingType !== getVestingType()) changedFields.push('vesting-type');
      if (previousValues.lockupPeriod !== lockupPeriod) changedFields.push('transfer-restrictions');
      if (previousValues.companyConsent !== companyConsent) changedFields.push('transfer-restrictions');
      if (previousValues.rightFirstRefusal !== rightFirstRefusal) changedFields.push('transfer-restrictions');
      if (previousValues.terminationType !== terminationType) changedFields.push('termination-provisions');
      if (previousValues.changeControlType !== changeControlType) changedFields.push('change-control');
      if (previousValues.disputeType !== disputeType) changedFields.push('dispute-resolution');
      if (previousValues.confidentiality !== confidentiality) changedFields.push('additional-provisions');
      if (previousValues.securities !== securities) changedFields.push('additional-provisions');
      if (previousValues.taxProvisions !== taxProvisions) changedFields.push('tax-provisions');
      if (previousValues.assignmentRestriction !== assignmentRestriction) changedFields.push('assignment-clause');
      if (previousValues.kycAml !== kycAml) changedFields.push('additional-provisions');
      if (previousValues.tgeConditions !== tgeConditions) changedFields.push('company-name');
      if (previousValues.onchainMechanics !== onchainMechanics) changedFields.push('company-name');
      if (previousValues.noEmploymentRights !== noEmploymentRights) changedFields.push('company-name');
      if (previousValues.walletAddress !== walletAddress) changedFields.push('company-name');
      if (previousValues.recipientStatus !== recipientStatus) changedFields.push('additional-provisions');

      // Update previous values
      previousValues = {
        companyName,
        companyAddress,
        signatoryName,
        signatoryTitle,
        recipientName,
        recipientAddress,
        recipientRole,
        relationship,
        walletAddress,
        recipientStatus,
        tokenAmount,
        tokenSymbol,
        contractAddress,
        tokenPrice,
        startDate,
        cliffMonths,
        totalMonths,
        governingLaw,
        vestingType: getVestingType(),
        lockupPeriod,
        companyConsent,
        rightFirstRefusal,
        terminationType,
        changeControlType,
        disputeType,
        confidentiality,
        securities,
        taxProvisions,
        assignmentRestriction,
        kycAml,
        tgeConditions,
        onchainMechanics,
        noEmploymentRights
      };

      const vestingType = getVestingType();

      const html = `
        <div class="doc-title">${tokenName} Token Vesting Agreement</div>

        <div class="doc-section">
          <p class="doc-paragraph">
            This Token Vesting Agreement (the "Agreement") is entered into as of <span id="start-date">${startDate}</span> (the "Effective Date"), by and between:
          </p>
          <p class="doc-paragraph">
            <strong><span id="company-name">${companyName}</span></strong>, a company organized under the laws of <span id="governing-law">${governingLaw}</span>, with address at <span id="company-address">${companyAddress}</span> (the "Company"), and
          </p>
          <p class="doc-paragraph">
            <strong><span id="recipient-name">${recipientName}</span></strong>, <span id="relationship">${relationship}</span> of the Company, with address at <span id="recipient-address">${recipientAddress}</span> (the "Recipient").
          </p>
          <p class="doc-paragraph">
            <strong>RECITALS:</strong> Recipient is serving as <span id="recipient-role-recital">${recipientRole}</span> and the Company desires to grant Recipient the right to receive certain tokens subject to vesting and the terms set forth herein. This grant is made in consideration for Recipient's services to the Company and is subject to all restrictions and conditions contained in this Agreement.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">DEFINITIONS</div>
          <p class="doc-paragraph">
            <strong>"Tokens"</strong> means ${tokenName} tokens with the symbol ${tokenSymbol}, implemented as ${document.getElementById('tokenStandard').value} tokens.
          </p>
          <p class="doc-paragraph">
            <strong>"Vesting Start Date"</strong> means the Effective Date specified above.
          </p>
          <p class="doc-paragraph">
            <strong>"Cliff Period"</strong> means the initial ${cliffMonths}-month period during which no Tokens shall vest${cliffMonths == 0 ? ' (zero months - no cliff applies)' : ''}.
          </p>
          <p class="doc-paragraph">
            <strong>"Vesting Period"</strong> means the ${totalMonths}-month period commencing on the Vesting Start Date during which the Tokens shall vest according to the schedule described herein.
          </p>
          <p class="doc-paragraph">
            <strong>"Vested Tokens"</strong> means Tokens that have satisfied all vesting conditions as of a given date and are no longer subject to forfeiture under this Agreement.
          </p>
          <p class="doc-paragraph">
            <strong>"Unvested Tokens"</strong> means Tokens that have not yet satisfied vesting conditions and remain subject to forfeiture. Unvested Tokens confer no rights to Recipient, including no voting, economic, or other rights, until they vest.
          </p>
          ${tgeConditions ? `<p class="doc-paragraph">
            <strong>"Token Generation Event" or "TGE"</strong> means the initial issuance or creation of the Tokens on the blockchain, whether through a token sale, airdrop, or other distribution method.
          </p>` : ''}
          <p class="doc-paragraph">
            <strong>"Change of Control"</strong> means: (a) the acquisition of the Company by another entity by means of merger, consolidation, or similar transaction; (b) a sale of all or substantially all of the Company's assets; or (c) any transaction resulting in a change of ownership of more than 50% of the Company's voting securities.
          </p>
          <p class="doc-paragraph">
            <strong>"Cause"</strong> means: (i) conviction of any felony or crime involving fraud or dishonesty; (ii) participation in fraud, embezzlement, or misappropriation against the Company; (iii) material breach of this Agreement or any other agreement with the Company; or (iv) gross negligence or willful misconduct materially harmful to the Company's business or reputation.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">1. GRANT OF TOKENS</div>
          <p class="doc-paragraph">
            Subject to the terms and conditions of this Agreement, the Company hereby grants to Recipient, in their capacity as <span id="recipient-role">${recipientRole}</span>, the conditional right to receive <strong class="highlight"><span id="token-amount">${formatNumber(tokenAmount)}</span> <span id="token-symbol">${tokenSymbol}</span></strong> tokens (the "Tokens"), subject to the vesting schedule described in Section 2 below.
          </p>
          <p class="doc-paragraph">
            The Tokens are ${tokenName} tokens with the symbol ${tokenSymbol}, implemented as ${document.getElementById('tokenStandard').value} tokens${contractAddress ? `, with smart contract address <span id="contract-address">${contractAddress}</span>` : ' (smart contract address to be determined)'}.${tokenPrice ? ` The reference price per token is <span id="token-price">$${tokenPrice} USD</span>.` : ''}${walletAddress ? ` Tokens shall be delivered to Recipient's designated wallet address: ${walletAddress}.` : ''}
          </p>
          ${tgeConditions ? `<p class="doc-paragraph">
            <strong>Conditional Grant:</strong> This grant is expressly conditioned upon: (a) the occurrence of a Token Generation Event; (b) the Company's determination that issuance and delivery of Tokens complies with all applicable securities laws, commodities laws, and other legal requirements; and (c) Recipient's satisfaction of all compliance requirements under this Agreement, including KYC/AML verification if required. If these conditions are not satisfied, the Company may, in its sole discretion, cancel this grant, substitute alternative consideration, or defer delivery.
          </p>` : ''}
          ${noEmploymentRights ? `<p class="doc-paragraph">
            <strong>No Employment Rights:</strong> This Agreement does not create any right to continued employment, engagement, or service relationship with the Company. Recipient's service relationship remains at-will (or as otherwise separately documented) and may be terminated at any time by either party. Nothing in this Agreement alters the terms of any employment or consulting agreement between the parties.
          </p>` : ''}
          <p class="doc-paragraph">
            <strong>No Rights Until Vesting:</strong> Unvested Tokens confer no rights whatsoever to Recipient, including no voting rights, no rights to distributions or dividends, and no economic interest in the Company or the Tokens. Only Vested Tokens that have been delivered to Recipient shall confer the rights associated with token ownership.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">2. VESTING SCHEDULE</div>
          <p class="doc-paragraph">
            <strong>Cliff Period:</strong> ${cliffMonths > 0 ? `No Tokens shall vest during the initial <span id="cliff-months">${cliffMonths}-month</span> cliff period.` : '<span id="cliff-months">No cliff period</span> applies; vesting begins immediately.'}
          </p>
          <p class="doc-paragraph">
            <strong>Vesting Type:</strong> Following any applicable cliff period, Tokens shall vest on a <strong class="highlight"><span id="vesting-type">${vestingType}</span></strong> basis over a total period of <span id="total-months">${totalMonths} months</span> from the Effective Date.
          </p>
          <p class="doc-paragraph">
            <strong>Vesting Commencement:</strong> The vesting schedule shall commence on the Effective Date.
          </p>
          <p class="doc-paragraph">
            <strong>Fractional Tokens:</strong> Any fractional Token amounts resulting from the vesting calculations shall be rounded down to the nearest whole Token. Any residual Tokens resulting from rounding shall vest on the final vesting date. For example, if monthly vesting would result in 8,333.33 Tokens, only 8,333 whole Tokens shall vest each month, with remaining Tokens vesting at the conclusion of the Vesting Period.
          </p>
          <p class="doc-paragraph">
            The Company shall maintain accurate records of all vested and unvested Tokens and shall provide such information to Recipient upon reasonable request.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">3. TERMINATION PROVISIONS</div>
          <p class="doc-paragraph" id="termination-provisions">
            ${getTerminationText()}
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">4. CHANGE OF CONTROL</div>
          <p class="doc-paragraph" id="change-control">
            ${getChangeOfControlText()}
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">5. TRANSFER RESTRICTIONS</div>
          <p class="doc-paragraph" id="transfer-restrictions">
            ${getTransferRestrictionText()}
          </p>
        </div>

        ${onchainMechanics ? `<div class="doc-section">
          <div class="doc-section-title">6. ON-CHAIN IMPLEMENTATION AND MECHANICS</div>
          <p class="doc-paragraph">
            <strong>Implementation Method:</strong> The Company may implement the vesting schedule through a smart contract, internal ledger, third-party custody arrangement, or other mechanism in its sole discretion. The Company shall have the right to change implementation methods at any time, provided that such changes do not materially alter the economic terms of this Agreement.
          </p>
          <p class="doc-paragraph">
            <strong>Token Delivery:</strong> Vested Tokens shall be delivered to Recipient in accordance with the Company's standard procedures, which may include batch transfers at regular intervals rather than continuous delivery. Recipient acknowledges that some delay between vesting and delivery is expected and acceptable.
          </p>
          <p class="doc-paragraph">
            <strong>Gas Fees:</strong> Unless otherwise agreed, Recipient shall be responsible for all gas fees, network fees, and transaction costs associated with claiming, withdrawing, or transferring Vested Tokens from any vesting contract or Company-controlled wallet. The Company shall be responsible for gas fees associated with initial token transfers into vesting contracts.
          </p>
          <p class="doc-paragraph">
            <strong>Forks, Airdrops, and Token Changes:</strong> In the event of any blockchain fork, token swap, token migration, airdrop of derivative tokens, or similar event affecting the Tokens, the Company shall make equitable adjustments to this Agreement in good faith to preserve the intended economic arrangement. Such adjustments may include substituting new tokens, adjusting token quantities, or other measures reasonably necessary to maintain the original intent of this Agreement.
          </p>
          <p class="doc-paragraph">
            <strong>Wallet Security:</strong> Recipient is solely responsible for maintaining the security of their wallet and private keys. The Company has no obligation to replace or re-issue Tokens that are lost, stolen, sent to an incorrect address, or otherwise become inaccessible due to Recipient's actions or negligence. However, if Recipient's wallet is compromised and Recipient provides adequate proof of identity and authorization, the Company may, in its sole discretion, redirect unvested Tokens to a new wallet address provided by Recipient.
          </p>
        </div>` : ''}

        <div class="doc-section">
          <div class="doc-section-title">${onchainMechanics ? '7' : '6'}. REPRESENTATIONS AND WARRANTIES</div>
          <p class="doc-paragraph" id="additional-provisions">
            Recipient represents and warrants that:
          </p>
          <p class="doc-paragraph">
            (a) Recipient has full power and authority to enter into this Agreement and perform Recipient's obligations hereunder;
          </p>
          ${securities ? `<p class="doc-paragraph">
            (b) Recipient understands that the Tokens may constitute securities under applicable law and that the Tokens have not been registered under the Securities Act of 1933 or any state securities laws;
          </p>
          <p class="doc-paragraph">
            (c) Recipient is acquiring the Tokens for Recipient's own account for investment purposes only and not with a view to distribution, resale, or fractionalization;
          </p>
          <p class="doc-paragraph">
            (d) Recipient is ${recipientStatus === 'us-person' ? 'a U.S. Person and an "accredited investor" as defined in Rule 501 of Regulation D under the Securities Act' : 'not a U.S. Person and is acquiring the Tokens in an offshore transaction in accordance with Regulation S under the Securities Act'};
          </p>
          <p class="doc-paragraph">
            (e) Recipient acknowledges that the Tokens are subject to transfer restrictions and may not be sold, transferred, or otherwise disposed of except in compliance with applicable securities laws;
          </p>` : ''}
          ${kycAml ? `<p class="doc-paragraph">
            (f) Recipient is not identified on any list of prohibited persons under applicable sanctions laws (including OFAC, UN, EU sanctions lists), is not located in or a resident of any sanctioned country or region, and is not otherwise prohibited from receiving the Tokens under applicable law;
          </p>
          <p class="doc-paragraph">
            (g) Recipient agrees to provide all information and documentation reasonably requested by the Company for Know-Your-Customer (KYC) and Anti-Money Laundering (AML) compliance purposes, including but not limited to government-issued identification, proof of address, and beneficial ownership information;
          </p>
          <p class="doc-paragraph">
            (h) The Company may delay, withhold, or forfeit delivery of any Vested Tokens if Recipient fails to provide requested compliance information, if Recipient becomes subject to sanctions, or if the Company determines in good faith that delivery would violate applicable law;
          </p>` : ''}
          ${confidentiality ? `<p class="doc-paragraph">
            ${securities || kycAml ? '(i)' : '(b)'} Recipient agrees to maintain the confidentiality of all non-public information relating to the Company, the Tokens, and this Agreement, except as required by law or with the Company's prior written consent; and
          </p>` : ''}
          <p class="doc-paragraph">
            ${securities && kycAml && confidentiality ? '(j)' : securities || kycAml ? '(i)' : confidentiality ? '(c)' : '(b)'} Recipient has had the opportunity to ask questions and receive answers regarding the Company, the Tokens, and this Agreement, and has consulted with such legal, tax, and financial advisors as Recipient deems necessary.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">${onchainMechanics ? '8' : '7'}. GOVERNING LAW AND DISPUTE RESOLUTION</div>
          <p class="doc-paragraph">
            This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw}, without regard to conflicts of law principles.
          </p>
          <p class="doc-paragraph" id="dispute-resolution">
            ${getDisputeResolutionText()}
          </p>
          <p class="doc-paragraph">
            <strong>Injunctive Relief:</strong> Notwithstanding the foregoing dispute resolution provisions, either party may seek temporary or preliminary injunctive relief in a court of competent jurisdiction to protect its confidential information, intellectual property rights, or to prevent irreparable harm, without waiving the right to arbitration or other dispute resolution of the underlying dispute.
          </p>
        </div>

        <div class="doc-section">
          <div class="doc-section-title">${onchainMechanics ? '9' : '8'}. MISCELLANEOUS</div>
          <p class="doc-paragraph">
            <strong>Entire Agreement:</strong> This Agreement constitutes the entire agreement between the parties regarding the subject matter hereof.
          </p>
          <p class="doc-paragraph">
            <strong>Amendment:</strong> This Agreement may only be amended by a written instrument signed by both parties.
          </p>
          <p class="doc-paragraph" id="assignment-clause">
            <strong>Assignment:</strong> ${document.getElementById('assignmentRestriction').checked ? 'Neither party may assign this Agreement without the prior written consent of the other party.' : 'This Agreement shall bind and inure to the benefit of the parties and their respective successors and permitted assigns.'}
          </p>
          <p class="doc-paragraph">
            <strong>Severability:</strong> If any provision of this Agreement is held invalid or unenforceable, the remaining provisions shall continue in full force and effect.
          </p>
        </div>

        ${taxProvisions ? `
        <div class="doc-section">
          <div class="doc-section-title">${onchainMechanics ? '10' : '9'}. TAX MATTERS</div>
          <p class="doc-paragraph" id="tax-provisions">
            <strong>Tax Responsibility:</strong> Recipient acknowledges and agrees that Recipient is solely responsible for all tax consequences arising from this Agreement, the grant, vesting, or transfer of Tokens, and any subsequent disposition of Tokens. The Company makes no representations or warranties regarding the tax treatment of the Tokens or this Agreement.
          </p>
          <p class="doc-paragraph">
            <strong>Tax Withholding:</strong> The Company shall have the right to withhold from any amounts payable to Recipient (including Tokens deliverable hereunder or other compensation) such amounts as the Company determines are required to satisfy any federal, state, local, or foreign tax withholding obligations. Recipient may be required to deliver cash to the Company or authorize the Company to withhold Tokens (at their fair market value as determined by the Company) to satisfy such obligations.
          </p>
          <p class="doc-paragraph">
            <strong>83(b) Election Notice:</strong> Recipient acknowledges that they have been advised to consult with a qualified tax advisor regarding the advisability of filing an Internal Revenue Code Section 83(b) election with respect to the Tokens. If applicable and if Recipient determines such an election is appropriate, any such election must be filed with the Internal Revenue Service within 30 days of the Effective Date (or other applicable grant date). The Company does not provide tax advice and does not file 83(b) elections on behalf of Recipients. Failure to timely file an 83(b) election, if appropriate, may result in adverse tax consequences.
          </p>
          <p class="doc-paragraph">
            <strong>Tax Reporting:</strong> Recipient agrees to provide the Company with any information reasonably requested for tax reporting purposes, including completed Form W-9 or W-8 (as applicable) and updates to such information as needed.
          </p>
        </div>
        ` : ''}

        <div class="doc-section" style="margin-top: 40px;">
          <div class="doc-section-title">SIGNATURES</div>
          <p class="doc-paragraph">
            IN WITNESS WHEREOF, the parties have executed this Token Vesting Agreement as of the Effective Date.
          </p>
          <div style="margin-top: 30px;">
            <p><strong>COMPANY:</strong></p>
            <p>${companyName}</p>
            <p style="margin-top: 20px;">By: _________________________</p>
            <p>Name: <span id="signatory-name">${signatoryName}</span></p>
            <p>Title: <span id="signatory-title">${signatoryTitle}</span></p>
          </div>
          <div style="margin-top: 30px;">
            <p><strong>RECIPIENT:</strong></p>
            <p>By: _________________________</p>
            <p>Name: ${recipientName}</p>
            <p>Date: _________________________</p>
          </div>
        </div>
      `;

      document.getElementById('previewBox').innerHTML = html;

      // Highlight and scroll to changed fields
      if (changedFields.length > 0) {
        setTimeout(() => {
          changedFields.forEach((fieldId, index) => {
            const element = document.getElementById(fieldId);
            if (element) {
              // Add highlight class
              element.classList.add('highlight-flash');

              // Scroll to first changed element
              if (index === 0) {
                element.scrollIntoView({
                  behavior: 'smooth',
                  block: 'center',
                  inline: 'nearest'
                });
              }

              // Remove highlight after 10 seconds
              setTimeout(() => {
                element.classList.remove('highlight-flash');
              }, 10000);
            }
          });
        }, 100);
      }

      updateVestingCalculator();
    }

    function getVestingType() {
      let vestingType = '';
      document.querySelectorAll('input[name="vestingType"]').forEach(radio => {
        if (radio.checked) {
          vestingType = radio.value === 'linear' ? 'linear (continuous)' :
                        radio.value === 'monthly' ? 'monthly' :
                        radio.value === 'quarterly' ? 'quarterly' : 'yearly';
        }
      });
      return vestingType;
    }

    function getTerminationText() {
      let terminationType = '';
      document.querySelectorAll('input[name="termination"]').forEach(radio => {
        if (radio.checked) terminationType = radio.value;
      });

      switch(terminationType) {
        case 'standard':
          return 'In the event that Recipient\'s service relationship with the Company terminates for any reason, all unvested Tokens shall cease vesting as of the termination date and shall be forfeited. All Tokens that have vested as of the termination date shall remain the property of Recipient.';
        case 'for-cause':
          return 'In the event that Recipient\'s service relationship with the Company is terminated for Cause (as defined below), all Tokens, whether vested or unvested, shall be immediately forfeited to the Company. For purposes of this Agreement, "Cause" means: (i) conviction of any felony or crime involving fraud or dishonesty; (ii) participation in fraud, embezzlement, or misappropriation against the Company; (iii) material breach of this Agreement; or (iv) gross negligence or willful misconduct materially harmful to the Company. If the relationship terminates for any reason other than for Cause, unvested Tokens shall be forfeited and vested Tokens shall remain with Recipient.';
        case 'partial':
          return 'In the event that Recipient\'s service relationship with the Company is terminated by the Company without Cause, 50% of the then-unvested Tokens shall immediately vest and the remaining unvested Tokens shall be forfeited. If the relationship terminates for any other reason, all unvested Tokens shall be forfeited and vested Tokens shall remain with Recipient.';
        default:
          return '';
      }
    }

    function getChangeOfControlText() {
      let controlType = '';
      document.querySelectorAll('input[name="changeControl"]').forEach(radio => {
        if (radio.checked) controlType = radio.value;
      });

      const cocDefinition = 'For purposes of this Agreement, "Change of Control" means: (a) the acquisition of the Company by another entity by means of merger, consolidation, or similar transaction; (b) a sale of all or substantially all of the Company\'s assets; or (c) any transaction resulting in a change of ownership of more than 50% of the Company\'s voting securities.';

      switch(controlType) {
        case 'double-trigger':
          return `<strong>Double-Trigger Acceleration:</strong> In the event of a Change of Control, if Recipient's service relationship is terminated without Cause within 12 months following such Change of Control, all unvested Tokens shall immediately vest in full. ${cocDefinition}`;
        case 'full':
          return `<strong>Full Acceleration:</strong> In the event of a Change of Control, all unvested Tokens shall immediately vest in full upon the closing of such transaction. ${cocDefinition}`;
        case 'none':
          return `<strong>No Acceleration:</strong> The vesting schedule shall continue unchanged in the event of a Change of Control. ${cocDefinition}`;
        default:
          return '';
      }
    }

    function getTransferRestrictionText() {
      let restrictions = [];

      if (document.getElementById('lockupPeriod').checked) {
        const lockupMonths = document.getElementById('lockupMonths').value || '6';
        restrictions.push(`Even after vesting, all Tokens shall be subject to a lockup period of ${lockupMonths} months from the date of vesting, during which Recipient may not sell, transfer, or otherwise dispose of such Tokens.`);
      }

      if (document.getElementById('companyConsent').checked) {
        restrictions.push('Recipient may not sell, transfer, assign, or otherwise dispose of any vested Tokens without the prior written consent of the Company.');
      }

      if (document.getElementById('rightFirstRefusal').checked) {
        restrictions.push('Prior to any proposed transfer of vested Tokens to a third party, Recipient must first offer such Tokens to the Company at the proposed transfer price. The Company shall have 30 days to exercise its right of first refusal.');
      }

      if (restrictions.length === 0) {
        return 'Subject to applicable securities laws and the terms of this Agreement, vested Tokens may be freely transferred by Recipient.';
      }

      return restrictions.join(' ');
    }

    function getDisputeResolutionText() {
      let disputeType = '';
      document.querySelectorAll('input[name="disputes"]').forEach(radio => {
        if (radio.checked) disputeType = radio.value;
      });

      const governingLaw = document.getElementById('governingLaw').value;

      if (disputeType === 'arbitration') {
        return `Any dispute arising out of or relating to this Agreement shall be resolved by binding arbitration in ${governingLaw} administered by the American Arbitration Association under its Commercial Arbitration Rules. The arbitrator's award shall be final and binding and may be entered as a judgment in any court of competent jurisdiction.`;
      } else {
        return `The parties consent to the exclusive jurisdiction and venue of the state and federal courts located in ${governingLaw} for any legal proceedings arising out of or relating to this Agreement.`;
      }
    }

    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function updateVestingCalculator() {
      const tokenAmount = parseInt(document.getElementById('tokenAmount').value) || 0;
      const cliffMonths = parseInt(document.getElementById('cliffMonths').value) || 0;
      const totalMonths = parseInt(document.getElementById('totalMonths').value) || 48;
      const startDate = new Date(document.getElementById('startDate').value);

      if (!tokenAmount || !totalMonths || isNaN(startDate.getTime())) {
        document.getElementById('vestingTimeline').innerHTML = '<p style="text-align: center; color: #64748b; font-size: 13px;">Complete the form to see vesting schedule</p>';
        return;
      }

      let vestingType = 'linear';
      document.querySelectorAll('input[name="vestingType"]').forEach(radio => {
        if (radio.checked) vestingType = radio.value;
      });

      const timeline = [];

      // Cliff event
      if (cliffMonths > 0) {
        const cliffDate = new Date(startDate);
        cliffDate.setMonth(cliffDate.getMonth() + cliffMonths);

        let cliffAmount = 0;
        if (vestingType === 'linear') {
          cliffAmount = Math.floor((tokenAmount / totalMonths) * cliffMonths);
        } else if (vestingType === 'monthly') {
          cliffAmount = Math.floor((tokenAmount / totalMonths) * cliffMonths);
        } else if (vestingType === 'quarterly') {
          const quartersElapsed = Math.floor(cliffMonths / 3);
          cliffAmount = Math.floor((tokenAmount / (totalMonths / 3)) * quartersElapsed);
        } else if (vestingType === 'yearly') {
          const yearsElapsed = Math.floor(cliffMonths / 12);
          cliffAmount = Math.floor((tokenAmount / (totalMonths / 12)) * yearsElapsed);
        }

        timeline.push({
          date: cliffDate,
          label: `Cliff (${cliffMonths} months)`,
          amount: cliffAmount,
          cumulative: cliffAmount
        });
      }

      // Subsequent vesting events
      let cumulativeVested = timeline.length > 0 ? timeline[0].cumulative : 0;
      const vestingMonths = totalMonths - cliffMonths;

      if (vestingType === 'monthly') {
        const monthlyAmount = Math.floor(tokenAmount / totalMonths);
        for (let i = 1; i <= Math.min(5, vestingMonths); i++) {
          const vestDate = new Date(startDate);
          vestDate.setMonth(vestDate.getMonth() + cliffMonths + i);
          cumulativeVested += monthlyAmount;
          timeline.push({
            date: vestDate,
            label: `Month ${cliffMonths + i}`,
            amount: monthlyAmount,
            cumulative: Math.min(cumulativeVested, tokenAmount)
          });
        }
      } else if (vestingType === 'quarterly') {
        const quarterlyAmount = Math.floor(tokenAmount / (totalMonths / 3));
        const quarters = Math.floor(vestingMonths / 3);
        for (let i = 1; i <= Math.min(4, quarters); i++) {
          const vestDate = new Date(startDate);
          vestDate.setMonth(vestDate.getMonth() + cliffMonths + (i * 3));
          cumulativeVested += quarterlyAmount;
          timeline.push({
            date: vestDate,
            label: `Quarter ${i}`,
            amount: quarterlyAmount,
            cumulative: Math.min(cumulativeVested, tokenAmount)
          });
        }
      } else if (vestingType === 'yearly') {
        const yearlyAmount = Math.floor(tokenAmount / (totalMonths / 12));
        const years = Math.floor(vestingMonths / 12);
        for (let i = 1; i <= Math.min(4, years); i++) {
          const vestDate = new Date(startDate);
          vestDate.setMonth(vestDate.getMonth() + cliffMonths + (i * 12));
          cumulativeVested += yearlyAmount;
          timeline.push({
            date: vestDate,
            label: `Year ${i}`,
            amount: yearlyAmount,
            cumulative: Math.min(cumulativeVested, tokenAmount)
          });
        }
      } else {
        // Linear - show key milestones
        const milestones = [25, 50, 75, 100];
        milestones.forEach(pct => {
          const monthsToVest = Math.floor((totalMonths * pct) / 100);
          if (monthsToVest > cliffMonths) {
            const vestDate = new Date(startDate);
            vestDate.setMonth(vestDate.getMonth() + monthsToVest);
            const amount = Math.floor((tokenAmount * pct) / 100);
            timeline.push({
              date: vestDate,
              label: `${pct}% Vested`,
              amount: 0,
              cumulative: amount
            });
          }
        });
      }

      let html = '<div class="vesting-timeline">';
      timeline.forEach(item => {
        html += `
          <div class="timeline-item">
            <span class="timeline-date">${item.date.toLocaleDateString()}</span>
            <span class="timeline-amount">${formatNumber(item.cumulative)} tokens</span>
          </div>
        `;
      });
      html += '</div>';

      document.getElementById('vestingTimeline').innerHTML = html;
    }

    // Check form completion and enable PayPal button
    function checkFormCompletion() {
      const requiredFields = [
        'companyName', 'companyAddress', 'signatoryName', 'signatoryTitle',
        'recipientName', 'recipientAddress', 'recipientRole', 'relationship',
        'tokenName', 'tokenSymbol', 'tokenAmount', 'startDate',
        'cliffMonths', 'totalMonths', 'governingLaw'
      ];

      const allFilled = requiredFields.every(fieldId => {
        const field = document.getElementById(fieldId);
        return field && field.value && field.value.trim() !== '';
      });

      if (allFilled) {
        renderPayPalButton();
      } else {
        document.getElementById('paypalButtonContainer').innerHTML =
          '<div class="payment-disabled">Complete all required fields above to proceed to payment</div>';
      }
    }

    // Render PayPal button
    function renderPayPalButton() {
      const container = document.getElementById('paypalButtonContainer');
      container.innerHTML = '';

      paypal.Buttons({
        createOrder: function(data, actions) {
          return actions.order.create({
            purchase_units: [{
              description: 'Token Vesting Agreement - Professional Template',
              amount: {
                value: '19.95'
              }
            }]
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            // Collect form data
            const formData = {
              companyName: document.getElementById('companyName').value,
              companyAddress: document.getElementById('companyAddress').value,
              signatoryName: document.getElementById('signatoryName').value,
              signatoryTitle: document.getElementById('signatoryTitle').value,
              recipientName: document.getElementById('recipientName').value,
              recipientAddress: document.getElementById('recipientAddress').value,
              recipientRole: document.getElementById('recipientRole').value,
              relationship: document.getElementById('relationship').value,
              walletAddress: document.getElementById('walletAddress').value || 'Not provided',
              recipientStatus: document.getElementById('recipientStatus').value,
              tokenName: document.getElementById('tokenName').value,
              tokenSymbol: document.getElementById('tokenSymbol').value,
              tokenAmount: document.getElementById('tokenAmount').value,
              tokenStandard: document.getElementById('tokenStandard').value,
              contractAddress: document.getElementById('contractAddress').value || 'Not yet deployed',
              tokenPrice: document.getElementById('tokenPrice').value || 'Not specified',
              startDate: document.getElementById('startDate').value,
              cliffMonths: document.getElementById('cliffMonths').value,
              totalMonths: document.getElementById('totalMonths').value,
              governingLaw: document.getElementById('governingLaw').value,
              amount: 19.95,
              paypalOrderId: details.id,
              paypalPayerName: details.payer.name.given_name + ' ' + details.payer.name.surname,
              paypalPayerEmail: details.payer.email_address
            };

            // Create email body
            const emailBody = `
NEW TOKEN VESTING AGREEMENT ORDER
========================================

PAYMENT DETAILS:
- PayPal Order ID: ${formData.paypalOrderId}
- Amount Paid: $${formData.amount}
- PayPal Payer: ${formData.paypalPayerName} (${formData.paypalPayerEmail})

COMPANY INFORMATION:
- Company Name: ${formData.companyName}
- Company Address: ${formData.companyAddress}
- Signatory Name: ${formData.signatoryName}
- Signatory Title: ${formData.signatoryTitle}

RECIPIENT INFORMATION:
- Recipient Name: ${formData.recipientName}
- Recipient Address: ${formData.recipientAddress}
- Role/Position: ${formData.recipientRole}
- Relationship: ${formData.relationship}
- Wallet Address: ${formData.walletAddress}
- Status: ${formData.recipientStatus}

TOKEN DETAILS:
- Token Name: ${formData.tokenName}
- Token Symbol: ${formData.tokenSymbol}
- Token Amount: ${formData.tokenAmount}
- Token Standard: ${formData.tokenStandard}
- Smart Contract: ${formData.contractAddress}
- Token Price: ${formData.tokenPrice}

VESTING SCHEDULE:
- Start Date: ${formData.startDate}
- Cliff Period: ${formData.cliffMonths} months
- Total Vesting Period: ${formData.totalMonths} months
- Governing Law: ${formData.governingLaw}

========================================
This order was submitted automatically after successful PayPal payment.
            `.trim();

            // Send email using Web3Forms service
            fetch('https://api.web3forms.com/submit', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
              },
              body: JSON.stringify({
                access_key: 'YOUR_WEB3FORMS_ACCESS_KEY_HERE',
                subject: `New Token Vesting Agreement Order - ${formData.tokenSymbol}`,
                from_name: formData.companyName,
                email: formData.paypalPayerEmail,
                message: emailBody,
                to_email: 'owner@terms.law',
                company_name: formData.companyName,
                token_symbol: formData.tokenSymbol,
                amount_paid: formData.amount,
                paypal_order_id: formData.paypalOrderId
              })
            })
            .then(response => response.json())
            .then(data => {
              console.log('Form submitted successfully:', data);
            })
            .catch(error => {
              console.error('Error submitting form:', error);
            });

            // Show success message
            document.getElementById('paymentSuccess').innerHTML = `
              <div class="payment-success">
                <div class="payment-success-icon">‚úì</div>
                <strong>Payment Successful!</strong><br>
                Order ID: ${details.id}<br><br>
                Your token vesting agreement is ready. Check your email at ${details.payer.email_address} for details.<br>
                You can now download your agreement using the "Download DOCX" button below.
              </div>
            `;
            document.getElementById('paymentSuccess').style.display = 'block';

            // Enable download button (you can implement DOCX generation here)
            alert('Payment successful! Your order ID: ' + details.id + '\\n\\nYour agreement is ready. We will email you the download link shortly at: ' + details.payer.email_address);
          });
        },
        onError: function(err) {
          console.error('PayPal error:', err);
          alert('Payment error. Please try again or contact owner@terms.law');
        }
      }).render('#paypalButtonContainer');
    }

    // Add event listeners to all form inputs to check completion
    const allFormInputs = document.querySelectorAll('.form-input, .form-select, input[type="radio"], input[type="checkbox"]');
    allFormInputs.forEach(input => {
      input.addEventListener('change', checkFormCompletion);
      input.addEventListener('input', checkFormCompletion);
    });

    // Toggle expandable help sections
    function toggleHelp(header) {
      const helpSection = header.parentElement;
      const content = header.nextElementSibling;

      helpSection.classList.toggle('active');

      if (content.classList.contains('active')) {
        content.classList.remove('active');
      } else {
        content.classList.add('active');
      }
    }

    // Initialize preview and check form
    updatePreview();
    checkFormCompletion();
  </script>

</body>
</html>
