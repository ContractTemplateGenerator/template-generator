<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyamorous & Swinger Privacy NDA Generator | Terms.Law</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #5a67d8;
            --primary-light: #a78bfa;
            --accent: #f093fb;
            --accent-dark: #f093fb;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --bg-primary: #ffffff;
            --bg-secondary: #f7fafc;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-card: rgba(255, 255, 255, 0.95);
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
        }
        
        .app {
            min-height: 100vh;
            background: var(--bg-gradient);
            position: relative;
        }
        
        .app::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .header-section {
            position: relative;
            z-index: 1;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 1rem;
            margin-bottom: 1rem;
            overflow: hidden;
            padding: 1.5rem;
            text-align: center;
        }
        
        .header-section h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--bg-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }
        
        .header-section p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin: 0;
        }
        
        .container {
            position: relative;
            z-index: 1;
            margin: 0 1rem 1rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            max-width: 100vw;
        }
        
        .form-section, .preview-section {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            height: calc(100vh - 12rem);
            display: flex;
            flex-direction: column;
        }
        
        .section-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.1"><polygon points="36 34 6 34 6 4 36 4"/></g></g></svg>');
            opacity: 0.3;
        }
        
        .section-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .section-header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
            line-height: 1.5;
        }
        
        .form-content {
            padding: 2rem;
            flex: 1;
            overflow-y: auto;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 1px solid #f59e0b;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .warning-box::before {
            content: '\f071';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: #f59e0b;
            opacity: 0.3;
        }
        
        .warning-box strong {
            color: #92400e;
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .nda-type-selector {
            background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%);
            border: 2px solid #0288d1;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .nda-type-selector h3 {
            color: #01579b;
            font-size: 1.25rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .nda-options {
            display: grid;
            gap: 1rem;
        }
        
        .nda-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nda-option:hover {
            border-color: var(--primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .nda-option.active {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }
        
        .nda-option input[type="radio"] {
            width: 1.25rem;
            height: 1.25rem;
            margin: 0;
        }
        
        .nda-option-content h4 {
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .nda-option-content p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        .event-details {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #10b981;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-top: 1.5rem;
            display: none;
        }
        
        .event-details.show {
            display: block;
            animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .tab-container {
            margin-top: 1rem;
        }
        
        .tab-nav {
            display: flex;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }
        
        .tab-btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            background: transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-secondary);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .tab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-gradient);
            border-radius: var(--radius-md);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .tab-btn span {
            position: relative;
            z-index: 1;
        }
        
        .tab-btn.active {
            color: white;
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .tab-btn.active::before {
            opacity: 1;
        }
        
        .tab-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
            animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .tab-content h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .tab-content h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: var(--bg-gradient);
            border-radius: 2px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%);
            border: 1px solid #0288d1;
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            color: #01579b;
            position: relative;
            overflow: hidden;
        }
        
        .info-box::before {
            content: '\f05a';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.25rem;
            opacity: 0.3;
        }
        
        .party-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .party-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--bg-gradient);
        }
        
        .party-section:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .party-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .party-section h3::before {
            content: '\f007';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="number"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            color: var(--text-primary);
        }
        
        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .checkbox-group {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .checkbox-label {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.25rem;
            background: white;
            border: 2px solid var(--border-light);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .checkbox-label::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .checkbox-label:hover {
            border-color: var(--primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .checkbox-label:hover::before {
            opacity: 0.05;
        }
        
        input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
        }
        
        input[type="checkbox"]:checked {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        input[type="checkbox"]:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 0.75rem;
        }
        
        .checkbox-label span {
            font-weight: 500;
            color: var(--text-primary);
            position: relative;
            z-index: 1;
        }
        
        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        button {
            padding: 1rem 2rem;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-family: inherit;
        }
        
        .btn-primary {
            background: var(--bg-gradient);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: white;
            color: var(--text-primary);
            border: 2px solid var(--border);
        }
        
        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .download-btn {
            flex: 1;
            min-width: 200px;
            padding: 1.25rem 2rem;
            font-size: 1.1rem;
            margin-top: 1rem;
        }
        
        .add-btn {
            width: 100%;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            margin-top: 1rem;
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .remove-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            font-size: 0.9rem;
            margin-top: 1rem;
        }
        
        .remove-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        /* Preview Section */
        .preview-section .section-header {
            background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
        }
        
        .preview-container {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: white;
            margin: 0;
        }
        
        .preview-content {
            font-family: 'Times New Roman', serif;
            font-size: 11pt;
            line-height: 1.6;
            color: #000;
            max-width: none;
        }
        
        .preview-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .preview-container::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }
        
        .preview-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        .preview-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* Footer */
        .footer-info {
            grid-column: 1 / -1;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 2rem;
            text-align: center;
            margin-top: 2rem;
        }
        
        .footer-info p {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .footer-info a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .footer-info a:hover {
            color: var(--primary-dark);
        }
        
        /* Responsive Design */
        @media (max-width: 1400px) {
            .container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin: 0 0.5rem 0.5rem;
            }
            
            .header-section {
                margin: 0.5rem;
            }
            
            .preview-container {
                height: 500px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 0 0.25rem 0.25rem;
            }
            
            .header-section {
                margin: 0.25rem;
                padding: 1rem;
            }
            
            .section-header {
                padding: 1.5rem;
            }
            
            .section-header h1 {
                font-size: 1.75rem;
            }
            
            .header-section h1 {
                font-size: 1.5rem;
            }
            
            .form-content {
                padding: 1.5rem;
            }
            
            .tab-nav {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .tab-btn {
                flex: none;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .download-btn {
                min-width: auto;
            }
        }
        
        @media (max-width: 480px) {
            .section-header h1 {
                font-size: 1.5rem;
            }
            
            .header-section h1 {
                font-size: 1.25rem;
            }
            
            .section-header p,
            .header-section p {
                font-size: 1rem;
            }
            
            .party-section,
            .form-content {
                padding: 1rem;
            }
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--bg-gradient);
            border-radius: 50%;
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }
        
        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            margin-bottom: 0.5rem;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        /* Risk Assessment Styles */
        .risk-overview {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0369a1;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .risk-overview h3 {
            color: #0369a1;
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .risk-overview h3::before {
            content: '\f0e3';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
        }
        
        .risk-item {
            margin-bottom: 1.5rem;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }
        
        .risk-item::before {
            content: '';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 1.5rem;
            opacity: 0.3;
        }
        
        .risk-high {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-left-color: #dc2626;
            border: 1px solid #fca5a5;
        }
        
        .risk-high::before {
            content: '\f071';
            color: #dc2626;
        }
        
        .risk-medium {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left-color: #d97706;
            border: 1px solid #fcd34d;
        }
        
        .risk-medium::before {
            content: '\f06a';
            color: #d97706;
        }
        
        .risk-low {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-left-color: #16a34a;
            border: 1px solid #86efac;
        }
        
        .risk-low::before {
            content: '\f05a';
            color: #16a34a;
        }
        
        .risk-item h4 {
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .risk-high h4 {
            color: #991b1b;
        }
        
        .risk-medium h4 {
            color: #92400e;
        }
        
        .risk-low h4 {
            color: #15803d;
        }
        
        .risk-item p {
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }
        
        .risk-high p {
            color: #7f1d1d;
        }
        
        .risk-medium p {
            color: #78350f;
        }
        
        .risk-low p {
            color: #14532d;
        }
        
        .risk-recommendation {
            background: rgba(255, 255, 255, 0.8);
            padding: 1rem;
            border-radius: var(--radius-md);
            margin-top: 0.75rem;
            font-weight: 500;
        }
        
        .risk-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .risk-badge.high {
            background: #dc2626;
            color: white;
        }
        
        .risk-badge.medium {
            background: #d97706;
            color: white;
        }
        
        .risk-badge.low {
            background: #16a34a;
            color: white;
        }
        
        /* Preview Highlighting */
        .preview-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            margin: -0.25rem -0.5rem;
            transition: all 0.6s ease;
            animation: highlightPulse 1.5s ease-out;
        }
        
        @keyframes highlightPulse {
            0% {
                background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                transform: scale(1.02);
            }
            50% {
                background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                transform: scale(1.02);
            }
            100% {
                background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header-section">
            <h1><i class="fas fa-heart"></i> Polyamorous & Swinger Privacy NDA Generator</h1>
            <p>Create comprehensive privacy agreements for polyamorous relationships, swinger activities, consensual multi-partner encounters, and exclusive events. Professional-grade legal protection for all participants.</p>
        </div>
        
        <div class="container">
            <div class="form-section">
                <div class="section-header">
                    <h1><i class="fas fa-cogs"></i> Agreement Configuration</h1>
                    <p>Complete all sections to generate your customized privacy agreement</p>
                </div>
                
                <div class="form-content">

                    <div class="nda-type-selector">
                        <h3><i class="fas fa-cog"></i> NDA Type & Scope</h3>
                        <div class="nda-options">
                            <label class="nda-option active" for="generalNDA">
                                <input type="radio" id="generalNDA" name="ndaType" value="general" checked>
                                <div class="nda-option-content">
                                    <h4><i class="fas fa-users"></i> General Relationship NDA</h4>
                                    <p>For ongoing polyamorous relationships and regular swinger activities</p>
                                </div>
                            </label>
                            <label class="nda-option" for="eventNDA">
                                <input type="radio" id="eventNDA" name="ndaType" value="event">
                                <div class="nda-option-content">
                                    <h4><i class="fas fa-calendar-alt"></i> Event-Specific NDA</h4>
                                    <p>For specific parties, gatherings, or one-time events with limited scope</p>
                                </div>
                            </label>
                        </div>

                        <div class="event-details" id="eventDetails">
                            <h4><i class="fas fa-calendar-check"></i> Event Information</h4>
                            <div class="form-group">
                                <label for="eventName"><i class="fas fa-tag"></i> Event Name/Title:</label>
                                <input type="text" id="eventName" placeholder="e.g., Private House Party, Pool Party, Weekend Retreat">
                            </div>
                            <div class="form-group">
                                <label for="eventDate"><i class="fas fa-calendar"></i> Event Date:</label>
                                <input type="date" id="eventDate">
                            </div>
                            <div class="form-group">
                                <label for="eventLocation"><i class="fas fa-map-marker-alt"></i> Event Location (optional):</label>
                                <input type="text" id="eventLocation" placeholder="e.g., Private Residence, Club Name (address kept confidential)">
                            </div>
                            <div class="form-group">
                                <label for="eventDescription"><i class="fas fa-align-left"></i> Event Description (optional):</label>
                                <textarea id="eventDescription" rows="3" placeholder="Brief description of the event nature and activities..."></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="tab-container">
                        <div class="tab-nav">
                            <button class="tab-btn active" data-tab="parties">
                                <span><i class="fas fa-users"></i> Parties</span>
                            </button>
                            <button class="tab-btn" data-tab="terms">
                                <span><i class="fas fa-file-contract"></i> Terms</span>
                            </button>
                            <button class="tab-btn" data-tab="protections">
                                <span><i class="fas fa-shield-alt"></i> Protections</span>
                            </button>
                            <button class="tab-btn" data-tab="risk">
                                <span><i class="fas fa-exclamation-triangle"></i> Risk Assessment</span>
                            </button>
                            <button class="tab-btn" data-tab="finalize">
                                <span><i class="fas fa-download"></i> Finalize</span>
                            </button>
                        </div>

                        <div class="tab-content active" id="parties">
                            <h2><i class="fas fa-user-friends"></i> Parties Information</h2>
                            <div class="info-box">
                                <i class="fas fa-info-circle"></i>
                                Add all parties who will be bound by this agreement. Minimum 3 parties required for multi-party relationships.
                            </div>

                            <div id="partiesContainer"></div>

                            <button class="add-btn" id="addPartyBtn">
                                <i class="fas fa-plus"></i> Add Another Party
                            </button>
                        </div>

                        <div class="tab-content" id="terms">
                            <h2><i class="fas fa-gavel"></i> Agreement Terms</h2>
                            
                            <div class="form-group">
                                <label for="stateJurisdiction"><i class="fas fa-map-marker-alt"></i> Governing Law (State/Jurisdiction):</label>
                                <select id="stateJurisdiction">
                                    <option value="">Select a State/Jurisdiction</option>
                                    <option value="Alabama">Alabama</option>
                                    <option value="Alaska">Alaska</option>
                                    <option value="Arizona">Arizona</option>
                                    <option value="Arkansas">Arkansas</option>
                                    <option value="California">California</option>
                                    <option value="Colorado">Colorado</option>
                                    <option value="Connecticut">Connecticut</option>
                                    <option value="Delaware">Delaware</option>
                                    <option value="Florida">Florida</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Hawaii">Hawaii</option>
                                    <option value="Idaho">Idaho</option>
                                    <option value="Illinois">Illinois</option>
                                    <option value="Indiana">Indiana</option>
                                    <option value="Iowa">Iowa</option>
                                    <option value="Kansas">Kansas</option>
                                    <option value="Kentucky">Kentucky</option>
                                    <option value="Louisiana">Louisiana</option>
                                    <option value="Maine">Maine</option>
                                    <option value="Maryland">Maryland</option>
                                    <option value="Massachusetts">Massachusetts</option>
                                    <option value="Michigan">Michigan</option>
                                    <option value="Minnesota">Minnesota</option>
                                    <option value="Mississippi">Mississippi</option>
                                    <option value="Missouri">Missouri</option>
                                    <option value="Montana">Montana</option>
                                    <option value="Nebraska">Nebraska</option>
                                    <option value="Nevada">Nevada</option>
                                    <option value="New Hampshire">New Hampshire</option>
                                    <option value="New Jersey">New Jersey</option>
                                    <option value="New Mexico">New Mexico</option>
                                    <option value="New York">New York</option>
                                    <option value="North Carolina">North Carolina</option>
                                    <option value="North Dakota">North Dakota</option>
                                    <option value="Ohio">Ohio</option>
                                    <option value="Oklahoma">Oklahoma</option>
                                    <option value="Oregon">Oregon</option>
                                    <option value="Pennsylvania">Pennsylvania</option>
                                    <option value="Rhode Island">Rhode Island</option>
                                    <option value="South Carolina">South Carolina</option>
                                    <option value="South Dakota">South Dakota</option>
                                    <option value="Tennessee">Tennessee</option>
                                    <option value="Texas">Texas</option>
                                    <option value="Utah">Utah</option>
                                    <option value="Vermont">Vermont</option>
                                    <option value="Virginia">Virginia</option>
                                    <option value="Washington">Washington</option>
                                    <option value="West Virginia">West Virginia</option>
                                    <option value="Wisconsin">Wisconsin</option>
                                    <option value="Wyoming">Wyoming</option>
                                    <option value="District of Columbia">District of Columbia</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="effectiveDate"><i class="fas fa-calendar-alt"></i> Effective Date:</label>
                                <input type="date" id="effectiveDate">
                            </div>

                            <div class="form-group">
                                <label for="duration"><i class="fas fa-clock"></i> Duration of Agreement:</label>
                                <select id="duration">
                                    <option value="1">1 year</option>
                                    <option value="2">2 years</option>
                                    <option value="3" selected>3 years</option>
                                    <option value="5">5 years</option>
                                    <option value="10">10 years</option>
                                    <option value="event-only">Event Duration Only (for event-specific NDAs)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="liquidatedDamages"><i class="fas fa-dollar-sign"></i> Liquidated Damages Amount:</label>
                                <input type="number" id="liquidatedDamages" value="10000" min="0">
                                <div class="info-box">
                                    <i class="fas fa-lightbulb"></i>
                                    <strong>Income-Based Guidelines:</strong><br>
                                    • $5,000-$15,000: Lower to middle income levels<br>
                                    • $15,000-$35,000: Middle to upper-middle income<br>
                                    • $35,000-$75,000: High income professionals<br>
                                    Courts prefer amounts that create meaningful deterrence without being punitive.
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="disputeResolution"><i class="fas fa-balance-scale"></i> Dispute Resolution:</label>
                                <select id="disputeResolution">
                                    <option value="arbitration" selected>Private Confidential Arbitration</option>
                                    <option value="mediation">Mediation then Confidential Arbitration</option>
                                    <option value="court">Court Litigation</option>
                                </select>
                                <div class="info-box">
                                    <i class="fas fa-user-secret"></i>
                                    Confidential arbitration keeps disputes private, while court proceedings become public record.
                                </div>
                            </div>
                        </div>

                        <div class="tab-content" id="protections">
                            <h2><i class="fas fa-lock"></i> Enhanced Protections</h2>

                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeSTIProtection" checked>
                                    <span><i class="fas fa-heartbeat"></i> STI/Health Information Protection</span>
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeSocialMediaRestrictions" checked>
                                    <span><i class="fab fa-instagram"></i> Social Media Restrictions (tagging, posting, identifying)</span>
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeVenueProtection" checked>
                                    <span><i class="fas fa-map-pin"></i> Venue/Location Privacy Protection</span>
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeGroupChatProtection" checked>
                                    <span><i class="fas fa-comments"></i> Group Chat/Communication Protection</span>
                                </label>
                                
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeUnanimousConsent" checked>
                                    <span><i class="fas fa-vote-yea"></i> Unanimous Consent for Media Creation</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="digitalContentHandling"><i class="fas fa-mobile-alt"></i> Digital Content Handling:</label>
                                <select id="digitalContentHandling">
                                    <option value="deleteUponRequest" selected>Must be deleted upon any party's request</option>
                                    <option value="deleteUponTermination">Must be deleted when agreement ends</option>
                                    <option value="noDistribution">May be kept but never distributed</option>
                                    <option value="custom">Custom handling (specify below)</option>
                                </select>
                            </div>

                            <div class="form-group" id="customDigitalGroup" style="display: none;">
                                <label for="customDigitalHandling"><i class="fas fa-edit"></i> Custom Digital Content Handling:</label>
                                <textarea id="customDigitalHandling" rows="3" placeholder="Specify custom handling requirements..."></textarea>
                            </div>
                        </div>

                        <div class="tab-content" id="risk">
                            <h2><i class="fas fa-balance-scale"></i> Legal Risk Assessment</h2>
                            

                            <div id="riskAssessments"></div>
                        </div>

                        <div class="tab-content" id="finalize">
                            <h2><i class="fas fa-check-circle"></i> Finalize Agreement</h2>

                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeJoinderForm" checked>
                                    <span><i class="fas fa-user-plus"></i> Include Joinder Form (allows new parties to join later)</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="additionalTerms"><i class="fas fa-plus-circle"></i> Additional Terms (optional):</label>
                                <textarea id="additionalTerms" rows="4" placeholder="Add any additional terms not covered above..."></textarea>
                            </div>

                            <div class="button-group">
                                <button class="btn-primary download-btn" id="downloadNDA">
                                    <i class="fas fa-file-word"></i> Download Word Document
                                </button>
                                
                                <button class="btn-secondary download-btn" id="copyToClipboard">
                                    <i class="fas fa-copy"></i> Copy to Clipboard
                                </button>
                                
                                <button class="btn-secondary download-btn" id="downloadTXT">
                                    <i class="fas fa-file-alt"></i> Download Text File
                                </button>
                                
                                <button class="btn-secondary download-btn" id="downloadJoinder">
                                    <i class="fas fa-user-plus"></i> Download Joinder Form
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="preview-section">
                <div class="section-header">
                    <h1><i class="fas fa-eye"></i> Live Preview</h1>
                    <p>Real-time document generation as you complete the form</p>
                </div>
                
                <div class="preview-container">
                    <div class="preview-content" id="previewContent">
                        <!-- Preview will be generated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="footer-info">
                <p>Created by <a href="https://terms.law" target="_blank"><i class="fas fa-external-link-alt"></i> Terms.Law</a> | California Attorney Sergei Tokmakov (CA Bar #279869)</p>
                <p>For personalized legal assistance, <a href="https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting" target="_blank"><i class="fas fa-calendar"></i> schedule a consultation</a></p>
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(0,0,0,0.05); border-radius: 8px; font-size: 0.85rem; color: #666;">
                    <strong>Legal Disclaimer:</strong> This generator provides attorney-drafted templates based on general legal principles. While designed by a licensed attorney, it is not a substitute for personalized legal advice. Consider consulting with an attorney before finalizing any legal document.
                </div>
            </div>
        </div>

        <!-- Floating Action Button -->
        <div class="fab tooltip" data-tooltip="Scroll to top" onclick="scrollToTop()">
            <i class="fas fa-chevron-up"></i>
        </div>
    </div>

    <script>
        // Application state
        let formData = {
            ndaType: 'general',
            eventName: '',
            eventDate: '',
            eventLocation: '',
            eventDescription: '',
            parties: [
                { name: '', email: '' },
                { name: '', email: '' },
                { name: '', email: '' }
            ],
            stateJurisdiction: '',
            effectiveDate: '',
            duration: '3',
            liquidatedDamages: '10000',
            disputeResolution: 'arbitration',
            includeSTIProtection: true,
            includeSocialMediaRestrictions: true,
            includeVenueProtection: true,
            includeGroupChatProtection: true,
            includeUnanimousConsent: true,
            digitalContentHandling: 'deleteUponRequest',
            customDigitalHandling: '',
            additionalTerms: '',
            includeJoinderForm: true
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeNDATypeSelector();
            initializeTabs();
            initializeParties();
            initializeEventListeners();
            generatePreview();
            generateRiskAssessment();
            
            // Smooth scrolling for better UX
            document.documentElement.style.scrollBehavior = 'smooth';
        });

        // Initialize NDA Type Selector
        function initializeNDATypeSelector() {
            const ndaOptions = document.querySelectorAll('input[name="ndaType"]');
            const eventDetails = document.getElementById('eventDetails');

            ndaOptions.forEach(option => {
                option.addEventListener('change', (e) => {
                    formData.ndaType = e.target.value;
                    
                    // Update UI
                    document.querySelectorAll('.nda-option').forEach(opt => opt.classList.remove('active'));
                    e.target.closest('.nda-option').classList.add('active');
                    
                    // Show/hide event details
                    if (e.target.value === 'event') {
                        eventDetails.classList.add('show');
                        // Auto-set duration to event-only for event NDAs
                        document.getElementById('duration').value = 'event-only';
                        formData.duration = 'event-only';
                    } else {
                        eventDetails.classList.remove('show');
                        // Reset duration to default for general NDAs
                        document.getElementById('duration').value = '3';
                        formData.duration = '3';
                    }
                    
                    generatePreview();
                    generateRiskAssessment();
                    
                    // Highlight document title
                    if (e.target.value === 'event') {
                        highlightPreview(/EVENT-SPECIFIC POLYAMOROUS/i);
                    } else {
                        highlightPreview(/POLYAMOROUS\/SWINGER RELATIONSHIP/i);
                    }
                });
            });
        }

        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Tab functionality with enhanced animations
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class with slight delay for animation
                    button.classList.add('active');
                    setTimeout(() => {
                        document.getElementById(tabId).classList.add('active');
                    }, 100);
                });
            });
        }

        // Enhanced party management
        function initializeParties() {
            renderParties();
            
            document.getElementById('addPartyBtn').addEventListener('click', () => {
                formData.parties.push({ name: '', email: '' });
                renderParties();
                generatePreview();
                
                // Scroll to new party with animation
                setTimeout(() => {
                    const newParty = document.querySelector('.party-section:last-child');
                    if (newParty) {
                        newParty.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        newParty.style.transform = 'scale(1.02)';
                        setTimeout(() => {
                            newParty.style.transform = 'scale(1)';
                        }, 200);
                    }
                }, 100);
            });
        }

        function renderParties() {
            const container = document.getElementById('partiesContainer');
            container.innerHTML = '';

            formData.parties.forEach((party, index) => {
                const partyDiv = document.createElement('div');
                partyDiv.className = 'party-section';
                partyDiv.style.animationDelay = `${index * 0.1}s`;
                partyDiv.innerHTML = `
                    <h3><i class="fas fa-user"></i> Party ${index + 1}</h3>
                    <div class="form-group">
                        <label><i class="fas fa-id-card"></i> Full Legal Name:</label>
                        <div class="input-wrapper">
                            <input type="text" data-party="${index}" data-field="name" value="${party.name}" placeholder="e.g., Jane A. Smith">
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Email Address (optional):</label>
                        <div class="input-wrapper">
                            <input type="email" data-party="${index}" data-field="email" value="${party.email}" placeholder="e.g., jane@example.com">
                        </div>
                    </div>
                    ${formData.parties.length > 3 ? `<button class="remove-btn" onclick="removeParty(${index})"><i class="fas fa-trash"></i> Remove Party</button>` : ''}
                `;
                container.appendChild(partyDiv);
            });

            // Add event listeners to party inputs
            container.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const partyIndex = parseInt(e.target.getAttribute('data-party'));
                    const field = e.target.getAttribute('data-field');
                    formData.parties[partyIndex][field] = e.target.value;
                    generatePreview();
                    generateRiskAssessment();
                    if (field === 'name') {
                        highlightPreview(/the following parties[\s\S]*?(?=<p><strong>EFFECTIVE DATE)/i);
                    }
                });

                // Add focus effects
                input.addEventListener('focus', (e) => {
                    e.target.parentElement.style.transform = 'translateY(-1px)';
                });

                input.addEventListener('blur', (e) => {
                    e.target.parentElement.style.transform = 'translateY(0)';
                });
            });
        }

        function removeParty(index) {
            if (formData.parties.length > 3) {
                const partyElement = document.querySelectorAll('.party-section')[index];
                partyElement.style.transform = 'scale(0.8)';
                partyElement.style.opacity = '0';
                
                setTimeout(() => {
                    formData.parties.splice(index, 1);
                    renderParties();
                    generatePreview();
                }, 200);
            }
        }

        // Enhanced event listeners
        function initializeEventListeners() {
            // Event details
            document.getElementById('eventName').addEventListener('input', (e) => {
                formData.eventName = e.target.value;
                generatePreview();
                generateRiskAssessment();
                highlightPreview(/Event Name: .+?(?=<br>)/i);
            });

            document.getElementById('eventDate').addEventListener('change', (e) => {
                formData.eventDate = e.target.value;
                generatePreview();
                generateRiskAssessment();
                highlightPreview(/Event Date: .+?(?=<br>)/i);
            });

            document.getElementById('eventLocation').addEventListener('input', (e) => {
                formData.eventLocation = e.target.value;
                generatePreview();
                generateRiskAssessment();
                highlightPreview(/Event Location: .+?(?=<br>)/i);
            });

            document.getElementById('eventDescription').addEventListener('input', (e) => {
                formData.eventDescription = e.target.value;
                generatePreview();
                generateRiskAssessment();
                highlightPreview(/Event Description: .+?(?=<br>)/i);
            });

            // State jurisdiction
            document.getElementById('stateJurisdiction').addEventListener('change', (e) => {
                formData.stateJurisdiction = e.target.value;
                generatePreview();
                generateRiskAssessment();
                addInputAnimation(e.target);
                highlightPreview(/governed by the laws of the .+?(?=,|\.)/i);
            });

            // Effective date
            document.getElementById('effectiveDate').addEventListener('change', (e) => {
                formData.effectiveDate = e.target.value;
                generatePreview();
                generateRiskAssessment();
                addInputAnimation(e.target);
                highlightPreview(/effective as of .+?(?=\(|\.)/i);
            });

            // Duration
            document.getElementById('duration').addEventListener('change', (e) => {
                formData.duration = e.target.value;
                generatePreview();
                generateRiskAssessment();
                addInputAnimation(e.target);
                highlightPreview(/remain in effect for .+?(?=\.|from)/i);
            });

            // Liquidated damages
            document.getElementById('liquidatedDamages').addEventListener('input', (e) => {
                formData.liquidatedDamages = e.target.value;
                generatePreview();
                generateRiskAssessment();
                highlightPreview(/\$[\d,]+(?:\.\d{2})? per breach/i);
            });

            // Dispute resolution
            document.getElementById('disputeResolution').addEventListener('change', (e) => {
                formData.disputeResolution = e.target.value;
                generatePreview();
                generateRiskAssessment();
                addInputAnimation(e.target);
                highlightPreview(/14\. DISPUTE RESOLUTION[\s\S]*?(?=<p><strong>1[56789]\.|$)/i);
            });

            // Checkboxes with enhanced feedback
            const checkboxes = [
                'includeSTIProtection', 'includeSocialMediaRestrictions', 
                'includeVenueProtection', 'includeGroupChatProtection', 
                'includeUnanimousConsent', 'includeJoinderForm'
            ];
            
            checkboxes.forEach(checkboxId => {
                document.getElementById(checkboxId).addEventListener('change', (e) => {
                    formData[checkboxId] = e.target.checked;
                    generatePreview();
                    generateRiskAssessment();
                    
                    // Add visual feedback
                    const label = e.target.closest('.checkbox-label');
                    label.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        label.style.transform = 'scale(1)';
                    }, 150);

                    // Highlight relevant sections
                    if (checkboxId === 'includeSTIProtection') {
                        highlightPreview(/7\. HEALTH INFORMATION PROTECTION/i);
                    } else if (checkboxId === 'includeSocialMediaRestrictions') {
                        highlightPreview(/8\. SOCIAL MEDIA AND DIGITAL RESTRICTIONS/i);
                    } else if (checkboxId === 'includeVenueProtection') {
                        highlightPreview(/9\. VENUE AND LOCATION PRIVACY/i);
                    } else if (checkboxId === 'includeGroupChatProtection') {
                        highlightPreview(/10\. GROUP COMMUNICATIONS PROTECTION/i);
                    } else if (checkboxId === 'includeUnanimousConsent') {
                        highlightPreview(/11\. UNANIMOUS CONSENT FOR MEDIA/i);
                    }
                });
            });

            // Digital content handling
            document.getElementById('digitalContentHandling').addEventListener('change', (e) => {
                formData.digitalContentHandling = e.target.value;
                const customGroup = document.getElementById('customDigitalGroup');
                
                if (e.target.value === 'custom') {
                    customGroup.style.display = 'block';
                    customGroup.style.opacity = '0';
                    setTimeout(() => {
                        customGroup.style.opacity = '1';
                    }, 100);
                } else {
                    customGroup.style.opacity = '0';
                    setTimeout(() => {
                        customGroup.style.display = 'none';
                    }, 200);
                }
                
                generatePreview();
                addInputAnimation(e.target);
                highlightPreview(/6\. DIGITAL CONTENT AND MEDIA[\s\S]*?(?=<p><strong>[789]\.|$)/i);
            });

            // Custom digital handling
            document.getElementById('customDigitalHandling').addEventListener('input', (e) => {
                formData.customDigitalHandling = e.target.value;
                generatePreview();
            });

            // Additional terms
            document.getElementById('additionalTerms').addEventListener('input', (e) => {
                formData.additionalTerms = e.target.value;
                generatePreview();
            });

            // Download buttons with loading states
            document.getElementById('downloadNDA').addEventListener('click', () => {
                const btn = document.getElementById('downloadNDA');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span class="loading"></span> Generating...';
                btn.disabled = true;
                
                setTimeout(() => {
                    downloadWordDocument(false);
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                }, 1000);
            });
            
            document.getElementById('copyToClipboard').addEventListener('click', () => {
                const btn = document.getElementById('copyToClipboard');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span class="loading"></span> Copying...';
                btn.disabled = true;
                
                setTimeout(() => {
                    copyToClipboard();
                    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    setTimeout(() => {
                        btn.innerHTML = originalHTML;
                        btn.disabled = false;
                    }, 2000);
                }, 500);
            });
            
            document.getElementById('downloadTXT').addEventListener('click', () => {
                const btn = document.getElementById('downloadTXT');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span class="loading"></span> Generating...';
                btn.disabled = true;
                
                setTimeout(() => {
                    downloadTextFile();
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                }, 1000);
            });

            document.getElementById('downloadJoinder').addEventListener('click', () => {
                const btn = document.getElementById('downloadJoinder');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<span class="loading"></span> Generating...';
                btn.disabled = true;
                
                setTimeout(() => {
                    downloadWordDocument(true);
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                }, 1000);
            });
        }

        // Add input animation feedback
        function addInputAnimation(element) {
            element.style.transform = 'scale(1.02)';
            element.style.boxShadow = '0 0 0 3px rgba(102, 126, 234, 0.2)';
            setTimeout(() => {
                element.style.transform = 'scale(1)';
                element.style.boxShadow = '';
            }, 200);
        }

        // Highlight and scroll to preview element
        function highlightPreview(regex, fallbackText = null) {
            const previewContent = document.getElementById('previewContent');
            const previewContainer = document.querySelector('.preview-container');
            
            // Remove existing highlights
            const existingHighlights = previewContent.querySelectorAll('.preview-highlight');
            existingHighlights.forEach(highlight => {
                const parent = highlight.parentNode;
                parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
                parent.normalize();
            });

            setTimeout(() => {
                let targetElement = null;
                
                if (regex) {
                    // Find text matching regex
                    const walker = document.createTreeWalker(
                        previewContent,
                        NodeFilter.SHOW_TEXT,
                        null,
                        false
                    );
                    
                    let node;
                    while (node = walker.nextNode()) {
                        const match = node.textContent.match(regex);
                        if (match) {
                            const span = document.createElement('span');
                            span.className = 'preview-highlight';
                            
                            const beforeText = node.textContent.substring(0, match.index);
                            const matchText = match[0];
                            const afterText = node.textContent.substring(match.index + matchText.length);
                            
                            const parent = node.parentNode;
                            
                            if (beforeText) {
                                parent.insertBefore(document.createTextNode(beforeText), node);
                            }
                            
                            span.textContent = matchText;
                            parent.insertBefore(span, node);
                            
                            if (afterText) {
                                parent.insertBefore(document.createTextNode(afterText), node);
                            }
                            
                            parent.removeChild(node);
                            targetElement = span;
                            break;
                        }
                    }
                } else if (fallbackText) {
                    // Find text by string search
                    const walker = document.createTreeWalker(
                        previewContent,
                        NodeFilter.SHOW_TEXT,
                        null,
                        false
                    );
                    
                    let node;
                    while (node = walker.nextNode()) {
                        if (node.textContent.includes(fallbackText)) {
                            const span = document.createElement('span');
                            span.className = 'preview-highlight';
                            
                            const index = node.textContent.indexOf(fallbackText);
                            const beforeText = node.textContent.substring(0, index);
                            const matchText = fallbackText;
                            const afterText = node.textContent.substring(index + matchText.length);
                            
                            const parent = node.parentNode;
                            
                            if (beforeText) {
                                parent.insertBefore(document.createTextNode(beforeText), node);
                            }
                            
                            span.textContent = matchText;
                            parent.insertBefore(span, node);
                            
                            if (afterText) {
                                parent.insertBefore(document.createTextNode(afterText), node);
                            }
                            
                            parent.removeChild(node);
                            targetElement = span;
                            break;
                        }
                    }
                }
                
                // Scroll to the highlighted element
                if (targetElement) {
                    const elementTop = targetElement.offsetTop;
                    const containerHeight = previewContainer.clientHeight;
                    const scrollTop = elementTop - (containerHeight / 2);
                    
                    previewContainer.scrollTo({
                        top: Math.max(0, scrollTop),
                        behavior: 'smooth'
                    });
                }
            }, 300); // Wait for preview to update
        }

        // Generate document preview
        function generatePreview() {
            const jurisdictionText = formData.stateJurisdiction === "District of Columbia" 
                ? "District of Columbia" 
                : formData.stateJurisdiction ? `State of ${formData.stateJurisdiction}` : '_______________';

            const partyNames = formData.parties
                .filter(party => party.name.trim())
                .map(party => party.name.trim());

            const partyList = partyNames.length > 0
                ? partyNames.map((name, index) => `${name} ("Party ${index + 1}")`).join(', ')
                : '[Party names will appear here]';

            const effectiveDateFormatted = formData.effectiveDate 
                ? new Date(formData.effectiveDate).toLocaleDateString('en-US', { 
                    year: 'numeric', month: 'long', day: 'numeric' 
                  })
                : '_______________';

            // Event-specific content
            let eventSection = '';
            let documentTitle = 'POLYAMOROUS/SWINGER RELATIONSHIP PRIVACY NON-DISCLOSURE AGREEMENT';
            
            if (formData.ndaType === 'event') {
                documentTitle = 'EVENT-SPECIFIC POLYAMOROUS/SWINGER PRIVACY NON-DISCLOSURE AGREEMENT';
                
                const eventDateFormatted = formData.eventDate 
                    ? new Date(formData.eventDate).toLocaleDateString('en-US', { 
                        year: 'numeric', month: 'long', day: 'numeric' 
                      })
                    : '_______________';

                eventSection = `
                    <p><strong>EVENT INFORMATION:</strong></p>
                    <p>Event Name: ${formData.eventName || '_______________'}<br>
                    Event Date: ${eventDateFormatted}<br>
                    Event Location: ${formData.eventLocation || '[Location details kept confidential]'}<br>
                    ${formData.eventDescription ? `Event Description: ${formData.eventDescription}<br>` : ''}
                    </p>
                `;
            }

            const disputeText = formData.disputeResolution === 'arbitration'
                ? "Any dispute arising out of or relating to this Agreement shall be resolved through binding confidential arbitration in accordance with the rules of the American Arbitration Association."
                : formData.disputeResolution === 'mediation'
                ? "Any dispute arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful, the dispute shall then be resolved through binding confidential arbitration in accordance with the rules of the American Arbitration Association."
                : "Any dispute arising out of or relating to this Agreement shall be resolved through litigation in the appropriate courts with jurisdiction over the matter.";

            const stiProtectionClause = formData.includeSTIProtection
                ? `<p><strong>7. HEALTH INFORMATION PROTECTION</strong></p>
                   <p>Any health information, including but not limited to STI test results, medical conditions, or health-related communications shared between the Parties, shall be treated as highly confidential information subject to the strictest protections under this Agreement. No Party shall disclose another Party's health information to any third party without explicit written consent, except as required by law or for emergency medical treatment.</p>`
                : '';

            const socialMediaClause = formData.includeSocialMediaRestrictions
                ? `<p><strong>8. SOCIAL MEDIA AND DIGITAL RESTRICTIONS</strong></p>
                   <p>No Party shall tag, mention, reference, or identify any other Party on any social media platform, dating application, or public digital forum without explicit written consent. This includes but is not limited to posting photos, videos, or comments that could identify other Parties or reveal their participation in activities covered by this Agreement.</p>`
                : '';

            const venueProtectionClause = formData.includeVenueProtection
                ? `<p><strong>9. VENUE AND LOCATION PRIVACY</strong></p>
                   <p>All details regarding locations where activities occur, including but not limited to private residences, clubs, events, hotels, or other venues, shall remain strictly confidential. No Party shall disclose addresses, venue names, event details, or any information that could identify or lead to the identification of locations used for activities covered by this Agreement.</p>`
                : '';

            const groupChatClause = formData.includeGroupChatProtection
                ? `<p><strong>10. GROUP COMMUNICATIONS PROTECTION</strong></p>
                   <p>All group communications, including but not limited to group text messages, shared photos or videos, private social media groups, email chains, and any other multi-party communications, are subject to the confidentiality obligations of this Agreement. Screenshots, forwarding, or sharing of group communications outside the group is strictly prohibited.</p>`
                : '';

            const unanimousConsentClause = formData.includeUnanimousConsent
                ? `<p><strong>11. UNANIMOUS CONSENT FOR MEDIA</strong></p>
                   <p>The creation, recording, or sharing of any photos, videos, audio recordings, or other media depicting or relating to activities covered by this Agreement requires the prior written consent of ALL Parties. No media may be created, distributed, or retained without unanimous written agreement from every Party involved.</p>`
                : '';

            const digitalHandlingText = formData.digitalContentHandling === 'custom' && formData.customDigitalHandling
                ? formData.customDigitalHandling
                : formData.digitalContentHandling === 'deleteUponRequest'
                ? "Any digital content containing Confidential Information must be deleted upon written request by any Party."
                : formData.digitalContentHandling === 'deleteUponTermination'
                ? "Any digital content containing Confidential Information must be deleted upon termination of this Agreement or any Party's withdrawal from the group."
                : "Any digital content containing Confidential Information may be kept but never distributed to any third party without unanimous written consent of all Parties.";

            const durationText = formData.duration === 'event-only' 
                ? "This Agreement shall remain in effect for the duration of the specified event and for a period of three (3) years thereafter for any confidential information disclosed during or in connection with the event."
                : `This Agreement shall remain in effect for ${formData.duration} years from the Effective Date.`;

            const joinderFormSection = formData.includeJoinderForm && formData.ndaType === 'general'
                ? `<p><strong>15. JOINDER OF ADDITIONAL PARTIES</strong></p>
                   <p>New parties may join this Agreement by executing the attached Joinder Agreement, which incorporates all terms and conditions of this Agreement. The addition of new parties requires unanimous written consent of all existing Parties. Upon execution of a Joinder Agreement, new parties become bound by all obligations and entitled to all protections under this Agreement as if they were original signatories.</p>`
                : '';

            const eventSpecificScope = formData.ndaType === 'event' 
                ? `<p><strong>EVENT-SPECIFIC SCOPE</strong></p>
                   <p>This Agreement applies specifically to the event described above and all activities, communications, and interactions related to or occurring during such event. The confidentiality obligations extend to all information shared in preparation for, during, and after the event, including but not limited to planning communications, participant lists, and any follow-up interactions.</p>`
                : '';

            const content = `
                <h1 style="text-align: center; font-size: 14pt; margin-bottom: 30px;">${documentTitle}</h1>
                
                <p>This ${formData.ndaType === 'event' ? 'Event-Specific ' : ''}Non-Disclosure Agreement (the "Agreement") is entered into by and between the following parties (collectively, the "Parties"):</p>
                <p style="margin-left: 20px;">${partyList}</p>
                
                <p><strong>EFFECTIVE DATE:</strong> This Agreement is effective as of ${effectiveDateFormatted} (the "Effective Date").</p>
                
                ${eventSection}
                
                <p><strong>1. PURPOSE</strong></p>
                <p>The Parties wish to protect the confidentiality and privacy of information related to their consensual adult activities, relationships, and interactions${formData.ndaType === 'event' ? ' in connection with the specified event' : ''}. This Agreement ensures that all Parties can engage in private activities with confidence that their privacy, dignity, and personal information will be protected.</p>
                
                ${eventSpecificScope}
                
                <p><strong>2. CONFIDENTIAL INFORMATION</strong></p>
                <p>For purposes of this Agreement, "Confidential Information" includes, but is not limited to:</p>
                <p>a) Personal identity information of all Parties, including names, contact information, employment details, and personal identification;<br>
                b) Photos, videos, and audio recordings of any activities or interactions between Parties;<br>
                c) All communications between Parties, including texts, emails, calls, and in-person conversations;<br>
                d) Details about the nature, scope, and participants of any relationship or activities;<br>
                e) Location information, venue details, and event specifics;<br>
                f) Health and medical information shared between Parties;<br>
                g) Social media interactions and digital communications;<br>
                h) Any other information that could identify Parties or their participation in activities covered by this Agreement.</p>
                
                <p><strong>3. OBLIGATIONS OF CONFIDENTIALITY</strong></p>
                <p>Each Party agrees to maintain strict confidentiality regarding all Confidential Information of every other Party. No Party shall disclose, distribute, share, or otherwise communicate any Confidential Information to third parties without the express written consent of ALL affected Parties.</p>
                
                <p><strong>4. EXCEPTIONS TO CONFIDENTIALITY</strong></p>
                <p>This Agreement does not restrict disclosure of information that:</p>
                <p>a) Is or becomes publicly available through no breach of this Agreement;<br>
                b) Is disclosed pursuant to court order or legal requirement, provided the disclosing Party gives prompt notice to all other Parties;<br>
                c) Is disclosed to report suspected criminal activity as required by law;<br>
                d) Is disclosed with the prior written consent of ALL Parties.</p>
                
                <p><strong>5. PERMITTED DISCLOSURES</strong></p>
                <p>Confidential Information may be disclosed only to:</p>
                <p>a) Legal counsel retained by a Party for advice relating to this Agreement;<br>
                b) Licensed healthcare providers when directly relevant to medical treatment;<br>
                c) Mental health professionals during therapy, subject to patient-therapist privilege.</p>
                
                <p><strong>6. DIGITAL CONTENT AND MEDIA</strong></p>
                <p>${digitalHandlingText} All digital content must be stored securely with appropriate password protection and encryption when possible.</p>
                
                ${stiProtectionClause}
                ${socialMediaClause}
                ${venueProtectionClause}
                ${groupChatClause}
                ${unanimousConsentClause}
                
                <p><strong>12. TERM AND DURATION</strong></p>
                <p>${durationText} Confidentiality obligations shall survive termination of this Agreement and continue indefinitely.</p>
                
                <p><strong>13. REMEDIES AND ENFORCEMENT</strong></p>
                <p>In the event of a breach, the non-breaching Parties shall be entitled to seek monetary damages of $${parseInt(formData.liquidatedDamages).toLocaleString()} per breach as liquidated damages, plus injunctive relief. The Parties acknowledge that breach would cause irreparable harm for which monetary damages alone would be inadequate.</p>
                
                <p><strong>14. DISPUTE RESOLUTION</strong></p>
                <p>${disputeText}</p>
                
                ${joinderFormSection}
                
                <p><strong>16. GOVERNING LAW</strong></p>
                <p>This Agreement shall be governed by the laws of the ${jurisdictionText}, without regard to conflict of law principles.</p>
                
                <p><strong>17. SEVERABILITY</strong></p>
                <p>If any provision of this Agreement is found unenforceable, the remainder shall continue in full force and effect.</p>
                
                <p><strong>18. ENTIRE AGREEMENT</strong></p>
                <p>This Agreement constitutes the entire understanding between the Parties and may only be modified by written agreement signed by all Parties.</p>
                
                <p><strong>19. COUNTERPARTS</strong></p>
                <p>This Agreement may be executed in separate counterparts, including digital signatures and electronic transmission, each deemed an original.</p>
                
                <p><strong>20. GENERAL PROVISIONS</strong></p>
                <p><strong>Assignment:</strong> This Agreement may not be assigned by any Party without the unanimous written consent of all other Parties.</p>
                <p><strong>Amendment:</strong> This Agreement may only be amended by written instrument signed by all Parties.</p>
                <p><strong>Waiver:</strong> No waiver of any provision shall be deemed a waiver of any other provision or subsequent breach.</p>
                <p><strong>Notice:</strong> All notices required hereunder shall be in writing and delivered by email or certified mail to the addresses provided by each Party.</p>
                <p><strong>Binding Effect:</strong> This Agreement shall be binding upon and inure to the benefit of the Parties and their respective heirs, successors, and assigns (where assignment is permitted).</p>
                <p><strong>Headings:</strong> Section headings are for convenience only and shall not affect interpretation of this Agreement.</p>
                
                ${formData.additionalTerms ? `<p><strong>21. ADDITIONAL TERMS</strong></p><p>${formData.additionalTerms}</p>` : ''}
                
                <div style="margin-top: 40px;">
                    <p><strong>SIGNATURE PAGE FOLLOWS</strong></p>
                    <p>IN WITNESS WHEREOF, the Parties have executed this Agreement as of the Effective Date.</p>
                    
                    <div style="margin-top: 40px;">
                        ${formData.parties.map((party, index) => `
                            <div style="margin-bottom: 40px;">
                                <p>_________________________________</p>
                                <p>${party.name || `Party ${index + 1} Name`}</p>
                                <p>Date: _____________</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.getElementById('previewContent').innerHTML = content;
        }

        // Generate risk assessment
        function generateRiskAssessment() {
            const risks = [];

            // Check for missing state jurisdiction
            if (!formData.stateJurisdiction) {
                risks.push({
                    level: 'high',
                    title: 'Missing Governing Law',
                    description: 'No governing state/jurisdiction selected. This creates legal uncertainty about which laws apply.',
                    recommendation: 'Select the state where most parties reside or where activities primarily occur.'
                });
            }

            // Check for court litigation with confidentiality concerns
            if (formData.disputeResolution === 'court') {
                risks.push({
                    level: 'high',
                    title: 'Public Court Proceedings Risk',
                    description: 'Court litigation makes disputes public record, potentially exposing confidential information you\'re trying to protect.',
                    recommendation: 'Consider confidential arbitration instead to keep disputes private and maintain confidentiality.'
                });
            }

            // Check for excessive liquidated damages
            const damages = parseInt(formData.liquidatedDamages);
            if (damages > 75000) {
                risks.push({
                    level: 'high',
                    title: 'Excessive Liquidated Damages',
                    description: `$${damages.toLocaleString()} may be deemed excessive by courts and declared unenforceable as a penalty.`,
                    recommendation: 'Consider reducing to $15,000-$35,000 range based on parties\' income levels for better enforceability.'
                });
            } else if (damages > 35000) {
                risks.push({
                    level: 'medium',
                    title: 'High Liquidated Damages',
                    description: `$${damages.toLocaleString()} is appropriate for high-income individuals but may be excessive for middle-income parties.`,
                    recommendation: 'Ensure this amount is proportionate to all parties\' income levels to maintain enforceability.'
                });
            } else if (damages < 5000) {
                risks.push({
                    level: 'medium',
                    title: 'Low Liquidated Damages',
                    description: `$${damages.toLocaleString()} may not provide sufficient deterrent effect for breaches.`,
                    recommendation: 'Consider increasing to $5,000-$15,000 range for better deterrent effect.'
                });
            }

            // Check for missing protections
            if (!formData.includeSTIProtection) {
                risks.push({
                    level: 'medium',
                    title: 'No STI/Health Information Protection',
                    description: 'Health information shared between partners will not have explicit confidentiality protection.',
                    recommendation: 'Enable STI/Health Information Protection for comprehensive privacy coverage.'
                });
            }

            if (!formData.includeSocialMediaRestrictions) {
                risks.push({
                    level: 'medium',
                    title: 'No Social Media Restrictions',
                    description: 'Without social media restrictions, parties could tag, post about, or identify each other online.',
                    recommendation: 'Enable social media restrictions to prevent unwanted online exposure.'
                });
            }

            if (!formData.includeUnanimousConsent) {
                risks.push({
                    level: 'high',
                    title: 'No Unanimous Consent Requirement',
                    description: 'Without unanimous consent requirements, any party could create or share media without permission from others.',
                    recommendation: 'Enable unanimous consent for media creation to protect all parties.'
                });
            }

            // Check for event-specific risks
            if (formData.ndaType === 'event' && !formData.eventDate) {
                risks.push({
                    level: 'medium',
                    title: 'Missing Event Date',
                    description: 'Event-specific NDAs should specify the exact event date for clarity.',
                    recommendation: 'Add the specific event date to clearly define the scope of coverage.'
                });
            }

            // Note: Removed "Insufficient Parties" check as per user request

            // Check for missing effective date
            if (!formData.effectiveDate) {
                risks.push({
                    level: 'medium',
                    title: 'Missing Effective Date',
                    description: 'Without an effective date, it may be unclear when the agreement takes effect.',
                    recommendation: 'Set a specific effective date, typically the date when all parties sign.'
                });
            }

            // Add positive assessments for good choices
            if (formData.disputeResolution === 'arbitration') {
                risks.push({
                    level: 'low',
                    title: 'Confidential Dispute Resolution',
                    description: 'Private arbitration keeps any disputes confidential, supporting the privacy goals of this agreement.',
                    recommendation: 'Good choice - arbitration maintains confidentiality even in disputes.'
                });
            }

            if (formData.includeUnanimousConsent) {
                risks.push({
                    level: 'low',
                    title: 'Strong Media Protection',
                    description: 'Unanimous consent requirements provide robust protection against unwanted media creation or sharing.',
                    recommendation: 'Excellent protection - this significantly reduces media-related risks.'
                });
            }

            if (damages >= 5000 && damages <= 35000) {
                risks.push({
                    level: 'low',
                    title: 'Reasonable Liquidated Damages',
                    description: `$${damages.toLocaleString()} is within the range courts typically find reasonable and enforceable.`,
                    recommendation: 'Good balance between deterrent effect and enforceability. Ensure amount is proportionate to parties\' income levels.'
                });
            }

            // Generate HTML for risk assessments
            const riskContainer = document.getElementById('riskAssessments');
            if (risks.length === 0) {
                riskContainer.innerHTML = `
                    <div class="risk-item risk-low">
                        <div class="risk-badge low">Low Risk</div>
                        <h4>Well-Configured Agreement</h4>
                        <p>No significant legal risks identified. Your configuration appears comprehensive and balanced.</p>
                    </div>
                `;
            } else {
                riskContainer.innerHTML = risks.map(risk => `
                    <div class="risk-item risk-${risk.level}">
                        <div class="risk-badge ${risk.level}">${risk.level.toUpperCase()} Risk</div>
                        <h4>${risk.title}</h4>
                        <p>${risk.description}</p>
                        <div class="risk-recommendation">
                            <strong>Recommendation:</strong> ${risk.recommendation}
                        </div>
                    </div>
                `).join('');
            }
        }

        // Generate joinder form
        function generateJoinderForm() {
            const jurisdictionText = formData.stateJurisdiction === "District of Columbia" 
                ? "District of Columbia" 
                : formData.stateJurisdiction ? `State of ${formData.stateJurisdiction}` : '_______________';

            return `
                <h1 style="text-align: center; font-size: 14pt; margin-bottom: 30px;">JOINDER AGREEMENT</h1>
                <p style="text-align: center;"><em>Polyamorous/Swinger Relationship Privacy Non-Disclosure Agreement</em></p>
                
                <p>This Joinder Agreement ("Joinder") is entered into by _________________ ("New Party") to join the Polyamorous/Swinger Relationship Privacy Non-Disclosure Agreement dated ${formData.effectiveDate || '_______________'} (the "Original Agreement").</p>
                
                <p><strong>JOINDER TERMS:</strong></p>
                
                <p>1. <strong>Incorporation:</strong> New Party hereby agrees to be bound by all terms, conditions, obligations, and provisions of the Original Agreement as if New Party were an original signatory thereto.</p>
                
                <p>2. <strong>Confidentiality Obligations:</strong> New Party acknowledges receiving copies of all Confidential Information subject to the Original Agreement and agrees to maintain strict confidentiality regarding all such information.</p>
                
                <p>3. <strong>Retroactive Effect:</strong> New Party's confidentiality obligations shall apply retroactively to any Confidential Information received prior to execution of this Joinder.</p>
                
                <p>4. <strong>Rights and Protections:</strong> New Party shall be entitled to all protections afforded to original Parties under the Original Agreement.</p>
                
                <p>5. <strong>Unanimous Consent:</strong> New Party acknowledges that joining required unanimous written consent of all existing Parties, which consent has been obtained.</p>
                
                <p>6. <strong>Governing Law:</strong> This Joinder shall be governed by the laws of the ${jurisdictionText}.</p>
                
                <p>7. <strong>Counterparts:</strong> This Joinder may be executed in counterparts, including digital signatures.</p>
                
                <div style="margin-top: 40px;">
                    <p>IN WITNESS WHEREOF, New Party has executed this Joinder as of _____________, 20__.</p>
                    
                    <div style="margin-top: 40px;">
                        <p>_________________________________</p>
                        <p>New Party Signature</p>
                        <p>Print Name: _________________________</p>
                        <p>Date: _____________</p>
                    </div>
                    
                    <div style="margin-top: 40px;">
                        <p><strong>EXISTING PARTIES' CONSENT:</strong></p>
                        <p>The undersigned existing Parties consent to New Party's joinder:</p>
                        
                        <div style="margin-top: 20px;">
                            ${formData.parties.map((party, index) => `
                                <div style="margin-bottom: 30px;">
                                    <p>_________________________________</p>
                                    <p>${party.name || `Party ${index + 1} Name`} - Date: _______</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate clean text content
        function generateCleanTextContent(isJoinder = false) {
            const content = isJoinder ? generateJoinderForm() : document.getElementById('previewContent').innerHTML;
            // Strip HTML tags and clean up formatting
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            return tempDiv.textContent || tempDiv.innerText || '';
        }
        
        // Download Word document
        function downloadWordDocument(isJoinder = false) {
            const content = isJoinder ? generateJoinderForm() : document.getElementById('previewContent').innerHTML;
            const filename = isJoinder ? 'Polyamorous-Swinger-Joinder-Agreement.doc' : 'Polyamorous-Swinger-Privacy-NDA.doc';
            
            const wordDoc = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" 
                      xmlns:w="urn:schemas-microsoft-com:office:word" 
                      xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>${isJoinder ? 'Polyamorous & Swinger Joinder Agreement' : 'Polyamorous & Swinger Privacy NDA'}</title>
                    <!--[if gte mso 9]>
                    <xml>
                        <w:WordDocument>
                            <w:View>Print</w:View>
                            <w:Zoom>90</w:Zoom>
                            <w:DoNotPromptForConvert/>
                            <w:DoNotShowInsertionsAndDeletions/>
                        </w:WordDocument>
                    </xml>
                    <![endif]-->
                    <style>
                        @page { margin: 1in; }
                        body { 
                            font-family: 'Times New Roman', serif; 
                            font-size: 12pt;
                            line-height: 1.6;
                            color: #000;
                        }
                        h1 { font-size: 14pt; font-weight: bold; text-align: center; }
                        p { margin-bottom: 12pt; }
                        strong { font-weight: bold; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;
            
            const blob = new Blob([wordDoc], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
        
        // Copy to clipboard
        function copyToClipboard() {
            const textContent = generateCleanTextContent();
            navigator.clipboard.writeText(textContent).then(() => {
                console.log('Content copied to clipboard');
            }).catch(err => {
                console.error('Failed to copy to clipboard:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = textContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            });
        }
        
        // Download text file
        function downloadTextFile() {
            const textContent = generateCleanTextContent();
            const filename = 'Polyamorous-Swinger-Privacy-NDA.txt';
            
            const blob = new Blob([textContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Make removeParty available globally
        window.removeParty = removeParty;
    </script>
</body>
</html>