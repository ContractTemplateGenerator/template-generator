<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Transfer Agreement: Complete Guide & Generator | Terms.Law</title>
  <link rel="canonical" href="https://terms.law/2023/02/19/stock-transfer-agreement-template-generator/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css">
</head>
<body>
  <div id="site-header"></div>
  <script src="/shared/header-loader.js"></script>
  <main>
    <article>
      <h1>Stock Transfer Agreement: Complete Guide & Generator</h1>
      <div class="meta">Published: February 19, 2023 • Document Generators, M&amp;A</div>
      <div class="content">
<p></p>



<h2 class="wp-block-heading">Understanding Stock Transfers and Their Legal Implications</h2>



<p>When ownership of shares changes hands, a proper Stock Transfer Agreement serves as the critical legal foundation that protects both buyer and seller. Whether you&#8217;re divesting shares in a private company, transferring ownership to a family member, or bringing in a new investor, this legal document creates a clear record of the transaction and establishes the rights and obligations of all parties involved.</p>



<p>Stock transfers occur regularly in the business world, but they&#8217;re deceptively complex. Without proper documentation, parties risk tax complications, disputes over share valuation, and potential violations of securities laws. A properly drafted agreement isn&#8217;t just paperwork—it&#8217;s essential protection against future legal challenges.</p>



<h3 class="wp-block-heading">When Stock Transfer Agreements Are Necessary</h3>



<p>Stock Transfer Agreements become necessary in several scenarios:</p>



<ul class="wp-block-list">
<li><strong>Private company transactions</strong>: Unlike publicly traded companies where shares trade freely on exchanges, private company stock transfers require formal documentation.</li>



<li><strong>Family transfers</strong>: When transferring shares to family members, whether for estate planning or business succession.</li>



<li><strong>Investor relations</strong>: When accepting new investors or when existing shareholders sell to third parties.</li>



<li><strong>Employee stock plans</strong>: When employees exercise options or receive stock as compensation.</li>



<li><strong>Corporate restructuring</strong>: During reorganizations, mergers, or when spinning off divisions.</li>
</ul>



<p>Without a formal agreement, these transactions lack clarity and enforceability. Verbal agreements about stock transfers are particularly dangerous, as they leave critical terms undefined and create ambiguity about when ownership actually changed hands.</p>



<h3 class="wp-block-heading">Key Legal Considerations in Stock Transfers</h3>



<p>Stock transfers involve multiple legal dimensions that must be addressed in your agreement:</p>



<ol class="wp-block-list">
<li><strong>Securities law compliance</strong>: Stock transfers must comply with federal and state securities regulations, including potential exemptions from registration requirements.</li>



<li><strong>Corporate governance restrictions</strong>: Many companies have bylaws, operating agreements, or shareholder agreements that restrict stock transfers or give existing shareholders rights of first refusal.</li>



<li><strong>Tax implications</strong>: The structure of a stock transfer can have significant tax consequences for both buyer and seller, affecting capital gains treatment and basis calculations.</li>



<li><strong>Representations and warranties</strong>: These provisions protect the parties by establishing facts about the company&#8217;s condition and the shares being transferred.</li>



<li><strong>Disclosure requirements</strong>: Proper disclosure of material information about the company and its financial condition protects against future claims of misrepresentation.</li>
</ol>



<p>The complexity increases when dealing with different classes of stock, voting rights, or when the transfer involves only partial ownership of a share block.</p>



<h3 class="wp-block-heading">Risks of Improper Documentation</h3>



<p>Failing to properly document stock transfers can lead to severe consequences:</p>



<ul class="wp-block-list">
<li><strong>Unenforceable transactions</strong>: Courts may not recognize transfers that lack proper documentation.</li>



<li><strong>Shareholder disputes</strong>: Ambiguity can lead to conflicts over ownership percentages, voting rights, or dividend entitlements.</li>



<li><strong>Regulatory penalties</strong>: Securities law violations can result in significant financial penalties and even rescission rights (allowing the transaction to be unwound).</li>



<li><strong>Tax audits</strong>: Inadequate documentation makes defending valuation and timing claims during tax audits extremely difficult.</li>



<li><strong>Financing obstacles</strong>: When seeking company financing, unclear cap tables and ownership records create red flags for potential investors.</li>
</ul>



<p>Even simple errors in stock transfer documentation can have costly long-term implications, potentially affecting company control and shareholder rights for years to come.</p>



<h3 class="wp-block-heading">Creating a Legally Sound Stock Transfer Agreement</h3>



<p>A comprehensive Stock Transfer Agreement must address purchase price, payment terms, closing conditions, and representations from both parties. The agreement must be tailored to your specific circumstances, state of incorporation, and the type of stock being transferred.</p>



<p>While templates offer starting points, they often fail to address the nuanced legal and tax considerations specific to your situation. My Stock Transfer Agreement Generator below helps create a customized agreement that addresses these critical issues while maintaining legal enforceability. It incorporates essential provisions that protect both buyer and seller throughout the transfer process.</p>



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Transfer Agreement Generator</title>
  <style>
    /* Base Styles */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #1abc9c;
      --accent-light: #e8f6f3;
      --accent-dark: #16a085;
      --bg-color: #f9fafb;
      --card-bg: #ffffff;
      --text-primary: #333333;
      --text-secondary: #666666;
      --border-color: #e0e0e0;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    body {
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
    }
    
    /* Container Styles */
    .generator-container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    
    /* Header Styles */
    .generator-header {
      background-color: var(--primary-color);
      color: white;
      padding: 25px;
      text-align: center;
    }
    
    .generator-header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .generator-header p {
      font-size: 16px;
      opacity: 0.9;
    }
    
    /* Progress Bar */
    .progress-container {
      padding: 15px 25px;
      background-color: var(--card-bg);
    }
    
    .progress-bar-outer {
      height: 6px;
      background-color: #e0e0e0;
      border-radius: 3px;
      margin: 5px 0;
      overflow: hidden;
    }
    
    .progress-bar-inner {
      height: 100%;
      background-color: var(--accent-color);
      width: 20%;
      transition: width 0.3s ease;
    }
    
    .progress-text {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    /* Content Layout */
    .generator-content {
      display: flex;
      min-height: 700px;
    }
    
    /* Form Styles */
    .form-container {
      flex: 1;
      padding: 25px;
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      max-height: 800px;
    }
    
    .question-step {
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .question-step.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .step-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .step-description {
      color: var(--text-secondary);
      margin-bottom: 20px;
      font-size: 14px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 5px;
      color: var(--text-primary);
      font-size: 14px;
    }
    
    .form-input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-primary);
      background-color: white;
      transition: var(--transition);
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }
    
    textarea.form-input {
      min-height: 80px;
      resize: vertical;
    }
    
    .form-helper {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    /* Radio and Checkbox Styles */
    .options-group {
      margin-bottom: 15px;
    }
    
    .option-item {
      display: flex;
      align-items: flex-start;
      padding: 10px;
      margin-bottom: 8px;
      background-color: #f5f7fa;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .option-item:hover {
      background-color: #eef2f7;
    }
    
    .option-item.selected {
      background-color: var(--accent-light);
      border-color: var(--accent-color);
    }
    
    .option-item input[type="radio"],
    .option-item input[type="checkbox"] {
      margin-right: 10px;
      margin-top: 3px;
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-label {
      font-weight: 500;
      display: block;
      margin-bottom: 2px;
      font-size: 14px;
    }
    
    .option-description {
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    /* Navigation buttons */
    .form-navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 25px;
    }
    
    .nav-btn {
      padding: 10px 16px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: var(--transition);
    }
    
    .btn-back {
      background-color: #f1f1f1;
      color: var(--text-primary);
    }
    
    .btn-back:hover:not(:disabled) {
      background-color: #e4e4e4;
    }
    
    .btn-back:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-next {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-next:hover {
      background-color: var(--accent-dark);
    }
    
    /* Form Actions */
    .form-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 25px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .btn {
      padding: 10px 16px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      text-align: center;
    }
    
    .btn-reset {
      background-color: #f1f1f1;
      color: var(--text-primary);
    }
    
    .btn-reset:hover {
      background-color: #e4e4e4;
    }
    
    .btn-copy {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .btn-copy:hover {
      background-color: #2980b9;
    }
    
    .btn-download {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-download:hover {
      background-color: #16a085;
    }
    
    .copy-message {
      display: none;
      font-size: 14px;
      color: #27ae60;
      margin-left: 10px;
    }
    
    .btn-consult {
      display: block;
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background-color: var(--primary-color);
      color: white;
      text-decoration: none;
      text-align: center;
      border-radius: 4px;
      font-weight: 500;
      transition: var(--transition);
    }
    
    .btn-consult:hover {
      background-color: #1e2a37;
    }
    
    /* Preview Styles */
    .preview-container {
      flex: 1;
      padding: 25px;
      position: relative;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .preview-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .preview-note {
      font-size: 12px;
      color: var(--text-secondary);
      font-style: italic;
    }
    
    .preview-box {
      height: 700px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      padding: 25px;
      background-color: white;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-primary);
      position: relative;
      user-select: none; /* Disable text selection until paid */
    }
    
    /* Document Styles */
    .document-template {
      font-family: Arial, sans-serif;
    }
    
    .document-title {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    
    .document-section {
      margin-bottom: 20px;
      position: relative;
      transition: opacity 0.3s ease;
    }
    
    .document-section.faded {
      opacity: 0.4;
    }
    
    .section-title {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .section-content {
      margin-bottom: 15px;
    }
    
    .paragraph {
      margin-bottom: 10px;
    }
    
    .signature-section {
      margin-top: 40px;
    }
    
    .signature-line {
      margin-top: 25px;
      border-top: 1px solid #ccc;
      width: 60%;
      margin-bottom: 5px;
    }
    
    /* Signatures side by side */
    .signatures-wrapper {
      display: flex;
      justify-content: space-between;
      margin-top: 40px;
    }
    
    .signature-column {
      width: 48%;
    }
    
    /* Highlight Effect */
    .highlight {
      background-color: #ffff8d;
      transition: background-color 0.5s ease;
    }
    
    /* Results Page */
    .results-container {
      display: none;
      padding: 25px;
    }
    
    .results-header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .results-title {
      font-size: 24px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    
    .results-description {
      color: var(--text-secondary);
    }

    /* Paywall Styles */
    .paywall-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.92);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10;
      text-align: center;
      padding: 20px;
    }
    
    .paywall-content {
      max-width: 500px;
      margin: 0 auto;
    }
    
    .paywall-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .paywall-description {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 25px;
      line-height: 1.5;
    }
    
    .paywall-badge {
      background-color: var(--accent-color);
      color: white;
      font-weight: 500;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 12px;
      margin-bottom: 10px;
      display: inline-block;
    }
    
    .paywall-price {
      font-size: 32px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 5px;
    }
    
    .price-note {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 25px;
    }
    
    .paywall-button-container {
      margin-bottom: 20px;
    }

    .recovery-section {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      text-align: center;
    }
    
    .recovery-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 10px;
      color: var(--text-secondary);
    }
    
    .recovery-input {
      display: flex;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .recovery-input input {
      flex: 1;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px 0 0 4px;
      font-size: 14px;
    }
    
    .recovery-btn {
      padding: 10px 15px;
      background-color: var(--secondary-color);
      color: white;
      font-weight: 500;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }
    
    .recovery-btn:hover {
      background-color: #2980b9;
    }
    
    /* Gradient fade for preview */
    .gradient-fade {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 200px;
      background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%);
      pointer-events: none;
      z-index: 5;
    }

    /* Success overlay */
    .success-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }
    
    .success-modal {
      background-color: white;
      border-radius: 8px;
      padding: 30px;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }
    
    .success-icon {
      font-size: 60px;
      color: var(--accent-color);
      margin-bottom: 20px;
    }
    
    .success-title {
      font-size: 24px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    
    .success-message {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 25px;
      line-height: 1.5;
    }
    
    .success-close {
      padding: 10px 20px;
      background-color: var(--accent-color);
      color: white;
      font-weight: 500;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .success-close:hover {
      background-color: #219653;
    }
    
    .payment-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background-color: var(--accent-color);
      color: white;
      padding: 5px 12px;
      border-radius: 30px;
      font-size: 12px;
      font-weight: 500;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: none;
      z-index: 5;
    }
    
    .mobile-payment-notice {
      display: none;
      margin-top: 10px;
      font-size: 12px;
      color: var(--text-secondary);
      text-align: center;
      padding: 8px;
      background-color: #f8f9fa;
      border-radius: 4px;
    }
    
    .payment-tracking {
      display: none;
      padding: 10px;
      background-color: #e8f4fd;
      border-radius: 4px;
      margin-bottom: 10px;
      font-size: 14px;
      text-align: center;
    }
    
    /* Responsive Styles */
    @media (max-width: 1024px) {
      .generator-content {
        flex-direction: column;
      }
      
      .form-container {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        max-height: none;
      }
      
      .preview-box {
        height: 500px;
      }

      .mobile-payment-notice {
        display: block;
      }
    }
    
    @media (max-width: 768px) {
      .generator-container {
        margin: 0;
        border-radius: 0;
      }
      
      .generator-header {
        padding: 20px;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .copy-message {
        margin-left: 0;
        margin-top: 5px;
        text-align: center;
      }
    }
    
    @media print {
      body {
        background-color: white;
        padding: 0;
      }
      
      .generator-container {
        box-shadow: none;
        border-radius: 0;
      }
      
      .generator-header,
      .form-container,
      .preview-header,
      .form-actions,
      .btn-consult,
      .paywall-overlay,
      .gradient-fade {
        display: none !important;
      }
      
      .generator-content {
        display: block;
      }
      
      .preview-container {
        padding: 0;
      }
      
      .preview-box {
        height: auto;
        overflow: visible;
        border: none;
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <div class="generator-container">
    <div class="generator-header">
      <h1>Stock Transfer Agreement Generator</h1>
      <p>Create a customized Stock Transfer Agreement in minutes</p>
    </div>
    
    <div id="paymentTracking" class="payment-tracking">
      Saving your data before payment&#8230;
    </div>
    
    <div class="progress-container">
      <div class="progress-text">
        <span>Step <span id="current-step">1</span> of <span id="total-steps">5</span></span>
        <span id="step-name">Parties Information</span>
      </div>
      <div class="progress-bar-outer">
        <div class="progress-bar-inner" id="progress-bar"></div>
      </div>
    </div>
    
    <div class="generator-content">
      <!-- Form Container -->
      <div class="form-container">
        <form id="stockTransferForm">
          <!-- Step 1: Parties Information -->
          <div class="question-step active" id="step1">
            <h2 class="step-title">Parties Information</h2>
            <p class="step-description">Provide information about the parties involved in the stock transfer.</p>
            
            <!-- Seller Information -->
            <div class="form-group">
              <label for="seller-name">Seller Name</label>
              <input type="text" id="seller-name" class="form-input" placeholder="Enter company name" value="ABC Corporation">
            </div>
            
            <div class="form-group">
              <label for="seller-entity">Seller Entity Type</label>
              <select id="seller-entity" class="form-input">
                <option value="Delaware corporation" selected>Delaware Corporation</option>
                <option value="California corporation">California Corporation</option>
                <option value="Nevada corporation">Nevada Corporation</option>
                <option value="New York corporation">New York Corporation</option>
                <option value="limited liability company">Limited Liability Company (LLC)</option>
                <option value="partnership">Partnership</option>
                <option value="individual">Individual</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="seller-address">Seller Address</label>
              <input type="text" id="seller-address" class="form-input" placeholder="Enter full address" value="123 Business Avenue, Wilmington, Delaware 19801">
            </div>
            
            <!-- Buyer Information -->
            <div class="form-group">
              <label for="buyer-name">Buyer Name</label>
              <input type="text" id="buyer-name" class="form-input" placeholder="Enter company or individual name" value="XYZ Ventures, Inc.">
            </div>
            
            <div class="form-group">
              <label for="buyer-entity">Buyer Entity Type</label>
              <select id="buyer-entity" class="form-input">
                <option value="Delaware corporation">Delaware Corporation</option>
                <option value="California corporation" selected>California Corporation</option>
                <option value="Nevada corporation">Nevada Corporation</option>
                <option value="New York corporation">New York Corporation</option>
                <option value="limited liability company">Limited Liability Company (LLC)</option>
                <option value="partnership">Partnership</option>
                <option value="individual">Individual</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="buyer-address">Buyer Address</label>
              <input type="text" id="buyer-address" class="form-input" placeholder="Enter full address" value="456 Tech Boulevard, San Francisco, California 94107">
            </div>
            
            <div class="form-navigation">
              <button type="button" class="nav-btn btn-back" disabled>Back</button>
              <button type="button" class="nav-btn btn-next" onclick="goToStep(2)">Next</button>
            </div>
          </div>
          
          <!-- Step 2: Stock Information -->
          <div class="question-step" id="step2">
            <h2 class="step-title">Stock Information</h2>
            <p class="step-description">Provide details about the stock being transferred.</p>
            
            <div class="form-group">
              <label for="agreement-date">Agreement Date</label>
              <input type="date" id="agreement-date" class="form-input" value="2023-04-05">
            </div>
            
            <div class="form-group">
              <label for="company-name">Company Name (whose stock is being transferred)</label>
              <input type="text" id="company-name" class="form-input" placeholder="Enter company name" value="Tech Innovations, Inc.">
            </div>
            
            <div class="form-group">
              <label for="shares-number">Number of Shares</label>
              <input type="number" id="shares-number" class="form-input" placeholder="Enter number of shares" value="1000">
            </div>
            
            <div class="form-group">
              <label for="share-type">Share Type</label>
              <select id="share-type" class="form-input">
                <option value="common stock" selected>Common Stock</option>
                <option value="preferred stock">Preferred Stock</option>
                <option value="Series A preferred stock">Series A Preferred Stock</option>
                <option value="Series B preferred stock">Series B Preferred Stock</option>
                <option value="restricted stock">Restricted Stock</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="purchase-price">Purchase Price ($)</label>
              <input type="number" id="purchase-price" class="form-input" placeholder="Enter purchase price in USD" value="50000">
            </div>
            
            <div class="form-group">
              <label for="closing-date">Closing Date (leave blank if same as agreement date)</label>
              <input type="date" id="closing-date" class="form-input">
              <div class="form-helper">The date when shares will be transferred and payment made</div>
            </div>
            
            <div class="form-navigation">
              <button type="button" class="nav-btn btn-back" onclick="goToStep(1)">Back</button>
              <button type="button" class="nav-btn btn-next" onclick="goToStep(3)">Next</button>
            </div>
          </div>
          
          <!-- Step 3: Additional Representations -->
          <div class="question-step" id="step3">
            <h2 class="step-title">Additional Representations</h2>
            <p class="step-description">Specify additional representations and warranties for the agreement.</p>
            
            <div class="form-group">
              <label>Additional Seller Representations</label>
              <div class="options-group">
                <label class="option-item selected">
                  <input type="checkbox" name="seller-reps" value="no-conflicts" checked>
                  <div class="option-content">
                    <span class="option-label">No Conflicts</span>
                    <span class="option-description">Seller represents that the transfer does not conflict with other agreements</span>
                  </div>
                </label>
                
                <label class="option-item selected">
                  <input type="checkbox" name="seller-reps" value="ownership" checked>
                  <div class="option-content">
                    <span class="option-label">Full Ownership</span>
                    <span class="option-description">Seller represents they are the sole owner of the shares</span>
                  </div>
                </label>
                
                <label class="option-item selected">
                  <input type="checkbox" name="seller-reps" value="no-litigation" checked>
                  <div class="option-content">
                    <span class="option-label">No Pending Litigation</span>
                    <span class="option-description">Seller represents there is no pending litigation affecting the shares</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="checkbox" name="seller-reps" value="comp-good-standing">
                  <div class="option-content">
                    <span class="option-label">Company in Good Standing</span>
                    <span class="option-description">Seller represents that the company whose shares are being transferred is in good standing</span>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Additional Buyer Representations</label>
              <div class="options-group">
                <label class="option-item selected">
                  <input type="checkbox" name="buyer-reps" value="financial-ability" checked>
                  <div class="option-content">
                    <span class="option-label">Financial Ability</span>
                    <span class="option-description">Buyer represents they have the financial ability to complete the purchase</span>
                  </div>
                </label>
                
                <label class="option-item selected">
                  <input type="checkbox" name="buyer-reps" value="accredited" checked>
                  <div class="option-content">
                    <span class="option-label">Accredited Investor</span>
                    <span class="option-description">Buyer represents they are an accredited investor (if applicable)</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="checkbox" name="buyer-reps" value="investment-purpose">
                  <div class="option-content">
                    <span class="option-label">Investment Purpose</span>
                    <span class="option-description">Buyer represents they are purchasing for investment purposes, not distribution</span>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="custom-reps">Custom Representations and Warranties (Optional)</label>
              <textarea id="custom-reps" class="form-input" placeholder="Enter any additional custom representations or warranties"></textarea>
            </div>
            
            <div class="form-navigation">
              <button type="button" class="nav-btn btn-back" onclick="goToStep(2)">Back</button>
              <button type="button" class="nav-btn btn-next" onclick="goToStep(4)">Next</button>
            </div>
          </div>
          
          <!-- Step 4: Legal Terms -->
          <div class="question-step" id="step4">
            <h2 class="step-title">Legal Terms</h2>
            <p class="step-description">Specify legal terms for the agreement.</p>
            
            <div class="form-group">
              <label for="governing-law">Governing Law</label>
              <select id="governing-law" class="form-input">
                <option value="Delaware" selected>Delaware</option>
                <option value="California">California</option>
                <option value="New York">New York</option>
                <option value="Texas">Texas</option>
                <option value="Florida">Florida</option>
                <option value="Nevada">Nevada</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Dispute Resolution</label>
              <div class="options-group">
                <label class="option-item selected">
                  <input type="radio" name="dispute-resolution" value="arbitration" checked>
                  <div class="option-content">
                    <span class="option-label">Binding Arbitration</span>
                    <span class="option-description">Disputes will be resolved through binding arbitration</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="radio" name="dispute-resolution" value="litigation">
                  <div class="option-content">
                    <span class="option-label">Court Litigation</span>
                    <span class="option-description">Disputes will be resolved through the court system</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="radio" name="dispute-resolution" value="mediation-arbitration">
                  <div class="option-content">
                    <span class="option-label">Mediation then Arbitration</span>
                    <span class="option-description">Disputes will first go to mediation, then to binding arbitration if unresolved</span>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Confidentiality</label>
              <div class="options-group">
                <label class="option-item selected">
                  <input type="radio" name="confidentiality" value="standard" checked>
                  <div class="option-content">
                    <span class="option-label">Standard Confidentiality</span>
                    <span class="option-description">Both parties agree to keep the terms of the agreement confidential</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="radio" name="confidentiality" value="enhanced">
                  <div class="option-content">
                    <span class="option-label">Enhanced Confidentiality</span>
                    <span class="option-description">Additional confidentiality provisions including business information and trade secrets</span>
                  </div>
                </label>
                
                <label class="option-item">
                  <input type="radio" name="confidentiality" value="none">
                  <div class="option-content">
                    <span class="option-label">No Confidentiality</span>
                    <span class="option-description">No specific confidentiality provisions</span>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="custom-terms">Custom Legal Terms (Optional)</label>
              <textarea id="custom-terms" class="form-input" placeholder="Enter any additional custom legal terms"></textarea>
            </div>
            
            <div class="form-navigation">
              <button type="button" class="nav-btn btn-back" onclick="goToStep(3)">Back</button>
              <button type="button" class="nav-btn btn-next" onclick="goToStep(5)">Next</button>
            </div>
          </div>
          
          <!-- Step 5: Signature Information -->
          <div class="question-step" id="step5">
            <h2 class="step-title">Signature Information</h2>
            <p class="step-description">Provide information about the signatories of the agreement.</p>
            
            <div class="form-group">
              <label for="seller-signatory">Seller Signatory Name</label>
              <input type="text" id="seller-signatory" class="form-input" placeholder="Enter name of person signing for seller" value="John Smith">
            </div>
            
            <div class="form-group">
              <label for="seller-title">Seller Signatory Title</label>
              <input type="text" id="seller-title" class="form-input" placeholder="Enter title of seller signatory" value="Chief Executive Officer">
            </div>
            
            <div class="form-group">
              <label for="buyer-signatory">Buyer Signatory Name</label>
              <input type="text" id="buyer-signatory" class="form-input" placeholder="Enter name of person signing for buyer" value="Jane Doe">
            </div>
            
            <div class="form-group">
              <label for="buyer-title">Buyer Signatory Title</label>
              <input type="text" id="buyer-title" class="form-input" placeholder="Enter title of buyer signatory" value="Managing Partner">
            </div>
            
            <div class="form-navigation">
              <button type="button" class="nav-btn btn-back" onclick="goToStep(4)">Back</button>
              <button type="button" class="nav-btn btn-next" onclick="showResults()">Generate Agreement</button>
            </div>
          </div>
        </form>
      </div>
      
      <!-- Preview Container -->
      <div class="preview-container">
        <div class="preview-header">
          <div class="preview-title">Agreement Preview</div>
          <div class="preview-note">Updates as you complete the form</div>
        </div>
        
        <div class="preview-box">
          <div class="document-template" id="agreementPreview">
            <!-- Document content will be populated by JavaScript -->
          </div>
          
          <!-- Paywall overlay -->
          <div class="paywall-overlay" id="paywallOverlay">
            <div class="paywall-content">
              <span class="paywall-badge">PREMIUM DOCUMENT</span>
              <h2 class="paywall-title">Complete Stock Transfer Agreement</h2>
              <p class="paywall-description">Get full access to this professionally drafted Stock Transfer Agreement that&#8217;s ready for immediate use in your business.</p>
              
              <div class="paywall-price">$9.99</div>
              <div class="price-note">One-time payment, no subscription</div>
              
              <div class="paywall-button-container" id="paypalForm">
                <style>.pp-XFKC5J2NFQBY2{text-align:center;border:none;border-radius:0.25rem;min-width:11.625rem;padding:0 2rem;height:2.625rem;font-weight:bold;background-color:#FFD140;color:#000000;font-family:"Helvetica Neue",Arial,sans-serif;font-size:1rem;line-height:1.25rem;cursor:pointer;}</style> 
                <form action="https://www.paypal.com/ncp/payment/XFKC5J2NFQBY2" method="post" target="_blank" style="display:inline-grid;justify-items:center;align-content:start;gap:0.5rem;" id="paypalFormInner"> 
                  <input class="pp-XFKC5J2NFQBY2" type="submit" value="Buy Now" /> 
                  <img src=https://www.paypalobjects.com/images/Debit_Credit_APM.svg alt="cards" /> 
                  <section> Powered by <img decoding="async" src="https://www.paypalobjects.com/paypal-ui/logos/svg/paypal-wordmark-color.svg" alt="paypal" style="height:0.875rem;vertical-align:middle;"/></section> 
                </form>
              </div>
              
              <div class="mobile-payment-notice">
                On mobile devices: After payment, you may need to manually return to this page. Your form data will be preserved.
              </div>
              
              <!-- Transaction ID Recovery -->
              <div class="recovery-section" id="recoverySection">
                <div class="recovery-title">Already purchased? Enter your PayPal Transaction ID:</div>
                <div class="recovery-input">
                  <input type="text" id="transactionIdInput" placeholder="e.g., 1XY23456AB789012C">
                  <button id="recoverBtn" class="recovery-btn">Unlock</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Gradient fade for partial preview -->
          <div class="gradient-fade" id="gradientFade"></div>
          
          <!-- Payment badge -->
          <div class="payment-badge" id="paymentBadge">
            PREMIUM UNLOCKED
          </div>
        </div>
      </div>
    </div>
    
    <!-- Success overlay -->
    <div class="success-overlay" id="successOverlay">
      <div class="success-modal">
        <div class="success-icon">✓</div>
        <h2 class="success-title">Payment Successful!</h2>
        <p class="success-message">Thank you for your purchase. You now have full access to the Stock Transfer Agreement. Your document is ready to be downloaded or copied.</p>
        <button id="closeSuccessBtn" class="success-close">Continue</button>
      </div>
    </div>
    
    <!-- Results Page -->
    <div class="results-container" id="resultsContainer">
      <div class="results-header">
        <h2 class="results-title">Your Stock Transfer Agreement</h2>
        <p class="results-description">Your customized agreement is ready. You can download it or copy it to clipboard.</p>
      </div>
      
      <div class="form-actions">
        <button type="button" id="copyBtn" class="btn btn-copy" disabled>Copy Agreement</button>
        <span id="copyMessage" class="copy-message">Agreement copied!</span>
        <button type="button" id="downloadBtn" class="btn btn-download" disabled>Download as DOCX</button>
        <button type="button" id="resetBtn" class="btn btn-reset">Start Over</button>
      </div>
      
      <a href="#" class="btn-consult" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">
        Schedule Legal Consultation
      </a>
    </div>
  </div>
  
  <!-- Libraries for DOCX download -->
  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- Calendly Integration -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM Elements
      const form = document.getElementById('stockTransferForm');
      const preview = document.getElementById('agreementPreview');
      const progressBar = document.getElementById('progress-bar');
      const currentStepEl = document.getElementById('current-step');
      const stepNameEl = document.getElementById('step-name');
      const totalStepsEl = document.getElementById('total-steps');
      const resultsContainer = document.getElementById('resultsContainer');
      const copyBtn = document.getElementById('copyBtn');
      const copyMessage = document.getElementById('copyMessage');
      const downloadBtn = document.getElementById('downloadBtn');
      const resetBtn = document.getElementById('resetBtn');
      const previewBox = document.querySelector('.preview-box');
      const paywallOverlay = document.getElementById('paywallOverlay');
      const gradientFade = document.getElementById('gradientFade');
      const paymentBadge = document.getElementById('paymentBadge');
      const recoverBtn = document.getElementById('recoverBtn');
      const successOverlay = document.getElementById('successOverlay');
      const closeSuccessBtn = document.getElementById('closeSuccessBtn');
      const paymentTracking = document.getElementById('paymentTracking');
      
      // Storage key constants
      const FORM_DATA_KEY = 'stock_transfer_form_data';
      const PAYMENT_STATUS_KEY = 'stock_transfer_payment_status';
      
      // Constants
      const TOTAL_STEPS = 5;
      const STEP_NAMES = [
        'Parties Information',
        'Stock Information',
        'Additional Representations',
        'Legal Terms',
        'Signature Information'
      ];
      
      // Set total steps
      totalStepsEl.textContent = TOTAL_STEPS;
      
      // Global variables
      let currentStep = 1;
      let activeSection = null;
      let highlightedElements = [];
      let highlightTimeout;
      let isPaid = false;
      
      // Check for payment status
      checkPaymentReturn();
      
      // Initialize preview
      updatePreview();
      
      // Add input event listeners to all form inputs
      form.addEventListener('input', function(e) {
        clearHighlights();
        updatePreview(e.target.id);
        if (copyMessage) copyMessage.style.display = 'none';
      });
      
      // Handle checkbox changes
      document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          // Toggle the selected class
          this.closest('.option-item').classList.toggle('selected', this.checked);
          
          // Clear highlights and update preview
          clearHighlights();
          updatePreview(this.name);
          if (copyMessage) copyMessage.style.display = 'none';
        });
      });
      
      // Handle radio button changes
      document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', function() {
          // Update selected class for all radio buttons in the same group
          document.querySelectorAll(`input[name="${this.name}"]`).forEach(r => {
            r.closest('.option-item').classList.toggle('selected', r.checked);
          });
          
          // Clear highlights and update preview
          clearHighlights();
          updatePreview(this.name);
          if (copyMessage) copyMessage.style.display = 'none';
        });
      });
      
      // Make option items clickable
      document.querySelectorAll('.option-item').forEach(item => {
        item.addEventListener('click', function(e) {
          // If the user clicked directly on the input, don't interfere
          if (e.target.type === 'checkbox' || e.target.type === 'radio') return;
          
          // Find the input inside this option item
          const input = this.querySelector('input');
          if (input) {
            // Toggle the input state
            if (input.type === 'checkbox') {
              input.checked = !input.checked;
              this.classList.toggle('selected', input.checked);
            } else if (input.type === 'radio') {
              input.checked = true;
              
              // Update selected class for all radio buttons in the same group
              document.querySelectorAll(`input[name="${input.name}"]`).forEach(r => {
                r.closest('.option-item').classList.toggle('selected', r.checked);
              });
            }
            
            // Clear highlights and update preview
            clearHighlights();
            updatePreview(input.name);
            if (copyMessage) copyMessage.style.display = 'none';
            
            // Dispatch change event
            const event = new Event('change', { bubbles: true });
            input.dispatchEvent(event);
          }
        });
      });
      
      // Function to navigate between steps
      window.goToStep = function(step) {
        // Hide current step
        document.getElementById(`step${currentStep}`).classList.remove('active');
        
        // Show new step
        document.getElementById(`step${step}`).classList.add('active');
        
        // Update current step
        currentStep = step;
        currentStepEl.textContent = step;
        stepNameEl.textContent = STEP_NAMES[step - 1];
        
        // Update progress bar
        progressBar.style.width = `${(step / TOTAL_STEPS) * 100}%`;
        
        // Clear any highlights
        clearHighlights();
        
        // Update preview based on the current step
        updatePreviewForCurrentStep();
      }
      
      // Function to show results page
      window.showResults = function() {
        // Hide the form container and show results
        document.querySelector('.generator-content').style.display = 'none';
        document.querySelector('.progress-container').style.display = 'none';
        resultsContainer.style.display = 'block';
        
        // Ensure the preview is fully updated
        updatePreview();
      }
      
      // Handle copy button click
      copyBtn.addEventListener('click', function() {
        const documentText = generatePlainText();
        
        // Copy to clipboard
        navigator.clipboard.writeText(documentText).then(function() {
          copyMessage.style.display = 'inline-block';
          
          // Hide message after 3 seconds
          setTimeout(() => {
            copyMessage.style.display = 'none';
          }, 3000);
        }).catch(function(err) {
          console.error('Could not copy text: ', err);
          alert('Failed to copy agreement. Please try selecting and copying the text manually.');
        });
      });
      
      // Handle download button click
      downloadBtn.addEventListener('click', function() {
        generateDocx();
      });
      
      // Handle reset button click
      resetBtn.addEventListener('click', function() {
        // Reset form
        form.reset();
        
        // Go back to step 1
        document.querySelector('.generator-content').style.display = 'flex';
        document.querySelector('.progress-container').style.display = 'block';
        resultsContainer.style.display = 'none';
        goToStep(1);
        
        // Reset preview
        updatePreview();
      });
      
      // Function to collect all form data
      function collectFormData() {
        const formData = {};
        
        // Collect text inputs, selects, textareas
        document.querySelectorAll('.form-input').forEach(input => {
          formData[input.id] = input.value;
        });
        
        // Collect checkboxes - use name_value pattern for identification
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
          formData[checkbox.name + '_' + checkbox.value] = checkbox.checked;
        });
        
        // Collect radio buttons
        document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
          formData[radio.name] = radio.value;
        });
        
        // Add metadata
        formData['_timestamp'] = Date.now();
        formData['_currentStep'] = currentStep;
        
        return formData;
      }
      
      // Function to save form data to local storage
      function saveFormDataToLocalStorage() {
        const formData = collectFormData();
        
        // Store in both localStorage and sessionStorage for redundancy
        localStorage.setItem(FORM_DATA_KEY, JSON.stringify(formData));
        sessionStorage.setItem(FORM_DATA_KEY, JSON.stringify(formData));
        
        // Backup copy
        localStorage.setItem(FORM_DATA_KEY + '_backup', JSON.stringify(formData));
        
        return formData;
      }
      
      // Function to restore form data from storage
      function restoreFormData() {
        // Try sessionStorage first, then localStorage, then backup
        let formDataStr = sessionStorage.getItem(FORM_DATA_KEY);
        if (!formDataStr) formDataStr = localStorage.getItem(FORM_DATA_KEY);
        if (!formDataStr) formDataStr = localStorage.getItem(FORM_DATA_KEY + '_backup');
        
        if (!formDataStr) return false;
        
        try {
          const formData = JSON.parse(formDataStr);
          
          // Restore input values
          for (const [key, value] of Object.entries(formData)) {
            if (key.startsWith('_')) continue; // Skip metadata
            
            if (key.includes('_')) {
              // Handle checkbox fields with name_value format
              const [name, checkValue] = key.split('_');
              const checkbox = document.querySelector(`input[name="${name}"][value="${checkValue}"]`);
              if (checkbox) {
                checkbox.checked = value;
                
                // Update UI state if using custom styling
                const optionItem = checkbox.closest('.option-item');
                if (optionItem) {
                  optionItem.classList.toggle('selected', value);
                }
              }
            } else if (document.querySelector(`input[name="${key}"]`)) {
              // Handle radio buttons
              const radio = document.querySelector(`input[name="${key}"][value="${value}"]`);
              if (radio) {
                radio.checked = true;
                
                // Update UI state if using custom styling
                const optionItem = radio.closest('.option-item');
                if (optionItem) {
                  optionItem.classList.add('selected');
                  
                  // Deselect other options in the same group
                  document.querySelectorAll(`input[name="${key}"]`).forEach(r => {
                    if (r !== radio) {
                      r.closest('.option-item').classList.remove('selected');
                    }
                  });
                }
              }
            } else {
              // Handle regular inputs
              const element = document.getElementById(key);
              if (element) {
                element.value = value;
              }
            }
          }
          
          // Restore current step if available
          if (formData['_currentStep']) {
            const savedStep = formData['_currentStep'];
            goToStep(savedStep);
          }
          
          // Update the preview
          updatePreview();
          
          return true;
        } catch (e) {
          console.error('Error restoring form data:', e);
          return false;
        }
      }
      
      // Function to clear highlights
      function clearHighlights() {
        if (highlightTimeout) {
          clearTimeout(highlightTimeout);
        }
        
        highlightedElements.forEach(element => {
          element.classList.remove('highlight');
        });
        highlightedElements = [];
      }
      
      // Format date for display
      function formatDate(dateString) {
        if (!dateString) return '';
        
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
      }
      
      // Function to update preview based on current step
      function updatePreviewForCurrentStep() {
        let sectionId = '';
        
        switch(currentStep) {
          case 1:
            sectionId = 'section-parties';
            break;
          case 2:
            sectionId = 'section-transfer';
            break;
          case 3:
            sectionId = 'section-reps';
            break;
          case 4:
            sectionId = 'section-legal';
            break;
          case 5:
            sectionId = 'section-signatures';
            break;
          default:
            sectionId = 'section-parties';
        }
        
        // Make sure the section is visible in the preview
        const section = document.getElementById(sectionId);
        if (section) {
          section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
      
      // Function to get URL parameters
      function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        const results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      }
      
      // Function to check payment return
      function checkPaymentReturn() {
        // Check URL for payment success
        const paymentSuccess = getUrlParameter('pmt') === 'success';
        const paymentToken = getUrlParameter('token');
        const paymentId = getUrlParameter('paymentId');
        const txnParameter = getUrlParameter('tx');
        
        // Check session storage flags
        const tempSuccess = sessionStorage.getItem('temp_payment_success');
        
        if (paymentSuccess || paymentToken || paymentId || txnParameter || tempSuccess) {
          // Store payment status
          const txnId = txnParameter || paymentId || paymentToken || sessionStorage.getItem('temp_txn_id') || 'paypal-return';
          markAsPaid(txnId);
          
          // Show success message
          showSuccess();
          
          // Restore form data
          restoreFormData();
        } else {
          // Check if previously paid
          const savedPaymentStatus = localStorage.getItem(PAYMENT_STATUS_KEY);
          if (savedPaymentStatus) {
            try {
              const paymentInfo = JSON.parse(savedPaymentStatus);
              if (paymentInfo && paymentInfo.paid) {
                // Restore paid status
                markAsPaid(paymentInfo.txnId || 'restored');
                restoreFormData();
              }
            } catch (e) {
              console.error('Error parsing payment status:', e);
            }
          }
        }
      }
      
      // Function to mark content as paid
      function markAsPaid(txnId = 'default') {
        isPaid = true;
        
        // Store payment status
        const paymentInfo = {
          paid: true,
          txnId: txnId,
          timestamp: Date.now()
        };
        
        localStorage.setItem(PAYMENT_STATUS_KEY, JSON.stringify(paymentInfo));
        
        // Enable buttons
        copyBtn.disabled = false;
        downloadBtn.disabled = false;
        
        // Hide paywall elements
        paywallOverlay.style.display = 'none';
        gradientFade.style.display = 'none';
        
        // Show premium badge
        paymentBadge.style.display = 'block';
        
        // Enable text selection
        previewBox.style.userSelect = 'text';
        
        // Remove context menu restrictions
        previewBox.oncontextmenu = null;
        
        // Show all sections clearly
        document.querySelectorAll('.document-section').forEach(section => {
          section.classList.remove('faded');
        });
      }
      
      // Function to show success overlay
      function showSuccess() {
        successOverlay.style.display = 'flex';
      }
      
      // Close success button event
      closeSuccessBtn.addEventListener('click', function() {
        successOverlay.style.display = 'none';
        
        // Optional: Auto-trigger download if paid
        if (isPaid) {
          setTimeout(function() {
            generateDocx();
          }, 500);
        }
      });
      
      // Add event listener to PayPal form
      document.getElementById('paypalFormInner').addEventListener('submit', function(e) {
        // Show saving indicator
        paymentTracking.style.display = 'block';
        
        // Save form data before redirect
        saveFormDataToLocalStorage();
        
        // Create a session ID
        const formId = 'form_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('session_id_key', formId);
        sessionStorage.setItem('temp_form_id', formId);
        
        // Allow form submission to continue
      });
      
      // Transaction ID recovery
      function isValidPayPalTransactionId(txnId) {
        // Most PayPal transaction IDs are alphanumeric and 10+ characters
        return /^[a-zA-Z0-9]{10,}$/.test(txnId.trim());
      }
      
      // Event listener for transaction ID recovery
      recoverBtn.addEventListener('click', function() {
        const recoveryTxnId = document.getElementById('transactionIdInput').value.trim();
        
        if (recoveryTxnId && isValidPayPalTransactionId(recoveryTxnId)) {
          // Mark as paid
          markAsPaid(recoveryTxnId);
          
          // Show success
          showSuccess();
        } else {
          alert('Transaction ID format not recognized. Please try again.');
        }
      });
      
      // Function to update the agreement preview
      function updatePreview(changedField = null) {
        // Get values from the form
        const sellerName = document.getElementById('seller-name').value || '[SELLER NAME]';
        const sellerEntity = document.getElementById('seller-entity').value || 'corporation';
        const sellerAddress = document.getElementById('seller-address').value || '[SELLER ADDRESS]';
        
        const buyerName = document.getElementById('buyer-name').value || '[BUYER NAME]';
        const buyerEntity = document.getElementById('buyer-entity').value || 'corporation';
        const buyerAddress = document.getElementById('buyer-address').value || '[BUYER ADDRESS]';
        
        const agreementDate = formatDate(document.getElementById('agreement-date').value) || '[DATE]';
        const companyName = document.getElementById('company-name').value || '[COMPANY NAME]';
        const sharesNumber = document.getElementById('shares-number').value || '[NUMBER]';
        const shareType = document.getElementById('share-type').value || 'common stock';
        const purchasePrice = document.getElementById('purchase-price').value || '[PRICE]';
        
        let closingDate = document.getElementById('closing-date').value;
        closingDate = closingDate ? formatDate(closingDate) : agreementDate;
        
        // Get selected representations
        const sellerReps = Array.from(document.querySelectorAll('input[name="seller-reps"]:checked'))
          .map(input => input.value);
          
        const buyerReps = Array.from(document.querySelectorAll('input[name="buyer-reps"]:checked'))
          .map(input => input.value);
          
        const customReps = document.getElementById('custom-reps').value;
        
        // Get legal terms
        const governingLaw = document.getElementById('governing-law').value || 'Delaware';
        
        let disputeResolution = '';
        document.querySelectorAll('input[name="dispute-resolution"]').forEach(radio => {
          if (radio.checked) {
            disputeResolution = radio.value;
          }
        });
        
        let confidentiality = '';
        document.querySelectorAll('input[name="confidentiality"]').forEach(radio => {
          if (radio.checked) {
            confidentiality = radio.value;
          }
        });
        
        const customTerms = document.getElementById('custom-terms').value;
        
        // Get signature information
        const sellerSignatory = document.getElementById('seller-signatory').value || '[NAME]';
        const sellerTitle = document.getElementById('seller-title').value || '[TITLE]';
        const buyerSignatory = document.getElementById('buyer-signatory').value || '[NAME]';
        const buyerTitle = document.getElementById('buyer-title').value || '[TITLE]';
        
        // Format currency
        const formatCurrency = (amount) => {
          return new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 2
          }).format(amount);
        };
        
        // Generate confidentiality clause
        let confidentialityClause = '';
        if (confidentiality === 'standard') {
          confidentialityClause = `<p class="paragraph">Both Seller and Buyer agree to maintain in strict confidence all terms and conditions of this Agreement and shall not disclose such information to any third party without the prior written consent of the other party, unless required by law or court order.</p>`;
        } else if (confidentiality === 'enhanced') {
          confidentialityClause = `<p class="paragraph">Both Seller and Buyer agree to maintain in strict confidence all terms and conditions of this Agreement, as well as all business information, trade secrets, financial data, and other proprietary information disclosed in connection with this Agreement. Neither party shall disclose such information to any third party without the prior written consent of the other party, unless required by law or court order. This confidentiality obligation shall survive the termination of this Agreement.</p>`;
        } else {
          confidentialityClause = `<p class="paragraph">The parties acknowledge that certain disclosures may be required by law, regulation, or legal process, and nothing in this Agreement shall prevent either party from making such legally required disclosures.</p>`;
        }
        
        // Generate dispute resolution clause
        let disputeResolutionClause = '';
        if (disputeResolution === 'arbitration') {
          disputeResolutionClause = `<p class="paragraph">Any dispute, controversy, or claim arising out of or relating to this Agreement shall be resolved through binding arbitration administered by the American Arbitration Association in accordance with its Commercial Arbitration Rules. The place of arbitration shall be ${governingLaw}. The arbitration shall be conducted by a single arbitrator. The decision of the arbitrator shall be final and binding upon the parties.</p>`;
        } else if (disputeResolution === 'litigation') {
          disputeResolutionClause = `<p class="paragraph">Any dispute, controversy, or claim arising out of or relating to this Agreement shall be resolved through litigation in the state or federal courts located in ${governingLaw}. Each party hereby submits to the exclusive jurisdiction of such courts.</p>`;
        } else if (disputeResolution === 'mediation-arbitration') {
          disputeResolutionClause = `<p class="paragraph">Any dispute, controversy, or claim arising out of or relating to this Agreement shall first be submitted to mediation in accordance with the Commercial Mediation Rules of the American Arbitration Association. If the dispute is not resolved within 60 days after the initiation of mediation, it shall be resolved through binding arbitration administered by the American Arbitration Association in accordance with its Commercial Arbitration Rules. The place of mediation and arbitration shall be ${governingLaw}. The arbitration shall be conducted by a single arbitrator. The decision of the arbitrator shall be final and binding upon the parties.</p>`;
        }
        
        // Build the agreement HTML
        let agreementHtml = `
          <div class="document-title">STOCK TRANSFER AGREEMENT</div>
          
          <div class="document-section" id="section-parties">
            <div class="section-content">
              <p class="paragraph">THIS STOCK TRANSFER AGREEMENT (the "Agreement") is entered into as of ${agreementDate}, by and between ${sellerName}, a ${sellerEntity}, with its principal place of business at ${sellerAddress} (the "Seller"), and ${buyerName}, a ${buyerEntity}, with its principal place of business at ${buyerAddress} (the "Buyer").</p>
            </div>
          </div>
          
          <div class="document-section" id="section-transfer">
            <div class="section-title">1. TRANSFER OF STOCK AND PURCHASE PRICE</div>
            <div class="section-content">
              <p class="paragraph">1.1 Subject to the terms and conditions set forth in this Agreement, Seller hereby sells, assigns, transfers, and delivers to Buyer, and Buyer hereby purchases and acquires from Seller, ${sharesNumber} shares of ${shareType} (the "Shares") of ${companyName}.</p>
              
              <p class="paragraph">1.2 The purchase price for the Shares shall be ${formatCurrency(purchasePrice)} (the "Purchase Price"), payable by Buyer to Seller on the closing date (the "Closing Date").</p>
              
              <p class="paragraph">1.3 At closing, Seller shall deliver to Buyer a duly endorsed stock certificate representing the Shares, and Buyer shall deliver to Seller the Purchase Price.</p>
              
              <p class="paragraph">1.4 The closing of the transaction contemplated by this Agreement (the "Closing") shall take place on ${closingDate}, or such other date as mutually agreed upon by the parties (the "Closing Date").</p>
            </div>
          </div>
          
          <div class="document-section" id="section-reps">
            <div class="section-title">2. REPRESENTATIONS AND WARRANTIES</div>
            <div class="section-content">
              <p class="paragraph">2.1 <strong>Seller Representations and Warranties.</strong> Seller represents and warrants to Buyer that:</p>
              
              <p class="paragraph">(a) It has the power and authority to execute and deliver this Agreement, and this Agreement constitutes a legal, valid, and binding obligation, enforceable against Seller;</p>
              
              <p class="paragraph">(b) The execution, delivery, and performance of this Agreement by Seller does not conflict with any laws, regulations, orders, or agreements to which Seller is subject;</p>
              
              <p class="paragraph">(c) Seller has good and marketable title to the Shares, free and clear of all liens, encumbrances, and restrictions of any kind;</p>`;
              
        // Add additional seller representations based on selections
        if (sellerReps.includes('no-conflicts')) {
          agreementHtml += `\n              <p class="paragraph">(d) The transfer of the Shares does not violate any agreement, contract, or understanding to which Seller is a party or by which Seller is bound;</p>`;
        }
        
        if (sellerReps.includes('ownership')) {
          agreementHtml += `\n              <p class="paragraph">(${sellerReps.includes('no-conflicts') ? 'e' : 'd'}) Seller is the sole owner of the Shares and has not granted any options, warrants, or other rights to purchase or otherwise acquire the Shares;</p>`;
        }
        
        if (sellerReps.includes('no-litigation')) {
          agreementHtml += `\n              <p class="paragraph">(${(sellerReps.includes('no-conflicts') && sellerReps.includes('ownership')) ? 'f' : (sellerReps.includes('no-conflicts') || sellerReps.includes('ownership') ? 'e' : 'd')}) There is no pending or threatened litigation, arbitration, or administrative proceeding affecting the Shares or that would impair Seller's ability to comply with the terms of this Agreement;</p>`;
        }
        
        if (sellerReps.includes('comp-good-standing')) {
          agreementHtml += `\n              <p class="paragraph">(${(sellerReps.includes('no-conflicts') && sellerReps.includes('ownership') && sellerReps.includes('no-litigation')) ? 'g' : ((sellerReps.includes('no-conflicts') && sellerReps.includes('ownership')) || (sellerReps.includes('no-conflicts') && sellerReps.includes('no-litigation')) || (sellerReps.includes('ownership') && sellerReps.includes('no-litigation')) ? 'f' : (sellerReps.includes('no-conflicts') || sellerReps.includes('ownership') || sellerReps.includes('no-litigation') ? 'e' : 'd'))}) ${companyName} is duly organized, validly existing, and in good standing under the laws of its jurisdiction of incorporation;</p>`;
        }
        
        agreementHtml += `
              <p class="paragraph">2.2 <strong>Buyer Representations and Warranties.</strong> Buyer represents and warrants to Seller that:</p>
              
              <p class="paragraph">(a) It has the power and authority to execute and deliver this Agreement, and this Agreement constitutes a legal, valid, and binding obligation, enforceable against Buyer;</p>
              
              <p class="paragraph">(b) The execution, delivery, and performance of this Agreement by Buyer does not conflict with any laws, regulations, orders, or agreements to which Buyer is subject;</p>`;
              
        // Add additional buyer representations based on selections
        if (buyerReps.includes('financial-ability')) {
          agreementHtml += `\n              <p class="paragraph">(c) Buyer has the financial ability to complete the purchase of the Shares and to make all payments required under this Agreement;</p>`;
        }
        
        if (buyerReps.includes('accredited')) {
          agreementHtml += `\n              <p class="paragraph">(${buyerReps.includes('financial-ability') ? 'd' : 'c'}) Buyer is an "accredited investor" as defined in Rule 501(a) of Regulation D promulgated under the Securities Act of 1933, as amended;</p>`;
        }
        
        if (buyerReps.includes('investment-purpose')) {
          agreementHtml += `\n              <p class="paragraph">(${(buyerReps.includes('financial-ability') && buyerReps.includes('accredited')) ? 'e' : (buyerReps.includes('financial-ability') || buyerReps.includes('accredited') ? 'd' : 'c')}) Buyer is acquiring the Shares for investment purposes only and not with a view to distribution or resale in violation of applicable securities laws;</p>`;
        }
        
        // Add custom representations if provided
        if (customReps) {
          agreementHtml += `\n              <p class="paragraph">2.3 <strong>Additional Representations and Warranties.</strong> The parties further represent and warrant that:</p>\n              <p class="paragraph">${customReps}</p>`;
        }
        
        agreementHtml += `
            </div>
          </div>
          
          <div class="document-section" id="section-confidentiality">
            <div class="section-title">3. CONFIDENTIALITY</div>
            <div class="section-content">
              ${confidentialityClause}
            </div>
          </div>
          
          <div class="document-section" id="section-indemnification">
            <div class="section-title">4. INDEMNIFICATION</div>
            <div class="section-content">
              <p class="paragraph">4.1 Each party (the "Indemnifying Party") agrees to indemnify, defend, and hold harmless the other party (the "Indemnified Party") against any and all losses, damages, liabilities, or expenses (including reasonable attorneys' fees) arising out of or resulting from any breach of this Agreement by the Indemnifying Party.</p>
              
              <p class="paragraph">4.2 The Indemnified Party shall promptly notify the Indemnifying Party in writing of any claim, action, or proceeding for which indemnification may be sought, provided that the failure to provide such notice shall not relieve the Indemnifying Party of its obligations except to the extent the Indemnifying Party is materially prejudiced thereby.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-limitation">
            <div class="section-title">5. LIMITATION OF LIABILITY</div>
            <div class="section-content">
              <p class="paragraph">5.1 NEITHER PARTY WILL BE LIABLE TO THE OTHER FOR ANY INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL, PUNITIVE, OR EXEMPLARY DAMAGES ARISING OUT OF OR RELATED TO THIS AGREEMENT, EXCEPT IN THE CASE OF GROSS NEGLIGENCE, WILLFUL MISCONDUCT, OR FRAUD.</p>
              
              <p class="paragraph">5.2 THE TOTAL LIABILITY OF EITHER PARTY FOR ANY AND ALL CLAIMS ARISING OUT OF OR RELATED TO THIS AGREEMENT WILL NOT EXCEED THE PURCHASE PRICE PAID FOR THE SHARES.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-legal">
            <div class="section-title">6. GENERAL</div>
            <div class="section-content">
              <p class="paragraph">6.1 <strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw}, without giving effect to any choice of law or conflict of law provisions.</p>
              
              <p class="paragraph">6.2 <strong>Dispute Resolution.</strong> ${disputeResolutionClause}</p>
              
              <p class="paragraph">6.3 <strong>Severability.</strong> If any provision of this Agreement is held to be invalid or unenforceable, the remaining provisions will remain in full force and effect.</p>
              
              <p class="paragraph">6.4 <strong>Waiver.</strong> No waiver by any party of any of the provisions of this Agreement shall be effective unless explicitly set forth in writing and signed by the party so waiving.</p>
              
              <p class="paragraph">6.5 <strong>Assignment.</strong> This Agreement is not assignable by either party without the prior written consent of the other party.</p>
              
              <p class="paragraph">6.6 <strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement and understanding between the parties with respect to the subject matter hereof and supersedes all prior and contemporaneous understandings, agreements, representations, and warranties, both written and oral, with respect to such subject matter.</p>
              
              <p class="paragraph">6.7 <strong>Counterparts.</strong> This Agreement may be executed in counterparts, each of which shall be deemed an original, but all of which together shall constitute one and the same instrument.</p>`;
              
        // Add custom legal terms if provided
        if (customTerms) {
          agreementHtml += `\n              <p class="paragraph">6.8 <strong>Additional Terms.</strong> ${customTerms}</p>`;
        }
        
        agreementHtml += `
            </div>
          </div>
          
          <div class="document-section" id="section-signatures">
            <div class="section-content">
              <p class="paragraph">IN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.</p>
              
              <div class="signatures-wrapper">
                <div class="signature-column">
                  <p><strong>SELLER:</strong></p>
                  <p>${sellerName}</p>
                  <div class="signature-line"></div>
                  <p>By: ${sellerSignatory}</p>
                  <p>Title: ${sellerTitle}</p>
                </div>
                
                <div class="signature-column">
                  <p><strong>BUYER:</strong></p>
                  <p>${buyerName}</p>
                  <div class="signature-line"></div>
                  <p>By: ${buyerSignatory}</p>
                  <p>Title: ${buyerTitle}</p>
                </div>
              </div>
            </div>
          </div>
        `;
        
        // Update the preview with the agreement HTML
        preview.innerHTML = agreementHtml;
        
        // If a specific field was changed, highlight the relevant content
        if (changedField) {
          highlightChangedContent(changedField);
        }
        
        // Apply fading to non-active sections if not paid
        if (!isPaid) {
          fadeNonActiveSections(changedField ? getActiveSection(changedField) : null);
        }
      }
      
      // Function to fade non-active sections
      function fadeNonActiveSections(activeId) {
        if (!isPaid && activeId) {
          document.querySelectorAll('.document-section').forEach(section => {
            if (section.id === activeId) {
              section.classList.remove('faded');
              activeSection = section;
            } else {
              section.classList.add('faded');
            }
          });
        }
      }
      
      // Function to get active section ID from a field
      function getActiveSection(field) {
        if (['seller-name', 'seller-entity', 'seller-address', 'buyer-name', 'buyer-entity', 'buyer-address'].includes(field)) {
          return 'section-parties';
        } else if (['agreement-date', 'company-name', 'shares-number', 'share-type', 'purchase-price', 'closing-date'].includes(field)) {
          return 'section-transfer';
        } else if (['seller-reps', 'buyer-reps', 'custom-reps'].includes(field)) {
          return 'section-reps';
        } else if (field === 'confidentiality') {
          return 'section-confidentiality';
        } else if (['governing-law', 'dispute-resolution', 'custom-terms'].includes(field)) {
          return 'section-legal';
        } else if (['seller-signatory', 'seller-title', 'buyer-signatory', 'buyer-title'].includes(field)) {
          return 'section-signatures';
        }
        
        return null;
      }
      
      // Function to highlight changed content in the preview
      function highlightChangedContent(changedField) {
        // Clear any existing highlights
        clearHighlights();
        
        // Determine which section to highlight based on the changed field
        let sectionId = getActiveSection(changedField);
        let textToFind = '';
        
        // Party Information fields
        if (['seller-name', 'seller-entity', 'seller-address', 'buyer-name', 'buyer-entity', 'buyer-address'].includes(changedField)) {
          if (changedField === 'seller-name') {
            textToFind = document.getElementById('seller-name').value;
          } else if (changedField === 'seller-entity') {
            textToFind = document.getElementById('seller-entity').value;
          } else if (changedField === 'seller-address') {
            textToFind = document.getElementById('seller-address').value;
          } else if (changedField === 'buyer-name') {
            textToFind = document.getElementById('buyer-name').value;
          } else if (changedField === 'buyer-entity') {
            textToFind = document.getElementById('buyer-entity').value;
          } else if (changedField === 'buyer-address') {
            textToFind = document.getElementById('buyer-address').value;
          }
        } 
        // Stock Information fields
        else if (['agreement-date', 'company-name', 'shares-number', 'share-type', 'purchase-price', 'closing-date'].includes(changedField)) {
          if (changedField === 'agreement-date') {
            textToFind = formatDate(document.getElementById('agreement-date').value);
          } else if (changedField === 'company-name') {
            textToFind = document.getElementById('company-name').value;
          } else if (changedField === 'shares-number') {
            textToFind = document.getElementById('shares-number').value;
          } else if (changedField === 'share-type') {
            textToFind = document.getElementById('share-type').value;
          } else if (changedField === 'purchase-price') {
            const price = document.getElementById('purchase-price').value;
            textToFind = new Intl.NumberFormat('en-US', {
              style: 'currency',
              currency: 'USD'
            }).format(price);
          } else if (changedField === 'closing-date') {
            textToFind = formatDate(document.getElementById('closing-date').value);
          }
        } 
        // Representations fields
        else if (['seller-reps', 'buyer-reps', 'custom-reps'].includes(changedField)) {
          if (changedField === 'custom-reps') {
            textToFind = document.getElementById('custom-reps').value;
          }
          // For checkbox groups, we'll just highlight the section
        } 
        // Legal terms fields
        else if (['governing-law', 'dispute-resolution', 'confidentiality', 'custom-terms'].includes(changedField)) {
          if (changedField === 'governing-law') {
            textToFind = document.getElementById('governing-law').value;
          } else if (changedField === 'custom-terms') {
            textToFind = document.getElementById('custom-terms').value;
          }
          // For radio groups, we'll just highlight the section
        } 
        // Signature fields
        else if (['seller-signatory', 'seller-title', 'buyer-signatory', 'buyer-title'].includes(changedField)) {
          if (changedField === 'seller-signatory') {
            textToFind = document.getElementById('seller-signatory').value;
          } else if (changedField === 'seller-title') {
            textToFind = document.getElementById('seller-title').value;
          } else if (changedField === 'buyer-signatory') {
            textToFind = document.getElementById('buyer-signatory').value;
          } else if (changedField === 'buyer-title') {
            textToFind = document.getElementById('buyer-title').value;
          }
        }
        
        // If we found a section, highlight it or the specific text
        if (sectionId) {
          const section = document.getElementById(sectionId);
          
          if (section) {
            // If we have specific text to find, highlight it
            if (textToFind) {
              const paragraphs = section.querySelectorAll('p');
              let foundHighlight = false;
              
              paragraphs.forEach(p => {
                if (p.textContent.includes(textToFind)) {
                  p.classList.add('highlight');
                  highlightedElements.push(p);
                  foundHighlight = true;
                  
                  // Scroll to the first highlighted element
                  if (highlightedElements.length === 1) {
                    // Get positions to check if scrolling is needed
                    const previewBox = document.querySelector('.preview-box');
                    const containerRect = previewBox.getBoundingClientRect();
                    const elementRect = p.getBoundingClientRect();
                    
                    // Check if element is fully visible
                    if (elementRect.top < containerRect.top || elementRect.bottom > containerRect.bottom) {
                      p.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                  }
                }
              });
              
              // If no specific text highlight was found, highlight the whole section
              if (!foundHighlight) {
                section.classList.add('highlight');
                highlightedElements.push(section);
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
              }
            } else {
              // No specific text to highlight, highlight the whole section
              section.classList.add('highlight');
              highlightedElements.push(section);
              
              // Ensure the section is visible
              section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }
        }
        
        // Set timeout to remove highlights after 3 seconds
        highlightTimeout = setTimeout(() => {
          clearHighlights();
        }, 3000);
      }
      
      // Function to generate plain text version for copying
      function generatePlainText() {
        // Get all the text content from the preview
        const content = preview.textContent;
        
        // Format it for better readability
        return content.replace(/\n\s+/g, '\n').replace(/\n{3,}/g, '\n\n');
      }
      
      // Function to generate DOCX file
      function generateDocx() {
        try {
          // Access docx library
          const docx = window.docx;
          if (!docx) {
            throw new Error("DOCX library not loaded");
          }
          
          const sellerName = document.getElementById('seller-name').value || '[SELLER NAME]';
          const buyerName = document.getElementById('buyer-name').value || '[BUYER NAME]';
          const sellerSignatory = document.getElementById('seller-signatory').value || '[NAME]';
          const sellerTitle = document.getElementById('seller-title').value || '[TITLE]';
          const buyerSignatory = document.getElementById('buyer-signatory').value || '[NAME]';
          const buyerTitle = document.getElementById('buyer-title').value || '[TITLE]';
          
          // Generate filename
          const dateStr = new Date().toISOString().split('T')[0];
          const filename = `Stock_Transfer_Agreement_${dateStr}.docx`;
          
          // Create paragraphs from preview content
          const paragraphs = [];
          const sections = document.querySelectorAll('.document-section');
          
          // Title - same font size as everything else (11pt), just bold and centered
          paragraphs.push(
            new docx.Paragraph({
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: 200,
                after: 200
              },
              children: [
                new docx.TextRun({
                  text: "STOCK TRANSFER AGREEMENT",
                  bold: true,
                  size: 22 // 11pt = 22 half-points
                })
              ]
            })
          );
          
          // Add each section
          sections.forEach(section => {
            const titleElement = section.querySelector('.section-title');
            if (titleElement) {
              // Add section title - same font size as everything else (11pt), just bold
              paragraphs.push(
                new docx.Paragraph({
                  spacing: {
                    before: 160,
                    after: 80
                  },
                  children: [
                    new docx.TextRun({
                      text: titleElement.textContent,
                      bold: true,
                      size: 22 // 11pt = 22 half-points
                    })
                  ]
                })
              );
            }
            
            // Add content paragraphs
            const contentParagraphs = section.querySelectorAll('.paragraph');
            contentParagraphs.forEach(p => {
              // Skip signature paragraphs as we'll handle them separately
              if (p.closest('.signatures-wrapper')) {
                return;
              }
              
              // Special handling for witness clause
              if (p.textContent.includes('IN WITNESS WHEREOF')) {
                paragraphs.push(
                  new docx.Paragraph({
                    text: p.textContent,
                    spacing: {
                      before: 160,
                      after: 160
                    },
                    size: 22 // 11pt = 22 half-points
                  })
                );
              } else {
                // Regular paragraph
                paragraphs.push(
                  new docx.Paragraph({
                    text: p.textContent,
                    spacing: {
                      before: 80,
                      after: 80
                    },
                    size: 22 // 11pt = 22 half-points
                  })
                );
              }
            });
          });
          
          // Add side-by-side signature blocks
          // This requires a table in docx.js
          const signatureTable = new docx.Table({
            width: {
              size: 100,
              type: docx.WidthType.PERCENTAGE,
            },
            rows: [
              new docx.TableRow({
                children: [
                  new docx.TableCell({
                    children: [
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: "SELLER:",
                            bold: true,
                            size: 22
                          })
                        ],
                        spacing: {
                          after: 40
                        }
                      }),
                      new docx.Paragraph({
                        text: sellerName,
                        spacing: {
                          after: 40
                        },
                        size: 22
                      }),
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: "__________________________",
                            size: 22
                          })
                        ],
                        spacing: {
                          before: 80,
                          after: 40
                        }
                      }),
                      new docx.Paragraph({
                        text: `By: ${sellerSignatory}`,
                        spacing: {
                          after: 40
                        },
                        size: 22
                      }),
                      new docx.Paragraph({
                        text: `Title: ${sellerTitle}`,
                        size: 22
                      })
                    ],
                    borders: {
                      top: { style: docx.BorderStyle.NONE },
                      bottom: { style: docx.BorderStyle.NONE },
                      left: { style: docx.BorderStyle.NONE },
                      right: { style: docx.BorderStyle.NONE }
                    }
                  }),
                  new docx.TableCell({
                    children: [
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: "BUYER:",
                            bold: true,
                            size: 22
                          })
                        ],
                        spacing: {
                          after: 40
                        }
                      }),
                      new docx.Paragraph({
                        text: buyerName,
                        spacing: {
                          after: 40
                        },
                        size: 22
                      }),
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: "__________________________",
                            size: 22
                          })
                        ],
                        spacing: {
                          before: 80,
                          after: 40
                        }
                      }),
                      new docx.Paragraph({
                        text: `By: ${buyerSignatory}`,
                        spacing: {
                          after: 40
                        },
                        size: 22
                      }),
                      new docx.Paragraph({
                        text: `Title: ${buyerTitle}`,
                        size: 22
                      })
                    ],
                    borders: {
                      top: { style: docx.BorderStyle.NONE },
                      bottom: { style: docx.BorderStyle.NONE },
                      left: { style: docx.BorderStyle.NONE },
                      right: { style: docx.BorderStyle.NONE }
                    }
                  })
                ]
              })
            ]
          });
          
          // Add signature table to paragraphs
          paragraphs.push(signatureTable);
          
          // Create document with standardized styling
          const doc = new docx.Document({
            styles: {
              paragraphStyles: [
                {
                  id: "Normal",
                  run: {
                    size: 22, // 11pt = 22 half-points
                    font: "Times New Roman"
                  },
                  paragraph: {
                    spacing: {
                      line: 276, // 1.15 line spacing
                      before: 0,
                      after: 0
                    }
                  }
                }
              ]
            },
            sections: [{
              properties: {
                page: {
                  margin: {
                    top: 1440, // 1 inch in twips
                    right: 1440,
                    bottom: 1440,
                    left: 1440
                  }
                }
              },
              children: paragraphs
            }]
          });
          
          // Generate and save document
          docx.Packer.toBlob(doc)
            .then(blob => {
              window.saveAs(blob, filename);
            })
            .catch(error => {
              console.error("Error saving DOCX:", error);
              alert("Unable to download. Please try using the copy button instead.");
            });
        } catch (error) {
          console.error("DOCX generation error:", error);
          alert("Unable to download. Please try using the copy button instead.");
        }
      }
    });
  </script>
</body>
</html>



<h2 class="wp-block-heading">Complete Guide to Stock Transfers: Process, Comparison, and Best Practices</h2>



<h3 class="wp-block-heading">The Stock Transfer Process: Step by Step</h3>



<p>The proper execution of a stock transfer involves several critical stages:</p>



<ol class="wp-block-list">
<li><strong>Initial Negotiation</strong>: Parties establish the fundamental terms of the transfer, including share quantity, price, and payment structure.</li>



<li><strong>Due Diligence</strong>: The buyer investigates the company&#8217;s financial condition, liabilities, and the legal status of the shares being transferred. This may include:
<ul class="wp-block-list">
<li>Reviewing corporate records and bylaws</li>



<li>Examining existing shareholder agreements</li>



<li>Verifying the absence of liens or encumbrances on the shares</li>



<li>Assessing potential regulatory issues</li>
</ul>
</li>



<li><strong>Agreement Drafting</strong>: Creating the Stock Transfer Agreement with appropriate terms, conditions, representations, and warranties.</li>



<li><strong>Compliance Review</strong>: Ensuring the transfer complies with:
<ul class="wp-block-list">
<li>Federal and state securities laws</li>



<li>Corporate governance documents</li>



<li>Existing shareholder agreements</li>



<li>Tax regulations</li>
</ul>
</li>



<li><strong>Execution and Closing</strong>: Both parties sign the agreement, the buyer delivers payment, and the seller delivers either physical stock certificates or executes the necessary documents for electronic transfers.</li>



<li><strong>Post-Closing Requirements</strong>:
<ul class="wp-block-list">
<li>Updating the company&#8217;s stock ledger or cap table</li>



<li>Issuing new stock certificates if necessary</li>



<li>Filing any required securities notices or exemption forms</li>



<li>Notifying the company&#8217;s board of directors</li>



<li>Completing tax documentation</li>
</ul>
</li>
</ol>



<p>Without attention to each of these steps, stock transfers may be legally vulnerable or fail to achieve the parties&#8217; intended outcomes.</p>



<h3 class="wp-block-heading">Understanding Key Provisions in Stock Transfer Agreements</h3>



<h4 class="wp-block-heading">1. Representations and Warranties</h4>



<p>These provisions function as legally binding statements of fact that create liability if untrue. Common representations include:</p>



<p><strong>From the Seller:</strong></p>



<ul class="wp-block-list">
<li>Clear title to the shares without encumbrances</li>



<li>Authority to transfer the shares</li>



<li>No conflicts with other agreements</li>



<li>Compliance with securities laws</li>
</ul>



<p><strong>From the Buyer:</strong></p>



<ul class="wp-block-list">
<li>Financial capacity to complete the purchase</li>



<li>Accredited investor status (if applicable)</li>



<li>Investment intent (not purchasing for immediate resale)</li>



<li>Acknowledgment of transfer restrictions</li>
</ul>



<p>The scope of representations directly affects risk allocation between parties. More extensive representations shift greater risk to the party making them.</p>



<h4 class="wp-block-heading">2. Indemnification Provisions</h4>



<p>Indemnification clauses establish how parties will be compensated if representations prove false or other specified events occur. These provisions determine:</p>



<ul class="wp-block-list">
<li>Who must defend against third-party claims</li>



<li>The process for making indemnification claims</li>



<li>Limitations on indemnification amounts</li>



<li>Time limitations for bringing claims</li>
</ul>



<p>Without proper indemnification language, parties lack clear recourse when problems arise post-transfer.</p>



<h4 class="wp-block-heading">3. Closing Conditions</h4>



<p>These provisions specify what must occur before the transfer becomes final:</p>



<ul class="wp-block-list">
<li>Board approval or waiver of transfer restrictions</li>



<li>Regulatory filings or approvals</li>



<li>Third-party consents</li>



<li>Delivery of legal opinions</li>



<li>Receipt of stock certificates</li>
</ul>



<p>Properly structured closing conditions protect parties from being bound to transfers that cannot be legally completed.</p>



<h3 class="wp-block-heading">Stock Transfers vs. Other Equity Transaction Methods</h3>



<div style="overflow-x:auto;">
<table border="1" cellpadding="8" cellspacing="0">
  <tr style="background-color:#f2f2f2; font-weight:bold;">
    <th>Feature</th>
    <th>Stock Transfer</th>
    <th>Asset Purchase</th>
    <th>Stock Option Grant</th>
    <th>Equity Issuance (New Shares)</th>
  </tr>
  <tr>
    <td><strong>Primary Function</strong></td>
    <td>Transfers existing shares from current holder to new owner</td>
    <td>Purchases specific company assets, not ownership shares</td>
    <td>Grants right to purchase shares at a specified price in the future</td>
    <td>Creates and issues new shares, diluting existing ownership</td>
  </tr>
  <tr>
    <td><strong>Effect on Company Capitalization</strong></td>
    <td>No change in outstanding shares</td>
    <td>No direct effect on capitalization</td>
    <td>No immediate change (changes only upon exercise)</td>
    <td>Increases total outstanding shares</td>
  </tr>
  <tr>
    <td><strong>Corporate Approval Required</strong></td>
    <td>Varies by corporate documents (often minimal)</td>
    <td>Board approval typically required</td>
    <td>Board approval required</td>
    <td>Board and potentially shareholder approval required</td>
  </tr>
  <tr>
    <td><strong>Tax Implications for Seller/Grantor</strong></td>
    <td>Capital gains/losses based on basis in shares</td>
    <td>Ordinary income and capital gains (depending on assets)</td>
    <td>No immediate tax consequence</td>
    <td>No direct tax consequence</td>
  </tr>
  <tr>
    <td><strong>Tax Implications for Buyer/Recipient</strong></td>
    <td>Establishes new cost basis in shares</td>
    <td>New depreciable basis in acquired assets</td>
    <td>Tax at exercise based on spread between strike and FMV</td>
    <td>Investment with basis equal to purchase price or value of consideration</td>
  </tr>
  <tr>
    <td><strong>Securities Law Considerations</strong></td>
    <td>Exemption from registration typically required</td>
    <td>Generally not subject to securities regulations</td>
    <td>Subject to securities laws as investment contracts</td>
    <td>Most stringent securities law requirements, often requiring detailed disclosures</td>
  </tr>
  <tr>
    <td><strong>Effect on Company Liabilities</strong></td>
    <td>No direct effect (buyer becomes owner of entity with existing liabilities)</td>
    <td>Typically excludes liabilities unless specifically assumed</td>
    <td>No effect</td>
    <td>No direct effect on existing liabilities</td>
  </tr>
  <tr>
    <td><strong>Documentation Complexity</strong></td>
    <td>Moderate</td>
    <td>High (requires detailed asset schedules)</td>
    <td>Moderate to high (requires option plan and grant documents)</td>
    <td>High (requires disclosure documents, board resolutions)</td>
  </tr>
  <tr>
    <td><strong>Typical Timeline</strong></td>
    <td>Days to weeks</td>
    <td>Weeks to months</td>
    <td>Days to weeks</td>
    <td>Weeks to months</td>
  </tr>
</table>
</div>




<h3 class="wp-block-heading">Common Stock Transfer Pitfalls to Avoid</h3>



<ol class="wp-block-list">
<li><strong>Ignoring Transfer Restrictions</strong> Many corporations have restrictions on stock transfers in their bylaws or shareholder agreements. Failing to obtain necessary approvals or waivers can invalidate the transfer entirely.</li>



<li><strong>Inadequate Disclosure</strong> Sellers may face liability for failing to disclose material information about the company or the shares. A proper Stock Transfer Agreement includes comprehensive representations that protect both parties.</li>



<li><strong>Securities Law Violations</strong> Most private stock transfers require exemptions from securities registration requirements. Without proper documentation of these exemptions, both parties may face regulatory penalties.</li>



<li><strong>Imprecise Valuation Methods</strong> Stock valuation disputes are common in private company transfers. Your agreement should clearly document the agreed valuation and methodology to prevent future challenges.</li>



<li><strong>Tax Structuring Oversights</strong> Different transfer structures have significant tax implications. Without proper planning, parties may face unexpected tax burdens or miss opportunities for more favorable treatment.</li>
</ol>



<h3 class="wp-block-heading">Frequently Asked Questions About Stock Transfers</h3>



<h4 class="wp-block-heading">Do I need board approval to transfer shares in a private company?</h4>



<p>It depends on the company&#8217;s governing documents. Many corporations have provisions in their bylaws, articles of incorporation, or shareholder agreements that require board approval for stock transfers or give existing shareholders rights of first refusal. Always review these documents before proceeding with a transfer.</p>



<h4 class="wp-block-heading">What&#8217;s the difference between a stock purchase agreement and a stock transfer agreement?</h4>



<p>While sometimes used interchangeably, a stock purchase agreement typically refers to purchasing shares directly from a corporation (new issuance), while a stock transfer agreement involves the transfer of existing shares from one shareholder to another. The Stock Transfer Agreement Generator above creates documentation for transferring existing shares between shareholders.</p>



<h4 class="wp-block-heading">How do I determine the fair market value of private company shares?</h4>



<p>Private company share valuation typically uses methods like:</p>



<ul class="wp-block-list">
<li>Discounted cash flow analysis</li>



<li>Comparable company analysis</li>



<li>Prior investment rounds pricing</li>



<li>Book value approaches</li>



<li>Revenue or EBITDA multiples</li>
</ul>



<p>For significant transfers, obtaining an independent valuation from a qualified business appraiser provides the strongest documentation for both tax purposes and to prevent future disputes.</p>



<h4 class="wp-block-heading">What happens if I transfer shares without proper documentation?</h4>



<p>Undocumented transfers create significant risks:</p>



<ul class="wp-block-list">
<li>The company may not recognize the transfer or record the new shareholder</li>



<li>The transfer might violate company bylaws or shareholder agreements</li>



<li>Securities law exemptions may be jeopardized</li>



<li>Tax authorities may challenge valuations or the timing of the transaction</li>



<li>Future disputes may arise about whether the transfer was completed</li>
</ul>



<p>Always document transfers formally, even between related parties or for nominally priced transactions.</p>



<h4 class="wp-block-heading">Are stock transfers taxable events?</h4>



<p>Yes, in most cases. The seller typically recognizes capital gain or loss based on the difference between their tax basis in the shares and the sale proceeds. Special rules may apply for transfers between related parties, transfers to entities like trusts, or transfers as gifts. Consult with a tax professional before structuring any stock transfer.</p>



<h3 class="wp-block-heading">Finalizing Your Stock Transfer</h3>



<p>A properly executed Stock Transfer Agreement represents the cornerstone of a legally sound ownership change. By addressing purchase terms, representations, and closing conditions, this document protects all parties and ensures regulatory compliance.</p>



<p>The Stock Transfer Agreement Generator above helps create a customized agreement tailored to your specific circumstances. For complex transfers or additional guidance, consider scheduling a legal consultation to address the unique aspects of your situation.</p>



<div class="wp-block-jetpack-calendly"><div class="wp-block-jetpack-button wp-block-button" style=""><a class="wp-block-button__link" style="" data-id-attr="calendly-block-33" id="calendly-block-33" href="https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting?hide_event_type_details=0&#038;background_color=ffffff&#038;text_color=4D5055&#038;primary_color=00A2FF" target="_blank" role="button" rel="noopener noreferrer" data-wp-class--is-submitting="state.isSubmitting" data-wp-bind--aria-disabled="state.isAriaDisabled">Schedule time with me<span class="spinner" aria-hidden="true"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25"/><path d="M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z"><animateTransform attributeName="transform" type="rotate" dur="0.75s" values="0 12 12;360 12 12" repeatCount="indefinite"/></path></svg><span class="is-visually-hidden">Submitting form</span></span></a></div></div>
</div>
    </article>
  </main>
  <footer><p>© Terms.Law. All rights reserved.</p></footer>
</body>
</html>