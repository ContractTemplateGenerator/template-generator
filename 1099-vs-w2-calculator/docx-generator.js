window.generateWordDoc = function(documentText, formData) {
  try {
    // Simple HTML that definitely works
    const htmlContent = `<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>1099 vs W-2 Tax Comparison</title>
<style>
body { font-family: Calibri; font-size: 11pt; margin: 0.5in; }
h1 { text-align: center; font-size: 16pt; }
pre { font-family: monospace; white-space: pre-wrap; }
</style>
</head>
<body>
<h1>1099 vs W-2 Tax Comparison Analysis</h1>
<pre>${documentText}</pre>
<p><em>Generated by terms.law Tax Calculator on ${new Date().toLocaleDateString()}</em></p>
</body>
</html>`;

    const blob = new Blob([htmlContent], { type: 'application/vnd.ms-word;charset=utf-8' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = '1099-vs-W2-Tax-Analysis.doc';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
  } catch (error) {
    console.error("Error:", error);
    alert("Error generating document. Please use the copy option instead.");
  }
};