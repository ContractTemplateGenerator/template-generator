<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terms of Use Update Notice & Banner Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Base Styles */
        :root {
            --primary-color: #0069ff;
            --secondary-color: #f9f9f9;
            --border-color: #ddd;
            --text-color: #333333;
            --highlight-color: #ffff00;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Open Sans', sans-serif;
        }
        
        body {
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }
        
        .generator-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px var(--shadow-color);
            overflow: hidden;
        }
        
        /* Header Styles */
        .generator-header {
            background-color: var(--primary-color);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .generator-header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .generator-header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        /* Content Layout */
        .generator-content {
            display: flex;
            min-height: 600px;
        }
        
        /* Form Styles */
        .form-container {
            flex: 1;
            padding: 25px;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            max-height: 800px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            background-color: #f1f1f1;
            margin-right: 5px;
            transition: background-color 0.3s;
        }
        
        .tab:hover {
            background-color: #e0e0e0;
        }
        
        .tab.active {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 105, 255, 0.2);
        }
        
        textarea.form-input {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-helper {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        /* Checkbox Styles */
        .checkbox-group {
            margin-top: 5px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: flex-start;
            padding: 8px 10px;
            margin-bottom: 8px;
            background-color: #f5f7fa;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .checkbox-label:hover {
            background-color: #eef2f7;
        }
        
        .checkbox-label.selected {
            background-color: #e8f6f3;
            border-color: var(--primary-color);
        }
        
        .checkbox-label input {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .checkbox-content {
            flex: 1;
        }
        
        .checkbox-title {
            font-weight: 500;
            display: block;
            margin-bottom: 2px;
        }
        
        .checkbox-description {
            font-size: 12px;
            color: #666;
        }
        
        /* Button Styles */
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0052cc;
        }
        
        .btn-secondary {
            background-color: #f1f1f1;
            color: var(--text-color);
        }
        
        .btn-secondary:hover {
            background-color: #e0e0e0;
        }
        
        /* Preview Styles */
        .preview-container {
            flex: 1;
            padding: 25px;
            position: relative;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .preview-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .preview-note {
            font-size: 12px;
            color: #666;
            font-style: italic;
        }
        
        .preview-box {
            height: 700px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 25px;
            background-color: white;
            font-size: 14px;
        }
        
        .highlight {
            background-color: var(--highlight-color);
            transition: background-color 0.5s ease;
        }
        
        .copy-message {
            display: none;
            font-size: 14px;
            color: #27ae60;
            margin-left: 10px;
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .generator-content {
                flex-direction: column;
            }
            
            .form-container {
                border-right: none;
                border-bottom: 1px solid var(--border-color);
                max-height: none;
            }
            
            .preview-box {
                height: 500px;
            }
        }
        
        @media (max-width: 768px) {
            .generator-container {
                margin: 0;
                border-radius: 0;
            }
            
            .generator-header {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .copy-message {
                margin-left: 0;
                margin-top: 5px;
                text-align: center;
            }
        }
        
        .banner-preview {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .email-preview {
            font-family: Arial, sans-serif;
        }
        
        .email-preview .email-header {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }
        
        .email-preview .email-footer {
            border-top: 1px solid #eee;
            padding-top: 10px;
            margin-top: 20px;
            font-size: 12px;
            color: #777;
        }
    </style>
</head>
<body>
    <div class="generator-container">
        <div class="generator-header">
            <h1>Terms of Use Update Notice & Banner Generator</h1>
            <p>Create professional notices for your website users when updating your Terms of Use</p>
        </div>
        
        <div class="generator-content">
            <!-- Form Container -->
            <div class="form-container">
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('general-tab')">General Info</div>
                    <div class="tab" onclick="switchTab('changes-tab')">Changes Made</div>
                    <div class="tab" onclick="switchTab('display-tab')">Display Options</div>
                </div>
                
                <div class="tab-content active" id="general-tab">
                    <div class="form-group">
                        <label for="company-name">Company/Website Name</label>
                        <input type="text" id="company-name" class="form-input" placeholder="e.g., Your Company Name" value="Your Company" oninput="updatePreview()">
                    </div>
                    
                    <div class="form-group">
                        <label for="website-url">Website URL</label>
                        <input type="text" id="website-url" class="form-input" placeholder="e.g., https://yourcompany.com" value="https://yourcompany.com" oninput="updatePreview()">
                    </div>
                    
                    <div class="form-group">
                        <label for="effective-date">Effective Date</label>
                        <input type="date" id="effective-date" class="form-input" onchange="updatePreview()">
                    </div>
                    
                    <div class="form-group">
                        <label for="notice-period">Notice Period (days)</label>
                        <input type="number" id="notice-period" class="form-input" placeholder="e.g., 30" value="30" min="1" max="90" oninput="updatePreview()">
                        <div class="form-helper">How many days in advance to notify users before changes take effect</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="terms-url">Link to Updated Terms</label>
                        <input type="text" id="terms-url" class="form-input" placeholder="e.g., https://yourcompany.com/terms" value="https://yourcompany.com/terms" oninput="updatePreview()">
                    </div>
                    
                    <div class="form-group">
                        <label for="contact-email">Contact Email</label>
                        <input type="email" id="contact-email" class="form-input" placeholder="e.g., support@yourcompany.com" value="support@yourcompany.com" oninput="updatePreview()">
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" id="reset-btn" onclick="resetForm()">Reset</button>
                        <button class="btn btn-primary" onclick="switchTab('changes-tab')">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="changes-tab">
                    <div class="form-group">
                        <label>Select Changes Made (Check all that apply)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label selected" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="privacy-policy" checked> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Data Privacy Updates</span>
                                    <span class="checkbox-description">Changes to comply with privacy laws or how you handle user data</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label selected" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="refund-policy" checked> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Refund Policy Changes</span>
                                    <span class="checkbox-description">Updates to refund terms, eligibility, or timeframes</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label selected" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="ip-rights" checked> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Intellectual Property Rights</span>
                                    <span class="checkbox-description">Changes to copyright, trademark, or content ownership</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label selected" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="jurisdiction" checked> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Jurisdiction Changes</span>
                                    <span class="checkbox-description">Updates to governing law or dispute resolution</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label selected" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="service-changes" checked> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Service Features/Functionality</span>
                                    <span class="checkbox-description">Changes to features, services, or platform functionality</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="payment-terms"> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">Payment Terms</span>
                                    <span class="checkbox-description">Updates to pricing, billing, or payment methods</span>
                                </div>
                            </label>
                            
                            <label class="checkbox-label" onclick="toggleOption(this)">
                                <input type="checkbox" name="change-option" value="user-content"> 
                                <div class="checkbox-content">
                                    <span class="checkbox-title">User Content Rights</span>
                                    <span class="checkbox-description">Changes to how user-generated content is managed</span>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="custom-details">Custom Details (Optional)</label>
                        <textarea id="custom-details" class="form-input" placeholder="Add any specific details about the changes..." oninput="updatePreview()"></textarea>
                        <div class="form-helper">Provide specific details about significant changes</div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="switchTab('general-tab')">Previous</button>
                        <button class="btn btn-primary" onclick="switchTab('display-tab')">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="display-tab">
                    <div class="form-group">
                        <label for="notice-type">Notice Type</label>
                        <select id="notice-type" class="form-input" onchange="updatePreview()">
                            <option value="both">Both Email & Website Banner</option>
                            <option value="email">Email Notice Only</option>
                            <option value="banner">Website Banner Only</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="banner-style">Banner Style</label>
                        <select id="banner-style" class="form-input" onchange="updatePreview()">
                            <option value="top">Top of Page</option>
                            <option value="bottom">Bottom of Page</option>
                            <option value="popup">Popup/Modal</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="consent-type">User Consent Method</label>
                        <select id="consent-type" class="form-input" onchange="updatePreview()">
                            <option value="explicit">Explicit (Require Click to Accept)</option>
                            <option value="implicit">Implicit (Continued Use Is Acceptance)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="banner-color">Banner Color</label>
                        <select id="banner-color" class="form-input" onchange="updatePreview()">
                            <option value="blue">Blue</option>
                            <option value="green">Green</option>
                            <option value="yellow">Yellow</option>
                            <option value="red">Red</option>
                            <option value="gray">Gray</option>
                        </select>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="switchTab('changes-tab')">Previous</button>
                        <button class="btn btn-primary" onclick="generateFinalOutput()">Generate Full Version</button>
                    </div>
                </div>
            </div>
            
            <!-- Preview Container -->
            <div class="preview-container">
                <div class="preview-header">
                    <div class="preview-title">Live Preview</div>
                    <div class="preview-note">Updates as you complete the form</div>
                </div>
                
                <div class="preview-box" id="preview-content">
                    <!-- Content will be generated via JavaScript -->
                </div>
                
                <div class="button-group" style="margin-top: 20px;">
                    <button class="btn btn-secondary" id="copy-btn" onclick="copyToClipboard()">Copy</button>
                    <span id="copy-message" class="copy-message">Copied to clipboard!</span>
                    <button class="btn btn-primary" id="download-btn" onclick="downloadText()">Download as Text</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Set today's date as the default effective date
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const futureDate = new Date();
            futureDate.setDate(today.getDate() + 30); // Default to 30 days in the future
            
            const formattedDate = futureDate.toISOString().slice(0, 10);
            document.getElementById('effective-date').value = formattedDate;
            
            // Initial preview update
            updatePreview();
        });
        
        // Track currently highlighted elements
        let highlightedElements = [];
        let highlightTimeout;
        
        // Format date function
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }
        
        // Calculate notice date
        function calculateNoticeDate(effectiveDate, noticePeriod) {
            const date = new Date(effectiveDate);
            date.setDate(date.getDate() - parseInt(noticePeriod));
            return formatDate(date);
        }
        
        // Tab switching functionality
        function switchTab(tabId) {
            // Remove active class from all tabs and tab contents
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to clicked tab
            document.querySelectorAll(`.tab`).forEach((tab, index) => {
                if (tab.getAttribute('onclick').includes(tabId)) {
                    tab.classList.add('active');
                }
            });
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Update preview after tab switch (to ensure all elements are properly initialized)
            updatePreview();
        }
        
        // Toggle checkbox options
        function toggleOption(element) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('selected');
            } else {
                element.classList.remove('selected');
            }
            
            updatePreview();
        }
        
        // Clear highlights
        function clearHighlights() {
            if (highlightTimeout) {
                clearTimeout(highlightTimeout);
            }
            
            highlightedElements.forEach(element => {
                if (element && element.classList) {
                    element.classList.remove('highlight');
                }
            });
            
            highlightedElements = [];
        }
        
        // Update preview function
        function updatePreview(changedField = null) {
            // Clear existing highlights
            clearHighlights();
            
            // Get all form values
            const companyName = document.getElementById('company-name').value;
            const websiteUrl = document.getElementById('website-url').value;
            const effectiveDate = document.getElementById('effective-date').value;
            const formattedEffectiveDate = formatDate(effectiveDate);
            const noticePeriod = document.getElementById('notice-period').value;
            const noticeDate = calculateNoticeDate(effectiveDate, noticePeriod);
            const termsUrl = document.getElementById('terms-url').value;
            const contactEmail = document.getElementById('contact-email').value;
            
            // Get selected changes
            const selectedChanges = [];
            document.querySelectorAll('input[name="change-option"]:checked').forEach(checkbox => {
                selectedChanges.push(checkbox.value);
            });
            
            const customDetails = document.getElementById('custom-details').value;
            
            // Get display options
            const noticeType = document.getElementById('notice-type')?.value || 'both';
            const bannerStyle = document.getElementById('banner-style')?.value || 'top';
            const consentType = document.getElementById('consent-type')?.value || 'explicit';
            const bannerColor = document.getElementById('banner-color')?.value || 'blue';
            
            // Build changes list
            let changesList = '';
            
            if (selectedChanges.includes('privacy-policy')) {
                changesList += '<p class="change-item privacy-policy"><strong>Data Privacy Updates:</strong> We have updated our data privacy policy to comply with recent legislation. This includes changes to the types of information we collect, how we use it, and how you can control your data.</p>';
            }
            
            if (selectedChanges.includes('refund-policy')) {
                changesList += '<p class="change-item refund-policy"><strong>Refund Policy:</strong> We have revised our refund policy to provide more clarity on the circumstances under which refunds will be granted.</p>';
            }
            
            if (selectedChanges.includes('ip-rights')) {
                changesList += '<p class="change-item ip-rights"><strong>Intellectual Property Rights:</strong> We have added new language to protect our intellectual property rights. This includes an explicit prohibition on using our content without permission.</p>';
            }
            
            if (selectedChanges.includes('jurisdiction')) {
                changesList += '<p class="change-item jurisdiction"><strong>Jurisdiction:</strong> We have added language specifying that our terms of use and any disputes arising therefrom will be governed by specific legal jurisdiction.</p>';
            }
            
            if (selectedChanges.includes('service-changes')) {
                changesList += '<p class="change-item service-changes"><strong>Service Features/Functionality:</strong> We have updated our terms to reflect changes to our service features and functionality.</p>';
            }
            
            if (selectedChanges.includes('payment-terms')) {
                changesList += '<p class="change-item payment-terms"><strong>Payment Terms:</strong> We have updated our payment terms and conditions.</p>';
            }
            
            if (selectedChanges.includes('user-content')) {
                changesList += '<p class="change-item user-content"><strong>User Content Rights:</strong> We have updated our terms regarding user-generated content and the rights associated with it.</p>';
            }
            
            // Add custom details if provided
            let customDetailsHtml = '';
            if (customDetails) {
                customDetailsHtml = `<p class="change-item custom-details"><strong>Additional Details:</strong><br>${customDetails.replace(/\n/g, '<br>')}</p>`;
            }
            
            // Banner color styles
            let bannerStyleCSS = '';
            switch (bannerColor) {
                case 'blue':
                    bannerStyleCSS = 'background-color: #e3f2fd; border-color: #90caf9;';
                    break;
                case 'green':
                    bannerStyleCSS = 'background-color: #e8f5e9; border-color: #a5d6a7;';
                    break;
                case 'yellow':
                    bannerStyleCSS = 'background-color: #fffde7; border-color: #fff59d;';
                    break;
                case 'red':
                    bannerStyleCSS = 'background-color: #ffebee; border-color: #ef9a9a;';
                    break;
                case 'gray':
                    bannerStyleCSS = 'background-color: #f5f5f5; border-color: #e0e0e0;';
                    break;
            }
            
            // Generate banner HTML based on style
            let bannerPositionCSS = '';
            switch (bannerStyle) {
                case 'top':
                    bannerPositionCSS = 'position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 15px; border-bottom: 1px solid;';
                    break;
                case 'bottom':
                    bannerPositionCSS = 'position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; padding: 15px; border-top: 1px solid;';
                    break;
                case 'popup':
                    bannerPositionCSS = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; padding: 20px; border: 1px solid; border-radius: 5px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 500px;';
                    break;
            }
            
            // Generate consent button based on type
            let consentButton = '';
            if (consentType === 'explicit') {
                consentButton = '<button style="background-color: #0069ff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-left: 10px;">I Accept</button>';
            }
            
            // Generate banner content
            const bannerHTML = `
                <div style="${bannerPositionCSS} ${bannerStyleCSS}">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <strong>Terms of Use Update Notice:</strong> We've updated our Terms of Use effective ${formattedEffectiveDate}. 
                            <a href="${termsUrl}" style="color: #0069ff; text-decoration: underline;">Click here</a> to review the changes.
                            ${consentType === 'implicit' ? 'By continuing to use our site, you accept these changes.' : ''}
                        </div>
                        ${consentButton}
                        ${bannerStyle === 'popup' ? '<button style="background: none; border: none; font-size: 16px; cursor: pointer; margin-left: 10px;">×</button>' : ''}
                    </div>
                </div>
            `;
            
            // Generate email template
            const emailTemplate = `
                <div class="email-preview">
                    <div class="email-header">
                        <strong>From:</strong> ${companyName} &lt;${contactEmail}&gt;<br>
                        <strong>Subject:</strong> Important Update to Our Terms of Use
                    </div>
                    
                    <p>Dear Valued User,</p>
                    
                    <p>We are writing to inform you that we have updated our Terms of Use. These changes will take effect on <strong>${formattedEffectiveDate}</strong>.</p>
                    
                    <p>Here's a summary of the key changes:</p>
                    
                    ${changesList}
                    ${customDetailsHtml}
                    
                    <p>You can review the full updated Terms of Use at: <a href="${termsUrl}">${termsUrl}</a></p>
                    
                    <p>${consentType === 'implicit' ? 'If you continue to use our service after ' + formattedEffectiveDate + ', it will be considered that you have accepted the updated terms.' : 'Please review and accept these terms the next time you use our service.'}</p>
                    
                    <p>If you have any questions or concerns about these changes, please don't hesitate to contact us at <a href="mailto:${contactEmail}">${contactEmail}</a>.</p>
                    
                    <p>Thank you for being a valued user of our service.</p>
                    
                    <p>Sincerely,<br>
                    The ${companyName} Team</p>
                    
                    <div class="email-footer">
                        <p>${companyName}<br>
                        ${websiteUrl}</p>
                    </div>
                </div>
            `;
            
            // Generate preview HTML based on selected notice type
            let previewHTML = '';
            
            if (noticeType === 'both' || noticeType === 'banner') {
                previewHTML += `
                    <h4>Website Banner</h4>
                    <div class="banner-preview">
                        ${bannerHTML}
                    </div>
                `;
            }
            
            if (noticeType === 'both' || noticeType === 'email') {
                previewHTML += `
                    <h4>Email Template</h4>
                    ${emailTemplate}
                `;
            }
            
            if (previewHTML === '') {
                previewHTML = '<p>Please select a notice type to generate the preview.</p>';
            }
            
            // Update the preview content
            document.getElementById('preview-content').innerHTML = previewHTML;
            
            // Remember which field was changed to highlight related content
            if (changedField) {
                highlightChangedContent(changedField);
            }
        }
        
        // Generate final, detailed output
        function generateFinalOutput() {
            // Get form values
            const companyName = document.getElementById('company-name').value;
            const websiteUrl = document.getElementById('website-url').value;
            const effectiveDate = document.getElementById('effective-date').value;
            const formattedEffectiveDate = formatDate(effectiveDate);
            const noticePeriod = document.getElementById('notice-period').value;
            const noticeDate = calculateNoticeDate(effectiveDate, noticePeriod);
            const termsUrl = document.getElementById('terms-url').value;
            const contactEmail = document.getElementById('contact-email').value;
            
            // Get selected changes
            const selectedChanges = [];
            document.querySelectorAll('input[name="change-option"]:checked').forEach(checkbox => {
                selectedChanges.push(checkbox.value);
            });
            
            const customDetails = document.getElementById('custom-details').value;
            
            // Get display options
            const noticeType = document.getElementById('notice-type').value;
            const bannerStyle = document.getElementById('banner-style').value;
            const consentType = document.getElementById('consent-type').value;
            const bannerColor = document.getElementById('banner-color').value;
            
            // Build changes list
            let changesList = '';
            
            if (selectedChanges.includes('privacy-policy')) {
                changesList += '<p class="change-item privacy-policy"><strong>Data Privacy Updates:</strong> We have updated our data privacy policy to comply with recent legislation. This includes changes to the types of information we collect, how we use it, and how you can control your data.</p>';
            }
            
            if (selectedChanges.includes('refund-policy')) {
                changesList += '<p class="change-item refund-policy"><strong>Refund Policy:</strong> We have revised our refund policy to provide more clarity on the circumstances under which refunds will be granted.</p>';
            }
            
            if (selectedChanges.includes('ip-rights')) {
                changesList += '<p class="change-item ip-rights"><strong>Intellectual Property Rights:</strong> We have added new language to protect our intellectual property rights. This includes an explicit prohibition on using our content without permission.</p>';
            }
            
            if (selectedChanges.includes('jurisdiction')) {
                changesList += '<p class="change-item jurisdiction"><strong>Jurisdiction:</strong> We have added language specifying that our terms of use and any disputes arising therefrom will be governed by specific legal jurisdiction.</p>';
            }
            
            if (selectedChanges.includes('service-changes')) {
                changesList += '<p class="change-item service-changes"><strong>Service Features/Functionality:</strong> We have updated our terms to reflect changes to our service features and functionality.</p>';
            }
            
            if (selectedChanges.includes('payment-terms')) {
                changesList += '<p class="change-item payment-terms"><strong>Payment Terms:</strong> We have updated our payment terms and conditions.</p>';
            }
            
            if (selectedChanges.includes('user-content')) {
                changesList += '<p class="change-item user-content"><strong>User Content Rights:</strong> We have updated our terms regarding user-generated content and the rights associated with it.</p>';
            }
            
            // Add custom details if provided
            let customDetailsHtml = '';
            if (customDetails) {
                customDetailsHtml = `<p class="change-item custom-details"><strong>Additional Details:</strong><br>${customDetails.replace(/\n/g, '<br>')}</p>`;
            }
            
            // Banner color styles
            let bannerStyleCSS = '';
            switch (bannerColor) {
                case 'blue':
                    bannerStyleCSS = 'background-color: #e3f2fd; border-color: #90caf9;';
                    break;
                case 'green':
                    bannerStyleCSS = 'background-color: #e8f5e9; border-color: #a5d6a7;';
                    break;
                case 'yellow':
                    bannerStyleCSS = 'background-color: #fffde7; border-color: #fff59d;';
                    break;
                case 'red':
                    bannerStyleCSS = 'background-color: #ffebee; border-color: #ef9a9a;';
                    break;
                case 'gray':
                    bannerStyleCSS = 'background-color: #f5f5f5; border-color: #e0e0e0;';
                    break;
            }
            
            // Generate banner HTML based on style
            let bannerPositionCSS = '';
            switch (bannerStyle) {
                case 'top':
                    bannerPositionCSS = 'position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 15px; border-bottom: 1px solid;';
                    break;
                case 'bottom':
                    bannerPositionCSS = 'position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; padding: 15px; border-top: 1px solid;';
                    break;
                case 'popup':
                    bannerPositionCSS = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; padding: 20px; border: 1px solid; border-radius: 5px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 500px;';
                    break;
            }
            
            // Generate consent button based on type
            let consentButton = '';
            if (consentType === 'explicit') {
                consentButton = '<button onclick="this.parentNode.style.display=\'none\'" style="background-color: #0069ff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-left: 10px;">I Accept</button>';
            }
            
            // Generate banner content
            const bannerHTML = `
                <div style="${bannerPositionCSS} ${bannerStyleCSS}">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <strong>Terms of Use Update Notice:</strong> We've updated our Terms of Use effective ${formattedEffectiveDate}. 
                            <a href="${termsUrl}" style="color: #0069ff; text-decoration: underline;">Click here</a> to review the changes.
                            ${consentType === 'implicit' ? 'By continuing to use our site, you accept these changes.' : ''}
                        </div>
                        ${consentButton}
                        ${bannerStyle === 'popup' ? '<button onclick="this.parentNode.parentNode.style.display=\'none\'" style="background: none; border: none; font-size: 16px; cursor: pointer; margin-left: 10px;">×</button>' : ''}
                    </div>
                </div>
            `;
            
            // Generate email template
            const emailTemplate = `
                <div class="email-preview">
                    <div class="email-header">
                        <strong>From:</strong> ${companyName} &lt;${contactEmail}&gt;<br>
                        <strong>Subject:</strong> Important Update to Our Terms of Use
                    </div>
                    
                    <p>Dear Valued User,</p>
                    
                    <p>We are writing to inform you that we have updated our Terms of Use. These changes will take effect on <strong>${formattedEffectiveDate}</strong>.</p>
                    
                    <p>Here's a summary of the key changes:</p>
                    
                    ${changesList}
                    ${customDetailsHtml}
                    
                    <p>You can review the full updated Terms of Use at: <a href="${termsUrl}">${termsUrl}</a></p>
                    
                    <p>${consentType === 'implicit' ? 'If you continue to use our service after ' + formattedEffectiveDate + ', it will be considered that you have accepted the updated terms.' : 'Please review and accept these terms the next time you use our service.'}</p>
                    
                    <p>If you have any questions or concerns about these changes, please don't hesitate to contact us at <a href="mailto:${contactEmail}">${contactEmail}</a>.</p>
                    
                    <p>Thank you for being a valued user of our service.</p>
                    
                    <p>Sincerely,<br>
                    The ${companyName} Team</p>
                    
                    <div class="email-footer">
                        <p>${companyName}<br>
                        ${websiteUrl}</p>
                    </div>
                </div>
            `;
            
            // Generate HTML output based on selected notice type
            let finalOutput = '';
            
            if (noticeType === 'both' || noticeType === 'banner') {
                finalOutput += `
                    <h2>Website Banner Code</h2>
                    <p>Add this code to your website to display the notice banner:</p>
                    <pre style="background-color: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto;">${bannerHTML.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
                    <div style="margin: 20px 0;">
                        <h3>Banner Preview:</h3>
                        <div class="banner-preview">
                            ${bannerHTML}
                        </div>
                    </div>
                `;
            }
            
            if (noticeType === 'both' || noticeType === 'email') {
                finalOutput += `
                    <h2>Email Notification Template</h2>
                    <p>Use this template for your email notification:</p>
                    <hr>
                    ${emailTemplate}
                    <hr>
                `;
            }
            
            finalOutput += `
                <h2>Implementation Notes</h2>
                <p>1. The banner should be displayed starting on <strong>${noticeDate}</strong> (${noticePeriod} days before the effective date).</p>
                <p>2. Email notifications should be sent at least ${noticePeriod} days before the effective date (by <strong>${noticeDate}</strong>).</p>
                <p>3. For optimal legal protection, consider keeping records of when users were notified and when they accepted the updated terms.</p>
            `;
            
            // Update the preview content
            document.getElementById('preview-content').innerHTML = finalOutput;
        }
        
        // Function to highlight changed content
        function highlightChangedContent(changedField) {
            // Clear existing highlights
            clearHighlights();
            
            // Define elements to highlight based on the changed field
            let elementsToHighlight = [];
            const previewContent = document.getElementById('preview-content');
            
            // Find elements to highlight based on the field that changed
            switch(changedField) {
                case 'company-name':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.email-header, .email-footer p'));
                    break;
                    
                case 'website-url':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.email-footer p'));
                    break;
                    
                case 'effective-date':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.banner-preview strong, .email-preview p:nth-of-type(2) strong'));
                    break;
                    
                case 'terms-url':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.banner-preview a, .email-preview a[href="' + document.getElementById('terms-url').value + '"]'));
                    break;
                    
                case 'contact-email':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.email-header, .email-preview a[href^="mailto"]'));
                    break;
                    
                case 'change-option':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.change-item'));
                    break;
                    
                case 'custom-details':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.change-item.custom-details'));
                    break;
                    
                case 'banner-style':
                case 'banner-color':
                    elementsToHighlight = Array.from(previewContent.querySelectorAll('.banner-preview'));
                    break;
                    
                case 'consent-type':
                    if (document.getElementById('consent-type').value === 'explicit') {
                        elementsToHighlight = Array.from(previewContent.querySelectorAll('.banner-preview button'));
                    } else {
                        elementsToHighlight = Array.from(previewContent.querySelectorAll('.banner-preview div div, .email-preview p:contains(continue to use)'));
                    }
                    break;
            }
            
            // Apply highlights
            elementsToHighlight.forEach(el => {
                if (el) {
                    el.classList.add('highlight');
                    highlightedElements.push(el);
                    
                    // Scroll to the element if not in view
                    const previewBox = document.querySelector('.preview-box');
                    const elRect = el.getBoundingClientRect();
                    const containerRect = previewBox.getBoundingClientRect();
                    
                    if (elRect.top < containerRect.top || elRect.bottom > containerRect.bottom) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            });
            
            // Remove highlights after a delay
            highlightTimeout = setTimeout(() => {
                clearHighlights();
            }, 2000);
        }
        
        // Function to reset the form
        function resetForm() {
            document.getElementById('company-name').value = 'Your Company';
            document.getElementById('website-url').value = 'https://yourcompany.com';
            
            // Reset to a date 30 days in the future
            const futureDate = new Date();
            futureDate.setDate(futureDate.getDate() + 30);
            document.getElementById('effective-date').value = futureDate.toISOString().slice(0, 10);
            
            document.getElementById('notice-period').value = '30';
            document.getElementById('terms-url').value = 'https://yourcompany.com/terms';
            document.getElementById('contact-email').value = 'support@yourcompany.com';
            
            // Reset checkboxes
            document.querySelectorAll('.checkbox-label').forEach(label => {
                const checkbox = label.querySelector('input[type="checkbox"]');
                if (checkbox.value === 'privacy-policy' || 
                    checkbox.value === 'refund-policy' || 
                    checkbox.value === 'ip-rights' || 
                    checkbox.value === 'jurisdiction' || 
                    checkbox.value === 'service-changes') {
                    checkbox.checked = true;
                    label.classList.add('selected');
                } else {
                    checkbox.checked = false;
                    label.classList.remove('selected');
                }
            });
            
            document.getElementById('custom-details').value = '';
            
            if (document.getElementById('notice-type')) {
                document.getElementById('notice-type').value = 'both';
            }
            
            if (document.getElementById('banner-style')) {
                document.getElementById('banner-style').value = 'top';
            }
            
            if (document.getElementById('consent-type')) {
                document.getElementById('consent-type').value = 'explicit';
            }
            
            if (document.getElementById('banner-color')) {
                document.getElementById('banner-color').value = 'blue';
            }
            
            // Clear any highlights
            clearHighlights();
            
            // Update preview
            updatePreview();
            
            // Hide copy message
            document.getElementById('copy-message').style.display = 'none';
        }
        
        // Function to copy to clipboard
        function copyToClipboard() {
            const previewContent = document.getElementById('preview-content');
            
            // Create a temporary textarea to copy from
            const textarea = document.createElement('textarea');
            textarea.value = previewContent.innerText;
            document.body.appendChild(textarea);
            
            // Select and copy
            textarea.select();
            document.execCommand('copy');
            
            // Remove the textarea
            document.body.removeChild(textarea);
            
            // Show copy message
            const copyMessage = document.getElementById('copy-message');
            copyMessage.style.display = 'inline-block';
            
            // Hide message after 3 seconds
            setTimeout(() => {
                copyMessage.style.display = 'none';
            }, 3000);
        }
        
        // Function to download as text
        function downloadText() {
            const previewContent = document.getElementById('preview-content');
            const companyName = document.getElementById('company-name').value;
            const blob = new Blob([previewContent.innerText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `${companyName.replace(/\s+/g, '-').toLowerCase()}-terms-update-notice.txt`;
            document.body.appendChild(a);
            a.click();
            
            // Cleanup
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
    </script>
</body>
</html>
