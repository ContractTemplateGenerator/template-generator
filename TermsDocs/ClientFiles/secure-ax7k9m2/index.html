<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
  <meta name="googlebot" content="noindex, nofollow">
  <title>Story Cannabis MSA - Redline Review | Sergei Tokmakov, Esq.</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #1a2e44;
      --primary-light: #2d4a6f;
      --accent: #8b5cf6;
      --surface: #ffffff;
      --bg: #f5f5f4;
      --border: #d4d4d4;
      --text: #1c1917;
      --text-muted: #57534e;
      --success: #166534;
      --success-bg: #dcfce7;
      --warning: #a16207;
      --warning-bg: #fef3c7;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    /* Confidential Header */
    .confidential-bar {
      background: #292524;
      color: #fafaf9;
      padding: 10px 20px;
      font-size: 0.75rem;
      text-align: center;
      letter-spacing: 0.5px;
    }

    /* Security Notice */
    .security-notice {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border-bottom: 1px solid #a7f3d0;
      padding: 14px 40px;
    }

    .security-notice-inner {
      max-width: 1100px;
      margin: 0 auto;
      font-size: 0.85rem;
      color: #065f46;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .security-notice-inner strong {
      white-space: nowrap;
    }

    .shield-icon {
      font-size: 1.2rem;
    }

    /* Letterhead */
    .letterhead {
      background: var(--primary);
      color: white;
      padding: 28px 40px;
    }

    .letterhead-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
    }

    .letterhead h1 {
      font-family: 'Crimson Pro', Georgia, serif;
      font-size: 1.4rem;
      font-weight: 500;
      letter-spacing: 0.3px;
      margin-bottom: 4px;
    }

    .letterhead .subtitle {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .letterhead-date {
      text-align: right;
      font-size: 0.8rem;
      opacity: 0.9;
    }

    /* Main Container */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 40px;
    }

    /* Matter Header */
    .matter-header {
      margin-bottom: 36px;
      padding-bottom: 24px;
      border-bottom: 1px solid var(--border);
    }

    .matter-header h2 {
      font-family: 'Crimson Pro', Georgia, serif;
      font-size: 1.8rem;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 8px;
    }

    .matter-meta {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    /* Overview Box */
    .overview-box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 24px 28px;
      margin-bottom: 32px;
    }

    .overview-box h3 {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .overview-box p {
      font-size: 0.95rem;
      line-height: 1.7;
      color: var(--text);
    }

    .overview-stats {
      display: flex;
      gap: 40px;
      margin-top: 20px;
      padding-top: 16px;
      border-top: 1px solid #e7e5e4;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 600;
      color: var(--primary);
    }

    .stat-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
    }

    /* Document Cards */
    .docs-section h3 {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .doc-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 16px;
      overflow: hidden;
    }

    .doc-card-header {
      padding: 20px 24px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.15s;
    }

    .doc-card-header:hover {
      background: #fafaf9;
    }

    .doc-title-area {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .doc-number {
      width: 32px;
      height: 32px;
      background: var(--primary);
      color: white;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .doc-title h4 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 2px;
    }

    .doc-title .doc-subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .doc-header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .expand-hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-style: italic;
    }

    .doc-card.expanded .expand-hint {
      display: none;
    }

    .redline-count {
      font-size: 0.75rem;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 12px;
      background: var(--warning-bg);
      color: var(--warning);
    }

    .expand-icon {
      color: var(--text-muted);
      font-size: 1.2rem;
      transition: transform 0.2s;
    }

    .doc-card.expanded .expand-icon {
      transform: rotate(180deg);
    }

    .doc-card-body {
      display: none;
      padding: 0 24px 24px 24px;
      border-top: 1px solid #e7e5e4;
    }

    .doc-card.expanded .doc-card-body {
      display: block;
    }

    /* Changes List */
    .changes-section {
      padding: 20px 0;
    }

    .changes-section h5 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .change-item {
      padding: 10px 0;
      border-bottom: 1px solid #f5f5f4;
      font-size: 0.9rem;
    }

    .change-item:last-child {
      border-bottom: none;
    }

    .change-item strong {
      color: var(--primary);
    }

    .change-item .note {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 4px;
      font-style: italic;
    }

    /* Rationale */
    .rationale-section {
      background: #fafaf9;
      border-radius: 6px;
      padding: 16px 20px;
      margin: 16px 0;
    }

    .rationale-section h5 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .rationale-section p {
      font-size: 0.9rem;
      line-height: 1.6;
    }

    /* Actions */
    .doc-actions {
      display: flex;
      gap: 10px;
      padding-top: 16px;
      border-top: 1px solid #e7e5e4;
    }

    .btn {
      padding: 10px 16px;
      font-size: 0.85rem;
      font-weight: 500;
      border-radius: 6px;
      cursor: pointer;
      border: none;
      transition: all 0.15s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-light);
    }

    .btn-secondary {
      background: white;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .btn-secondary:hover {
      background: #fafaf9;
    }

    /* Footer */
    .footer {
      margin-top: 48px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .footer a {
      color: var(--primary);
      text-decoration: none;
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .toolbar-left, .toolbar-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .btn-sm {
      padding: 8px 14px;
      font-size: 0.8rem;
    }

    /* Feedback elements */
    .feedback-section {
      margin-top: 20px;
      padding-top: 16px;
      border-top: 1px solid #e7e5e4;
    }

    .feedback-section h5 {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .feedback-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      padding: 12px 0;
      border-bottom: 1px solid #f5f5f4;
    }

    .feedback-item:last-child {
      border-bottom: none;
    }

    .feedback-select {
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.8rem;
      min-width: 120px;
      cursor: pointer;
      background: white;
    }

    .feedback-select.status-approved {
      background: #dcfce7;
      border-color: #86efac;
      color: #166534;
    }

    .feedback-select.status-declined {
      background: #fee2e2;
      border-color: #fca5a5;
      color: #991b1b;
    }

    .feedback-select.status-discuss {
      background: #fef3c7;
      border-color: #fcd34d;
      color: #92400e;
    }

    .feedback-label {
      flex: 1;
      font-size: 0.85rem;
      color: var(--text);
    }

    .feedback-note {
      width: 100%;
      margin-top: 12px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 0.85rem;
      font-family: inherit;
      resize: vertical;
      min-height: 60px;
    }

    .feedback-note:focus {
      outline: none;
      border-color: var(--accent);
    }

    .feedback-note::placeholder {
      color: #a8a29e;
    }

    .save-bar {
      position: sticky;
      bottom: 0;
      background: white;
      border-top: 1px solid var(--border);
      padding: 12px 40px;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
    }

    .btn-save {
      background: var(--accent);
      color: white;
    }

    .btn-save:hover {
      background: #7c3aed;
    }

    /* Issue Summary Table */
    .issues-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      margin-top: 20px;
    }

    .issues-table th {
      text-align: left;
      padding: 10px 12px;
      background: #f5f5f4;
      font-weight: 600;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      color: var(--text-muted);
      border-bottom: 1px solid var(--border);
    }

    .issues-table td {
      padding: 12px;
      border-bottom: 1px solid #e7e5e4;
      vertical-align: top;
    }

    .issues-table tr:last-child td {
      border-bottom: none;
    }

    .check {
      color: var(--success);
      font-weight: 600;
    }

    .dash {
      color: #d4d4d4;
    }
  </style>
</head>
<body>

<div class="confidential-bar">
  üîí PRIVILEGED & CONFIDENTIAL ‚Äî ATTORNEY WORK PRODUCT
</div>

<div class="security-notice">
  <div class="security-notice-inner">
    <span class="shield-icon">üõ°Ô∏è</span>
    <div><strong>Secure Client Workroom</strong> ‚Äî This page is not indexed by search engines and cannot be found through browsing. Only those with the direct link can access it. Documents and communications here are protected by attorney-client privilege.</div>
  </div>
</div>

<header class="letterhead">
  <div class="letterhead-inner">
    <div>
      <h1>Sergei Tokmakov, Esq.</h1>
      <a href="https://apps.calbar.ca.gov/attorney/Licensee/Detail/279869" target="_blank" style="font-size:0.75rem;opacity:0.7;margin-top:2px;color:white;text-decoration:none;">California Bar #279869</a>
    </div>
    <div class="letterhead-date">
      December 15, 2025<br>
      <span style="opacity:0.7">NR-7f9x2k</span>
    </div>
  </div>
</header>

<div class="container">

  <div class="matter-header">
    <h2>Story Cannabis MSA ‚Äî Proposed Redlines</h2>
    <div class="matter-meta">
      Salve Consulting LLC ‚Üí Story Cannabis | Master Services Agreement Package (Effective 1/1/26)
    </div>
  </div>

  <div class="overview-box">
    <h3>Summary</h3>
    <p>
      The attached documents contain our proposed revisions to the Story Cannabis MSA package. The redlines fall into a few main categories: (1) clarifying payment terms and invoice timing to align cash flow with actual service delivery, (2) adding third-party integration risk allocation language‚Äîcritical given the heavy reliance on systems like Dutchie, Treez, Springbig that we don't control, (3) tightening up SLA response times and carving out appropriate exclusions, and (4) various cleanup items where the original drafts had inconsistent references or missing definitions.
    </p>
    <p style="margin-top:12px;">
      Each document below expands to show specific changes and the thinking behind them. The redlined Word files are available for download‚Äîthey're formatted as proper Track Changes so Story's counsel can review in the usual way.
    </p>
    <div class="overview-stats">
      <div class="stat">
        <div class="stat-number">4</div>
        <div class="stat-label">Documents</div>
      </div>
      <div class="stat">
        <div class="stat-number">20</div>
        <div class="stat-label">Total Redlines</div>
      </div>
    </div>
  </div>

  <!-- Issues at a Glance -->
  <div class="overview-box">
    <h3>Issues at a Glance</h3>
    <table class="issues-table">
      <thead>
        <tr>
          <th style="width:40%">Issue</th>
          <th>SLA</th>
          <th>iPaaS</th>
          <th>PM</th>
          <th>DW</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <strong>Payment/Invoicing Structure</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Setup fees at kick-off, monthly fees upon go-live, Net 30 with grace period, overage pricing</span>
          </td>
          <td class="dash">‚Äî</td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
        </tr>
        <tr>
          <td>
            <strong>Third-Party Risk Exclusions</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Carve-outs for Dutchie/Treez/Springbig outages, API changes, rate limits, credential expirations</span>
          </td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
          <td class="dash">‚Äî</td>
          <td class="dash">‚Äî</td>
        </tr>
        <tr>
          <td>
            <strong>Response Time / SLA Adjustments</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Faster Sev 2 response (8hr‚Üí1hr), realistic Sev 3-4 windows, scope limitation clause</span>
          </td>
          <td class="check">‚úì</td>
          <td class="dash">‚Äî</td>
          <td class="dash">‚Äî</td>
          <td class="dash">‚Äî</td>
        </tr>
        <tr>
          <td>
            <strong>IP & Licensing Terms</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Work product ownership, perpetual license grant, third-party component acknowledgments</span>
          </td>
          <td class="dash">‚Äî</td>
          <td class="check">‚úì</td>
          <td class="dash">‚Äî</td>
          <td class="dash">‚Äî</td>
        </tr>
        <tr>
          <td>
            <strong>Suspension/Non-Payment Rights</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Provider can pause services after 45 days non-payment with 5-day notice</span>
          </td>
          <td class="dash">‚Äî</td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
        </tr>
        <tr>
          <td>
            <strong>Effective Date / Reference Fixes</strong><br>
            <span style="color:var(--text-muted);font-size:0.8rem;">Consistent nomenclature, corrected cross-references, added Exhibit D definition</span>
          </td>
          <td class="dash">‚Äî</td>
          <td class="check">‚úì</td>
          <td class="check">‚úì</td>
          <td class="dash">‚Äî</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="docs-section">
    <div class="toolbar">
      <h3 style="margin:0;">Documents</h3>
      <div class="toolbar-right">
        <button class="btn btn-secondary btn-sm" onclick="expandAll()">Expand All</button>
        <button class="btn btn-secondary btn-sm" onclick="collapseAll()">Collapse All</button>
        <button class="btn btn-primary btn-sm" onclick="downloadAll()">‚Üì Download All</button>
      </div>
    </div>

    <!-- SLA -->
    <div class="doc-card" id="doc-sla">
      <div class="doc-card-header" onclick="toggleCard('doc-sla')">
        <div class="doc-title-area">
          <div class="doc-number">1</div>
          <div class="doc-title">
            <h4>Service Level Agreement</h4>
            <div class="doc-subtitle">SALVE-STORY SLA (1.01.26)</div>
          </div>
        </div>
        <div class="doc-header-right">
          <span class="expand-hint">click to see details & rationale</span>
          <span class="redline-count">6 redlines</span>
          <span class="expand-icon">‚ñº</span>
        </div>
      </div>
      <div class="doc-card-body">
        <div class="changes-section">
          <h5>What Changed</h5>
          <div class="change-item">
            <strong>Response Time Adjustments (Severity Levels 2-4)</strong> ‚Äî Tightened the response windows. Sev 2 goes from 8 hours down to 1 hour during business hours. Sev 3 and 4 extended slightly (1‚Üí3 days, 2‚Üí5 days) to be more realistic for lower-priority issues.
          </div>
          <div class="change-item">
            <strong>Scope Limitation Clause (new item e)</strong> ‚Äî Added language clarifying Provider makes no guarantees for inquiries outside defined scope. Customer is responsible for monitoring their own external matters.
            <div class="note">This one is important‚Äîprevents scope creep into areas we're not being paid to support.</div>
          </div>
          <div class="change-item">
            <strong>Third-Party Integration Exclusions (items m-r)</strong> ‚Äî New exclusion items after Force Majeure covering API outages, rate limiting, credential issues, and third-party policy changes for systems like Dutchie, Treez, etc.
          </div>
          <div class="change-item">
            <strong>AI Agent Disclaimer</strong> ‚Äî Added disclaimer that AI Agent support is "as-is" and doesn't constitute formal support tickets or trigger SLA commitments.
          </div>
        </div>

        <div class="rationale-section">
          <h5>Why These Matter</h5>
          <p>
            The third-party exclusions are non-negotiable from our perspective. When Dutchie's API goes down at 2am, that's not something we can control or fix‚Äîand we shouldn't be on the hook for SLA credits because of it. The response time adjustments balance faster response for critical issues against realistic timelines for routine matters. The AI disclaimer is prophylactic; we don't want someone arguing that chatting with the AI agent counts as "opening a ticket."
          </p>
        </div>

        <div class="doc-actions">
          <a href="SALVE-STORY%20SLA%20(1.01.26)%20-%20REDLINED.docx" class="btn btn-primary" download>
            Download Redlined Version
          </a>
        </div>

        <div class="feedback-section">
          <h5>Notes</h5>
          <textarea class="feedback-note" data-item="sla" placeholder="Questions or comments on SLA redlines..."></textarea>
        </div>
      </div>
    </div>

    <!-- iPaaS SOW -->
    <div class="doc-card" id="doc-ipaas">
      <div class="doc-card-header" onclick="toggleCard('doc-ipaas')">
        <div class="doc-title-area">
          <div class="doc-number">2</div>
          <div class="doc-title">
            <h4>iPaaS Statement of Work</h4>
            <div class="doc-subtitle">Exhibit C-5 ‚Äî Integration Platform Services</div>
          </div>
        </div>
        <div class="doc-header-right">
          <span class="expand-hint">click to see details & rationale</span>
          <span class="redline-count">10 redlines</span>
          <span class="expand-icon">‚ñº</span>
        </div>
      </div>
      <div class="doc-card-body">
        <div class="changes-section">
          <h5>What Changed</h5>
          <div class="change-item">
            <strong>Payment Terms Restructure</strong> ‚Äî Complete rewrite of Section 6.4. Setup fees now invoiced at kick-off (due before production deployment). Monthly fees commence when integration goes live, prorated for mid-month starts. Added event volume caps (100M/month) with overage pricing.
          </div>
          <div class="change-item">
            <strong>Third-Party Integration Dependencies (new Section 6.5)</strong> ‚Äî Four subsections covering: nature of dependencies, excluded events, Provider obligations during outages, and automatic timeline extensions.
            <div class="note">This is the heart of our risk allocation for iPaaS work.</div>
          </div>
          <div class="change-item">
            <strong>Change Management Process (new Section 8)</strong> ‚Äî Formal CO process: written request ‚Üí 5-day impact assessment ‚Üí 5-day customer response ‚Üí signed CO required. No work outside scope without executed CO.
          </div>
          <div class="change-item">
            <strong>IP & License Terms (Section 7)</strong> ‚Äî Fleshed out the bare-bones IP section with work product ownership, third-party component acknowledgments, customer data rights, and reservation of rights.
          </div>
          <div class="change-item">
            <strong>Exhibit D Definition & References</strong> ‚Äî Added definition for "Exhibit D: 2026 Technical Roadmap" and fixed broken reference in Section 3.2.3 that pointed to wrong section.
          </div>
          <div class="change-item">
            <strong>PM Services Clarification</strong> ‚Äî Explicit statement that project management is separate (Exhibit C-6) and not included in iPaaS fees.
          </div>
          <div class="change-item">
            <strong>Suspension Rights</strong> ‚Äî Provider can suspend after 45 days non-payment with 5 business days notice. Covers active integrations, deliverables, platform access, and new work.
          </div>
          <div class="change-item">
            <strong>Cleanup</strong> ‚Äî Fixed "any other C-5 SOW" ‚Üí "any other SOW" and "Effective Date" ‚Üí "C-5 SOW Effective Date" for clarity.
          </div>
        </div>

        <div class="rationale-section">
          <h5>Why These Matter</h5>
          <p>
            This SOW has the most redlines because it's also the most complex engagement. The payment restructure aligns cash flow with delivery milestones rather than back-loading everything. The third-party dependencies section is critical‚Äîwe're building integrations with systems we don't own, and when Treez changes their API schema without warning, that's not our breach. The change management process protects both sides from scope creep and the "oh, we assumed that was included" conversations.
          </p>
        </div>

        <div class="doc-actions">
          <a href="SALVE-STORY%20iPAAS%20SOW%20(01.01.26)%20-%20REDLINED.docx" class="btn btn-primary" download>
            Download Redlined Version
          </a>
        </div>

        <div class="feedback-section">
          <h5>Notes</h5>
          <textarea class="feedback-note" data-item="ipaas" placeholder="Questions or comments on iPaaS SOW redlines..."></textarea>
        </div>
      </div>
    </div>

    <!-- PM SOW -->
    <div class="doc-card" id="doc-pm">
      <div class="doc-card-header" onclick="toggleCard('doc-pm')">
        <div class="doc-title-area">
          <div class="doc-number">3</div>
          <div class="doc-title">
            <h4>Project Management SOW</h4>
            <div class="doc-subtitle">Exhibit C-6 ‚Äî PM Services for iPaaS Implementation</div>
          </div>
        </div>
        <div class="doc-header-right">
          <span class="expand-hint">click to see details & rationale</span>
          <span class="redline-count">5 redlines</span>
          <span class="expand-icon">‚ñº</span>
        </div>
      </div>
      <div class="doc-card-body">
        <div class="changes-section">
          <h5>What Changed</h5>
          <div class="change-item">
            <strong>Payment Terms</strong> ‚Äî Aligned with same structure as iPaaS SOW (setup at kick-off, monthly upon commencement, Net 30 with 15-day grace).
          </div>
          <div class="change-item">
            <strong>Cross-Reference to Change Management</strong> ‚Äî Added reference to C-5 SOW Section 8 for change order process.
          </div>
          <div class="change-item">
            <strong>Relationship Clarification</strong> ‚Äî This SOW supports C-5 iPaaS implementation; made that explicit.
          </div>
          <div class="change-item">
            <strong>Effective Date Fix</strong> ‚Äî Same nomenclature cleanup as iPaaS.
          </div>
          <div class="change-item">
            <strong>Suspension Language</strong> ‚Äî Mirror of iPaaS suspension rights for non-payment.
          </div>
        </div>

        <div class="rationale-section">
          <h5>Why These Matter</h5>
          <p>
            Mostly harmonization‚Äîwe want the PM SOW and iPaaS SOW to work together seamlessly. Same payment terms, same suspension rights, clear relationship between the two. The change management cross-reference avoids having to duplicate that whole section here.
          </p>
        </div>

        <div class="doc-actions">
          <a href="SALVE-STORY%20PM%20SOW%20(01.01.26)%20-%20REDLINED.docx" class="btn btn-primary" download>
            Download Redlined Version
          </a>
        </div>

        <div class="feedback-section">
          <h5>Notes</h5>
          <textarea class="feedback-note" data-item="pm" placeholder="Questions or comments on PM SOW redlines..."></textarea>
        </div>
      </div>
    </div>

    <!-- DW SOW -->
    <div class="doc-card" id="doc-dw">
      <div class="doc-card-header" onclick="toggleCard('doc-dw')">
        <div class="doc-title-area">
          <div class="doc-number">4</div>
          <div class="doc-title">
            <h4>Data Warehouse SOW</h4>
            <div class="doc-subtitle">Exhibit C-4 ‚Äî Analytics & Reporting Services</div>
          </div>
        </div>
        <div class="doc-header-right">
          <span class="expand-hint">click to see details & rationale</span>
          <span class="redline-count">3 redlines</span>
          <span class="expand-icon">‚ñº</span>
        </div>
      </div>
      <div class="doc-card-body">
        <div class="changes-section">
          <h5>What Changed</h5>
          <div class="change-item">
            <strong>Payment Terms</strong> ‚Äî Same alignment as other SOWs. Setup invoiced at kick-off, monthly upon go-live.
          </div>
          <div class="change-item">
            <strong>Suspension Rights</strong> ‚Äî Added ability to suspend services and withhold deliverables for non-payment after 45 days.
          </div>
          <div class="change-item">
            <strong>Monthly Fee Commencement</strong> ‚Äî Clarified that ongoing fees start when DW environment is actively receiving production data.
          </div>
        </div>

        <div class="rationale-section">
          <h5>Why These Matter</h5>
          <p>
            The DW SOW was relatively clean to begin with. Main additions are consistency with the payment/suspension terms across all SOWs. We want a single, predictable framework for how invoicing and non-payment situations work across the entire engagement.
          </p>
        </div>

        <div class="doc-actions">
          <a href="SALVE-STORY%20DW%20SOW%20(1.01.26)%20-%20REDLINED.docx" class="btn btn-primary" download>
            Download Redlined Version
          </a>
        </div>

        <div class="feedback-section">
          <h5>Notes</h5>
          <textarea class="feedback-note" data-item="dw" placeholder="Questions or comments on DW SOW redlines..."></textarea>
        </div>
      </div>
    </div>

  </div>

</div>


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCeACvK3MVTOOaWY4SWG1yNnrcA9ILkkaM",
  authDomain: "termsdocs.firebaseapp.com",
  databaseURL: "https://termsdocs-default-rtdb.firebaseio.com",
  projectId: "termsdocs",
  storageBucket: "termsdocs.firebasestorage.app",
  messagingSenderId: "62791617178",
  appId: "1:62791617178:web:ff79f24f40cc98e88aed23"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const workroomRef = db.ref('workrooms/NR-7f9x2k');

function toggleCard(id) {
  const card = document.getElementById(id);
  card.classList.toggle('expanded');
}

function expandAll() {
  document.querySelectorAll('.doc-card').forEach(card => card.classList.add('expanded'));
}

function collapseAll() {
  document.querySelectorAll('.doc-card').forEach(card => card.classList.remove('expanded'));
}

function downloadAll() {
  const files = [
    'SALVE-STORY%20SLA%20(1.01.26)%20-%20REDLINED.docx',
    'SALVE-STORY%20iPAAS%20SOW%20(01.01.26)%20-%20REDLINED.docx',
    'SALVE-STORY%20PM%20SOW%20(01.01.26)%20-%20REDLINED.docx',
    'SALVE-STORY%20DW%20SOW%20(1.01.26)%20-%20REDLINED.docx'
  ];
  files.forEach((file, i) => {
    setTimeout(() => {
      const a = document.createElement('a');
      a.href = file;
      a.download = decodeURIComponent(file);
      a.click();
    }, i * 500);
  });
}

// Save feedback to Firebase
function saveFeedback() {
  const data = {
    selections: {},
    notes: {},
    lastUpdated: new Date().toISOString()
  };

  document.querySelectorAll('.feedback-select').forEach(sel => {
    if (sel.value) data.selections[sel.dataset.item] = sel.value;
  });
  document.querySelectorAll('.feedback-note').forEach(note => {
    if (note.value.trim()) data.notes[note.dataset.item] = note.value;
  });

  workroomRef.child('feedback').set(data)
    .then(() => showSaveConfirm())
    .catch(err => {
      console.error('Save failed:', err);
      alert('Save failed. Check console for details.');
    });
}

// Load feedback from Firebase (real-time listener)
function setupRealtimeSync() {
  workroomRef.child('feedback').on('value', (snapshot) => {
    const data = snapshot.val();
    if (!data) return;

    // Update selections
    if (data.selections) {
      document.querySelectorAll('.feedback-select').forEach(sel => {
        if (data.selections[sel.dataset.item]) {
          sel.value = data.selections[sel.dataset.item];
        } else {
          sel.value = '';
        }
        updateSelectStyle(sel);
      });
    }

    // Update notes
    if (data.notes) {
      document.querySelectorAll('.feedback-note').forEach(note => {
        if (data.notes[note.dataset.item]) {
          note.value = data.notes[note.dataset.item];
        }
      });
    }

    // Show last updated
    if (data.lastUpdated) {
      updateLastSaved(data.lastUpdated);
    }
  });
}

function updateSelectStyle(sel) {
  sel.classList.remove('status-approved', 'status-declined', 'status-discuss');
  if (sel.value === 'approved') sel.classList.add('status-approved');
  if (sel.value === 'declined') sel.classList.add('status-declined');
  if (sel.value === 'discuss') sel.classList.add('status-discuss');
}

function showSaveConfirm() {
  const btn = document.getElementById('saveBtn');
  const orig = btn.textContent;
  btn.textContent = 'Saved ‚úì';
  btn.style.background = '#166534';
  setTimeout(() => {
    btn.textContent = orig;
    btn.style.background = '';
  }, 1500);
}

function updateLastSaved(isoDate) {
  const date = new Date(isoDate);
  const formatted = date.toLocaleString('en-US', {
    month: 'short', day: 'numeric',
    hour: 'numeric', minute: '2-digit',
    hour12: true
  });
  const indicator = document.getElementById('lastSaved');
  if (indicator) indicator.textContent = 'Last saved: ' + formatted;
}

document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('doc-sla').classList.add('expanded');
  setupRealtimeSync();

  document.querySelectorAll('.feedback-select').forEach(sel => {
    sel.addEventListener('change', function() {
      updateSelectStyle(this);
    });
  });
});
</script>

</body>
</html>
