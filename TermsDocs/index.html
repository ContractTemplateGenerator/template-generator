<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TermsDocs | Attorney-Drafted Legal Documents</title>
  <meta name="description" content="Attorney-drafted documents you customize yourself. Document generators, compliance calendar, e-signatures, and live collaboration.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --color-primary: #6366f1;
      --color-primary-dark: #4f46e5;
      --color-success: #10b981;
      --color-warning: #f59e0b;
      --color-danger: #ef4444;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-text: #1e293b;
      --color-text-secondary: #64748b;
      --color-text-muted: #94a3b8;
      --sidebar-width: 260px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
    }

    /* Layout */
    .app-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--color-text);
      color: white;
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      z-index: 100;
      transition: width 0.2s ease;
    }

    .sidebar.collapsed {
      width: 60px;
    }

    .sidebar.collapsed .nav-section-title,
    .sidebar.collapsed .nav-item span:not(.icon),
    .sidebar.collapsed .nav-item .badge,
    .sidebar.collapsed .user-info > div:last-child,
    .sidebar.collapsed .logo span:last-child {
      display: none;
    }

    .sidebar.collapsed .nav-item {
      justify-content: center;
      padding: 14px;
    }

    .sidebar.collapsed .sidebar-header {
      justify-content: center;
    }

    .sidebar.collapsed .user-info {
      justify-content: center;
    }

    .sidebar-toggle {
      position: absolute;
      right: -12px;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      background: var(--color-primary);
      border: none;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      z-index: 101;
      box-shadow: var(--shadow-md);
    }

    .sidebar-toggle:hover {
      background: var(--color-primary-dark);
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .logo {
      font-size: 22px;
      font-weight: 800;
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo span { color: var(--color-primary); }

    .sidebar-nav {
      flex: 1;
      padding: 16px 0;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 24px;
    }

    .nav-section-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: rgba(255,255,255,0.4);
      padding: 0 20px;
      margin-bottom: 8px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: rgba(255,255,255,0.7);
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      cursor: pointer;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
    }

    .nav-item:hover {
      background: rgba(255,255,255,0.1);
      color: white;
    }

    .nav-item.active {
      background: var(--color-primary);
      color: white;
    }

    .nav-item .icon {
      font-size: 18px;
      width: 24px;
      text-align: center;
    }

    .nav-item .badge {
      margin-left: auto;
      background: var(--color-danger);
      color: white;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 10px;
    }

    .sidebar-footer {
      padding: 16px 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--color-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }

    .user-name {
      font-size: 14px;
      font-weight: 500;
    }

    .user-email {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      min-height: 100vh;
      transition: margin-left 0.2s ease;
    }

    .sidebar.collapsed + .main-content,
    body.sidebar-collapsed .main-content {
      margin-left: 60px;
    }

    .content-header {
      background: var(--color-surface);
      border-bottom: 1px solid var(--color-border);
      padding: 20px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .page-title {
      font-size: 24px;
      font-weight: 700;
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: none;
    }

    .btn-primary {
      background: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--color-primary-dark);
    }

    .btn-secondary {
      background: var(--color-surface);
      color: var(--color-text);
      border: 1px solid var(--color-border);
    }

    .btn-secondary:hover {
      background: var(--color-bg);
    }

    .btn-success {
      background: var(--color-success);
      color: white;
    }

    .content-body {
      padding: 32px;
    }

    /* Tab Content */
    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Dashboard Cards */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--color-surface);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid var(--color-border);
    }

    .stat-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .stat-icon.purple { background: #ede9fe; }
    .stat-icon.blue { background: #dbeafe; }
    .stat-icon.green { background: #d1fae5; }
    .stat-icon.orange { background: #ffedd5; }

    .stat-value {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 14px;
      color: var(--color-text-secondary);
    }

    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    .action-card {
      background: var(--color-surface);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid var(--color-border);
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      color: inherit;
    }

    .action-card:hover {
      border-color: var(--color-primary);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
      transform: translateY(-2px);
    }

    .action-icon {
      font-size: 28px;
      margin-bottom: 12px;
    }

    .action-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .action-desc {
      font-size: 13px;
      color: var(--color-text-secondary);
    }

    /* Recent Documents */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
    }

    .doc-list {
      background: var(--color-surface);
      border-radius: 12px;
      border: 1px solid var(--color-border);
      overflow: hidden;
    }

    .doc-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 20px;
      border-bottom: 1px solid var(--color-border);
      transition: background 0.2s;
      cursor: pointer;
    }

    .doc-item:last-child {
      border-bottom: none;
    }

    .doc-item:hover {
      background: var(--color-bg);
    }

    .doc-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      background: #f1f5f9;
    }

    .doc-info {
      flex: 1;
    }

    .doc-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .doc-meta {
      font-size: 12px;
      color: var(--color-text-muted);
    }

    .doc-status {
      font-size: 12px;
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: 500;
    }

    .doc-status.draft { background: #fef3c7; color: #92400e; }
    .doc-status.pending { background: #dbeafe; color: #1e40af; }
    .doc-status.signed { background: #d1fae5; color: #065f46; }

    /* Compliance Dashboard */
    .compliance-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }

    @media (max-width: 1200px) {
      .compliance-grid {
        grid-template-columns: 1fr;
      }
    }

    .entity-card {
      background: var(--color-surface);
      border-radius: 12px;
      border: 1px solid var(--color-border);
      overflow: hidden;
    }

    .entity-header {
      padding: 20px;
      border-bottom: 1px solid var(--color-border);
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .entity-icon {
      width: 48px;
      height: 48px;
      border-radius: 10px;
      background: var(--color-primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .entity-name {
      font-size: 18px;
      font-weight: 700;
    }

    .entity-type {
      font-size: 13px;
      color: var(--color-text-secondary);
    }

    .entity-body {
      padding: 20px;
    }

    .deadline-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid var(--color-border);
    }

    .deadline-item:last-child {
      border-bottom: none;
    }

    .deadline-icon {
      font-size: 18px;
      margin-top: 2px;
    }

    .deadline-info {
      flex: 1;
    }

    .deadline-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .deadline-date {
      font-size: 13px;
      color: var(--color-text-secondary);
    }

    .deadline-fee {
      font-size: 14px;
      font-weight: 600;
    }

    .deadline-urgent {
      color: var(--color-danger);
    }

    .cost-summary {
      margin-top: 16px;
      padding: 16px;
      background: var(--color-bg);
      border-radius: 8px;
    }

    .cost-row {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      padding: 4px 0;
    }

    .cost-row.total {
      font-weight: 700;
      border-top: 1px solid var(--color-border);
      margin-top: 8px;
      padding-top: 12px;
    }

    /* Entity Comparison */
    .comparison-table {
      background: var(--color-surface);
      border-radius: 12px;
      border: 1px solid var(--color-border);
      overflow: hidden;
    }

    .comparison-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .comparison-table th,
    .comparison-table td {
      padding: 14px 16px;
      text-align: left;
      border-bottom: 1px solid var(--color-border);
    }

    .comparison-table th {
      background: var(--color-bg);
      font-size: 13px;
      font-weight: 600;
      color: var(--color-text-secondary);
    }

    .comparison-table td {
      font-size: 14px;
    }

    .comparison-table tr:last-child td {
      border-bottom: none;
    }

    .comparison-table .highlight {
      background: #f0fdf4;
      font-weight: 600;
    }

    /* Document Workspace */
    .workspace-container {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 16px;
      height: calc(100vh - 140px);
    }

    .generator-panel:not(.collapsed) {
      width: 220px;
      min-width: 220px;
    }

    .generator-panel {
      background: var(--color-surface);
      border-radius: 12px;
      border: 1px solid var(--color-border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transition: width 0.2s ease, min-width 0.2s ease;
      position: relative;
    }

    .generator-panel.collapsed {
      width: 50px !important;
      min-width: 50px !important;
    }

    .generator-panel.collapsed .panel-header span,
    .generator-panel.collapsed .generator-search,
    .generator-panel.collapsed .generator-item .name {
      display: none;
    }

    .generator-panel.collapsed .panel-header {
      padding: 16px 8px;
      justify-content: center;
    }

    .generator-panel.collapsed .generator-item {
      justify-content: center;
      padding: 12px 8px;
    }

    .generator-panel.collapsed .generator-item .icon {
      margin: 0;
    }

    .panel-collapse-btn {
      position: absolute;
      right: -12px;
      top: 16px;
      width: 24px;
      height: 24px;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      z-index: 10;
      box-shadow: var(--shadow-sm);
    }

    .panel-collapse-btn:hover {
      background: var(--color-bg);
    }

    .panel-header {
      padding: 16px;
      border-bottom: 1px solid var(--color-border);
      font-weight: 600;
    }

    .generator-search {
      padding: 12px 16px;
      border-bottom: 1px solid var(--color-border);
    }

    .generator-search input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 14px;
    }

    .generator-list {
      flex: 1;
      overflow-y: auto;
      padding: 8px;
    }

    .generator-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .generator-item:hover {
      background: var(--color-bg);
    }

    .generator-item.active {
      background: #ede9fe;
    }

    .generator-item.view-all {
      border-top: 1px solid var(--color-border);
      margin-top: 8px;
      padding-top: 16px;
      color: var(--color-primary);
    }

    .generator-item.view-all:hover {
      background: #ede9fe;
    }

    /* Generator iframe embed */
    .editor-embed {
      flex: 1;
      border: none;
      width: 100%;
      height: 100%;
    }

    .editor-content.with-iframe {
      padding: 0;
      display: flex;
    }

    .editor-content.with-iframe textarea {
      display: none;
    }

    /* Generator loaded indicator */
    .generator-loaded-bar {
      padding: 6px 12px;
      background: #f0fdf4;
      border-bottom: 1px solid #bbf7d0;
      font-size: 12px;
      color: #166534;
      display: none;
      justify-content: space-between;
      align-items: center;
    }

    .generator-loaded-bar.visible {
      display: flex;
    }

    .generator-loaded-bar .width-hint {
      font-size: 11px;
      color: #15803d;
      opacity: 0.8;
      margin-left: auto;
      margin-right: 12px;
    }

    /* Hide toolbar when generator is loaded */
    .doc-editor.has-generator .editor-toolbar {
      display: none;
    }

    .generator-loaded-bar button {
      background: none;
      border: none;
      color: #166534;
      font-size: 12px;
      cursor: pointer;
      text-decoration: underline;
    }

    /* Signature style toggle buttons */
    .sig-style-btn.active {
      background: var(--color-primary);
      color: white;
      border-color: var(--color-primary);
    }

    .generator-item .icon {
      font-size: 20px;
    }

    .generator-item .name {
      font-size: 14px;
      font-weight: 500;
    }

    .doc-editor {
      background: var(--color-surface);
      border-radius: 12px;
      border: 1px solid var(--color-border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .editor-toolbar {
      padding: 12px 16px;
      border-bottom: 1px solid var(--color-border);
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .toolbar-btn {
      padding: 8px 12px;
      background: none;
      border: 1px solid var(--color-border);
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .toolbar-btn:hover {
      background: var(--color-bg);
    }

    .toolbar-divider {
      width: 1px;
      height: 24px;
      background: var(--color-border);
      margin: 0 8px;
    }

    .collab-users {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .collab-avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--color-primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      border: 2px solid white;
      margin-left: -8px;
    }

    .collab-avatar:first-child {
      margin-left: 0;
    }

    .collab-avatar.green { background: var(--color-success); }
    .collab-avatar.orange { background: var(--color-warning); }

    .editor-content {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
    }

    .editor-content textarea {
      width: 100%;
      height: 100%;
      border: none;
      resize: none;
      font-size: 14px;
      line-height: 1.8;
      font-family: inherit;
    }

    .editor-content textarea:focus {
      outline: none;
    }

    /* Attorney Review Nudge */
    .attorney-review-hint {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: #fefce8;
      border-top: 1px solid #fef08a;
      font-size: 13px;
      color: #713f12;
    }

    .attorney-review-hint .hint-icon {
      font-size: 16px;
      flex-shrink: 0;
    }

    .attorney-review-hint .hint-text {
      flex: 1;
    }

    .attorney-review-hint .hint-link {
      color: #854d0e;
      font-weight: 600;
      text-decoration: none;
      white-space: nowrap;
    }

    .attorney-review-hint .hint-link:hover {
      text-decoration: underline;
    }

    .attorney-review-hint .hint-dismiss {
      background: none;
      border: none;
      color: #a16207;
      font-size: 18px;
      cursor: pointer;
      padding: 0 4px;
      opacity: 0.6;
    }

    .attorney-review-hint .hint-dismiss:hover {
      opacity: 1;
    }

    /* E-Sign Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--color-surface);
      border-radius: 16px;
      width: 100%;
      max-width: 500px;
      max-height: 90vh;
      overflow: hidden;
    }

    .modal-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--color-border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 700;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--color-text-muted);
    }

    .modal-body {
      padding: 24px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 14px;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .timestamp-preview {
      background: var(--color-bg);
      padding: 16px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 13px;
      text-align: center;
      margin-top: 16px;
    }

    .modal-footer {
      padding: 16px 24px;
      border-top: 1px solid var(--color-border);
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar {
        width: 80px;
      }
      .sidebar .nav-section-title,
      .sidebar .nav-item span:not(.icon),
      .sidebar .user-info > div,
      .logo span:last-child {
        display: none;
      }
      .sidebar .nav-item {
        justify-content: center;
        padding: 16px;
      }
      .main-content {
        margin-left: 80px;
      }
      .workspace-container {
        grid-template-columns: 1fr;
      }
      .generator-panel {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="mainSidebar">
      <button class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle sidebar">â—€</button>
      <div class="sidebar-header">
        <a href="/" class="logo">
          <span>Terms</span><span>.Docs</span>
        </a>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Main</div>
          <button class="nav-item active" onclick="showTab('dashboard')">
            <span class="icon">ğŸ </span>
            <span>Dashboard</span>
          </button>
          <button class="nav-item" onclick="showTab('workspace')">
            <span class="icon">ğŸ“„</span>
            <span>Document Workspace</span>
          </button>
          <button class="nav-item" onclick="showTab('mydocs')">
            <span class="icon">ğŸ“</span>
            <span>My Documents</span>
            <span class="badge">3</span>
          </button>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Compliance</div>
          <button class="nav-item" onclick="showTab('compliance')">
            <span class="icon">ğŸ“…</span>
            <span>Compliance Calendar</span>
          </button>
          <button class="nav-item" onclick="showTab('compare')">
            <span class="icon">ğŸ“Š</span>
            <span>Entity Comparison</span>
          </button>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Signing</div>
          <button class="nav-item" onclick="showTab('esign')">
            <span class="icon">âœï¸</span>
            <span>E-Signatures</span>
          </button>
        </div>

        <div class="nav-section">
          <a href="mailto:owner@terms.law?subject=Attorney%20Review%20Request" class="nav-item">
            <span class="icon">âš–ï¸</span>
            <span>Get Attorney Review</span>
          </a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <div class="user-info">
          <div class="user-avatar">G</div>
          <div>
            <div class="user-name">Guest User</div>
            <div class="user-email">Not signed in</div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

      <!-- Dashboard Tab -->
      <div id="tab-dashboard" class="tab-content active">
        <div class="content-header">
          <h1 class="page-title">Dashboard</h1>
          <div class="header-actions">
            <button class="btn btn-primary" onclick="showTab('workspace')">
              <span>+</span> New Document
            </button>
          </div>
        </div>

        <div class="content-body">
          <!-- Mini stat cards -->
          <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
            <div onclick="showTab('mydocs')" style="flex: 1; min-width: 140px; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 8px; padding: 12px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">ğŸ“„</span>
              <div>
                <div style="font-size: 18px; font-weight: 700;">0</div>
                <div style="font-size: 11px; color: var(--color-text-muted);">Generators Saved</div>
              </div>
            </div>
            <div onclick="showTab('esign')" style="flex: 1; min-width: 140px; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 8px; padding: 12px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">âœï¸</span>
              <div>
                <div style="font-size: 18px; font-weight: 700;">0</div>
                <div style="font-size: 11px; color: var(--color-text-muted);">Pending Signatures</div>
              </div>
            </div>
            <div onclick="showTab('compliance')" style="flex: 1; min-width: 140px; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 8px; padding: 12px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">ğŸ¢</span>
              <div>
                <div style="font-size: 18px; font-weight: 700;">0</div>
                <div style="font-size: 11px; color: var(--color-text-muted);">Entities Tracked</div>
              </div>
            </div>
          </div>

          <h3 class="section-title" style="margin-bottom: 16px;">What You Can Do</h3>
          <div class="quick-actions">
            <div class="action-card" onclick="showTab('workspace')">
              <div class="action-icon">âš™ï¸</div>
              <div class="action-title">Document Generators</div>
              <div class="action-desc">NDA, LLC, contracts â€” fill in blanks, preview live</div>
            </div>
            <div class="action-card" onclick="shareCollabLink()">
              <div class="action-icon">ğŸ‘¥</div>
              <div class="action-title">Live Collaboration</div>
              <div class="action-desc">Share link, edit together over Zoom</div>
            </div>
            <div class="action-card" onclick="showTab('esign')">
              <div class="action-icon">âœï¸</div>
              <div class="action-title">E-Sign & Send</div>
              <div class="action-desc">Sign yourself or request from others</div>
            </div>
            <div class="action-card" onclick="showTab('compliance')">
              <div class="action-icon">ğŸ“…</div>
              <div class="action-title">Compliance Calendar</div>
              <div class="action-desc">Track entity filings, taxes, deadlines</div>
            </div>
          </div>

          <div class="section-header">
            <h3 class="section-title">Recent Documents</h3>
            <button class="btn btn-secondary" onclick="showTab('mydocs')">View All</button>
          </div>
          <div class="doc-list">
            <div class="doc-item">
              <div class="doc-icon">ğŸ“‹</div>
              <div class="doc-info">
                <div class="doc-name">NDA - Acme Corp Partnership</div>
                <div class="doc-meta">Modified 2 hours ago</div>
              </div>
              <span class="doc-status pending">Pending Signature</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">ğŸ“„</div>
              <div class="doc-info">
                <div class="doc-name">LLC Operating Agreement - Ventures LLC</div>
                <div class="doc-meta">Modified yesterday</div>
              </div>
              <span class="doc-status draft">Draft</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">âœ…</div>
              <div class="doc-info">
                <div class="doc-name">Consulting Agreement - J. Smith</div>
                <div class="doc-meta">Completed Dec 10, 2025</div>
              </div>
              <span class="doc-status signed">Signed</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Document Workspace Tab -->
      <div id="tab-workspace" class="tab-content">
        <div class="content-header">
          <h1 class="page-title">Document Workspace</h1>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="shareCollabLink()">
              <span>ğŸ”—</span> Share Link
            </button>
            <button class="btn btn-primary" onclick="openEsignModal()">
              <span>âœï¸</span> Send for Signature
            </button>
          </div>
        </div>

        <div class="content-body">
          <div class="workspace-container">
            <!-- Generator Panel -->
            <div class="generator-panel" id="generatorPanel">
              <button class="panel-collapse-btn" onclick="toggleGeneratorPanel()" title="Toggle panel">â—€</button>
              <div class="panel-header"><span>Document Generators</span></div>
              <div class="generator-search">
                <input type="text" placeholder="Search generators..." id="generatorSearch">
              </div>
              <div class="generator-list" id="generatorList">
                <div class="generator-item active" data-generator="">
                  <span class="icon">ğŸ“</span>
                  <span class="name">Blank Document</span>
                </div>
                <div class="generator-item" data-generator="../Templates/nda-mutual-confidentiality-agreement.html">
                  <span class="icon">ğŸ¤</span>
                  <span class="name">NDA (Mutual)</span>
                </div>
                <div class="generator-item" data-generator="../Templates/llc-operating-agreement-generator.html">
                  <span class="icon">ğŸ¢</span>
                  <span class="name">LLC Operating Agreement</span>
                </div>
                <div class="generator-item" data-generator="../Templates/consulting-agreement-generator.html">
                  <span class="icon">ğŸ’¼</span>
                  <span class="name">Consulting Agreement</span>
                </div>
                <div class="generator-item" data-generator="../Templates/employment-offer-letter-generator.html">
                  <span class="icon">ğŸ‘”</span>
                  <span class="name">Employment Offer</span>
                </div>
                <div class="generator-item" data-generator="../Templates/privacy-policy-generator.html">
                  <span class="icon">ğŸ”</span>
                  <span class="name">Privacy Policy</span>
                </div>
                <div class="generator-item" data-generator="../Templates/terms-of-service-generator.html">
                  <span class="icon">ğŸ“‹</span>
                  <span class="name">Terms of Service</span>
                </div>
                <div class="generator-item" data-generator="../Templates/saas-agreement-generator.html">
                  <span class="icon">ğŸ›’</span>
                  <span class="name">SaaS Agreement</span>
                </div>
                <div class="generator-item" data-generator="../Templates/msa-generator.html">
                  <span class="icon">ğŸ“„</span>
                  <span class="name">Master Services (MSA)</span>
                </div>
                <div class="generator-item" data-generator="../Templates/safe-agreement-generator.html">
                  <span class="icon">ğŸ’°</span>
                  <span class="name">SAFE Agreement</span>
                </div>
                <div class="generator-item" data-generator="../Templates/independent-contractor-agreement-generator.html">
                  <span class="icon">ğŸ”§</span>
                  <span class="name">Contractor Agreement</span>
                </div>
                <div class="generator-item" data-generator="../stripe-demand-letter-generator/">
                  <span class="icon">ğŸ“©</span>
                  <span class="name">Stripe Demand Letter</span>
                </div>
                <div class="generator-item" data-generator="../Templates/founders-agreement-generator.html">
                  <span class="icon">ğŸ¤</span>
                  <span class="name">Founders Agreement</span>
                </div>
                <div class="generator-item" data-generator="../Templates/piia-generator.html">
                  <span class="icon">ğŸ’¡</span>
                  <span class="name">PIIA / Invention Assignment</span>
                </div>
                <div class="generator-item" data-generator="../Templates/convertible-note-generator.html">
                  <span class="icon">ğŸ“ˆ</span>
                  <span class="name">Convertible Note</span>
                </div>
                <div class="generator-item view-all" onclick="showAllGenerators()">
                  <span class="icon">â•</span>
                  <span class="name">View All 38+ Generators</span>
                </div>
              </div>
            </div>

            <!-- Editor -->
            <div class="doc-editor">
              <div class="generator-loaded-bar" id="generatorLoadedBar">
                <span><strong id="loadedGeneratorName">LLC Operating Agreement</strong> generator loaded</span>
                <span class="width-hint">â†” Widen window for side-by-side preview</span>
                <button onclick="closeGenerator()">Back to blank editor</button>
              </div>
              <div class="editor-toolbar">
                <button class="toolbar-btn">ğŸ“ Open</button>
                <button class="toolbar-btn">ğŸ’¾ Save</button>
                <button class="toolbar-btn">ğŸ“¥ Download</button>
                <div class="toolbar-divider"></div>
                <button class="toolbar-btn">âš–ï¸ Attorney Review</button>
                <div class="collab-users">
                  <span style="font-size: 13px; color: var(--color-text-secondary); margin-right: 8px;">Live:</span>
                  <div class="collab-avatar">Y</div>
                  <div class="collab-avatar green">C</div>
                </div>
              </div>
              <div class="editor-content">
                <textarea placeholder="Start typing your document here, or select a generator from the left panel...

You can also paste existing text to edit, or share this workspace link for real-time collaboration with your attorney or the other party."></textarea>
              </div>
              <div class="attorney-review-hint" id="reviewHint">
                <span class="hint-icon">ğŸ’¡</span>
                <span class="hint-text">These templates are attorney-drafted starting points. For complex situations, consider a <a href="mailto:owner@terms.law?subject=Document%20Review%20Request" class="hint-link">quick attorney review</a>.</span>
                <button class="hint-dismiss" onclick="dismissReviewHint()" title="Dismiss">&times;</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- My Documents Tab -->
      <div id="tab-mydocs" class="tab-content">
        <div class="content-header">
          <h1 class="page-title">My Documents</h1>
          <div class="header-actions">
            <button class="btn btn-secondary">
              <span>ğŸ“¤</span> Upload
            </button>
            <button class="btn btn-primary" onclick="showTab('workspace')">
              <span>+</span> New Document
            </button>
          </div>
        </div>

        <div class="content-body">
          <div class="doc-list">
            <div class="doc-item">
              <div class="doc-icon">ğŸ“‹</div>
              <div class="doc-info">
                <div class="doc-name">NDA - Acme Corp Partnership</div>
                <div class="doc-meta">Modified 2 hours ago Â· Sent to john@acme.com</div>
              </div>
              <span class="doc-status pending">Pending Signature</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">ğŸ“„</div>
              <div class="doc-info">
                <div class="doc-name">LLC Operating Agreement - Ventures LLC</div>
                <div class="doc-meta">Modified yesterday Â· California LLC</div>
              </div>
              <span class="doc-status draft">Draft</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">ğŸ“„</div>
              <div class="doc-info">
                <div class="doc-name">Consulting Agreement - Draft v2</div>
                <div class="doc-meta">Modified Dec 11, 2025</div>
              </div>
              <span class="doc-status draft">Draft</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">âœ…</div>
              <div class="doc-info">
                <div class="doc-name">Consulting Agreement - J. Smith</div>
                <div class="doc-meta">Signed Dec 10, 2025 at 2:34 PM PST</div>
              </div>
              <span class="doc-status signed">Signed</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">âœ…</div>
              <div class="doc-info">
                <div class="doc-name">NDA - Partner Co</div>
                <div class="doc-meta">Signed Dec 5, 2025 at 10:15 AM PST</div>
              </div>
              <span class="doc-status signed">Signed</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Compliance Calendar Tab -->
      <div id="tab-compliance" class="tab-content">
        <div class="content-header">
          <h1 class="page-title">Compliance Calendar</h1>
          <div class="header-actions">
            <button class="btn btn-primary" onclick="addEntityModal()">
              <span>+</span> Add Entity
            </button>
          </div>
        </div>

        <div class="content-body">
          <div class="compliance-grid">
            <!-- Entity Card 1 -->
            <div class="entity-card">
              <div class="entity-header">
                <div class="entity-icon">ğŸ¢</div>
                <div>
                  <div class="entity-name">Acme Ventures LLC</div>
                  <div class="entity-type">California LLC Â· Formed Jan 15, 2024</div>
                </div>
              </div>
              <div class="entity-body">
                <div class="deadline-item">
                  <span class="deadline-icon">ğŸ“…</span>
                  <div class="deadline-info">
                    <div class="deadline-name">Franchise Tax Due</div>
                    <div class="deadline-date deadline-urgent">April 15, 2025 Â· 123 days</div>
                  </div>
                  <div class="deadline-fee">$800</div>
                </div>
                <div class="deadline-item">
                  <span class="deadline-icon">ğŸ“‹</span>
                  <div class="deadline-info">
                    <div class="deadline-name">Statement of Information (LLC-12)</div>
                    <div class="deadline-date">January 15, 2026 Â· 398 days</div>
                  </div>
                  <div class="deadline-fee">$20</div>
                </div>
                <div class="deadline-item">
                  <span class="deadline-icon">ğŸ“Š</span>
                  <div class="deadline-info">
                    <div class="deadline-name">Tax Return (Form 568)</div>
                    <div class="deadline-date">March 15, 2025 Â· 92 days</div>
                  </div>
                  <div class="deadline-fee">â€”</div>
                </div>

                <div class="cost-summary">
                  <div class="cost-row">
                    <span>Franchise Tax</span>
                    <span>$800</span>
                  </div>
                  <div class="cost-row">
                    <span>Statement of Info</span>
                    <span>$20</span>
                  </div>
                  <div class="cost-row">
                    <span>Registered Agent (est.)</span>
                    <span>$100</span>
                  </div>
                  <div class="cost-row total">
                    <span>Annual Total</span>
                    <span>$920</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Entity Card 2 -->
            <div class="entity-card">
              <div class="entity-header">
                <div class="entity-icon" style="background: var(--color-success);">ğŸ›ï¸</div>
                <div>
                  <div class="entity-name">TechStartup Inc</div>
                  <div class="entity-type">Delaware C-Corp Â· Formed Mar 1, 2023</div>
                </div>
              </div>
              <div class="entity-body">
                <div class="deadline-item">
                  <span class="deadline-icon" style="color: var(--color-danger);">âš ï¸</span>
                  <div class="deadline-info">
                    <div class="deadline-name" style="color: var(--color-danger);">Annual Report OVERDUE</div>
                    <div class="deadline-date deadline-urgent">Was due March 1, 2024</div>
                  </div>
                  <div class="deadline-fee">$50 + late fees</div>
                </div>
                <div class="deadline-item">
                  <span class="deadline-icon">ğŸ“…</span>
                  <div class="deadline-info">
                    <div class="deadline-name">Franchise Tax</div>
                    <div class="deadline-date">March 1, 2025 Â· 78 days</div>
                  </div>
                  <div class="deadline-fee">$225</div>
                </div>

                <div class="cost-summary">
                  <div class="cost-row">
                    <span>Franchise Tax</span>
                    <span>$225</span>
                  </div>
                  <div class="cost-row">
                    <span>Annual Report</span>
                    <span>$50</span>
                  </div>
                  <div class="cost-row">
                    <span>Registered Agent (est.)</span>
                    <span>$100</span>
                  </div>
                  <div class="cost-row total">
                    <span>Annual Total</span>
                    <span>$375</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Entity Comparison Tab -->
      <div id="tab-compare" class="tab-content">
        <div class="content-header">
          <h1 class="page-title">Entity Comparison</h1>
        </div>

        <div class="content-body">
          <p style="margin-bottom: 24px; color: var(--color-text-secondary);">
            Compare annual compliance costs and requirements before choosing your entity type.
          </p>

          <div class="comparison-table">
            <table>
              <thead>
                <tr>
                  <th>Requirement</th>
                  <th>CA LLC</th>
                  <th>CA Corp</th>
                  <th>DE LLC</th>
                  <th>DE Corp</th>
                  <th>DE PBC</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Franchise Tax</strong></td>
                  <td>$800/yr</td>
                  <td>$800/yr</td>
                  <td class="highlight">$0</td>
                  <td>$175+</td>
                  <td>$175+</td>
                </tr>
                <tr>
                  <td><strong>Annual Report</strong></td>
                  <td>$20 (biennial)</td>
                  <td>$25/yr</td>
                  <td>$300/yr</td>
                  <td>$50/yr</td>
                  <td>$50/yr</td>
                </tr>
                <tr>
                  <td><strong>State Income Tax</strong></td>
                  <td>Yes (8.84%)</td>
                  <td>Yes (8.84%)</td>
                  <td class="highlight">No*</td>
                  <td class="highlight">No*</td>
                  <td class="highlight">No*</td>
                </tr>
                <tr>
                  <td><strong>Registered Agent</strong></td>
                  <td>~$100/yr</td>
                  <td>~$100/yr</td>
                  <td>~$100/yr</td>
                  <td>~$100/yr</td>
                  <td>~$100/yr</td>
                </tr>
                <tr>
                  <td><strong>First Year Due Date</strong></td>
                  <td>15th of 4th mo.</td>
                  <td>15th of 4th mo.</td>
                  <td>June 1</td>
                  <td>March 1</td>
                  <td>March 1</td>
                </tr>
                <tr style="background: #f8fafc;">
                  <td><strong>MIN. ANNUAL COST</strong></td>
                  <td><strong>$820</strong></td>
                  <td><strong>$925</strong></td>
                  <td><strong style="color: var(--color-success);">$400</strong></td>
                  <td><strong>$325</strong></td>
                  <td><strong>$325</strong></td>
                </tr>
              </tbody>
            </table>
          </div>

          <p style="margin-top: 16px; font-size: 13px; color: var(--color-text-muted);">
            * Delaware has no state income tax on income earned outside Delaware. If you operate in California, you'll still owe CA taxes.
          </p>

          <div style="margin-top: 32px; padding: 24px; background: var(--color-surface); border-radius: 12px; border: 1px solid var(--color-border);">
            <h3 style="margin-bottom: 12px;">Not sure which entity is right for you?</h3>
            <p style="color: var(--color-text-secondary); margin-bottom: 16px;">
              Book a quick call to discuss your situation. I'll help you choose the right structure for your business goals.
            </p>
            <a href="mailto:owner@terms.law?subject=Entity%20Selection%20Consultation" class="btn btn-primary">
              <span>ğŸ“</span> Book a Consultation
            </a>
          </div>
        </div>
      </div>

      <!-- E-Sign Tab -->
      <div id="tab-esign" class="tab-content">
        <div class="content-header">
          <h1 class="page-title">E-Signatures</h1>
          <div class="header-actions">
            <button class="btn btn-secondary" onclick="openSelfSignModal()">
              <span>âœï¸</span> Sign Yourself
            </button>
            <button class="btn btn-primary" onclick="openEsignModal()">
              <span>ğŸ“§</span> Send for Signature
            </button>
          </div>
        </div>

        <div class="content-body">
          <!-- Quick sign cards -->
          <div class="quick-actions" style="margin-bottom: 24px;">
            <div class="action-card" onclick="openSelfSignModal()">
              <div class="action-icon">âœï¸</div>
              <div class="action-title">Sign a Document</div>
              <div class="action-desc">Add your own signature with timestamp</div>
            </div>
            <div class="action-card" onclick="openEsignModal()">
              <div class="action-icon">ğŸ“§</div>
              <div class="action-title">Request Signature</div>
              <div class="action-desc">Send to another party for signing</div>
            </div>
          </div>

          <h3 class="section-title" style="margin-bottom: 16px;">Signature History</h3>
          <div class="doc-list">
            <div class="doc-item">
              <div class="doc-icon">â³</div>
              <div class="doc-info">
                <div class="doc-name">NDA - Acme Corp Partnership</div>
                <div class="doc-meta">Sent to john@acme.com Â· Dec 13, 2025</div>
              </div>
              <span class="doc-status pending">Awaiting Signature</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">âœ…</div>
              <div class="doc-info">
                <div class="doc-name">Consulting Agreement - J. Smith</div>
                <div class="doc-meta">Signed by jane@company.com Â· Dec 10, 2025 at 2:34:17 PM PST</div>
              </div>
              <span class="doc-status signed">Completed</span>
            </div>
            <div class="doc-item">
              <div class="doc-icon">âœ…</div>
              <div class="doc-info">
                <div class="doc-name">NDA - Partner Co</div>
                <div class="doc-meta">Signed by partner@example.com Â· Dec 5, 2025 at 10:15:42 AM PST</div>
              </div>
              <span class="doc-status signed">Completed</span>
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>

  <!-- E-Sign Modal -->
  <div class="modal-overlay" id="esignModal">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title">Send for E-Signature</h2>
        <button class="modal-close" onclick="closeEsignModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Document</label>
          <select class="form-input">
            <option>NDA - Acme Corp Partnership (current)</option>
            <option>LLC Operating Agreement - Ventures LLC</option>
            <option>Upload a document...</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Recipient Email</label>
          <input type="email" class="form-input" placeholder="counterparty@example.com">
        </div>
        <div class="form-group">
          <label class="form-label">Recipient Name</label>
          <input type="text" class="form-input" placeholder="John Smith">
        </div>
        <div class="form-group">
          <label class="form-label">Message (optional)</label>
          <textarea class="form-input" rows="3" placeholder="Please review and sign the attached agreement..."></textarea>
        </div>
        <div class="timestamp-preview" id="timestampPreview">
          Signature will be timestamped:<br>
          <strong id="liveTimestamp"></strong>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeEsignModal()">Cancel</button>
        <button class="btn btn-success">
          <span>âœï¸</span> Send for Signature
        </button>
      </div>
    </div>
  </div>

  <!-- Self-Sign Modal -->
  <div class="modal-overlay" id="selfSignModal">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h2 class="modal-title">Sign Document</h2>
        <button class="modal-close" onclick="closeSelfSignModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Document</label>
          <select class="form-input" id="selfSignDoc">
            <option>Current document in workspace</option>
            <option>NDA - Acme Corp Partnership</option>
            <option>LLC Operating Agreement - Ventures LLC</option>
            <option>Upload a document...</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Your Full Legal Name</label>
          <input type="text" class="form-input" id="signerName" placeholder="Enter your full name">
        </div>
        <div class="form-group">
          <label class="form-label">Signature Style</label>
          <div style="display: flex; gap: 8px; margin-top: 8px;">
            <button class="btn btn-secondary sig-style-btn active" onclick="setSignatureStyle('type')" data-style="type">Type</button>
            <button class="btn btn-secondary sig-style-btn" onclick="setSignatureStyle('draw')" data-style="draw">Draw</button>
          </div>
        </div>
        <div class="form-group" id="typeSignatureGroup">
          <label class="form-label">Type Your Signature</label>
          <input type="text" class="form-input" id="typedSignature" placeholder="Type your name" style="font-family: 'Brush Script MT', cursive; font-size: 24px; text-align: center; padding: 16px;">
        </div>
        <div class="form-group" id="drawSignatureGroup" style="display: none;">
          <label class="form-label">Draw Your Signature</label>
          <canvas id="signatureCanvas" style="width: 100%; height: 120px; border: 1px solid var(--color-border); border-radius: 8px; cursor: crosshair;"></canvas>
          <button style="margin-top: 8px; font-size: 12px; background: none; border: none; color: var(--color-primary); cursor: pointer;" onclick="clearSignatureCanvas()">Clear signature</button>
        </div>
        <div class="form-group">
          <label style="display: flex; align-items: flex-start; gap: 8px; cursor: pointer;">
            <input type="checkbox" id="signatureConsent" style="margin-top: 4px;">
            <span style="font-size: 13px; color: var(--color-text-secondary);">
              I agree that this electronic signature has the same legal effect as a handwritten signature and that I intend to sign this document.
            </span>
          </label>
        </div>
        <div class="timestamp-preview" id="selfSignTimestamp">
          Your signature will be timestamped:<br>
          <strong id="selfSignLiveTimestamp"></strong>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeSelfSignModal()">Cancel</button>
        <button class="btn btn-success" onclick="applySignature()">
          <span>âœï¸</span> Apply Signature
        </button>
      </div>
    </div>
  </div>

  <script>
    // Sidebar & Panel Toggle
    function toggleSidebar() {
      const sidebar = document.getElementById('mainSidebar');
      const btn = sidebar.querySelector('.sidebar-toggle');
      sidebar.classList.toggle('collapsed');
      document.body.classList.toggle('sidebar-collapsed');
      btn.textContent = sidebar.classList.contains('collapsed') ? 'â–¶' : 'â—€';
      localStorage.setItem('sidebar_collapsed', sidebar.classList.contains('collapsed'));
    }

    function toggleGeneratorPanel() {
      const panel = document.getElementById('generatorPanel');
      const btn = panel.querySelector('.panel-collapse-btn');
      panel.classList.toggle('collapsed');
      btn.textContent = panel.classList.contains('collapsed') ? 'â–¶' : 'â—€';
      localStorage.setItem('generator_panel_collapsed', panel.classList.contains('collapsed'));
    }

    // Restore collapse states on load
    if (localStorage.getItem('sidebar_collapsed') === 'true') {
      document.getElementById('mainSidebar').classList.add('collapsed');
      document.body.classList.add('sidebar-collapsed');
      document.querySelector('.sidebar-toggle').textContent = 'â–¶';
    }
    if (localStorage.getItem('generator_panel_collapsed') === 'true') {
      const panel = document.getElementById('generatorPanel');
      const btn = document.querySelector('.panel-collapse-btn');
      if (panel) panel.classList.add('collapsed');
      if (btn) btn.textContent = 'â–¶';
    }

    // Tab Navigation
    function showTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });

      // Deactivate all nav items
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });

      // Show selected tab
      document.getElementById('tab-' + tabName).classList.add('active');

      // Activate corresponding nav item
      event.target.closest('.nav-item')?.classList.add('active');
    }

    // E-Sign Modal
    function openEsignModal() {
      document.getElementById('esignModal').classList.add('active');
      updateTimestamp();
    }

    function closeEsignModal() {
      document.getElementById('esignModal').classList.remove('active');
    }

    // Self-Sign Modal
    function openSelfSignModal() {
      document.getElementById('selfSignModal').classList.add('active');
      updateSelfSignTimestamp();
      initSignatureCanvas();
    }

    function closeSelfSignModal() {
      document.getElementById('selfSignModal').classList.remove('active');
    }

    function updateSelfSignTimestamp() {
      const now = new Date();
      const options = {
        timeZone: 'America/Los_Angeles',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true
      };
      const pstTime = now.toLocaleString('en-US', options) + ' PST';
      document.getElementById('selfSignLiveTimestamp').textContent = pstTime;
    }

    let signatureStyle = 'type';
    let isDrawing = false;
    let signatureCtx = null;

    function setSignatureStyle(style) {
      signatureStyle = style;
      document.querySelectorAll('.sig-style-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.style === style);
      });
      document.getElementById('typeSignatureGroup').style.display = style === 'type' ? 'block' : 'none';
      document.getElementById('drawSignatureGroup').style.display = style === 'draw' ? 'block' : 'none';
    }

    function initSignatureCanvas() {
      const canvas = document.getElementById('signatureCanvas');
      signatureCtx = canvas.getContext('2d');
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
      signatureCtx.strokeStyle = '#1e293b';
      signatureCtx.lineWidth = 2;
      signatureCtx.lineCap = 'round';
      signatureCtx.lineJoin = 'round';

      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseout', stopDrawing);
      canvas.addEventListener('touchstart', handleTouch);
      canvas.addEventListener('touchmove', handleTouchMove);
      canvas.addEventListener('touchend', stopDrawing);
    }

    function startDrawing(e) {
      isDrawing = true;
      signatureCtx.beginPath();
      signatureCtx.moveTo(e.offsetX, e.offsetY);
    }

    function draw(e) {
      if (!isDrawing) return;
      signatureCtx.lineTo(e.offsetX, e.offsetY);
      signatureCtx.stroke();
    }

    function stopDrawing() {
      isDrawing = false;
    }

    function handleTouch(e) {
      e.preventDefault();
      const rect = e.target.getBoundingClientRect();
      const touch = e.touches[0];
      startDrawing({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
    }

    function handleTouchMove(e) {
      e.preventDefault();
      const rect = e.target.getBoundingClientRect();
      const touch = e.touches[0];
      draw({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
    }

    function clearSignatureCanvas() {
      const canvas = document.getElementById('signatureCanvas');
      signatureCtx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function applySignature() {
      const name = document.getElementById('signerName').value.trim();
      const consent = document.getElementById('signatureConsent').checked;

      if (!name) {
        alert('Please enter your full legal name.');
        return;
      }
      if (!consent) {
        alert('Please check the consent box to confirm your signature.');
        return;
      }

      const timestamp = document.getElementById('selfSignLiveTimestamp').textContent;
      let signatureData = '';

      if (signatureStyle === 'type') {
        signatureData = document.getElementById('typedSignature').value || name;
      } else {
        signatureData = document.getElementById('signatureCanvas').toDataURL();
      }

      // Success - in production would save to document
      alert(`Document signed successfully!\n\nSigned by: ${name}\nTimestamp: ${timestamp}\n\nYour signed document is ready for download.`);
      closeSelfSignModal();
    }

    // Live Timestamp (PST)
    function updateTimestamp() {
      const now = new Date();
      const options = {
        timeZone: 'America/Los_Angeles',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true
      };
      const pstTime = now.toLocaleString('en-US', options) + ' PST';
      document.getElementById('liveTimestamp').textContent = pstTime;
    }

    // Update timestamps every second when modals are open
    setInterval(() => {
      if (document.getElementById('esignModal').classList.contains('active')) {
        updateTimestamp();
      }
      if (document.getElementById('selfSignModal').classList.contains('active')) {
        updateSelfSignTimestamp();
      }
    }, 1000);

    // Share Collaboration Link
    function shareCollabLink() {
      const roomId = Math.random().toString(36).substring(2, 10);
      const link = window.location.origin + '/TermsDocs/?room=' + roomId;

      if (navigator.clipboard) {
        navigator.clipboard.writeText(link);
        alert('Collaboration link copied to clipboard!\n\n' + link + '\n\nShare this link to collaborate in real-time.');
      } else {
        prompt('Copy this collaboration link:', link);
      }
    }

    // Generator Search
    document.getElementById('generatorSearch')?.addEventListener('input', function() {
      const query = this.value.toLowerCase();
      document.querySelectorAll('.generator-item').forEach(item => {
        const name = item.querySelector('.name').textContent.toLowerCase();
        item.style.display = name.includes(query) ? 'flex' : 'none';
      });
    });

    // Generator Selection & Loading
    let currentGeneratorUrl = null;

    document.querySelectorAll('.generator-item:not(.view-all)').forEach(item => {
      item.addEventListener('click', function() {
        const generatorUrl = this.dataset.generator;
        const name = this.querySelector('.name').textContent;

        document.querySelectorAll('.generator-item').forEach(i => i.classList.remove('active'));
        this.classList.add('active');

        if (!generatorUrl) {
          // Blank document - show textarea
          closeGenerator();
        } else {
          // Load generator in iframe
          loadGenerator(generatorUrl, name);
        }
      });
    });

    function loadGenerator(url, name) {
      currentGeneratorUrl = url;
      const editorContent = document.querySelector('.editor-content');

      // Check if iframe already exists
      let iframe = editorContent.querySelector('.editor-embed');
      if (!iframe) {
        iframe = document.createElement('iframe');
        iframe.className = 'editor-embed';
        editorContent.appendChild(iframe);
      }

      // Add embed parameter to hide header in generator
      const embedUrl = url + (url.includes('?') ? '&' : '?') + 'embed=1';
      iframe.src = embedUrl;
      editorContent.classList.add('with-iframe');

      // Show loaded bar, hide toolbar
      document.getElementById('loadedGeneratorName').textContent = name;
      document.getElementById('generatorLoadedBar').classList.add('visible');
      document.querySelector('.doc-editor').classList.add('has-generator');
    }

    function closeGenerator() {
      currentGeneratorUrl = null;
      const editorContent = document.querySelector('.editor-content');

      // Remove iframe
      const iframe = editorContent.querySelector('.editor-embed');
      if (iframe) iframe.remove();

      editorContent.classList.remove('with-iframe');
      document.getElementById('generatorLoadedBar').classList.remove('visible');
      document.querySelector('.doc-editor').classList.remove('has-generator');

      // Activate blank document option
      document.querySelectorAll('.generator-item').forEach(i => i.classList.remove('active'));
      document.querySelector('.generator-item[data-generator=""]').classList.add('active');
    }

    function showAllGenerators() {
      // Open generators index in new tab or modal
      window.open('../Templates/', '_blank');
    }

    // Open generator in new window (alternative)
    function openGeneratorNewWindow(url) {
      const roomId = Math.random().toString(36).substring(2, 10);
      window.open(url + '?room=' + roomId, '_blank');
    }

    // Close modals on overlay click
    document.getElementById('esignModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeEsignModal();
      }
    });

    document.getElementById('selfSignModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeSelfSignModal();
      }
    });

    // Attorney Review Hint
    function dismissReviewHint() {
      document.getElementById('reviewHint').style.display = 'none';
      localStorage.setItem('termsdocs_hint_dismissed', 'true');
    }

    // Check if hint was previously dismissed
    if (localStorage.getItem('termsdocs_hint_dismissed') === 'true') {
      document.getElementById('reviewHint').style.display = 'none';
    }
  </script>
</body>
</html>
