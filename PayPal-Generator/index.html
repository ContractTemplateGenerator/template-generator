<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPal Fund Hold Demand Letter Generator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }

        .generator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            height: 100vh;
            max-width: 100%;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
        }

        .form-panel {
            background: #f8fafc;
            border-right: 1px solid #e2e8f0;
            overflow-y: auto;
            padding: 30px;
            min-width: 0;
        }

        .preview-panel {
            overflow-y: auto;
            padding: 40px;
            background: white;
            min-width: 0;
        }

        .form-panel::-webkit-scrollbar,
        .preview-panel::-webkit-scrollbar {
            width: 10px;
        }

        .form-panel::-webkit-scrollbar-track,
        .preview-panel::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .form-panel::-webkit-scrollbar-thumb,
        .preview-panel::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 5px;
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 20px 30px;
            border-bottom: 4px solid #1e3a8a;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .header-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .form-section {
            margin-bottom: 25px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #dbeafe;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
            color: #334155;
            font-size: 14px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-group label {
            cursor: pointer;
            font-size: 14px;
            color: #475569;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .radio-option label {
            cursor: pointer;
            font-size: 14px;
            color: #475569;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .risk-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: 999px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 15px;
            background: #e2e8f0;
            color: #0f172a;
        }

        .risk-low {
            background: #dcfce7;
            color: #166534;
        }

        .risk-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .risk-high {
            background: #fee2e2;
            color: #b91c1c;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #1e40af;
            border: 2px solid #3b82f6;
        }

        .btn-secondary:hover {
            background: #eff6ff;
        }

        .preview-document {
            background: white;
            padding: 60px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            font-family: 'Georgia', serif;
            font-size: 14px;
            line-height: 1.8;
            color: #1e293b;
            max-width: 850px;
            margin: 0 auto;
        }

        .summary-box {
            background: #f1f5f9;
            border-left: 5px solid #1e40af;
            border-radius: 6px;
            padding: 18px 20px;
            margin-bottom: 28px;
            font-family: 'Inter', sans-serif;
        }

        .summary-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: .08em;
            color: #1e40af;
            margin-bottom: 12px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px 20px;
            font-size: 13px;
        }

        .summary-item span {
            display: block;
            color: #475569;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: .05em;
            margin-bottom: 4px;
        }

        .summary-item strong {
            color: #0f172a;
            font-size: 14px;
            font-weight: 600;
        }

        .preview-document p {
            margin-bottom: 12px;
        }

        .preview-document strong {
            color: #1e40af;
        }

        .highlight {
            background-color: #fef08a;
            padding: 2px 4px;
            border-radius: 3px;
            animation: highlight-flash 0.6s ease-in-out;
        }

        @keyframes highlight-flash {
            0%, 100% { background-color: #fef08a; }
            50% { background-color: #fde047; }
        }

        .signature-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
        }

        .signature-input {
            border: 2px dashed #cbd5e1;
            padding: 15px;
            border-radius: 8px;
            min-height: 80px;
            font-family: 'Brush Script MT', cursive;
            font-size: 24px;
            text-align: center;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 15px;
            border-left: 4px solid;
            font-size: 13px;
        }

        .alert-info {
            background: #dbeafe;
            border-color: #3b82f6;
            color: #1e40af;
        }

        .alert-warning {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #92400e;
        }

        .alert-success {
            background: #dcfce7;
            border-color: #22c55e;
            color: #166534;
        }

        .tips-box {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border: 2px solid #3b82f6;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            font-size: 13px;
        }

        .tips-title {
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tips-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .tips-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            color: #1e40af;
        }

        .tips-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            font-weight: 700;
            color: #22c55e;
        }

        .strength-analyzer {
            background: #fff;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
        }

        .strength-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .strength-score {
            font-size: 32px;
            font-weight: 700;
            line-height: 1;
        }

        .strength-meter {
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }

        .strength-meter-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #22c55e 100%);
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .factors-list {
            margin-top: 15px;
        }

        .factor-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            font-size: 13px;
        }

        .factor-item.improve {
            background: #fef3c7;
            border-left: 3px solid #f59e0b;
        }

        .factor-item.strong {
            background: #dcfce7;
            border-left: 3px solid #22c55e;
        }

        .factor-icon {
            font-size: 16px;
            flex-shrink: 0;
        }

        .factor-text {
            flex: 1;
            color: #1e293b;
        }

        .factor-impact {
            font-size: 11px;
            font-weight: 600;
            color: #64748b;
            white-space: nowrap;
        }

        .next-steps-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .next-steps-content {
            background: white;
            border-radius: 12px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .next-steps-header {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 12px 12px 0 0;
        }

        .next-steps-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .next-steps-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .next-steps-body {
            padding: 30px;
        }

        .step-section {
            margin-bottom: 25px;
        }

        .step-section-title {
            font-size: 16px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checklist {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8fafc;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checklist-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .checklist-item label {
            flex: 1;
            cursor: pointer;
            font-size: 14px;
            color: #1e293b;
        }

        .checklist-item.completed {
            opacity: 0.6;
        }

        .checklist-item.completed label {
            text-decoration: line-through;
        }

        .timeline-item {
            padding: 12px 16px;
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            border-radius: 4px;
            margin-bottom: 10px;
            font-size: 13px;
        }

        .timeline-date {
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 4px;
        }

        .timeline-desc {
            color: #475569;
        }

        .next-steps-footer {
            padding: 20px 30px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .preview-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #1e40af;
        }

        @media (max-width: 1200px) {
            .form-panel {
                padding: 20px;
            }

            .preview-panel {
                padding: 20px;
            }

            .preview-document {
                padding: 30px 20px;
            }

            .form-section {
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            .form-panel {
                padding: 15px;
            }

            .preview-panel {
                padding: 15px;
            }

            .preview-document {
                padding: 20px 15px;
            }
        }

        @media print {
            .form-panel,
            .button-group {
                display: none;
            }

            .generator-container {
                grid-template-columns: 1fr;
            }

            .preview-panel {
                padding: 0;
            }

            .preview-document {
                box-shadow: none;
                padding: 0;
            }
        }

        .input-hint {
            font-size: 12px;
            color: #64748b;
            margin-top: 4px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const PayPalDemandGenerator = () => {
            // Form state
            const [accountType, setAccountType] = useState('business');
            const [fullName, setFullName] = useState('');
            const [email, setEmail] = useState('');
            const [phone, setPhone] = useState('');
            const [address, setAddress] = useState('');
            const [state, setState] = useState('');

            const [holdType, setHoldType] = useState('limited');
            const [amountHeld, setAmountHeld] = useState('');
            const [holdDate, setHoldDate] = useState('');
            const [limitationType, setLimitationType] = useState('temporary');

            const [reasonGiven, setReasonGiven] = useState('no_explanation');
            const [specificReason, setSpecificReason] = useState('');

            const [businessDescription, setBusinessDescription] = useState('');
            const [chargebackCount, setChargebackCount] = useState('0');
            const [disputeCount, setDisputeCount] = useState('0');
            const [days180Mentioned, setDays180Mentioned] = useState(false);
            const [days180Date, setDays180Date] = useState('');
            const [past180Days, setPast180Days] = useState(false);

            const [harmDescription, setHarmDescription] = useState('');
            const [seekDamages, setSeekDamages] = useState(false);
            const [estimatedDamages, setEstimatedDamages] = useState('');
            const [missedPayments, setMissedPayments] = useState('');
            const [businessImpact, setBusinessImpact] = useState('');

            const [preferredForum, setPreferredForum] = useState('aaa');
            const [attachArbDemand, setAttachArbDemand] = useState(true);
            const [hearingPreference, setHearingPreference] = useState('documents');

            const [signature, setSignature] = useState('');

            const [highlightedSection, setHighlightedSection] = useState('');
            const [showNextSteps, setShowNextSteps] = useState(false);
            const [checkedSteps, setCheckedSteps] = useState({});
            const previewRef = useRef(null);

            const currentDate = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const reasonLookup = {
                'aup_violation': 'alleged Acceptable Use Policy violation',
                'high_risk': 'designation as "high risk" activity',
                'unusual_activity': 'unusual or suspicious activity',
                'too_many_disputes': 'excessive disputes or chargebacks',
                'verification_needed': 'additional verification required',
                'no_explanation': 'no specific explanation provided'
            };

            const getReasonText = () => reasonLookup[reasonGiven];

            const formatCurrency = (value) => {
                if (!value || isNaN(parseFloat(value))) return 'Not specified';
                return '$' + parseFloat(value).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            };

            // Helper to format state/jurisdiction properly (DC is not a state)
            const getJurisdictionPhrase = () => {
                if (!state) return '';
                if (state === 'District of Columbia') {
                    return 'the District of Columbia';
                }
                return state;
            };

            const getStateLawPhrase = () => {
                if (!state) return '';
                if (state === 'District of Columbia') {
                    return 'District of Columbia';
                }
                return state;
            };

            // Auto-scroll and highlight function
            const scrollToSection = (sectionId) => {
                setHighlightedSection(sectionId);
                setTimeout(() => {
                    const element = document.getElementById(sectionId);
                    if (element && previewRef.current) {
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 100);
                setTimeout(() => setHighlightedSection(''), 2000);
            };

            // Generate demand letter
            const generateDemandLetter = () => {
                const sections = [];

                // Header
                sections.push({
                    id: 'header',
                    content: `<div class="preview-header">
                        <p><strong>FORMAL NOTICE OF DISPUTE</strong></p>
                        <p><strong>PayPal Account Freeze/Restriction</strong></p>
                        <p><strong>VIA EMAIL AND CERTIFIED MAIL</strong></p>
                        <p>Date: ${currentDate}</p>
                    </div>`
                });

                // Address
                sections.push({
                    id: 'address',
                    content: `<p>To: <strong>PayPal, Inc.</strong><br/>
                    Attn: Legal Specialists – Notice of Dispute<br/>
                    P.O. Box 45950<br/>
                    Omaha, NE 68145-0950</p>
                    <p><strong>RE: Formal Notice of Dispute and Demand for Release of Funds – PayPal Account ${email || '[Your Email]'}</strong></p>`
                });

                // Opening paragraph
                sections.push({
                    id: 'opening',
                    content: `<p>Dear Legal Specialists,</p>
                    <p></p>
                    <p>I am writing to provide PayPal, Inc. with a formal <strong>Notice of Dispute</strong> regarding the ${holdType === 'limited' ? 'limitation' : holdType === 'reserve' ? 'reserve' : 'hold'} placed on my PayPal account and the resulting hold on my funds. This notice is sent pursuant to the "Agreement to Arbitrate" and "Notices of Disputes" provisions in the PayPal User Agreement in effect for my account.</p>
                    ${attachArbDemand ? `<p>For clarity and to facilitate resolution, I am attaching a <strong>draft Demand for Arbitration</strong> that I am prepared to file with the American Arbitration Association if this matter is not resolved within the contractual 45-day period.</p>` : ''}`
                });

                // Account information
                sections.push({
                    id: 'account-info',
                    content: `<p><strong>I. ACCOUNT AND CONTACT INFORMATION</strong></p>
                    <p></p>
                    <p>My information is as follows:</p>
                    <p>• Name: <strong>${fullName || '[Your Full Name]'}</strong><br/>
                    • Mailing address: <strong>${address || '[Your Address]'}</strong><br/>
                    • Email associated with PayPal account: <strong>${email || '[Your Email]'}</strong><br/>
                    • Telephone number: <strong>${phone || '[Your Phone]'}</strong><br/>
                    • PayPal account type: <strong>${accountType === 'business' ? 'Business' : 'Personal'}</strong><br/>
                    </p>`
                });

                // Background and description
                const reasonText = getReasonText();

                sections.push({
                    id: 'background',
                    content: `<p><strong>II. BACKGROUND AND DESCRIPTION OF THE DISPUTE</strong></p>
                    <p></p>
                    <p>${businessDescription ? `I operate ${businessDescription}.` : `I ${accountType === 'business' ? 'operate a business' : 'use PayPal for personal transactions'}.`} I have used PayPal to ${accountType === 'business' ? 'receive payments' : 'send and receive funds'} ${holdDate ? 'since before ' + new Date(holdDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long' }) : 'for some time'}.</p>
                    <p>On or about <strong>${holdDate ? new Date(holdDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : '[Date]'}</strong>, PayPal placed a ${holdType === 'limited' ? 'limitation' : holdType === 'reserve' ? 'reserve' : 'hold'} on my account. At that time, the account balance held by PayPal was approximately <strong>${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'}</strong>. Since the ${holdType === 'limited' ? 'limitation' : holdType === 'reserve' ? 'reserve' : 'hold'} was imposed, I have been unable to withdraw these funds or to use my PayPal balance in the ordinary course of ${accountType === 'business' ? 'business' : 'my financial affairs'}.</p>
                    <p>PayPal's communications to me about this ${holdType === 'limited' ? 'limitation' : holdType === 'reserve' ? 'reserve' : 'hold'} have indicated that the reason for this action was <strong>${reasonText}</strong>${specificReason ? ': ' + specificReason : ''}${days180Mentioned ? `, and that funds might be held for up to 180 days${days180Date ? ' (until approximately ' + new Date(days180Date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) + ')' : ''}` : ''}.</p>
                    <p>Despite ${accountType === 'business' ? 'my efforts to provide documentation, respond to all requests, and explain my legitimate business model' : 'my cooperation and provision of requested information'}, my account remains ${limitationType === 'permanent' ? 'permanently limited' : 'limited'}, and PayPal continues to hold approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'} of my funds. I have not received a clear explanation that ties my specific facts to any particular contractual provision in the User Agreement.</p>`
                });

                // Contract framework
                sections.push({
                    id: 'contract',
                    content: `<p><strong>III. APPLICABLE CONTRACT FRAMEWORK</strong></p>
                    <p></p>
                    <p>I understand that my relationship with PayPal is governed by the PayPal User Agreement${accountType === 'business' ? ', PayPal Balance Terms and Conditions, and related merchant agreements' : ' and related policies'}, including the provisions regarding holds, limitations, reserves, and the Agreement to Arbitrate.</p>
                    <p>I also understand that PayPal may in some circumstances place holds on funds or impose reserves in order to protect against chargebacks, reversals, fines, and other liabilities. Those powers, however, are not unlimited. They must be exercised consistently with the express terms of the User Agreement and the implied covenant of good faith and fair dealing that applies to all contracts under Delaware law.</p>
                    <p>In my situation, PayPal's continuing hold and limitation are not reasonably tailored to any legitimate risk that remains, for several reasons:</p>
                    <p>• The number of actual chargebacks or buyer disputes on my account is <strong>${chargebackCount || 'zero'} chargebacks and ${disputeCount || 'zero'} disputes</strong>${(parseInt(chargebackCount) === 0 && parseInt(disputeCount) === 0) ? ', which demonstrates that my account presents minimal risk' : ', which is within normal industry parameters for legitimate businesses'}.<br/>
                    ${businessDescription ? `• My business model (${businessDescription}) is legitimate and involves ${accountType === 'business' ? 'delivery of real goods/services' : 'ordinary personal transactions'}.<br/>` : ''}
                    ${past180Days ? `• The 180-day hold period ${days180Date ? 'referenced in PayPal\'s notice' : 'commonly applied to account limitations'} has already passed${days180Date ? ' (it ended on ' + new Date(days180Date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) + ')' : ''}, meaning any chargeback windows have effectively closed.<br/>` : ''}
                    • ${reasonGiven === 'no_explanation' ? 'PayPal has provided no specific explanation for the hold beyond generic policy language.' : 'Any initial concern about ' + reasonText + ' has been fully addressed through the information I have provided.'}
                    </p>
                    <p>In light of these facts, an ongoing or indefinite hold on the full balance in my account is not consistent with the purposes for which the hold and reserve provisions exist in the User Agreement.</p>`
                });

                // Legal theories
                sections.push({
                    id: 'legal-theories',
                    content: `<p><strong>IV. LEGAL THEORIES AND NATURE OF MY CLAIMS</strong></p>
                    <p></p>
                    <p>Without limiting any additional rights, I believe PayPal's conduct gives rise to the following claims:</p>
                    <p><strong>1. Breach of contract</strong>, because PayPal has continued to hold funds and maintain a limitation in a manner that is inconsistent with the language and purpose of the hold, limitation, and reserve provisions in the User Agreement${accountType === 'business' ? ', Balance Terms, and Online Payment Services Agreement' : ''}, and has failed to release unrestricted funds once any reasonable risk of chargebacks or reversals was past.</p>
                    <p><strong>2. Breach of the implied covenant of good faith and fair dealing</strong> under Delaware law, because PayPal has exercised its contractual discretion to impose and maintain a hold in a way that is arbitrary and that frustrates my reasonable expectations${accountType === 'business' ? ' of being paid for delivered goods or services' : ''}. Those expectations include timely access to funds that have already been paid${accountType === 'business' ? ' by my customers' : ''} and that are no longer subject to meaningful risk of reversal.</p>
                    <p><strong>3. Unjust enrichment and related restitutionary theories</strong>, to the extent allowed by applicable law, because PayPal has continued to benefit from the use of my funds and from the fees paid on the underlying transactions while depriving me of the ability to use those funds for my own ${accountType === 'business' ? 'business' : 'personal'} needs without a contractually legitimate basis.</p>
                    ${state ? `<p><strong>4. Violations of consumer protection or unfair practices statutes</strong> under ${getStateLawPhrase()} law, to the extent those statutes apply, insofar as PayPal's communications about holds and risk management are misleading, inconsistent, or materially incomplete.</p>` : ''}`
                });

                // Harm and damages
                sections.push({
                    id: 'harm',
                    content: `<p><strong>V. HARM AND DAMAGES</strong></p>
                    <p></p>
                    <p>As a direct result of this limitation and hold, I have suffered significant harm, including but not limited to:</p>
                    <p>• Loss of access to approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'} in funds that I reasonably expected to use for ${accountType === 'business' ? 'business operations, inventory, payroll, taxes, or other business needs' : 'personal expenses and obligations'}.<br/>
                    ${harmDescription ? `• ${harmDescription}<br/>` : ''}
                    ${missedPayments ? `• Unable to meet the following financial obligations: ${missedPayments}.<br/>` : ''}
                    ${businessImpact ? `• ${businessImpact}.<br/>` : ''}
                    ${estimatedDamages ? `• Estimated consequential damages of approximately $${parseFloat(estimatedDamages).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} in lost profits, financing costs, and other economic harm.<br/>` : ''}
                    • Time and expense spent attempting to resolve this matter through PayPal's support channels and documentation requests, as well as the need to seek legal assistance.
                    </p>
                    <p>My losses continue to grow for as long as PayPal maintains the limitation and hold.</p>`
                });

                // Relief sought
                sections.push({
                    id: 'relief',
                    content: `<p><strong>VI. RELIEF SOUGHT</strong></p>
                    <p></p>
                    <p>Through this Notice of Dispute and demand, I am asking PayPal to:</p>
                    <p><strong>Primary Request:</strong> Immediately remove any unjustified limitation or reserve on my account and promptly release the full balance of my available funds, currently approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'}, to me by withdrawal to my linked bank account or other agreed method.</p>
                    <p><strong>Alternative Resolution:</strong> If PayPal believes that only a partial release is appropriate, I request a detailed explanation of the specific risk being covered, the exact amount retained for that purpose, and the contractual justification for that figure, along with a specific timeline for release of the retained portion.</p>
                    <p><strong>Minimum Acceptable Resolution:</strong> At minimum, if funds cannot be immediately released, I require a substantive response explaining the specific basis for the continued hold, what regulatory authority requires it, and what concrete steps would lead to release.</p>
                    ${seekDamages ? `<p><strong>Additional Relief:</strong> Compensation for documented consequential damages, including lost business opportunities, emergency financing costs, and other economic harm caused by the improper withholding of my funds, to the extent allowed by applicable law and the arbitrator's discretion.</p>` : ''}`
                });

                // Notice of intent to arbitrate
                sections.push({
                    id: 'arbitration-notice',
                    content: `<p><strong>VII. NOTICE OF INTENT TO ARBITRATE</strong></p>
                    <p></p>
                    <p>This letter is intended to fully satisfy the Notice of Dispute requirements in the Agreement to Arbitrate section of the PayPal User Agreement. It includes my contact information, account information, a description of the nature and basis of the claims, a statement of the specific relief sought, and identifies relevant documents that I am prepared to provide in support of my position.</p>
                    <p>If PayPal does not resolve this dispute within forty-five (45) days after receiving this Notice of Dispute, I intend to pursue my claims in binding arbitration administered by the American Arbitration Association under the AAA Consumer Arbitration Rules.</p>
                    ${attachArbDemand ? `<p>The attached draft Demand for Arbitration reflects how I currently expect to present my claims if arbitration becomes necessary. It is provided now to encourage an informed and efficient discussion and is not a waiver of any rights.</p>` : ''}`
                });

                // Documents available
                sections.push({
                    id: 'documents',
                    content: `<p><strong>VIII. DOCUMENTS AND INFORMATION AVAILABLE</strong></p>
                    <p></p>
                    <p>In support of my position, I am prepared to provide, and in many cases have already provided through the PayPal Resolution Center, documents that include:</p>
                    <p>• Screenshots of my PayPal account history showing the limitation and the amounts held<br/>
                    • Transaction records${accountType === 'business' ? ' and invoices' : ''} for the payments at issue<br/>
                    ${accountType === 'business' ? '• Business formation documents and tax records demonstrating legitimate business operations<br/>' : ''}
                    • Communications with ${accountType === 'business' ? 'customers and any' : 'any'} dispute or chargeback documentation<br/>
                    • Prior correspondence with PayPal support and the Resolution Center
                    </p>
                    <p>If additional documents or clarifications would assist in resolving this matter promptly, I am willing to provide them upon request.</p>
                    <p>Please direct all written responses regarding this Notice of Dispute to the mailing address and email listed at the beginning of this letter.</p>
                    <p>I look forward to a prompt and good faith response.</p>`
                });

                // Signature
                sections.push({
                    id: 'signature',
                    content: `<div class="signature-section">
                        <p>Sincerely,</p>
                        ${signature ? `<p class="signature-input" style="text-align: left; border: none; padding: 10px 0; font-size: 28px;">${signature}</p>` : '<p>[Signature]</p>'}
                        <p><strong>${fullName || '[Your Name]'}</strong><br/>
                        ${address || '[Your Address]'}<br/>
                        ${email || '[Your Email]'}<br/>
                        ${phone || '[Your Phone]'}
                        </p>
                        ${attachArbDemand ? `<p><strong>Enclosure:</strong> Draft Demand for Arbitration</p>` : ''}
                    </div>`
                });

                return sections;
            };

            // Generate arbitration demand
            const generateArbDemand = () => {
                if (!attachArbDemand) return null;

                return `<div style="page-break-before: always; margin-top: 60px; padding-top: 40px; border-top: 4px solid #1e40af;">
                    <p style="text-align: center;"><strong style="font-size: 18px;">DRAFT DEMAND FOR ARBITRATION</strong></p>
                    <p style="text-align: center;"><strong>(For Filing with AAA if Dispute Not Resolved)</strong></p>

                    <p><strong>In the Matter of the Arbitration Between</strong></p>

                    <p>
                    <strong>${fullName || '[Your Name]'}</strong>,<br/>
                    Claimant,
                    </p>

                    <p>and</p>

                    <p>
                    <strong>PayPal, Inc.</strong>,<br/>
                    Respondent.
                    </p>

                    <p><strong>DEMAND FOR ARBITRATION</strong></p>

                    <p>Claimant, ${fullName || '[Your Name]'}, demands arbitration of the dispute described below against PayPal, Inc., pursuant to the Agreement to Arbitrate in the PayPal User Agreement and the applicable American Arbitration Association rules.</p>

                    <p><strong>1. PARTIES AND CONTACT INFORMATION</strong></p>

                    <p>
                    <strong>Claimant:</strong><br/>
                    Name: ${fullName || '[Your Full Name]'}<br/>
                    Mailing address: ${address || '[Your Address]'}<br/>
                    Telephone: ${phone || '[Your Phone]'}<br/>
                    Email: ${email || '[Your Email]'}
                    </p>

                    <p>
                    <strong>Respondent:</strong><br/>
                    PayPal, Inc.<br/>
                    2211 North First Street<br/>
                    San Jose, California 95131
                    </p>

                    <p><strong>2. ARBITRATION AGREEMENT AND APPLICABLE RULES</strong></p>

                    <p>This dispute arises out of and relates to claimant's use of PayPal's services under the PayPal User Agreement. That agreement contains an Agreement to Arbitrate that requires most disputes between claimant and PayPal to be resolved through binding arbitration or in small claims court.</p>

                    <p>Claimant has elected to proceed in arbitration.</p>

                    <p>Because the value of the relief sought is ${amountHeld && parseFloat(amountHeld) <= 10000 ? 'ten thousand dollars ($10,000) or less' : 'more than ten thousand dollars ($10,000)'}, claimant requests that the AAA apply the <strong>Consumer Arbitration Rules</strong> to this dispute as provided in the PayPal User Agreement.</p>

                    <p>To the extent applicable, claimant also invokes the Federal Arbitration Act as the law governing the arbitration agreement.</p>

                    <p><strong>3. COMPLIANCE WITH THE NOTICE OF DISPUTE REQUIREMENT</strong></p>

                    <p>On ${currentDate}, claimant sent PayPal a written Notice of Dispute by certified mail to the address specified in the PayPal User Agreement (P.O. Box 45950, Omaha, NE 68145-0950), describing the nature and basis of the claims, the relief sought, and attaching supporting documents.</p>

                    <p>More than forty-five (45) days have passed since PayPal received that notice, and the dispute has not been resolved. Claimant has therefore satisfied the contractual pre-arbitration notice requirement and is entitled to initiate this arbitration.</p>

                    <p><strong>4. NATURE OF THE DISPUTE AND FACTUAL BACKGROUND</strong></p>

                    <p>${businessDescription ? `Claimant operates ${businessDescription} and` : `Claimant`} has used PayPal to ${accountType === 'business' ? 'receive payments' : 'send and receive funds'} ${holdDate ? 'since before ' + new Date(holdDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long' }) : 'for some time'}.</p>

                    <p>On or about ${holdDate ? new Date(holdDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : '[Date]'}, PayPal placed a ${holdType === 'limited' ? 'limitation' : holdType === 'reserve' ? 'reserve' : 'hold'} on claimant's account and began holding approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'} in funds that had already been received from ${accountType === 'business' ? 'customers' : 'other parties'}.</p>

                    <p>PayPal's explanation for this action was ${(() => {
                        const reasons = {
                            'aup_violation': 'alleged violation of the Acceptable Use Policy',
                            'high_risk': 'designation of claimant\'s activity as "high risk"',
                            'unusual_activity': 'alleged unusual or suspicious activity',
                            'too_many_disputes': 'alleged excessive disputes or chargebacks',
                            'verification_needed': 'need for additional verification',
                            'no_explanation': 'not clearly explained; PayPal provided only generic policy language'
                        };
                        return reasons[reasonGiven] || 'not clearly explained';
                    })()}${specificReason ? ': ' + specificReason : ''}. Claimant has consistently ${reasonGiven === 'aup_violation' ? 'denied any violation of the Acceptable Use Policy and has' : ''} provided documentation to show that the underlying transactions were legitimate${accountType === 'business' ? ' and that goods or services were delivered' : ''}.</p>

                    <p>Since the limitation or hold began, claimant has responded to all requests for documentation, provided ${accountType === 'business' ? 'invoices, tracking numbers, customer communications,' : ''} and other evidence, and attempted to communicate with PayPal support multiple times without receiving a clear, individualized explanation or path to resolution.</p>

                    <p>Despite these efforts, PayPal has continued to hold claimant's funds${past180Days ? ', even after the 180-day period mentioned in PayPal\'s communications has expired' : days180Mentioned ? ' and has cited a standard period of up to 180 days without addressing why such a long hold is actually necessary given the transaction history' : ' without providing a specific timeline for release'}.</p>

                    <p><strong>5. CLAIMS</strong></p>

                    <p>Without limiting any additional claims that may be recognized in claimant's jurisdiction, claimant asserts the following causes of action against PayPal:</p>

                    <p><strong>1. Breach of contract</strong> for failing to administer the limitation and fund hold in conformity with the PayPal User Agreement${accountType === 'business' ? ', Balance Terms, and Online Payment Services Agreement' : ''}, including failing to release unrestricted funds in a timely manner once any legitimate risk of chargebacks, reversals, or regulatory exposure passed.</p>

                    <p><strong>2. Breach of the implied covenant of good faith and fair dealing</strong> under Delaware law for exercising contractual discretion to restrict claimant's access to funds in an arbitrary and unreasonable manner that undermines the basic purpose of the agreement and claimant's reasonable expectations${accountType === 'business' ? ' of being paid for delivered goods or services' : ''}.</p>

                    <p><strong>3. Unjust enrichment and related restitutionary theories</strong>, because PayPal has retained the benefit of claimant's funds and of the transaction fees while depriving claimant of the use of those funds without a legitimate contractual justification.</p>

                    ${state ? `<p><strong>4. Violations of applicable consumer protection or unfair practices statutes</strong> under ${getStateLawPhrase()} law, to the extent applicable, based on misleading, opaque, or unfair practices in the way PayPal has handled claimant's account and maintained its limitation.</p>` : ''}

                    <p>Claimant reserves the right to clarify, refine, or supplement these legal theories as the arbitration proceeds, consistent with the applicable rules.</p>

                    <p><strong>6. AMOUNT IN CONTROVERSY</strong></p>

                    <p>The amount in controversy consists of:</p>

                    <p>
                    • The principal sum of funds held, currently approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'}, plus<br/>
                    • Interest on that amount from the date the hold was imposed until the date of release or award, and<br/>
                    ${seekDamages ? '• Additional consequential damages to the extent allowed by the arbitrator, such as lost profits, costs incurred in mitigating harm, and expenses associated with attempting to resolve the dispute.<br/>' : ''}
                    </p>

                    <p>For AAA administrative purposes, claimant estimates the value of the claim at approximately ${amountHeld ? '$' + parseFloat(amountHeld).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '$[Amount]'}.</p>

                    <p><strong>7. RELIEF REQUESTED</strong></p>

                    <p>Claimant requests that the arbitrator enter an award that includes the following relief:</p>

                    <p>
                    1. A declaration that PayPal's hold, limitation, or reserve as applied to claimant's account was not justified under the PayPal User Agreement, or that its duration and scope were unreasonable given the facts.<br/>
                    <br/>
                    2. An order requiring PayPal to immediately release all funds currently held in connection with claimant's account, together with any accrued interest where appropriate.<br/>
                    <br/>
                    3. An award of money damages, in an amount to be proven, to compensate claimant for ${accountType === 'business' ? 'business losses' : 'economic harm'}, out-of-pocket expenses, and other harm caused by PayPal's actions.<br/>
                    <br/>
                    4. An award of claimant's arbitration filing fee and any other costs that the arbitrator determines should be shifted to PayPal, to the extent consistent with applicable law and the AAA Consumer Arbitration Rules.<br/>
                    <br/>
                    5. Any other relief that the arbitrator deems just and appropriate under the circumstances.
                    </p>

                    <p><strong>8. FEES AND REQUESTED ALLOCATION</strong></p>

                    <p>Because the amount of relief sought is ${amountHeld && parseFloat(amountHeld) <= 10000 ? 'ten thousand dollars ($10,000) or less' : 'more than ten thousand dollars ($10,000)'}, claimant requests that the AAA and the arbitrator apply the fee allocation provisions in the PayPal User Agreement and the AAA Consumer Arbitration Rules.</p>

                    ${amountHeld && parseFloat(amountHeld) <= 10000 ? `<p>For claims of ten thousand dollars ($10,000) or less, claimant specifically requests that PayPal be required to pay all AAA filing, administration, and arbitrator fees directly to the AAA, consistent with the promise in its arbitration agreement.</p>` : `<p>Claimant requests that PayPal be required to pay at least that portion of the AAA fees that is necessary to prevent the cost of arbitration from becoming prohibitive compared to small claims or other court proceedings.</p>`}

                    <p><strong>9. LOCALE AND HEARING FORMAT</strong></p>

                    <p>Claimant resides in ${state ? getJurisdictionPhrase() : '[State]'} and requests that the arbitration locale be set in ${state ? getJurisdictionPhrase() : '[location]'} in accordance with the PayPal User Agreement${state ? ' and AAA rules providing for hearings in the county where the consumer resides' : ''}.</p>

                    <p>Given the size of the dispute and the nature of the issues, claimant requests that the matter be decided ${hearingPreference === 'documents' ? 'on written submissions only, without an in-person hearing' : hearingPreference === 'remote' ? 'via telephonic or video conference hearing' : 'with an in-person hearing in ' + (state ? getJurisdictionPhrase() : '[claimant\'s location]')}${hearingPreference === 'documents' ? ', consistent with AAA Consumer Rules providing for documents-only resolution of claims under $25,000' : ''}.</p>

                    <p><strong>10. RESERVATION OF RIGHTS</strong></p>

                    <p>Claimant reserves the right to supplement or amend this Demand for Arbitration as additional facts or legal issues emerge and as permitted by the AAA rules and the arbitrator's orders.</p>

                    <p style="margin-top: 40px;">
                    Date: ${currentDate}
                    </p>

                    ${signature ? `<p class="signature-input" style="text-align: left; border: none; padding: 10px 0; font-size: 28px;">${signature}</p>` : '<p>[Signature]</p>'}

                    <p>
                    <strong>${fullName || '[Your Name]'}</strong><br/>
                    Claimant
                    </p>
                </div>`;
            };

            const demandSections = generateDemandLetter();
            const arbDemand = generateArbDemand();

            const copyToClipboard = () => {
                const content = demandSections.map(s => s.content).join('\n\n') + (arbDemand || '');
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = content;
                const text = tempDiv.innerText;

                navigator.clipboard.writeText(text).then(() => {
                    alert('Copied to clipboard!');
                }).catch(() => {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('Copied to clipboard!');
                });
            };

            const handleESignature = async () => {
                // Validate required fields
                if (!fullName || !email) {
                    alert('❌ Missing Required Information\n\nPlease provide:\n• Full Legal Name\n• Email Address\n\nThese fields are required for eSignature.');
                    return;
                }

                const confirmSend = confirm(
                    `📧 Send for Electronic Signature?\n\n` +
                    `This will create a legally binding eSignature request.\n\n` +
                    `Document will be sent to:\n` +
                    `Name: ${fullName}\n` +
                    `Email: ${email}\n\n` +
                    `Click OK to proceed with eSignature creation.`
                );

                if (!confirmSend) return;

                try {
                    // Generate full document text
                    const demandLetterText = demandSections.map(s => {
                        const div = document.createElement('div');
                        div.innerHTML = s.content;
                        return div.innerText;
                    }).join('\n\n');

                    const arbDemandText = arbDemand ? (() => {
                        const div = document.createElement('div');
                        div.innerHTML = arbDemand;
                        return div.innerText;
                    })() : '';

                    const finalDocumentText = demandLetterText + (arbDemandText ? '\n\n' + '='.repeat(80) + '\nARBITRATION DEMAND (ATTACHMENT)\n' + '='.repeat(80) + '\n\n' + arbDemandText : '');

                    const documentTitle = attachArbDemand ? 'PayPal Demand Letter with Arbitration Demand' : 'PayPal Demand Letter';

                    const apiData = {
                        test: "no",
                        template: {
                            title: documentTitle,
                            content: finalDocumentText,
                            content_type: "text"
                        },
                        signers: [{
                            email: email,
                            name: fullName,
                            role: "signer"
                        }]
                    };

                    console.log('Sending to eSignature API:', apiData);

                    // Try Node.js proxy
                    const response = await fetch('http://localhost:3001/esign-proxy', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(apiData)
                    });

                    const result = await response.json();
                    console.log('eSignature API response:', result);

                    if (response.ok && result.status === 'success' && result.data?.signing_url) {
                        // Open signing URL in new window
                        window.open(result.data.signing_url, '_blank', 'width=1000,height=800,scrollbars=yes,resizable=yes');
                        alert(`✅ eSignature Document Created!\n\nContract ID: ${result.data.contract_id}\n\nA new window has opened with your document ready for signature.\n\nAn email has also been sent to ${email} with the signing link.`);
                    } else {
                        throw new Error(result.error || 'eSignature creation failed');
                    }

                } catch (error) {
                    console.error('eSignature error:', error);
                    alert(`❌ eSignature Service Unavailable\n\nThe eSignature service is currently unavailable.\n\nError: ${error.message}\n\nPlease try:\n1. Using the "Copy to Clipboard" button to save your document\n2. Using the "Print" button to create a PDF\n3. Contacting support if you need eSignature assistance`);
                }
            };

            const holdDateDisplay = holdDate ? new Date(holdDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : null;
            const daysSinceHold = holdDate ? Math.max(0, Math.round((Date.now() - new Date(holdDate).getTime()) / (1000 * 60 * 60 * 24))) : null;

            const totalClaimAmount = (() => {
                const principal = parseFloat(amountHeld) || 0;
                const damages = parseFloat(estimatedDamages) || 0;
                return principal + damages;
            })();

            const summaryDetails = [
                { label: 'Account Type', value: accountType === 'business' ? 'Business' : 'Personal' },
                { label: 'Hold Type', value: holdType === 'limited' ? 'Account Limitation' : holdType === 'reserve' ? 'Reserve' : 'Payment Hold' },
                { label: 'Funds Held', value: formatCurrency(amountHeld) },
                { label: 'Hold Date', value: holdDateDisplay || 'Not specified' },
                { label: 'Days Since Hold', value: daysSinceHold !== null ? `${daysSinceHold} days` : 'Not specified' },
                { label: 'Reason Cited', value: getReasonText() },
                { label: '180-Day Status', value: past180Days ? '✓ Passed' : days180Mentioned ? `Expected ${days180Date ? new Date(days180Date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : 'TBD'}` : 'Not applicable' },
                { label: 'Additional Damages', value: estimatedDamages ? formatCurrency(estimatedDamages) : 'None claimed' },
                { label: 'Total Claim', value: formatCurrency(totalClaimAmount.toString()) },
                { label: 'Chargebacks/Disputes', value: `${chargebackCount || '0'} / ${disputeCount || '0'}` },
                { label: 'AAA Fees', value: parseFloat(amountHeld) <= 10000 ? '✓ PayPal pays all fees' : 'Filing fee ~$200-300' },
                { label: 'Arbitration Demand', value: attachArbDemand ? '✓ Attached' : 'Not attached' }
            ];

            // Enhanced Case Strength Analyzer
            const caseStrength = (() => {
                let score = 0;
                let maxScore = 100;
                const factors = [];

                // Factor 1: Basic Information Completeness (20 points)
                let infoScore = 0;
                if (fullName) infoScore += 4;
                if (email) infoScore += 4;
                if (phone) infoScore += 3;
                if (address) infoScore += 3;
                if (state) infoScore += 3;
                if (signature) infoScore += 3;
                score += infoScore;
                if (infoScore < 15) factors.push({ type: 'improve', text: 'Complete all contact information fields', impact: '+' + (20 - infoScore) + ' points' });

                // Factor 2: Hold Details Specificity (15 points)
                let holdScore = 0;
                if (amountHeld && parseFloat(amountHeld) > 0) holdScore += 8;
                if (holdDate) holdScore += 7;
                score += holdScore;
                if (!amountHeld) factors.push({ type: 'improve', text: 'Specify the exact amount held', impact: '+8 points' });
                if (!holdDate) factors.push({ type: 'improve', text: 'Provide the hold start date', impact: '+7 points' });

                // Factor 3: Business/Account History (15 points)
                let historyScore = 0;
                if (businessDescription && businessDescription.length > 20) historyScore += 8;
                if (chargebackCount === '0' && disputeCount === '0') historyScore += 7;
                else if (parseInt(chargebackCount) < 3 && parseInt(disputeCount) < 5) historyScore += 4;
                score += historyScore;
                if (!businessDescription || businessDescription.length < 20) factors.push({ type: 'improve', text: 'Add detailed business/account description', impact: '+8 points' });
                if (parseInt(chargebackCount) > 0 || parseInt(disputeCount) > 2) factors.push({ type: 'strong', text: 'Low chargeback/dispute rate strengthens case', impact: 'positive' });

                // Factor 4: Timeline Advantage (20 points)
                let timeScore = 0;
                if (past180Days) {
                    timeScore += 20;
                    factors.push({ type: 'strong', text: '180-day period passed - very strong position', impact: '+20 points' });
                } else if (daysSinceHold > 90) {
                    timeScore += 12;
                    factors.push({ type: 'strong', text: 'Hold duration exceeds 90 days', impact: '+12 points' });
                } else if (daysSinceHold > 45) {
                    timeScore += 8;
                }
                score += timeScore;

                // Factor 5: Documented Harm (15 points)
                let harmScore = 0;
                if (harmDescription && harmDescription.length > 30) harmScore += 6;
                if (missedPayments && missedPayments.length > 10) harmScore += 5;
                if (businessImpact && businessImpact.length > 10) harmScore += 4;
                score += harmScore;
                if (!harmDescription || harmDescription.length < 30) factors.push({ type: 'improve', text: 'Provide detailed harm description', impact: '+6 points' });
                if (!missedPayments) factors.push({ type: 'improve', text: 'List specific missed payments/obligations', impact: '+5 points' });

                // Factor 6: Amount at Stake (10 points)
                let amountScore = 0;
                const amt = parseFloat(amountHeld);
                if (amt > 0 && amt <= 10000) {
                    amountScore = 10;
                    factors.push({ type: 'strong', text: 'Amount under $10k - PayPal pays all AAA fees', impact: 'strategic advantage' });
                } else if (amt > 10000 && amt <= 25000) {
                    amountScore = 8;
                } else if (amt > 25000) {
                    amountScore = 6;
                }
                score += amountScore;

                // Factor 7: Arbitration Strategy (5 points)
                if (attachArbDemand) {
                    score += 5;
                    factors.push({ type: 'strong', text: 'Including arbitration demand shows seriousness', impact: '+5 points' });
                } else {
                    factors.push({ type: 'improve', text: 'Attach arbitration demand to strengthen position', impact: '+5 points' });
                }

                return { score, factors, maxScore };
            })();

            const strengthLevel = caseStrength.score >= 75 ? 'strong' : caseStrength.score >= 50 ? 'moderate' : 'developing';
            const strengthLabel = strengthLevel === 'strong' ? '💪 Strong Case' : strengthLevel === 'moderate' ? '👍 Moderate Case' : '📝 Developing Case';
            const strengthColor = strengthLevel === 'strong' ? '#166534' : strengthLevel === 'moderate' ? '#92400e' : '#64748b';

            const riskScore = (() => {
                let score = 0;
                const amount = parseFloat(amountHeld);
                if (!isNaN(amount)) {
                    if (amount > 50000) score += 2;
                    else if (amount > 10000) score += 1;
                }
                if (holdType === 'reserve' || holdType === 'payment') score += 1;
                if (past180Days || (daysSinceHold !== null && daysSinceHold > 180)) score += 2;
                return score;
            })();

            const riskLevel = riskScore >= 4 ? 'high' : riskScore >= 2 ? 'medium' : 'low';
            const riskLabel = riskLevel === 'high' ? '🔴 High Priority' : riskLevel === 'medium' ? '🟡 Medium Priority' : '🟢 Standard Priority';
            const riskCaption = riskLevel === 'high'
                ? 'Significant funds held long-term — immediate action recommended'
                : riskLevel === 'medium'
                    ? 'Meaningful exposure — prompt escalation advised'
                    : 'Lower exposure or early-stage hold';

            // Calculate completion percentage
            const completionChecks = [
                fullName, email, phone, address, state,
                amountHeld, holdDate,
                businessDescription,
                harmDescription,
                signature
            ];
            const completionPercent = Math.round((completionChecks.filter(Boolean).length / completionChecks.length) * 100);

            return (
                <>
                    <div className="header">
                        <div className="header-title">PayPal Fund Hold Demand Letter Generator</div>
                        <div className="header-subtitle">Generate a contract-compliant Notice of Dispute with optional AAA Arbitration Demand</div>
                    </div>

                    <div className="generator-container">
                        <div className="form-panel">
                            <div className="tips-box">
                                <div className="tips-title">💡 Quick Tips for a Strong Demand Letter</div>
                                <ul className="tips-list">
                                    <li>Be specific about dates, amounts, and timeline</li>
                                    <li>Document all harm and financial impact</li>
                                    <li>Include details about your business/account history</li>
                                    <li>Keep copies of all PayPal communications</li>
                                    <li>Send via certified mail with tracking</li>
                                </ul>
                            </div>

                            <div className="strength-analyzer">
                                <div className="strength-header">
                                    <div>
                                        <div style={{ fontSize: '14px', fontWeight: 600, color: '#64748b', marginBottom: '4px' }}>CASE STRENGTH</div>
                                        <div style={{ display: 'flex', alignItems: 'baseline', gap: '8px' }}>
                                            <span className="strength-score" style={{ color: strengthColor }}>{caseStrength.score}</span>
                                            <span style={{ fontSize: '14px', color: '#64748b' }}>/ {caseStrength.maxScore}</span>
                                        </div>
                                    </div>
                                    <div style={{ textAlign: 'right' }}>
                                        <div style={{ fontSize: '18px', fontWeight: 700, color: strengthColor }}>{strengthLabel}</div>
                                        <div style={{ fontSize: '12px', color: '#64748b', marginTop: '4px' }}>
                                            {strengthLevel === 'strong' ? 'Excellent position' : strengthLevel === 'moderate' ? 'Good foundation' : 'Keep building'}
                                        </div>
                                    </div>
                                </div>

                                <div className="strength-meter">
                                    <div className="strength-meter-fill" style={{ width: `${caseStrength.score}%` }}></div>
                                </div>

                                {caseStrength.factors.length > 0 && (
                                    <div className="factors-list">
                                        <div style={{ fontSize: '12px', fontWeight: 700, color: '#64748b', marginBottom: '8px', textTransform: 'uppercase', letterSpacing: '0.05em' }}>
                                            Key Factors
                                        </div>
                                        {caseStrength.factors.map((factor, idx) => (
                                            <div key={idx} className={`factor-item ${factor.type}`}>
                                                <span className="factor-icon">{factor.type === 'improve' ? '⚠️' : '✅'}</span>
                                                <span className="factor-text">{factor.text}</span>
                                                <span className="factor-impact">{factor.impact}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>

                            <div className="form-section">
                                <div className="section-title">Account Information</div>

                                <div className="form-group">
                                    <label className="form-label">Account Type</label>
                                    <div className="radio-group">
                                        <div className="radio-option">
                                            <input type="radio" id="business" name="accountType" value="business" checked={accountType === 'business'} onChange={(e) => { setAccountType(e.target.value); scrollToSection('account-info'); }} />
                                            <label htmlFor="business">Business Account</label>
                                        </div>
                                        <div className="radio-option">
                                            <input type="radio" id="personal" name="accountType" value="personal" checked={accountType === 'personal'} onChange={(e) => { setAccountType(e.target.value); scrollToSection('account-info'); }} />
                                            <label htmlFor="personal">Personal Account</label>
                                        </div>
                                    </div>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Full Legal Name</label>
                                    <input type="text" className="form-input" value={fullName} onChange={(e) => { setFullName(e.target.value); scrollToSection('account-info'); }} placeholder="John Smith" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Email Address (PayPal account)</label>
                                    <input type="email" className="form-input" value={email} onChange={(e) => { setEmail(e.target.value); scrollToSection('account-info'); }} placeholder="john@example.com" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Phone Number</label>
                                    <input type="tel" className="form-input" value={phone} onChange={(e) => { setPhone(e.target.value); scrollToSection('account-info'); }} placeholder="(555) 123-4567" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Mailing Address</label>
                                    <input type="text" className="form-input" value={address} onChange={(e) => { setAddress(e.target.value); scrollToSection('account-info'); }} placeholder="123 Main St, City, State ZIP" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">State of Residence</label>
                                    <select className="form-select" value={state} onChange={(e) => { setState(e.target.value); scrollToSection('legal-theories'); }}>
                                        <option value="">Select State</option>
                                        <option value="Alabama">Alabama</option>
                                        <option value="Alaska">Alaska</option>
                                        <option value="Arizona">Arizona</option>
                                        <option value="Arkansas">Arkansas</option>
                                        <option value="California">California</option>
                                        <option value="Colorado">Colorado</option>
                                        <option value="Connecticut">Connecticut</option>
                                        <option value="Delaware">Delaware</option>
                                        <option value="District of Columbia">District of Columbia</option>
                                        <option value="Florida">Florida</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Hawaii">Hawaii</option>
                                        <option value="Idaho">Idaho</option>
                                        <option value="Illinois">Illinois</option>
                                        <option value="Indiana">Indiana</option>
                                        <option value="Iowa">Iowa</option>
                                        <option value="Kansas">Kansas</option>
                                        <option value="Kentucky">Kentucky</option>
                                        <option value="Louisiana">Louisiana</option>
                                        <option value="Maine">Maine</option>
                                        <option value="Maryland">Maryland</option>
                                        <option value="Massachusetts">Massachusetts</option>
                                        <option value="Michigan">Michigan</option>
                                        <option value="Minnesota">Minnesota</option>
                                        <option value="Mississippi">Mississippi</option>
                                        <option value="Missouri">Missouri</option>
                                        <option value="Montana">Montana</option>
                                        <option value="Nebraska">Nebraska</option>
                                        <option value="Nevada">Nevada</option>
                                        <option value="New Hampshire">New Hampshire</option>
                                        <option value="New Jersey">New Jersey</option>
                                        <option value="New Mexico">New Mexico</option>
                                        <option value="New York">New York</option>
                                        <option value="North Carolina">North Carolina</option>
                                        <option value="North Dakota">North Dakota</option>
                                        <option value="Ohio">Ohio</option>
                                        <option value="Oklahoma">Oklahoma</option>
                                        <option value="Oregon">Oregon</option>
                                        <option value="Pennsylvania">Pennsylvania</option>
                                        <option value="Rhode Island">Rhode Island</option>
                                        <option value="South Carolina">South Carolina</option>
                                        <option value="South Dakota">South Dakota</option>
                                        <option value="Tennessee">Tennessee</option>
                                        <option value="Texas">Texas</option>
                                        <option value="Utah">Utah</option>
                                        <option value="Vermont">Vermont</option>
                                        <option value="Virginia">Virginia</option>
                                        <option value="Washington">Washington</option>
                                        <option value="West Virginia">West Virginia</option>
                                        <option value="Wisconsin">Wisconsin</option>
                                        <option value="Wyoming">Wyoming</option>
                                    </select>
                                </div>
                            </div>

                            <div className="form-section">
                                <div className="section-title">Hold Details</div>

                                <div className="form-group">
                                    <label className="form-label">What happened to your account?</label>
                                    <div className="radio-group">
                                        <div className="radio-option">
                                            <input type="radio" id="limited" name="holdType" value="limited" checked={holdType === 'limited'} onChange={(e) => { setHoldType(e.target.value); scrollToSection('background'); }} />
                                            <label htmlFor="limited">Account is limited, cannot withdraw</label>
                                        </div>
                                        <div className="radio-option">
                                            <input type="radio" id="closed" name="holdType" value="closed" checked={holdType === 'closed'} onChange={(e) => { setHoldType(e.target.value); scrollToSection('background'); }} />
                                            <label htmlFor="closed">Account closed, 180-day hold</label>
                                        </div>
                                        <div className="radio-option">
                                            <input type="radio" id="reserve" name="holdType" value="reserve" checked={holdType === 'reserve'} onChange={(e) => { setHoldType(e.target.value); scrollToSection('background'); }} />
                                            <label htmlFor="reserve">Reserve imposed</label>
                                        </div>
                                    </div>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Limitation Type</label>
                                    <div className="radio-group">
                                        <div className="radio-option">
                                            <input type="radio" id="temporary" name="limitationType" value="temporary" checked={limitationType === 'temporary'} onChange={(e) => { setLimitationType(e.target.value); scrollToSection('background'); }} />
                                            <label htmlFor="temporary">Temporary Limitation</label>
                                        </div>
                                        <div className="radio-option">
                                            <input type="radio" id="permanent" name="limitationType" value="permanent" checked={limitationType === 'permanent'} onChange={(e) => { setLimitationType(e.target.value); scrollToSection('background'); }} />
                                            <label htmlFor="permanent">Permanent Limitation</label>
                                        </div>
                                    </div>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Amount Currently Held</label>
                                    <input type="number" className="form-input" value={amountHeld} onChange={(e) => { setAmountHeld(e.target.value); scrollToSection('background'); }} placeholder="5000.00" step="0.01" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Date Hold/Limitation Imposed</label>
                                    <input type="date" className="form-input" value={holdDate} onChange={(e) => { setHoldDate(e.target.value); scrollToSection('background'); }} />
                                </div>

                                <div className="checkbox-group">
                                    <input type="checkbox" id="days180" checked={days180Mentioned} onChange={(e) => { setDays180Mentioned(e.target.checked); scrollToSection('background'); }} />
                                    <label htmlFor="days180">PayPal mentioned "180 days"</label>
                                </div>

                                {days180Mentioned && (
                                    <div className="form-group">
                                        <label className="form-label">Expected 180-Day End Date</label>
                                        <input type="date" className="form-input" value={days180Date} onChange={(e) => { setDays180Date(e.target.value); scrollToSection('background'); }} />
                                    </div>
                                )}

                                <div className="checkbox-group">
                                    <input type="checkbox" id="past180" checked={past180Days} onChange={(e) => { setPast180Days(e.target.checked); scrollToSection('contract'); }} />
                                    <label htmlFor="past180">180-day period has already passed</label>
                                </div>
                            </div>

                            <div className="form-section">
                                <div className="section-title">Reason Given by PayPal</div>

                                <div className="form-group">
                                    <label className="form-label">What reason did PayPal give?</label>
                                    <select className="form-select" value={reasonGiven} onChange={(e) => { setReasonGiven(e.target.value); scrollToSection('background'); }}>
                                        <option value="no_explanation">No specific explanation</option>
                                        <option value="aup_violation">Acceptable Use Policy violation</option>
                                        <option value="high_risk">High risk designation</option>
                                        <option value="unusual_activity">Unusual or suspicious activity</option>
                                        <option value="too_many_disputes">Too many disputes/chargebacks</option>
                                        <option value="verification_needed">Additional verification needed</option>
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Additional details about reason (optional)</label>
                                    <textarea className="form-textarea" value={specificReason} onChange={(e) => { setSpecificReason(e.target.value); scrollToSection('background'); }} placeholder="Any specific language from PayPal emails..."></textarea>
                                </div>
                            </div>

                            <div className="form-section">
                                <div className="section-title">Business & Transaction History</div>

                                <div className="form-group">
                                    <label className="form-label">Business Description</label>
                                    <textarea className="form-textarea" value={businessDescription} onChange={(e) => { setBusinessDescription(e.target.value); scrollToSection('background'); }} placeholder="Brief description of your business or how you use PayPal (e.g., 'a small ecommerce store selling handmade jewelry')"></textarea>
                                    <div className="input-hint">Helps establish legitimacy of your transactions</div>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Number of Chargebacks (last 6-12 months)</label>
                                    <input type="number" className="form-input" value={chargebackCount} onChange={(e) => { setChargebackCount(e.target.value); scrollToSection('contract'); }} placeholder="0" />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Number of Disputes (last 6-12 months)</label>
                                    <input type="number" className="form-input" value={disputeCount} onChange={(e) => { setDisputeCount(e.target.value); scrollToSection('contract'); }} placeholder="0" />
                                </div>
                            </div>

                            <div className="form-section">
                                <div className="section-title">Harm & Damages</div>

                                <div className="form-group">
                                    <label className="form-label">Describe the harm caused by this hold</label>
                                    <textarea className="form-textarea" value={harmDescription} onChange={(e) => { setHarmDescription(e.target.value); scrollToSection('harm'); }} placeholder="e.g., 'Unable to pay suppliers, missed rent payment, had to take emergency loan at high interest rate'"></textarea>
                                </div>

                                <div className="form-group">
                                    <label className="form-label">Missed Payments or Obligations</label>
                                    <textarea className="form-textarea" value={missedPayments} onChange={(e) => { setMissedPayments(e.target.value); scrollToSection('harm'); }} placeholder="e.g., 'Rent, supplier invoices, payroll, loan payments'"></textarea>
                                    <div className="input-hint">List specific bills or obligations you couldn't meet</div>
                                </div>

                                {accountType === 'business' && (
                                    <div className="form-group">
                                        <label className="form-label">Business Impact</label>
                                        <textarea className="form-textarea" value={businessImpact} onChange={(e) => { setBusinessImpact(e.target.value); scrollToSection('harm'); }} placeholder="e.g., 'Lost customers, couldn't restock inventory, had to close temporarily'"></textarea>
                                        <div className="input-hint">Operational impact on your business</div>
                                    </div>
                                )}

                                <div className="checkbox-group">
                                    <input type="checkbox" id="seekDamages" checked={seekDamages} onChange={(e) => { setSeekDamages(e.target.checked); scrollToSection('relief'); }} />
                                    <label htmlFor="seekDamages">I want to seek additional damages in arbitration (not just fund release)</label>
                                </div>

                                {seekDamages && (
                                    <div className="form-group">
                                        <label className="form-label">Estimated Additional Damages</label>
                                        <input type="number" className="form-input" value={estimatedDamages} onChange={(e) => { setEstimatedDamages(e.target.value); scrollToSection('relief'); }} placeholder="5000.00" step="0.01" />
                                        <div className="input-hint">Estimated lost profits, interest costs, etc.</div>
                                    </div>
                                )}
                            </div>

                            <div className="form-section">
                                <div className="section-title">Arbitration Options</div>

                                <div className="checkbox-group">
                                    <input type="checkbox" id="attachArb" checked={attachArbDemand} onChange={(e) => setAttachArbDemand(e.target.checked)} />
                                    <label htmlFor="attachArb">Attach draft AAA Arbitration Demand to this letter</label>
                                </div>

                                {attachArbDemand && (
                                    <div className="form-group">
                                        <label className="form-label">Hearing preference</label>
                                        <div className="radio-group">
                                            <div className="radio-option">
                                                <input type="radio" id="documents" name="hearingPreference" value="documents" checked={hearingPreference === 'documents'} onChange={(e) => setHearingPreference(e.target.value)} />
                                                <label htmlFor="documents">Documents only (faster/cheaper)</label>
                                            </div>
                                            <div className="radio-option">
                                                <input type="radio" id="remote" name="hearingPreference" value="remote" checked={hearingPreference === 'remote'} onChange={(e) => setHearingPreference(e.target.value)} />
                                                <label htmlFor="remote">Remote hearing (phone/video)</label>
                                            </div>
                                            <div className="radio-option">
                                                <input type="radio" id="in_person" name="hearingPreference" value="in_person" checked={hearingPreference === 'in_person'} onChange={(e) => setHearingPreference(e.target.value)} />
                                                <label htmlFor="in_person">In-person hearing</label>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="form-section">
                                <div className="section-title">E-Signature</div>

                                <div className="form-group">
                                    <label className="form-label">Type your name to sign (optional)</label>
                                    <input type="text" className="signature-input" value={signature} onChange={(e) => { setSignature(e.target.value); scrollToSection('signature'); }} placeholder="Your signature" />
                                    <div className="input-hint">Leave blank if printing to sign by hand</div>
                                </div>
                            </div>

                            <div className="button-group">
                                <button className="btn btn-primary" onClick={copyToClipboard}>
                                    📋 Copy to Clipboard
                                </button>
                                <button className="btn btn-primary" onClick={() => setShowNextSteps(true)} style={{ background: 'linear-gradient(135deg, #059669 0%, #10b981 100%)' }}>
                                    ✅ View Next Steps
                                </button>
                            </div>

                            <div className="alert alert-warning">
                                <strong>Important:</strong> This is a template. Review carefully and customize before sending. Send via certified mail to the Omaha address. Keep copies of everything.
                            </div>
                        </div>

                        <div className="preview-panel" ref={previewRef}>
                            <div className="preview-document">
                                <div className="summary-box">
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>
                                        <div className="summary-title">Dispute Snapshot</div>
                                        <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>
                                            <div style={{ fontSize: '12px', color: '#64748b', fontWeight: 600 }}>
                                                {completionPercent}% Complete
                                            </div>
                                            <div className={`risk-chip risk-${riskLevel}`}>
                                                {riskLabel}
                                            </div>
                                        </div>
                                    </div>
                                    <div className="summary-grid">
                                        {summaryDetails.map((item, index) => (
                                            <div className="summary-item" key={index}>
                                                <span>{item.label}</span>
                                                <strong>{item.value}</strong>
                                            </div>
                                        ))}
                                    </div>
                                    <div style={{ marginTop: '15px', padding: '12px', background: '#fff', borderRadius: '6px', fontSize: '12px', color: '#475569', fontStyle: 'italic' }}>
                                        💡 {riskCaption}
                                    </div>
                                </div>

                                {demandSections.map((section) => (
                                    <div
                                        key={section.id}
                                        id={section.id}
                                        className={highlightedSection === section.id ? 'highlight' : ''}
                                        dangerouslySetInnerHTML={{ __html: section.content }}
                                    />
                                ))}

                                {arbDemand && (
                                    <div dangerouslySetInnerHTML={{ __html: arbDemand }} />
                                )}
                            </div>
                        </div>
                    </div>

                    {showNextSteps && (
                        <div className="next-steps-modal" onClick={() => setShowNextSteps(false)}>
                            <div className="next-steps-content" onClick={(e) => e.stopPropagation()}>
                                <div className="next-steps-header">
                                    <div className="next-steps-title">📋 Next Steps Checklist</div>
                                    <div className="next-steps-subtitle">Follow these steps to send your demand letter and pursue resolution</div>
                                </div>

                                <div className="next-steps-body">
                                    {/* Timeline Section */}
                                    <div className="step-section">
                                        <div className="step-section-title">📅 Key Deadlines</div>
                                        {holdDate && (
                                            <>
                                                <div className="timeline-item">
                                                    <div className="timeline-date">Today: {currentDate}</div>
                                                    <div className="timeline-desc">Send Notice of Dispute via certified mail</div>
                                                </div>
                                                <div className="timeline-item">
                                                    <div className="timeline-date">
                                                        Day 45: {new Date(Date.now() + 45 * 24 * 60 * 60 * 1000).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
                                                    </div>
                                                    <div className="timeline-desc">Earliest you can file AAA arbitration if no resolution</div>
                                                </div>
                                                {days180Date && !past180Days && (
                                                    <div className="timeline-item">
                                                        <div className="timeline-date">
                                                            180-Day Mark: {new Date(days180Date).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
                                                        </div>
                                                        <div className="timeline-desc">PayPal's stated hold end date - leverage this in negotiations</div>
                                                    </div>
                                                )}
                                                {past180Days && (
                                                    <div className="timeline-item" style={{ background: '#dcfce7', borderColor: '#22c55e' }}>
                                                        <div className="timeline-date">✅ 180-Day Period Passed</div>
                                                        <div className="timeline-desc">Strong leverage - PayPal's stated timeline has expired</div>
                                                    </div>
                                                )}
                                            </>
                                        )}
                                    </div>

                                    {/* Pre-Send Checklist */}
                                    <div className="step-section">
                                        <div className="step-section-title">✅ Before Sending (Complete Now)</div>
                                        <ul className="checklist">
                                            {[
                                                { id: 'review', label: 'Review entire demand letter for accuracy and completeness' },
                                                { id: 'evidence', label: 'Gather all supporting documents (screenshots, emails, invoices, tracking numbers)' },
                                                { id: 'copies', label: 'Make 3 copies: one for certified mail, one for your records, one backup' },
                                                { id: 'sign', label: signature ? '✓ Letter is signed' : 'Print and sign the letter (or use e-signature)' }
                                            ].map(item => (
                                                <li key={item.id} className={`checklist-item ${checkedSteps[item.id] ? 'completed' : ''}`} onClick={() => setCheckedSteps(prev => ({ ...prev, [item.id]: !prev[item.id] }))}>
                                                    <input type="checkbox" checked={checkedSteps[item.id] || false} onChange={() => {}} />
                                                    <label>{item.label}</label>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>

                                    {/* Mailing Instructions */}
                                    <div className="step-section">
                                        <div className="step-section-title">📮 Sending the Letter</div>
                                        <ul className="checklist">
                                            {[
                                                { id: 'usps', label: 'Go to USPS and send via Certified Mail with Return Receipt (~$8-10)' },
                                                { id: 'address', label: 'Confirm address: PayPal, Inc., Attn: Legal Specialists, P.O. Box 45950, Omaha, NE 68145-0950' },
                                                { id: 'tracking', label: 'Save certified mail tracking number and return receipt' },
                                                { id: 'proof', label: 'Take photo of envelope with tracking label before mailing' }
                                            ].map(item => (
                                                <li key={item.id} className={`checklist-item ${checkedSteps[item.id] ? 'completed' : ''}`} onClick={() => setCheckedSteps(prev => ({ ...prev, [item.id]: !prev[item.id] }))}>
                                                    <input type="checkbox" checked={checkedSteps[item.id] || false} onChange={() => {}} />
                                                    <label>{item.label}</label>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>

                                    {/* After Sending */}
                                    <div className="step-section">
                                        <div className="step-section-title">⏰ After Sending (Next 45 Days)</div>
                                        <ul className="checklist">
                                            {[
                                                { id: 'calendar', label: 'Mark calendar for 45 days from delivery date (check tracking)' },
                                                { id: 'monitor', label: 'Monitor PayPal account daily for any changes or communications' },
                                                { id: 'log', label: 'Keep detailed log of all PayPal communications (date, time, representative name)' },
                                                { id: 'noreply', label: 'If PayPal calls/emails, get everything in writing before agreeing to anything' }
                                            ].map(item => (
                                                <li key={item.id} className={`checklist-item ${checkedSteps[item.id] ? 'completed' : ''}`} onClick={() => setCheckedSteps(prev => ({ ...prev, [item.id]: !prev[item.id] }))}>
                                                    <input type="checkbox" checked={checkedSteps[item.id] || false} onChange={() => {}} />
                                                    <label>{item.label}</label>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>

                                    {/* If No Response */}
                                    <div className="step-section">
                                        <div className="step-section-title">⚖️ If No Resolution After 45 Days</div>
                                        <ul className="checklist">
                                            {[
                                                { id: 'aaa_visit', label: 'Visit AAA website: adr.org' },
                                                { id: 'aaa_file', label: `File consumer arbitration (${parseFloat(amountHeld) <= 10000 ? 'PayPal pays all fees for claims ≤$10k' : 'expect filing fee of $200-300'})` },
                                                { id: 'aaa_attach', label: 'Attach: (1) Arbitration demand, (2) Original notice, (3) Certified mail proof, (4) All evidence' },
                                                { id: 'aaa_serve', label: 'AAA will serve PayPal - you don\'t need to' }
                                            ].map(item => (
                                                <li key={item.id} className={`checklist-item ${checkedSteps[item.id] ? 'completed' : ''}`} onClick={() => setCheckedSteps(prev => ({ ...prev, [item.id]: !prev[item.id] }))}>
                                                    <input type="checkbox" checked={checkedSteps[item.id] || false} onChange={() => {}} />
                                                    <label>{item.label}</label>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>

                                    {/* Tips */}
                                    <div className="alert alert-info" style={{ marginTop: '20px' }}>
                                        <strong>💡 Pro Tips:</strong>
                                        <ul style={{ marginTop: '8px', marginBottom: 0, paddingLeft: '20px' }}>
                                            <li>PayPal often responds near day 44/45 - be patient</li>
                                            <li>Many cases settle after arbitration is filed but before hearing</li>
                                            <li>Document everything - screenshots, emails, call logs</li>
                                            <li>Don't accept partial payment without getting reason for hold removal in writing</li>
                                        </ul>
                                    </div>
                                </div>

                                <div className="next-steps-footer">
                                    <button className="btn btn-secondary" onClick={() => window.print()}>
                                        🖨️ Print Checklist
                                    </button>
                                    <button className="btn btn-primary" onClick={() => setShowNextSteps(false)}>
                                        Done
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PayPalDemandGenerator />);
    </script>
</body>
</html>
