<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>California Advisory Agreement Generator | Terms.Law</title>
  <meta name="description" content="The California Advisory Agreement Generator creates customized agreements for consultants and advisors, detailing services, compensation, term, confidentiality,">
  <link rel="canonical" href="https://terms.law/2025/01/05/california-advisory-agreement-generator/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css">
</head>
<body>
  <div id="site-header"></div>
  <script src="/shared/header-loader.js"></script>

  <main>
    <article>
      <h1>California Advisory Agreement Generator</h1>
      <div class="meta">Published: January 5, 2025 â€¢ Document Generators, Free Templates, Incorporation</div>
      <div class="content">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>California Advisory Agreement Generator</title>
  <style>
    /* Base Styles */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #1abc9c;
      --bg-color: #f9fafb;
      --card-bg: #ffffff;
      --text-primary: #333333;
      --text-secondary: #666666;
      --border-color: #e0e0e0;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    body {
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
    }
    
    /* Generator Container */
    .generator-container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    
    /* Generator Header */
    .generator-header {
      background-color: var(--primary-color);
      color: white;
      padding: 25px;
      text-align: center;
    }
    
    .generator-header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .generator-header p {
      font-size: 16px;
      opacity: 0.9;
    }
    
    /* Split View Layout */
    .split-view {
      display: flex;
      min-height: 700px;
    }
    
    /* Form Panel */
    .form-panel {
      flex: 1;
      padding: 20px;
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      max-height: 800px;
    }
    
    .form-section {
      padding-bottom: 20px;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .form-section:last-child {
      border-bottom: none;
    }
    
    .section-title {
      font-size: 18px;
      color: var(--primary-color);
      margin-bottom: 15px;
      font-weight: 600;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .form-input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
    }
    
    textarea.form-input {
      min-height: 80px;
      resize: vertical;
    }
    
    .form-helper {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    /* Option Cards */
    .options-group {
      margin-bottom: 15px;
    }
    
    .option-card {
      display: flex;
      align-items: flex-start;
      padding: 12px;
      margin-bottom: 10px;
      background-color: #f5f7fa;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .option-card:hover {
      background-color: #eef2f7;
    }
    
    .option-card.selected {
      background-color: #e3f8f5;
      border-color: var(--accent-color);
    }
    
    .option-card input[type="radio"],
    .option-card input[type="checkbox"] {
      margin-right: 10px;
      margin-top: 3px;
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-title {
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .option-desc {
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    /* Form Actions */
    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }
    
    .btn-secondary {
      background-color: #e9ecef;
      color: var(--text-primary);
    }
    
    .btn-secondary:hover {
      background-color: #dee2e6;
    }
    
    .btn-primary {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #16a085;
    }
    
    .btn-outline {
      background-color: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-primary);
    }
    
    .btn-outline:hover {
      background-color: #f8f9fa;
    }
    
    .copy-message {
      font-size: 14px;
      color: #28a745;
      margin-left: 10px;
      display: none;
    }
    
    /* Preview Panel */
    .preview-panel {
      flex: 1;
      padding: 20px;
      position: relative;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .preview-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .preview-note {
      font-size: 13px;
      color: var(--text-secondary);
      font-style: italic;
    }
    
    .preview-box {
      height: 700px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 30px;
      background-color: white;
    }
    
    /* Document Styles */
    .document {
      max-width: 100%;
      font-family: "Times New Roman", Times, serif;
      font-size: 14px;
      line-height: 1.5;
      color: #000;
    }
    
    .document-title {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    
    .document-section {
      margin-bottom: 20px;
    }
    
    .section-heading {
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .signature-block {
      margin-top: 30px;
      page-break-inside: avoid;
    }
    
    .signature-line {
      display: block;
      margin-top: 40px;
      margin-bottom: 5px;
      border-top: 1px solid #000;
      width: 250px;
    }
    
    .signature-name {
      font-weight: bold;
    }
    
    .signature-date {
      margin-left: 15px;
      font-style: italic;
    }
    
    /* Highlight Effect */
    .highlight {
      background-color: #ffffb3;
      transition: background-color 0.5s ease;
    }
    
    /* CTA Button */
    .cta-button {
      display: block;
      width: 100%;
      padding: 12px;
      background-color: var(--primary-color);
      color: white;
      text-align: center;
      text-decoration: none;
      font-weight: 500;
      border-radius: 6px;
      margin-top: 20px;
      transition: var(--transition);
    }
    
    .cta-button:hover {
      background-color: #1e2a37;
    }
    
    /* Responsive Styles */
    @media (max-width: 1024px) {
      .split-view {
        flex-direction: column;
      }
      
      .form-panel {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        max-height: none;
      }
      
      .preview-box {
        height: 500px;
      }
    }
    
    @media (max-width: 768px) {
      .generator-container {
        border-radius: 0;
        box-shadow: none;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .copy-message {
        margin-left: 0;
        margin-top: 5px;
        text-align: center;
      }
    }
    
    @media print {
      body {
        background-color: white;
        padding: 0;
      }
      
      .generator-container {
        box-shadow: none;
        border-radius: 0;
      }
      
      .generator-header,
      .form-panel,
      .preview-header,
      .form-actions,
      .cta-button {
        display: none;
      }
      
      .split-view {
        display: block;
      }
      
      .preview-panel {
        padding: 0;
      }
      
      .preview-box {
        height: auto;
        overflow: visible;
        border: none;
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <div class="generator-container">
    <div class="generator-header">
      <h1>California Advisory Agreement Generator</h1>
      <p>Create a customized advisory agreement for consultants and advisors in California</p>
    </div>
    
    <div class="split-view">
      <!-- Form Panel -->
      <div class="form-panel">
        <form id="advisoryForm">
          <!-- Parties Section -->
          <div class="form-section">
            <h2 class="section-title">Parties</h2>
            
            <div class="form-group">
              <label for="companyName">Company Name</label>
              <input type="text" id="companyName" class="form-input" value="ABC Tech, Inc.">
            </div>
            
            <div class="form-group">
              <label for="companyAddress">Company Address</label>
              <input type="text" id="companyAddress" class="form-input" value="123 Main Street, San Francisco, CA 94105">
            </div>
            
            <div class="form-group">
              <label for="advisorName">Advisor Name</label>
              <input type="text" id="advisorName" class="form-input" value="Jane Smith">
            </div>
            
            <div class="form-group">
              <label for="advisorAddress">Advisor Address</label>
              <input type="text" id="advisorAddress" class="form-input" value="456 Oak Avenue, San Diego, CA 92101">
            </div>
            
            <div class="form-group">
              <label for="effectiveDate">Effective Date</label>
              <input type="date" id="effectiveDate" class="form-input" value="2025-04-01">
            </div>
          </div>
          
          <!-- Services Section -->
          <div class="form-section">
            <h2 class="section-title">Services</h2>
            
            <div class="form-group">
              <label for="servicesDescription">Description of Services</label>
              <textarea id="servicesDescription" class="form-input" rows="4">Advisor will provide strategic business consulting services including market analysis, growth strategy development, and mentorship to the executive team.</textarea>
              <div class="form-helper">Describe the advisory services to be provided</div>
            </div>
            
            <div class="form-group">
              <label for="timeCommitment">Time Commitment</label>
              <input type="text" id="timeCommitment" class="form-input" value="10 hours per month">
              <div class="form-helper">Specify the expected time commitment (e.g., hours per month)</div>
            </div>
            
            <div class="form-group">
              <label>Service Location</label>
              <div class="options-group">
                <label class="option-card selected" for="locationRemote">
                  <input type="radio" id="locationRemote" name="serviceLocation" value="remote" checked>
                  <div class="option-content">
                    <div class="option-title">Remote Services</div>
                    <div class="option-desc">Services primarily provided remotely via phone, email, or video conference</div>
                  </div>
                </label>
                
                <label class="option-card" for="locationHybrid">
                  <input type="radio" id="locationHybrid" name="serviceLocation" value="hybrid">
                  <div class="option-content">
                    <div class="option-title">Hybrid Services</div>
                    <div class="option-desc">Mix of remote and on-site services as reasonably requested</div>
                  </div>
                </label>
                
                <label class="option-card" for="locationOnsite">
                  <input type="radio" id="locationOnsite" name="serviceLocation" value="onsite">
                  <div class="option-content">
                    <div class="option-title">On-site Services</div>
                    <div class="option-desc">Services primarily provided at Company&#8217;s premises or specified locations</div>
                  </div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Compensation Section -->
          <div class="form-section">
            <h2 class="section-title">Compensation</h2>
            
            <div class="form-group">
              <label>Compensation Type</label>
              <div class="options-group">
                <label class="option-card selected" for="compType1">
                  <input type="radio" id="compType1" name="compensationType" value="cash" checked>
                  <div class="option-content">
                    <div class="option-title">Cash Compensation</div>
                    <div class="option-desc">Fixed cash payment for services</div>
                  </div>
                </label>
                
                <label class="option-card" for="compType2">
                  <input type="radio" id="compType2" name="compensationType" value="equity">
                  <div class="option-content">
                    <div class="option-title">Equity Compensation</div>
                    <div class="option-desc">Stock options or equity in the company</div>
                  </div>
                </label>
                
                <label class="option-card" for="compType3">
                  <input type="radio" id="compType3" name="compensationType" value="hybrid">
                  <div class="option-content">
                    <div class="option-title">Hybrid Compensation</div>
                    <div class="option-desc">Combination of cash and equity</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div id="cashCompensationSection">
              <div class="form-group">
                <label for="cashAmount">Cash Compensation Amount</label>
                <input type="text" id="cashAmount" class="form-input" value="$5,000">
              </div>
              
              <div class="form-group">
                <label for="paymentFrequency">Payment Frequency</label>
                <select id="paymentFrequency" class="form-input">
                  <option value="monthly" selected>Monthly</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="annually">Annually</option>
                  <option value="perMeeting">Per Meeting</option>
                </select>
              </div>
            </div>
            
            <div id="equityCompensationSection" style="display: none;">
              <div class="form-group">
                <label for="equityAmount">Equity Amount</label>
                <input type="text" id="equityAmount" class="form-input" value="1% of the Company's common stock">
              </div>
              
              <div class="form-group">
                <label for="vestingSchedule">Vesting Schedule</label>
                <textarea id="vestingSchedule" class="form-input">Options shall vest over a 24-month period, with 1/24th of the options vesting each month, subject to Advisor&#8217;s continued service to the Company.</textarea>
              </div>
            </div>
            
            <div class="form-group">
              <label for="expensePolicy">Expense Reimbursement</label>
              <select id="expensePolicy" class="form-input">
                <option value="noExpenses">No expense reimbursement</option>
                <option value="reasonable" selected>Reasonable and pre-approved expenses</option>
                <option value="all">All business-related expenses</option>
              </select>
            </div>
            
            <div id="expenseDetailsSection">
              <div class="form-group">
                <label for="expenseDetails">Expense Details</label>
                <textarea id="expenseDetails" class="form-input">The Company will reimburse Advisor for reasonable, documented, and pre-approved expenses incurred in connection with the performance of services under this Agreement.</textarea>
              </div>
            </div>
          </div>
          
          <!-- Term and Termination -->
          <div class="form-section">
            <h2 class="section-title">Term and Termination</h2>
            
            <div class="form-group">
              <label>Agreement Term</label>
              <div class="options-group">
                <label class="option-card selected" for="termType1">
                  <input type="radio" id="termType1" name="termType" value="fixed" checked>
                  <div class="option-content">
                    <div class="option-title">Fixed Term</div>
                    <div class="option-desc">Agreement valid for a specific time period</div>
                  </div>
                </label>
                
                <label class="option-card" for="termType2">
                  <input type="radio" id="termType2" name="termType" value="indefinite">
                  <div class="option-content">
                    <div class="option-title">Indefinite Term</div>
                    <div class="option-desc">Agreement continues until terminated</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div id="fixedTermSection">
              <div class="form-group">
                <label for="termDuration">Term Duration</label>
                <input type="text" id="termDuration" class="form-input" value="12 months">
              </div>
              
              <div class="form-group">
                <label for="autoRenewal">Auto-Renewal</label>
                <select id="autoRenewal" class="form-input">
                  <option value="no">No automatic renewal</option>
                  <option value="yes" selected>Automatic renewal</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label for="terminationNotice">Termination Notice Period</label>
              <select id="terminationNotice" class="form-input">
                <option value="7">7 days</option>
                <option value="14">14 days</option>
                <option value="30" selected>30 days</option>
                <option value="60">60 days</option>
                <option value="90">90 days</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Early Termination Options</label>
              <div class="options-group">
                <label class="option-card selected">
                  <input type="checkbox" id="terminationWithCause" checked>
                  <div class="option-content">
                    <div class="option-title">Termination for Cause</div>
                    <div class="option-desc">Immediate termination for material breach or misconduct</div>
                  </div>
                </label>
                
                <label class="option-card selected">
                  <input type="checkbox" id="terminationForConvenience" checked>
                  <div class="option-content">
                    <div class="option-title">Termination for Convenience</div>
                    <div class="option-desc">Either party may terminate with notice</div>
                  </div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Confidentiality and IP -->
          <div class="form-section">
            <h2 class="section-title">Confidentiality and IP</h2>
            
            <div class="form-group">
              <label>Confidentiality Provisions</label>
              <div class="options-group">
                <label class="option-card selected" for="confidentialityLevel1">
                  <input type="radio" id="confidentialityLevel1" name="confidentialityLevel" value="standard" checked>
                  <div class="option-content">
                    <div class="option-title">Standard Confidentiality</div>
                    <div class="option-desc">Basic confidentiality obligations</div>
                  </div>
                </label>
                
                <label class="option-card" for="confidentialityLevel2">
                  <input type="radio" id="confidentialityLevel2" name="confidentialityLevel" value="enhanced">
                  <div class="option-content">
                    <div class="option-title">Enhanced Confidentiality</div>
                    <div class="option-desc">Stronger confidentiality with detailed provisions</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Intellectual Property Rights</label>
              <div class="options-group">
                <label class="option-card selected" for="ipAssignment1">
                  <input type="radio" id="ipAssignment1" name="ipAssignment" value="full" checked>
                  <div class="option-content">
                    <div class="option-title">Full IP Assignment</div>
                    <div class="option-desc">All IP created by Advisor is assigned to Company</div>
                  </div>
                </label>
                
                <label class="option-card" for="ipAssignment2">
                  <input type="radio" id="ipAssignment2" name="ipAssignment" value="limited">
                  <div class="option-content">
                    <div class="option-title">Limited IP Assignment</div>
                    <div class="option-desc">Only directly related IP is assigned to Company</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="workForHire">Work-for-Hire Clause</label>
              <select id="workForHire" class="form-input">
                <option value="yes" selected>Include work-for-hire clause</option>
                <option value="no">Exclude work-for-hire clause</option>
              </select>
              <div class="form-helper">Work-for-hire clauses state that the work performed is owned by the Company</div>
            </div>
          </div>
          
          <!-- Additional Terms -->
          <div class="form-section">
            <h2 class="section-title">Additional Terms</h2>
            
            <div class="form-group">
              <label>Relationship of Parties</label>
              <div class="options-group">
                <label class="option-card selected" for="relationship1">
                  <input type="radio" id="relationship1" name="relationship" value="contractor" checked>
                  <div class="option-content">
                    <div class="option-title">Independent Contractor</div>
                    <div class="option-desc">Advisor is an independent contractor, not an employee</div>
                  </div>
                </label>
                
                <label class="option-card" for="relationship2">
                  <input type="radio" id="relationship2" name="relationship" value="consultant">
                  <div class="option-content">
                    <div class="option-title">Consultant</div>
                    <div class="option-desc">Advisor is a consultant with more defined relationship terms</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Dispute Resolution</label>
              <div class="options-group">
                <label class="option-card selected" for="disputeMethod1">
                  <input type="radio" id="disputeMethod1" name="disputeMethod" value="court" checked>
                  <div class="option-content">
                    <div class="option-title">California Courts</div>
                    <div class="option-desc">Disputes resolved in California courts</div>
                  </div>
                </label>
                
                <label class="option-card" for="disputeMethod2">
                  <input type="radio" id="disputeMethod2" name="disputeMethod" value="arbitration">
                  <div class="option-content">
                    <div class="option-title">Binding Arbitration</div>
                    <div class="option-desc">Disputes resolved through binding arbitration in California</div>
                  </div>
                </label>
                
                <label class="option-card" for="disputeMethod3">
                  <input type="radio" id="disputeMethod3" name="disputeMethod" value="mediation">
                  <div class="option-content">
                    <div class="option-title">Mediation then Arbitration</div>
                    <div class="option-desc">Disputes first go to mediation, then binding arbitration</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="venueCounty">Venue County</label>
              <select id="venueCounty" class="form-input">
                <option value="San Francisco">San Francisco County</option>
                <option value="Los Angeles">Los Angeles County</option>
                <option value="San Diego" selected>San Diego County</option>
                <option value="Santa Clara">Santa Clara County</option>
                <option value="Alameda">Alameda County</option>
                <option value="Orange">Orange County</option>
                <option value="Sacramento">Sacramento County</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="additionalTerms">Additional Custom Terms</label>
              <textarea id="additionalTerms" class="form-input"></textarea>
              <div class="form-helper">Add any other specific terms you want to include in the agreement</div>
            </div>
          </div>
          
          <!-- Form Actions -->
          <div class="form-actions">
            <button type="button" id="copyBtn" class="btn btn-secondary">Copy Agreement</button>
            <button type="button" id="downloadBtn" class="btn btn-primary">Download as DOCX</button>
            <button type="reset" class="btn btn-outline">Reset Form</button>
            <span id="copyMessage" class="copy-message">Agreement copied to clipboard!</span>
          </div>
          
          <a href="#" class="cta-button" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">
            Schedule Legal Consultation
          </a>
        </form>
      </div>
      
      <!-- Preview Panel -->
      <div class="preview-panel">
        <div class="preview-header">
          <div class="preview-title">Agreement Preview</div>
          <div class="preview-note">Updates as you complete the form</div>
        </div>
        
        <div class="preview-box">
          <div class="document" id="documentPreview">
            <!-- Document content will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Libraries for DOCX download -->
  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- Calendly Integration -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get form and preview elements
      const form = document.getElementById('advisoryForm');
      const preview = document.getElementById('documentPreview');
      const copyBtn = document.getElementById('copyBtn');
      const copyMessage = document.getElementById('copyMessage');
      const downloadBtn = document.getElementById('downloadBtn');
      const previewBox = document.querySelector('.preview-box');
      
      // Format date from YYYY-MM-DD to readable format
      function formatDate(dateString) {
        if (!dateString) return '';
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
      }
      
      // Initialize the form
      initializeForm();
      
      // Update the preview on load
      updatePreview();
      
      // Track currently highlighted elements
      let highlightedElements = [];
      let highlightTimeout;
      
      // Initialize form dependencies and event listeners
      function initializeForm() {
        // Add input event listener to all form inputs
        const inputs = form.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
          input.addEventListener('input', function() {
            clearHighlights();
            updatePreview(this.id);
            copyMessage.style.display = 'none';
          });
          
          // For select inputs, also listen for change events
          if (input.tagName.toLowerCase() === 'select') {
            input.addEventListener('change', function() {
              clearHighlights();
              updatePreview(this.id);
              copyMessage.style.display = 'none';
            });
          }
        });
        
        // Make option cards clickable
        document.querySelectorAll('.option-card').forEach(card => {
          card.addEventListener('click', function(e) {
            // If the user clicked directly on the input, don't interfere
            if (e.target.tagName.toLowerCase() === 'input') return;
            
            // Find the input inside this card
            const input = this.querySelector('input');
            if (!input) return;
            
            // For radio buttons
            if (input.type === 'radio') {
              // Select this option
              input.checked = true;
              
              // Update visual selection for all options in this group
              document.querySelectorAll(`input[name="${input.name}"]`).forEach(radio => {
                radio.closest('.option-card').classList.toggle('selected', radio === input);
              });
            } 
            // For checkboxes
            else if (input.type === 'checkbox') {
              // Toggle checkbox state
              input.checked = !input.checked;
              
              // Toggle selected class
              this.classList.toggle('selected', input.checked);
            }
            
            // Clear highlights and update preview
            clearHighlights();
            updatePreview(input.id);
            copyMessage.style.display = 'none';
            
            // Trigger change event on the input
            const event = new Event('change', { bubbles: true });
            input.dispatchEvent(event);
          });
        });
        
        // Handle form reset
        form.addEventListener('reset', function() {
          // Wait for form to reset before updating preview
          setTimeout(() => {
            // Reset selected class on option items
            document.querySelectorAll('.option-card').forEach(card => {
              const input = card.querySelector('input');
              if (input) {
                card.classList.toggle('selected', input.checked);
              }
            });
            
            // Update dynamic sections visibility
            updateDynamicSections();
            
            // Update preview
            clearHighlights();
            updatePreview();
            copyMessage.style.display = 'none';
          }, 10);
        });
        
        // Add change listeners to compensation type radios
        document.querySelectorAll('input[name="compensationType"]').forEach(radio => {
          radio.addEventListener('change', function() {
            updateCompensationSection();
          });
        });
        
        // Add change listener to term type radios
        document.querySelectorAll('input[name="termType"]').forEach(radio => {
          radio.addEventListener('change', function() {
            updateTermSection();
          });
        });
        
        // Add change listener to expense policy dropdown
        document.getElementById('expensePolicy').addEventListener('change', function() {
          updateExpenseSection();
        });
        
        // Initialize dynamic sections
        updateDynamicSections();
        
        // Set up copy button
        copyBtn.addEventListener('click', function() {
          const documentText = preview.innerText;
          
          // Copy to clipboard
          navigator.clipboard.writeText(documentText).then(function() {
            copyMessage.style.display = 'inline-block';
            
            // Hide message after 3 seconds
            setTimeout(() => {
              copyMessage.style.display = 'none';
            }, 3000);
          }).catch(function(err) {
            console.error('Could not copy text: ', err);
            alert('Failed to copy agreement. Please try selecting and copying the text manually.');
          });
        });
        
        // Set up download button
        downloadBtn.addEventListener('click', function() {
          generateDocx();
        });
      }
      
      // Update all dynamic sections based on form state
      function updateDynamicSections() {
        updateCompensationSection();
        updateTermSection();
        updateExpenseSection();
      }
      
      // Update compensation section visibility
      function updateCompensationSection() {
        const compensationType = document.querySelector('input[name="compensationType"]:checked').value;
        
        // Show/hide relevant sections
        document.getElementById('cashCompensationSection').style.display = 
          (compensationType === 'cash' || compensationType === 'hybrid') ? 'block' : 'none';
        
        document.getElementById('equityCompensationSection').style.display = 
          (compensationType === 'equity' || compensationType === 'hybrid') ? 'block' : 'none';
      }
      
      // Update term section visibility
      function updateTermSection() {
        const termType = document.querySelector('input[name="termType"]:checked').value;
        
        // Show/hide relevant sections
        document.getElementById('fixedTermSection').style.display = 
          (termType === 'fixed') ? 'block' : 'none';
      }
      
      // Update expense section visibility
      function updateExpenseSection() {
        const expensePolicy = document.getElementById('expensePolicy').value;
        
        // Show/hide expense details section
        document.getElementById('expenseDetailsSection').style.display = 
          (expensePolicy === 'no') ? 'none' : 'block';
      }
      
      // Function to clear highlights
      function clearHighlights() {
        if (highlightTimeout) {
          clearTimeout(highlightTimeout);
        }
        
        highlightedElements.forEach(element => {
          element.classList.remove('highlight');
        });
        highlightedElements = [];
      }
      
      // Function to update the agreement preview
      function updatePreview(changedField = null) {
        // Get values from the form
        const companyName = document.getElementById('companyName').value;
        const companyAddress = document.getElementById('companyAddress').value;
        const advisorName = document.getElementById('advisorName').value;
        const advisorAddress = document.getElementById('advisorAddress').value;
        const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
        
        const servicesDescription = document.getElementById('servicesDescription').value;
        const timeCommitment = document.getElementById('timeCommitment').value;
        const serviceLocation = document.querySelector('input[name="serviceLocation"]:checked').value;
        
        const compensationType = document.querySelector('input[name="compensationType"]:checked').value;
        const cashAmount = document.getElementById('cashAmount').value;
        const paymentFrequencyEl = document.getElementById('paymentFrequency');
        const paymentFrequency = paymentFrequencyEl.options[paymentFrequencyEl.selectedIndex].text;
        const equityAmount = document.getElementById('equityAmount').value;
        const vestingSchedule = document.getElementById('vestingSchedule').value;
        
        const expensePolicyEl = document.getElementById('expensePolicy');
        const expensePolicy = expensePolicyEl.options[expensePolicyEl.selectedIndex].text;
        const expenseDetails = document.getElementById('expenseDetails').value;
        
        const termType = document.querySelector('input[name="termType"]:checked').value;
        const termDuration = document.getElementById('termDuration').value;
        const autoRenewalEl = document.getElementById('autoRenewal');
        const autoRenewal = autoRenewalEl.value === 'yes';
        const terminationNoticeEl = document.getElementById('terminationNotice');
        const terminationNotice = terminationNoticeEl.value;
        
        const terminationWithCause = document.getElementById('terminationWithCause').checked;
        const terminationForConvenience = document.getElementById('terminationForConvenience').checked;
        
        const confidentialityLevel = document.querySelector('input[name="confidentialityLevel"]:checked').value;
        const ipAssignment = document.querySelector('input[name="ipAssignment"]:checked').value;
        const workForHireEl = document.getElementById('workForHire');
        const workForHire = workForHireEl.value === 'yes';
        
        const relationship = document.querySelector('input[name="relationship"]:checked').value;
        const disputeMethod = document.querySelector('input[name="disputeMethod"]:checked').value;
        const venueCountyEl = document.getElementById('venueCounty');
        const venueCounty = venueCountyEl.options[venueCountyEl.selectedIndex].text;
        
        const additionalTerms = document.getElementById('additionalTerms').value;
        
        // Build the agreement HTML
        let agreementHtml = `
          <div class="document-title">ADVISORY AGREEMENT</div>
          
          <div class="document-section" id="intro-section">
            <p>This Advisory Agreement (the "Agreement") is entered into as of <span id="effective-date-span">${effectiveDate}</span> (the "Effective Date"), by and between <span id="company-name-span">${companyName}</span>, a California corporation with its principal place of business at <span id="company-address-span">${companyAddress}</span> (the "Company"), and <span id="advisor-name-span">${advisorName}</span>, an individual with an address at <span id="advisor-address-span">${advisorAddress}</span> (the "Advisor").</p>
            
            <p>The parties agree as follows:</p>
          </div>
          
          <div class="document-section" id="services-section">
            <p class="section-heading">1. SERVICES</p>
            
            <p id="services-description-para">1.1 <b>Services.</b> Advisor will provide advisory and consulting services to the Company as reasonably requested by the Company from time to time (the "Services"), including but not limited to: <span id="services-description-span">${servicesDescription}</span></p>
            
            <p id="time-commitment-para">1.2 <b>Time Commitment.</b> Advisor will devote approximately <span id="time-commitment-span">${timeCommitment}</span> to performing the Services. The timing and availability of the Services shall be reasonably determined by mutual agreement between Advisor and the Company.</p>
            
            <p id="service-location-para">1.3 <b>Location.</b> Advisor will provide the Services <span id="service-location-span">${serviceLocation === 'remote' ? 'primarily remotely via phone, email, or video conference' : serviceLocation === 'hybrid' ? 'through a combination of remote meetings and on-site visits as reasonably requested by the Company' : 'primarily at the Company\'s offices or at such other locations as reasonably requested by the Company'}</span>.</p>
            
            <p id="performance-para">1.4 <b>Performance.</b> Advisor will perform the Services in a professional and workmanlike manner, consistent with industry standards. Advisor will comply with all applicable laws and Company policies when performing the Services.</p>
          </div>
          
          <div class="document-section" id="compensation-section">
            <p class="section-heading">2. COMPENSATION</p>
            
            <p id="compensation-type-para">2.1 <b><span id="compensation-type-span">${compensationType === 'cash' ? 'Cash Compensation' : compensationType === 'equity' ? 'Equity Compensation' : 'Compensation'}</span>.</b> ${
              compensationType === 'cash' ? 
              `As full compensation for the Services, the Company will pay Advisor <span id="cash-amount-span">${cashAmount}</span> <span id="payment-frequency-span">${paymentFrequency.toLowerCase()}</span>.` :
              compensationType === 'equity' ? 
              `As full compensation for the Services, the Company will grant Advisor <span id="equity-amount-span">${equityAmount}</span>, subject to the terms and conditions of the Company's equity incentive plan and applicable equity grant documents. <span id="vesting-schedule-span">${vestingSchedule}</span>` :
              `As full compensation for the Services, the Company will (a) pay Advisor <span id="cash-amount-span">${cashAmount}</span> <span id="payment-frequency-span">${paymentFrequency.toLowerCase()}</span>, and (b) grant Advisor <span id="equity-amount-span">${equityAmount}</span>, subject to the terms and conditions of the Company's equity incentive plan and applicable equity grant documents. <span id="vesting-schedule-span">${vestingSchedule}</span>`
            }</p>
            
            <p id="expenses-para">2.2 <b>Expenses.</b> <span id="expense-details-span">${
              expensePolicyEl.value === 'noExpenses' ? 
              'Advisor is responsible for all expenses incurred in performing the Services, and the Company will not reimburse any expenses.' :
              expenseDetails
            }</span></p>
            
            <p id="taxes-para">2.3 <b>Taxes.</b> Advisor is solely responsible for all taxes, withholdings, and other statutory or contractual obligations of any sort related to Advisor's performance of the Services, including but not limited to, self-employment tax, income tax, and any other applicable taxes. The Company will report the compensation paid to Advisor under this Agreement as required by applicable law.</p>
          </div>
          
          <div class="document-section" id="term-termination-section">
            <p class="section-heading">3. TERM AND TERMINATION</p>
            
            <p id="term-para">3.1 <b>Term.</b> <span id="term-text-span">${
              termType === 'fixed' ? 
              `This Agreement will commence on the Effective Date and will continue for a period of <span id="term-duration-span">${termDuration}</span>, unless earlier terminated as provided in this Agreement${autoRenewal ? `<span id="auto-renewal-span">. Upon expiration, this Agreement will automatically renew for successive periods of the same duration, unless either party provides written notice of non-renewal at least ${terminationNotice} days before the end of the then-current term</span>` : '.'}` :
              'This Agreement will commence on the Effective Date and will continue until terminated as provided in this Agreement.'
            }</span></p>
            
            <p id="termination-para">3.2 <b>Termination.</b> <span id="termination-text-span">${
              (terminationWithCause && terminationForConvenience) ?
              `This Agreement may be terminated: (a) by either party upon written notice to the other party at least <span id="termination-notice-span">${terminationNotice}</span> days in advance; or (b) immediately by either party if the other party materially breaches this Agreement.` :
              terminationWithCause ?
              `This Agreement may be terminated immediately by either party if the other party materially breaches this Agreement.` :
              terminationForConvenience ?
              `This Agreement may be terminated by either party upon written notice to the other party at least <span id="termination-notice-span">${terminationNotice}</span> days in advance.` :
              `This Agreement may only be terminated upon mutual written agreement of the parties or expiration of its term.`
            }</span></p>
            
            <p id="effect-termination-para">3.3 <b>Effect of Termination.</b> Upon termination of this Agreement: (a) Advisor will promptly deliver to the Company all Company property, including Confidential Information and work product, in Advisor's possession or control; (b) the Company will pay Advisor any fees earned for Services performed up to the date of termination; and (c) the following provisions will survive: Sections 4 (Confidentiality), 5 (Intellectual Property), 7 (Limitation of Liability), 8 (Indemnification), and 10 (General Provisions).</p>
          </div>
          
          <div class="document-section" id="confidentiality-section">
            <p class="section-heading">4. CONFIDENTIALITY</p>
            
            <p id="confidential-info-para">4.1 <b>Confidential Information.</b> "Confidential Information" means all non-public information, whether in oral, written, or electronic form, concerning the Company and its business, technology, products, plans, and services that is provided to Advisor by the Company or its representatives, or that Advisor has access to during the term of this Agreement<span id="confidentiality-detail-span">${
              confidentialityLevel === 'enhanced' ? 
              `, including, but not limited to: (a) trade secrets, inventions, ideas, processes, formulas, source and object code, data, programs, other works of authorship, know-how, improvements, discoveries, developments, designs, and techniques; (b) information regarding plans for research, development, new products, marketing and selling, business plans, budgets, financial information, licenses, prices and costs, suppliers, and customers; and (c) information regarding the skills and compensation of employees and contractors of the Company.` :
              '.'
            }</span></p>
            
            <p id="non-disclosure-para">4.2 <b>Non-Disclosure and Non-Use.</b> Advisor will not, during or after the term of this Agreement, directly or indirectly: (a) use any Confidential Information for any purpose other than performing the Services for the benefit of the Company; or (b) disclose or otherwise make available any Confidential Information to any third party without the Company's prior written consent. Advisor will protect the Confidential Information from unauthorized use, access, or disclosure using at least the same degree of care<span id="care-level-span">${
              confidentialityLevel === 'enhanced' ? 
              `, but no less than a reasonable degree of care,` :
              ''
            }</span> as Advisor uses to protect Advisor's own confidential information of a similar nature.</p>
            
            <p id="confidentiality-exceptions-para">4.3 <b>Exceptions.</b> The obligations in Section 4.2 will not apply to any information that: (a) was known to Advisor prior to receipt from the Company without an obligation of confidentiality; (b) is or becomes publicly known through no fault of Advisor; (c) is rightfully received by Advisor from a third party without a duty of confidentiality; (d) is independently developed by Advisor without use of or reference to the Confidential Information; or (e) is required to be disclosed by law or court order, provided that Advisor gives the Company prompt written notice of such requirement and cooperates with the Company in seeking a protective order or other appropriate protection of such information.</p>
            
            <div id="return-materials-div">
            ${
              confidentialityLevel === 'enhanced' ? 
              `<p id="return-materials-para">4.4 <b>Return of Materials.</b> Upon termination of this Agreement or at the Company's request at any time, Advisor will promptly: (a) return to the Company all tangible documents and materials (and any copies, extracts, and summaries thereof) containing or reflecting any Confidential Information; and (b) delete or destroy all electronic files containing or reflecting any Confidential Information. At the Company's request, Advisor will provide written confirmation of such deletion or destruction.</p>` :
              ''
            }
            </div>
          </div>
          
          <div class="document-section" id="ip-section">
            <p class="section-heading">5. INTELLECTUAL PROPERTY</p>
            
            <p id="works-para">5.1 <b>Works.</b> <span id="work-for-hire-span">Advisor agrees that all notes, records, drawings, designs, inventions, improvements, developments, discoveries, trade secrets, and works of authorship, whether patentable or copyrightable, conceived, made, or discovered by Advisor, solely or in collaboration with others, during the term of this Agreement in connection with the Services (collectively, "Works") will ${
              workForHire ? 
              'be works made for hire and will' :
              ''
            } remain the sole and exclusive property of the Company.</span></p>
            
            <p id="assignment-para">5.2 <b>Assignment.</b> To the extent any Works may not be deemed works made for hire under applicable law, Advisor hereby <span id="ip-assignment-span">${
              ipAssignment === 'full' ? 
              'irrevocably assigns to the Company all right, title, and interest worldwide in and to such Works and all intellectual property rights therein.' :
              'assigns to the Company all right, title, and interest worldwide in and to such Works and all intellectual property rights therein that directly relate to the Company\'s business or that are conceived, made, or discovered by Advisor in connection with performing the Services.'
            }</span></p>
            
            <p id="moral-rights-para">5.3 <b>Moral Rights.</b> Advisor hereby irrevocably waives and agrees never to assert any moral rights Advisor may have in or with respect to any Works, even after termination of this Agreement.</p>
            
            <p id="assistance-para">5.4 <b>Assistance.</b> Advisor will assist the Company (at the Company's expense) to obtain and enforce patents, copyrights, or other rights in the Works. Advisor will execute any documents that the Company may reasonably request for use in obtaining or enforcing such patents, copyrights, or other rights.</p>
            
            <div id="pre-existing-ip-div">
            ${
              ipAssignment === 'limited' ? 
              `<p id="pre-existing-ip-para">5.5 <b>Pre-Existing Intellectual Property.</b> Advisor retains all right, title, and interest in and to any of Advisor's pre-existing intellectual property, including any developments made by Advisor outside the scope of the Services, provided that Advisor hereby grants to the Company a non-exclusive, perpetual, irrevocable, royalty-free, worldwide license to use such pre-existing intellectual property incorporated into any Works or delivered to the Company as part of the Services.</p>` :
              ''
            }
            </div>
          </div>
          
          <div class="document-section" id="relationship-section">
            <p class="section-heading">6. RELATIONSHIP OF THE PARTIES</p>
            
            <p id="independent-contractor-para">6.1 <b>Independent Contractor.</b> Advisor is an independent contractor and not an employee, agent, or partner of the Company. Advisor will not be eligible for any employee benefits or unemployment insurance benefits by virtue of this Agreement. Advisor is free to provide services to others during the term of this Agreement, provided that such services do not create a conflict of interest or interfere with Advisor's obligations under this Agreement.</p>
            
            <p id="no-authority-para">6.2 <b>No Authority.</b> Advisor has no authority to bind the Company in any contract or obligation without the prior written authorization of the Company.</p>
            
            <p id="ca-contractor-para">6.3 <b>California Independent Contractor Status.</b> Advisor acknowledges that under California law, individuals performing services for another person or business as an independent contractor may be classified as an employee if the relationship meets the requirements established by law. The parties intend to create an independent contractor relationship, and this Agreement shall be interpreted consistent with that intent.</p>
          </div>
          
          <div class="document-section" id="liability-section">
            <p class="section-heading">7. LIMITATION OF LIABILITY</p>
            
            <p id="limitation-liability-para">7.1 <b>Limitation of Liability.</b> EXCEPT FOR BREACHES OF SECTIONS 4 (CONFIDENTIALITY) OR 5 (INTELLECTUAL PROPERTY), IN NO EVENT WILL EITHER PARTY BE LIABLE TO THE OTHER PARTY FOR ANY SPECIAL, INCIDENTAL, INDIRECT, EXEMPLARY, OR CONSEQUENTIAL DAMAGES OF ANY KIND IN CONNECTION WITH THIS AGREEMENT, EVEN IF THE PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. EXCEPT FOR BREACHES OF SECTIONS 4 (CONFIDENTIALITY) OR 5 (INTELLECTUAL PROPERTY), EACH PARTY'S TOTAL CUMULATIVE LIABILITY IN CONNECTION WITH THIS AGREEMENT, WHETHER IN CONTRACT, TORT, OR OTHERWISE, WILL NOT EXCEED THE AMOUNT OF FEES PAID OR PAYABLE TO ADVISOR UNDER THIS AGREEMENT.</p>
          </div>
          
          <div class="document-section" id="general-section">
            <p class="section-heading">8. GENERAL PROVISIONS</p>
            
            <p id="entire-agreement-para">8.1 <b>Entire Agreement.</b> This Agreement constitutes the entire agreement between the parties relating to the subject matter hereof and supersedes all prior or contemporaneous agreements, whether written or oral, between the parties with respect to such subject matter.</p>
            
            <p id="amendments-para">8.2 <b>Amendments.</b> This Agreement may only be amended or modified by a written agreement signed by both parties.</p>
            
            <p id="assignment-agreement-para">8.3 <b>Assignment.</b> Advisor may not assign or delegate any rights or obligations under this Agreement without the Company's prior written consent. The Company may assign this Agreement to any successor to its business. Subject to the foregoing, this Agreement will be binding upon and inure to the benefit of the parties and their respective successors and permitted assigns.</p>
            
            <p id="severability-para">8.4 <b>Severability.</b> If any provision of this Agreement is held invalid, illegal, or unenforceable, the validity, legality, and enforceability of the remaining provisions will not be affected or impaired.</p>
            
            <p id="governing-law-para">8.5 <b>Governing Law.</b> This Agreement will be governed by and construed in accordance with the laws of the State of California, without regard to its conflict of laws principles.</p>
            
            <p id="dispute-resolution-para">8.6 <b>Dispute Resolution.</b> <span id="dispute-resolution-span">${
              disputeMethod === 'court' ? 
              `Any dispute arising out of or relating to this Agreement shall be resolved in the state or federal courts located in <span id="venue-county-span">${venueCounty}</span>, California, and each party consents to the personal jurisdiction and venue of such courts.` :
              disputeMethod === 'arbitration' ? 
              `Any dispute arising out of or relating to this Agreement shall be resolved through binding arbitration conducted in <span id="venue-county-span">${venueCounty}</span>, California, in accordance with the Commercial Arbitration Rules of the American Arbitration Association. The arbitration shall be conducted by a single arbitrator, and judgment on the award may be entered in any court having jurisdiction.` :
              `Any dispute arising out of or relating to this Agreement shall first be submitted to mediation in <span id="venue-county-span">${venueCounty}</span>, California. If mediation is unsuccessful, the dispute shall be resolved through binding arbitration conducted in <span id="venue-county-span">${venueCounty}</span>, California, in accordance with the Commercial Arbitration Rules of the American Arbitration Association. The arbitration shall be conducted by a single arbitrator, and judgment on the award may be entered in any court having jurisdiction.`
            }</span></p>
            
            <p id="notices-para">8.7 <b>Notices.</b> All notices under this Agreement must be in writing and will be deemed given when personally delivered, sent by overnight courier, or by electronic mail with confirmation of receipt.</p>
            
            <p id="waiver-para">8.8 <b>Waiver.</b> No waiver of any provision of this Agreement will be effective unless in writing and signed by the waiving party. No failure or delay by either party in exercising any right under this Agreement will constitute a waiver.</p>
            
            ${
              additionalTerms ? 
              `<p id="additional-terms-para">8.9 <b>Additional Terms.</b> <span id="additional-terms-span">${additionalTerms}</span></p>` :
              ''
            }
          </div>
          
          <div class="document-section" id="signature-section">
            <p id="signature-para">IN WITNESS WHEREOF, the parties have executed this Advisory Agreement as of the Effective Date.</p>
            
            <div class="signature-block">
              <p><b>COMPANY:</b></p>
              <p>${companyName}</p>
              <span class="signature-line"></span>
              <p>By: ______________________________</p>
              <p>Name: ___________________________</p>
              <p>Title: _____________________________</p>
              <p>Date: _____________________________</p>
              
              <p style="margin-top: 40px;"><b>ADVISOR:</b></p>
              <span class="signature-line"></span>
              <p>${advisorName}</p>
              <p>Date: _____________________________</p>
            </div>
          </div>
        `;
        
        // Update the preview with the agreement HTML
        preview.innerHTML = agreementHtml;
        
        // If a specific field was changed, highlight the relevant section
        if (changedField) {
          highlightChangedContent(changedField);
        }
      }
      
      // Function to highlight changed content in the preview
      function highlightChangedContent(changedField) {
        // Clear any existing highlights
        clearHighlights();
        
        // Map fields to their corresponding span IDs
        const fieldMappings = {
          // Party information
          'companyName': 'company-name-span',
          'companyAddress': 'company-address-span',
          'advisorName': 'advisor-name-span',
          'advisorAddress': 'advisor-address-span',
          'effectiveDate': 'effective-date-span',
          
          // Services
          'servicesDescription': 'services-description-span',
          'timeCommitment': 'time-commitment-span',
          'serviceLocation': 'service-location-span',
          
          // Compensation
          'compensationType': 'compensation-type-span',
          'cashAmount': 'cash-amount-span',
          'paymentFrequency': 'payment-frequency-span',
          'equityAmount': 'equity-amount-span',
          'vestingSchedule': 'vesting-schedule-span',
          'expensePolicy': 'expense-details-span',
          'expenseDetails': 'expense-details-span',
          
          // Term and termination
          'termType': 'term-text-span',
          'termDuration': 'term-duration-span',
          'autoRenewal': 'auto-renewal-span',
          'terminationNotice': 'termination-notice-span',
          'terminationWithCause': 'termination-text-span',
          'terminationForConvenience': 'termination-text-span',
          
          // Confidentiality and IP
          'confidentialityLevel': ['confidentiality-detail-span', 'care-level-span', 'return-materials-div'],
          'ipAssignment': ['ip-assignment-span', 'pre-existing-ip-div'],
          'workForHire': 'work-for-hire-span',
          
          // Relationship and dispute resolution
          'relationship': 'independent-contractor-para',
          'disputeMethod': 'dispute-resolution-span',
          'venueCounty': 'venue-county-span',
          
          // Additional terms
          'additionalTerms': 'additional-terms-span'
        };
        
        // Get the element ID(s) to highlight
        let elementIds = fieldMappings[changedField] || '';
        
        // Convert single ID to array for consistent processing
        if (!Array.isArray(elementIds)) {
          elementIds = [elementIds];
        }
        
        // Process each element to highlight
        let highlightedSomething = false;
        
        for (const elementId of elementIds) {
          if (elementId) {
            const element = document.getElementById(elementId);
            if (element) {
              // Apply highlight class
              element.classList.add('highlight');
              highlightedElements.push(element);
              highlightedSomething = true;
              
              // If this is the first highlighted element, ensure it's visible
              if (highlightedElements.length === 1) {
                // Ensure the highlighted element is visible
                const elementRect = element.getBoundingClientRect();
                const previewRect = previewBox.getBoundingClientRect();
                
                // If element is not fully visible in the preview box
                if (elementRect.top < previewRect.top || elementRect.bottom > previewRect.bottom) {
                  // Scroll to the element (with a small offset to better center it)
                  previewBox.scrollTop = element.offsetTop - previewBox.clientHeight / 3;
                }
              }
            }
          }
        }
        
        // If nothing was highlighted by specific IDs, fall back to paragraph highlighting for special cases
        if (!highlightedSomething) {
          // Special cases or legacy fields without specific spans
          const fallbackMappings = {
            'relationship': 'independent-contractor-para',
            // Add other mappings as needed for elements without specific spans
          };
          
          const fallbackId = fallbackMappings[changedField];
          if (fallbackId) {
            const element = document.getElementById(fallbackId);
            if (element) {
              element.classList.add('highlight');
              highlightedElements.push(element);
              
              // Ensure the highlighted element is visible
              const elementRect = element.getBoundingClientRect();
              const previewRect = previewBox.getBoundingClientRect();
              
              // If element is not fully visible in the preview box
              if (elementRect.top < previewRect.top || elementRect.bottom > previewRect.bottom) {
                // Scroll to the element (with a small offset to better center it)
                previewBox.scrollTop = element.offsetTop - previewBox.clientHeight / 3;
              }
            }
          }
        }
        
        // Set timeout to remove highlight after 5 seconds
        highlightTimeout = setTimeout(() => {
          clearHighlights();
        }, 5000);
      }
      
      // Function to generate and download a DOCX file
      function generateDocx() {
        try {
          // Access docx library
          const docx = window.docx;
          if (!docx) {
            throw new Error("DOCX library not loaded");
          }
          
          // Get all form values
          const companyName = document.getElementById('companyName').value;
          const companyAddress = document.getElementById('companyAddress').value;
          const advisorName = document.getElementById('advisorName').value;
          const advisorAddress = document.getElementById('advisorAddress').value;
          const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
          
          const servicesDescription = document.getElementById('servicesDescription').value;
          const timeCommitment = document.getElementById('timeCommitment').value;
          const serviceLocation = document.querySelector('input[name="serviceLocation"]:checked').value;
          
          const compensationType = document.querySelector('input[name="compensationType"]:checked').value;
          const cashAmount = document.getElementById('cashAmount').value;
          const paymentFrequencyEl = document.getElementById('paymentFrequency');
          const paymentFrequency = paymentFrequencyEl.options[paymentFrequencyEl.selectedIndex].text;
          const equityAmount = document.getElementById('equityAmount').value;
          const vestingSchedule = document.getElementById('vestingSchedule').value;
          
          const expensePolicyEl = document.getElementById('expensePolicy');
          const expensePolicy = expensePolicyEl.value;
          const expenseDetails = document.getElementById('expenseDetails').value;
          
          const termType = document.querySelector('input[name="termType"]:checked').value;
          const termDuration = document.getElementById('termDuration').value;
          const autoRenewalEl = document.getElementById('autoRenewal');
          const autoRenewal = autoRenewalEl.value === 'yes';
          const terminationNoticeEl = document.getElementById('terminationNotice');
          const terminationNotice = terminationNoticeEl.value;
          
          const terminationWithCause = document.getElementById('terminationWithCause').checked;
          const terminationForConvenience = document.getElementById('terminationForConvenience').checked;
          
          const confidentialityLevel = document.querySelector('input[name="confidentialityLevel"]:checked').value;
          const ipAssignment = document.querySelector('input[name="ipAssignment"]:checked').value;
          const workForHireEl = document.getElementById('workForHire');
          const workForHire = workForHireEl.value === 'yes';
          
          const relationship = document.querySelector('input[name="relationship"]:checked').value;
          const disputeMethod = document.querySelector('input[name="disputeMethod"]:checked').value;
          const venueCountyEl = document.getElementById('venueCounty');
          const venueCounty = venueCountyEl.options[venueCountyEl.selectedIndex].text;
          
          const additionalTerms = document.getElementById('additionalTerms').value;
          
          // Create paragraphs array
          const paragraphs = [];
          
          // Title
          paragraphs.push(
            new docx.Paragraph({
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "ADVISORY AGREEMENT",
                  bold: true,
                  size: 28
                })
              ]
            })
          );
          
          // Introduction
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: `This Advisory Agreement (the "Agreement") is entered into as of ${effectiveDate} (the "Effective Date"), by and between ${companyName}, a California corporation with its principal place of business at ${companyAddress} (the "Company"), and ${advisorName}, an individual with an address at ${advisorAddress} (the "Advisor").`
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 480
              },
              children: [
                new docx.TextRun({
                  text: `The parties agree as follows:`
                })
              ]
            })
          );
          
          // Section 1: Services
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "1. SERVICES",
                  bold: true
                })
              ]
            })
          );
          
          // 1.1 Services
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "1.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Services. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: `Advisor will provide advisory and consulting services to the Company as reasonably requested by the Company from time to time (the "Services"), including but not limited to: ${servicesDescription}`
                })
              ]
            })
          );
          
          // 1.2 Time Commitment
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "1.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Time Commitment. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: `Advisor will devote approximately ${timeCommitment} to performing the Services. The timing and availability of the Services shall be reasonably determined by mutual agreement between Advisor and the Company.`
                })
              ]
            })
          );
          
          // 1.3 Location
          let locationText = '';
          if (serviceLocation === 'remote') {
            locationText = 'primarily remotely via phone, email, or video conference';
          } else if (serviceLocation === 'hybrid') {
            locationText = 'through a combination of remote meetings and on-site visits as reasonably requested by the Company';
          } else {
            locationText = 'primarily at the Company\'s offices or at such other locations as reasonably requested by the Company';
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "1.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Location. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: `Advisor will provide the Services ${locationText}.`
                })
              ]
            })
          );
          
          // 1.4 Performance
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "1.4 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Performance. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: `Advisor will perform the Services in a professional and workmanlike manner, consistent with industry standards. Advisor will comply with all applicable laws and Company policies when performing the Services.`
                })
              ]
            })
          );
          
          // Section 2: Compensation
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "2. COMPENSATION",
                  bold: true
                })
              ]
            })
          );
          
          // 2.1 Compensation
          let compensationTitle = '';
          let compensationText = '';
          
          if (compensationType === 'cash') {
            compensationTitle = 'Cash Compensation';
            compensationText = `As full compensation for the Services, the Company will pay Advisor ${cashAmount} ${paymentFrequency.toLowerCase()}.`;
          } else if (compensationType === 'equity') {
            compensationTitle = 'Equity Compensation';
            compensationText = `As full compensation for the Services, the Company will grant Advisor ${equityAmount}, subject to the terms and conditions of the Company's equity incentive plan and applicable equity grant documents. ${vestingSchedule}`;
          } else {
            compensationTitle = 'Compensation';
            compensationText = `As full compensation for the Services, the Company will (a) pay Advisor ${cashAmount} ${paymentFrequency.toLowerCase()}, and (b) grant Advisor ${equityAmount}, subject to the terms and conditions of the Company's equity incentive plan and applicable equity grant documents. ${vestingSchedule}`;
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "2.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: `${compensationTitle}. `,
                  bold: true
                }),
                new docx.TextRun({
                  text: compensationText
                })
              ]
            })
          );
          
          // 2.2 Expenses
          let expenseText = '';
          if (expensePolicy === 'noExpenses') {
            expenseText = 'Advisor is responsible for all expenses incurred in performing the Services, and the Company will not reimburse any expenses.';
          } else {
            expenseText = expenseDetails;
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "2.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Expenses. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: expenseText
                })
              ]
            })
          );
          
          // 2.3 Taxes
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "2.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Taxes. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor is solely responsible for all taxes, withholdings, and other statutory or contractual obligations of any sort related to Advisor's performance of the Services, including but not limited to, self-employment tax, income tax, and any other applicable taxes. The Company will report the compensation paid to Advisor under this Agreement as required by applicable law."
                })
              ]
            })
          );
          
          // Section 3: Term and Termination
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "3. TERM AND TERMINATION",
                  bold: true
                })
              ]
            })
          );
          
          // 3.1 Term
          let termText = '';
          if (termType === 'fixed') {
            termText = `This Agreement will commence on the Effective Date and will continue for a period of ${termDuration}, unless earlier terminated as provided in this Agreement`;
            if (autoRenewal) {
              termText += `. Upon expiration, this Agreement will automatically renew for successive periods of the same duration, unless either party provides written notice of non-renewal at least ${terminationNotice} days before the end of the then-current term`;
            }
            termText += '.';
          } else {
            termText = 'This Agreement will commence on the Effective Date and will continue until terminated as provided in this Agreement.';
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "3.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Term. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: termText
                })
              ]
            })
          );
          
          // 3.2 Termination
          let terminationText = '';
          if (terminationWithCause && terminationForConvenience) {
            terminationText = `This Agreement may be terminated: (a) by either party upon written notice to the other party at least ${terminationNotice} days in advance; or (b) immediately by either party if the other party materially breaches this Agreement.`;
          } else if (terminationWithCause) {
            terminationText = "This Agreement may be terminated immediately by either party if the other party materially breaches this Agreement.";
          } else if (terminationForConvenience) {
            terminationText = `This Agreement may be terminated by either party upon written notice to the other party at least ${terminationNotice} days in advance.`;
          } else {
            terminationText = "This Agreement may only be terminated upon mutual written agreement of the parties or expiration of its term.";
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "3.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Termination. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: terminationText
                })
              ]
            })
          );
          
          // 3.3 Effect of Termination
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "3.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Effect of Termination. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Upon termination of this Agreement: (a) Advisor will promptly deliver to the Company all Company property, including Confidential Information and work product, in Advisor's possession or control; (b) the Company will pay Advisor any fees earned for Services performed up to the date of termination; and (c) the following provisions will survive: Sections 4 (Confidentiality), 5 (Intellectual Property), 7 (Limitation of Liability), 8 (Indemnification), and 10 (General Provisions)."
                })
              ]
            })
          );
          
          // Section 4: Confidentiality
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "4. CONFIDENTIALITY",
                  bold: true
                })
              ]
            })
          );
          
          // 4.1 Confidential Information
          let confidentialInfoText = '';
          if (confidentialityLevel === 'enhanced') {
            confidentialInfoText = `"Confidential Information" means all non-public information, whether in oral, written, or electronic form, concerning the Company and its business, technology, products, plans, and services that is provided to Advisor by the Company or its representatives, or that Advisor has access to during the term of this Agreement, including, but not limited to: (a) trade secrets, inventions, ideas, processes, formulas, source and object code, data, programs, other works of authorship, know-how, improvements, discoveries, developments, designs, and techniques; (b) information regarding plans for research, development, new products, marketing and selling, business plans, budgets, financial information, licenses, prices and costs, suppliers, and customers; and (c) information regarding the skills and compensation of employees and contractors of the Company.`;
          } else {
            confidentialInfoText = `"Confidential Information" means all non-public information, whether in oral, written, or electronic form, concerning the Company and its business, technology, products, plans, and services that is provided to Advisor by the Company or its representatives, or that Advisor has access to during the term of this Agreement.`;
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "4.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Confidential Information. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: confidentialInfoText
                })
              ]
            })
          );
          
          // 4.2 Non-Disclosure and Non-Use
          let nonDisclosureText = '';
          if (confidentialityLevel === 'enhanced') {
            nonDisclosureText = "Advisor will not, during or after the term of this Agreement, directly or indirectly: (a) use any Confidential Information for any purpose other than performing the Services for the benefit of the Company; or (b) disclose or otherwise make available any Confidential Information to any third party without the Company's prior written consent. Advisor will protect the Confidential Information from unauthorized use, access, or disclosure using at least the same degree of care, but no less than a reasonable degree of care, as Advisor uses to protect Advisor's own confidential information of a similar nature.";
          } else {
            nonDisclosureText = "Advisor will not, during or after the term of this Agreement, directly or indirectly: (a) use any Confidential Information for any purpose other than performing the Services for the benefit of the Company; or (b) disclose or otherwise make available any Confidential Information to any third party without the Company's prior written consent. Advisor will protect the Confidential Information from unauthorized use, access, or disclosure using at least the same degree of care as Advisor uses to protect Advisor's own confidential information of a similar nature.";
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "4.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Non-Disclosure and Non-Use. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: nonDisclosureText
                })
              ]
            })
          );
          
          // 4.3 Exceptions
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "4.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Exceptions. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "The obligations in Section 4.2 will not apply to any information that: (a) was known to Advisor prior to receipt from the Company without an obligation of confidentiality; (b) is or becomes publicly known through no fault of Advisor; (c) is rightfully received by Advisor from a third party without a duty of confidentiality; (d) is independently developed by Advisor without use of or reference to the Confidential Information; or (e) is required to be disclosed by law or court order, provided that Advisor gives the Company prompt written notice of such requirement and cooperates with the Company in seeking a protective order or other appropriate protection of such information."
                })
              ]
            })
          );
          
          // 4.4 Return of Materials for enhanced confidentiality
          if (confidentialityLevel === 'enhanced') {
            paragraphs.push(
              new docx.Paragraph({
                spacing: {
                  before: 120,
                  after: 240
                },
                children: [
                  new docx.TextRun({
                    text: "4.4 ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: "Return of Materials. ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: "Upon termination of this Agreement or at the Company's request at any time, Advisor will promptly: (a) return to the Company all tangible documents and materials (and any copies, extracts, and summaries thereof) containing or reflecting any Confidential Information; and (b) delete or destroy all electronic files containing or reflecting any Confidential Information. At the Company's request, Advisor will provide written confirmation of such deletion or destruction."
                  })
                ]
              })
            );
          }
          
          // Section 5: Intellectual Property
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "5. INTELLECTUAL PROPERTY",
                  bold: true
                })
              ]
            })
          );
          
          // 5.1 Works
          let worksText = '';
          if (workForHire) {
            worksText = "Advisor agrees that all notes, records, drawings, designs, inventions, improvements, developments, discoveries, trade secrets, and works of authorship, whether patentable or copyrightable, conceived, made, or discovered by Advisor, solely or in collaboration with others, during the term of this Agreement in connection with the Services (collectively, \"Works\") will be works made for hire and will remain the sole and exclusive property of the Company.";
          } else {
            worksText = "Advisor agrees that all notes, records, drawings, designs, inventions, improvements, developments, discoveries, trade secrets, and works of authorship, whether patentable or copyrightable, conceived, made, or discovered by Advisor, solely or in collaboration with others, during the term of this Agreement in connection with the Services (collectively, \"Works\") will remain the sole and exclusive property of the Company.";
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "5.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Works. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: worksText
                })
              ]
            })
          );
          
          // 5.2 Assignment
          let assignmentText = '';
          if (ipAssignment === 'full') {
            assignmentText = "To the extent any Works may not be deemed works made for hire under applicable law, Advisor hereby irrevocably assigns to the Company all right, title, and interest worldwide in and to such Works and all intellectual property rights therein.";
          } else {
            assignmentText = "To the extent any Works may not be deemed works made for hire under applicable law, Advisor hereby assigns to the Company all right, title, and interest worldwide in and to such Works and all intellectual property rights therein that directly relate to the Company's business or that are conceived, made, or discovered by Advisor in connection with performing the Services.";
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "5.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Assignment. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: assignmentText
                })
              ]
            })
          );
          
          // 5.3 Moral Rights
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "5.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Moral Rights. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor hereby irrevocably waives and agrees never to assert any moral rights Advisor may have in or with respect to any Works, even after termination of this Agreement."
                })
              ]
            })
          );
          
          // 5.4 Assistance
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "5.4 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Assistance. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor will assist the Company (at the Company's expense) to obtain and enforce patents, copyrights, or other rights in the Works. Advisor will execute any documents that the Company may reasonably request for use in obtaining or enforcing such patents, copyrights, or other rights."
                })
              ]
            })
          );
          
          // 5.5 Pre-existing IP for limited assignment
          if (ipAssignment === 'limited') {
            paragraphs.push(
              new docx.Paragraph({
                spacing: {
                  before: 120,
                  after: 240
                },
                children: [
                  new docx.TextRun({
                    text: "5.5 ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: "Pre-Existing Intellectual Property. ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: "Advisor retains all right, title, and interest in and to any of Advisor's pre-existing intellectual property, including any developments made by Advisor outside the scope of the Services, provided that Advisor hereby grants to the Company a non-exclusive, perpetual, irrevocable, royalty-free, worldwide license to use such pre-existing intellectual property incorporated into any Works or delivered to the Company as part of the Services."
                  })
                ]
              })
            );
          }
          
          // Section 6: Relationship of the Parties
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "6. RELATIONSHIP OF THE PARTIES",
                  bold: true
                })
              ]
            })
          );
          
          // 6.1 Independent Contractor
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "6.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Independent Contractor. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor is an independent contractor and not an employee, agent, or partner of the Company. Advisor will not be eligible for any employee benefits or unemployment insurance benefits by virtue of this Agreement. Advisor is free to provide services to others during the term of this Agreement, provided that such services do not create a conflict of interest or interfere with Advisor's obligations under this Agreement."
                })
              ]
            })
          );
          
          // 6.2 No Authority
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "6.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "No Authority. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor has no authority to bind the Company in any contract or obligation without the prior written authorization of the Company."
                })
              ]
            })
          );
          
          // 6.3 California Independent Contractor Status
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "6.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "California Independent Contractor Status. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor acknowledges that under California law, individuals performing services for another person or business as an independent contractor may be classified as an employee if the relationship meets the requirements established by law. The parties intend to create an independent contractor relationship, and this Agreement shall be interpreted consistent with that intent."
                })
              ]
            })
          );
          
          // Section 7: Limitation of Liability
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "7. LIMITATION OF LIABILITY",
                  bold: true
                })
              ]
            })
          );
          
          // 7.1 Limitation of Liability
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "7.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Limitation of Liability. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "EXCEPT FOR BREACHES OF SECTIONS 4 (CONFIDENTIALITY) OR 5 (INTELLECTUAL PROPERTY), IN NO EVENT WILL EITHER PARTY BE LIABLE TO THE OTHER PARTY FOR ANY SPECIAL, INCIDENTAL, INDIRECT, EXEMPLARY, OR CONSEQUENTIAL DAMAGES OF ANY KIND IN CONNECTION WITH THIS AGREEMENT, EVEN IF THE PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. EXCEPT FOR BREACHES OF SECTIONS 4 (CONFIDENTIALITY) OR 5 (INTELLECTUAL PROPERTY), EACH PARTY'S TOTAL CUMULATIVE LIABILITY IN CONNECTION WITH THIS AGREEMENT, WHETHER IN CONTRACT, TORT, OR OTHERWISE, WILL NOT EXCEED THE AMOUNT OF FEES PAID OR PAYABLE TO ADVISOR UNDER THIS AGREEMENT."
                })
              ]
            })
          );
          
          // Section 8: General Provisions
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "8. GENERAL PROVISIONS",
                  bold: true
                })
              ]
            })
          );
          
          // 8.1 Entire Agreement
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.1 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Entire Agreement. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "This Agreement constitutes the entire agreement between the parties relating to the subject matter hereof and supersedes all prior or contemporaneous agreements, whether written or oral, between the parties with respect to such subject matter."
                })
              ]
            })
          );
          
          // 8.2 Amendments
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.2 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Amendments. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "This Agreement may only be amended or modified by a written agreement signed by both parties."
                })
              ]
            })
          );
          
          // 8.3 Assignment
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.3 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Assignment. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Advisor may not assign or delegate any rights or obligations under this Agreement without the Company's prior written consent. The Company may assign this Agreement to any successor to its business. Subject to the foregoing, this Agreement will be binding upon and inure to the benefit of the parties and their respective successors and permitted assigns."
                })
              ]
            })
          );
          
          // 8.4 Severability
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.4 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Severability. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "If any provision of this Agreement is held invalid, illegal, or unenforceable, the validity, legality, and enforceability of the remaining provisions will not be affected or impaired."
                })
              ]
            })
          );
          
          // 8.5 Governing Law
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.5 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Governing Law. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "This Agreement will be governed by and construed in accordance with the laws of the State of California, without regard to its conflict of laws principles."
                })
              ]
            })
          );
          
          // 8.6 Dispute Resolution
          let disputeResolutionText = '';
          if (disputeMethod === 'court') {
            disputeResolutionText = `Any dispute arising out of or relating to this Agreement shall be resolved in the state or federal courts located in ${venueCounty}, California, and each party consents to the personal jurisdiction and venue of such courts.`;
          } else if (disputeMethod === 'arbitration') {
            disputeResolutionText = `Any dispute arising out of or relating to this Agreement shall be resolved through binding arbitration conducted in ${venueCounty}, California, in accordance with the Commercial Arbitration Rules of the American Arbitration Association. The arbitration shall be conducted by a single arbitrator, and judgment on the award may be entered in any court having jurisdiction.`;
          } else {
            disputeResolutionText = `Any dispute arising out of or relating to this Agreement shall first be submitted to mediation in ${venueCounty}, California. If mediation is unsuccessful, the dispute shall be resolved through binding arbitration conducted in ${venueCounty}, California, in accordance with the Commercial Arbitration Rules of the American Arbitration Association. The arbitration shall be conducted by a single arbitrator, and judgment on the award may be entered in any court having jurisdiction.`;
          }
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.6 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Dispute Resolution. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: disputeResolutionText
                })
              ]
            })
          );
          
          // 8.7 Notices
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.7 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Notices. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "All notices under this Agreement must be in writing and will be deemed given when personally delivered, sent by overnight courier, or by electronic mail with confirmation of receipt."
                })
              ]
            })
          );
          
          // 8.8 Waiver
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "8.8 ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "Waiver. ",
                  bold: true
                }),
                new docx.TextRun({
                  text: "No waiver of any provision of this Agreement will be effective unless in writing and signed by the waiving party. No failure or delay by either party in exercising any right under this Agreement will constitute a waiver."
                })
              ]
            })
          );
          
          // 8.9 Additional Terms
          if (additionalTerms) {
            paragraphs.push(
              new docx.Paragraph({
                spacing: {
                  before: 120,
                  after: 240
                },
                children: [
                  new docx.TextRun({
                    text: "8.9 ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: "Additional Terms. ",
                    bold: true
                  }),
                  new docx.TextRun({
                    text: additionalTerms
                  })
                ]
              })
            );
          }
          
          // Signature Block
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 360,
                after: 240
              },
              children: [
                new docx.TextRun({
                  text: "IN WITNESS WHEREOF, the parties have executed this Advisory Agreement as of the Effective Date."
                })
              ]
            })
          );
          
          // Company Signature
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "COMPANY:",
                  bold: true
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: companyName
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "By: ______________________________"
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "Name: ___________________________"
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "Title: _____________________________"
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 360
              },
              children: [
                new docx.TextRun({
                  text: "Date: _____________________________"
                })
              ]
            })
          );
          
          // Advisor Signature
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "ADVISOR:",
                  bold: true
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 240,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "______________________________"
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: advisorName
                })
              ]
            })
          );
          
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 120,
                after: 120
              },
              children: [
                new docx.TextRun({
                  text: "Date: _____________________________"
                })
              ]
            })
          );
          
          // Create document
          const doc = new docx.Document({
            styles: {
              default: {
                document: {
                  run: {
                    size: 24, // 12pt in half-points
                    font: "Times New Roman"
                  },
                  paragraph: {
                    spacing: {
                      line: 360, // 1.5 line spacing
                      before: 0,
                      after: 0
                    }
                  }
                }
              }
            },
            sections: [{
              properties: {
                page: {
                  margin: {
                    top: 1440, // 1 inch in twips
                    right: 1440,
                    bottom: 1440,
                    left: 1440
                  }
                }
              },
              children: paragraphs
            }]
          });
          
          // Generate and save document
          docx.Packer.toBlob(doc)
            .then(blob => {
              const filename = `${companyName.replace(/[^a-z0-9]/gi, '_')}_Advisory_Agreement.docx`;
              window.saveAs(blob, filename);
            })
            .catch(error => {
              console.error("Error saving DOCX:", error);
              alert("Unable to download the document. Please try using the copy button instead.");
            });
        } catch (error) {
          console.error("DOCX generation error:", error);
          alert("Unable to download the document. Please try using the copy button instead.");
        }
      }
    });
  </script>
</body>
</html>



<p></p>



<h1 class="wp-block-heading">Protecting Your Business Relationships</h1>



<p>As a California business attorney with over 13 years of experience, I&#8217;ve seen countless advisory relationships go south due to poorly drafted agreements. Whether you&#8217;re a startup looking to formalize your relationship with a strategic advisor or an established company seeking specialized expertise, a well-crafted advisory agreement is essential to protect both parties.</p>



<h2 class="wp-block-heading">Why You Need a Proper California Advisory Agreement</h2>



<p>Advisory relationships are common in the California business ecosystem, particularly in tech and startup environments. These relationships bring valuable expertise to your company, but without proper documentation, they can lead to misunderstandings, intellectual property disputes, and even legal liability.</p>



<p>California law has specific requirements that make advisory agreements particularly important in our state. As a business owner, you need to clearly establish the independent contractor status of your advisors, protect your confidential information, and secure proper assignment of intellectual property rights.</p>



<h2 class="wp-block-heading">Key Components of a California Advisory Agreement</h2>



<h3 class="wp-block-heading">1. Relationship Definition and Services</h3>



<p>The foundation of any advisory agreement is a clear definition of the relationship and the services to be provided. California courts look closely at the actual nature of working relationships, so your agreement should explicitly define the advisor as an independent contractor and outline specific services they&#8217;ll provide.</p>



<p>The agreement should specify:</p>



<ul class="wp-block-list">
<li>Scope of advisory services</li>



<li>Time commitment expectations</li>



<li>Service delivery location (remote, hybrid, or on-site)</li>



<li>Performance standards</li>
</ul>



<p>Having practiced in California for many years, I&#8217;ve seen how important it is to be explicit about these terms. Courts apply a multi-factor test when determining whether someone is truly an independent contractor, and proper documentation is your first line of defense.</p>



<h3 class="wp-block-heading">2. Compensation Structure</h3>



<p>Advisory compensation can take multiple forms in California, each with different legal and tax implications. Your agreement should clearly address:</p>



<p>For cash compensation:</p>



<ul class="wp-block-list">
<li>Payment amount and frequency</li>



<li>Expense reimbursement policies</li>



<li>Tax treatment (1099 reporting requirements)</li>
</ul>



<p>For equity compensation:</p>



<ul class="wp-block-list">
<li>Type and amount of equity granted</li>



<li>Vesting schedule</li>



<li>Exercise terms</li>



<li>Tax considerations (particularly important in California)</li>
</ul>



<p>The trend I&#8217;ve observed in California advisory relationships has shifted toward hybrid compensation models that include both cash and equity components, allowing companies to conserve cash while still attracting top advisory talent.</p>



<h3 class="wp-block-heading">3. Term and Termination Provisions</h3>



<p>California favors employment mobility, so termination provisions are particularly important. Your agreement should address:</p>



<ul class="wp-block-list">
<li>Initial term length (fixed or indefinite)</li>



<li>Auto-renewal provisions</li>



<li>Notice periods for termination</li>



<li>Termination for cause versus convenience</li>



<li>Post-termination obligations</li>
</ul>



<p>I recommend including reasonable notice periods that give both parties adequate time to adjust. California courts may scrutinize overly restrictive termination provisions, particularly if they appear to limit an advisor&#8217;s future opportunities.</p>



<h3 class="wp-block-heading">4. Confidentiality and IP Protection</h3>



<p>California has strict laws governing both confidentiality and intellectual property rights. Given the state&#8217;s unique combination of trade secret protection under the California Uniform Trade Secrets Act and strong employee mobility policies, your advisory agreement must carefully balance these interests.</p>



<p>For confidentiality:</p>



<ul class="wp-block-list">
<li>Define confidential information comprehensively</li>



<li>Include reasonable protection obligations</li>



<li>Address exceptions to confidentiality</li>



<li>Include provisions for return or destruction of confidential materials</li>
</ul>



<p>For IP protection:</p>



<ul class="wp-block-list">
<li>Include strong work-for-hire language</li>



<li>Secure proper IP assignment provisions</li>



<li>Address moral rights waivers</li>



<li>Consider pre-existing IP carve-outs when appropriate</li>
</ul>



<p>California&#8217;s strong public policy favoring employee mobility can make broad non-compete provisions unenforceable. However, properly drafted confidentiality and IP provisions can still protect your most valuable assets.</p>



<h3 class="wp-block-heading">5. Dispute Resolution</h3>



<p>Given California&#8217;s litigation landscape, thoughtful dispute resolution provisions are critical. Consider whether court proceedings, arbitration, or a combined approach best serves your interests:</p>



<ul class="wp-block-list">
<li>Court proceedings offer transparency but can be public and costly</li>



<li>Arbitration provides confidentiality but may limit appeal rights</li>



<li>Mediation followed by arbitration offers a balanced approach</li>
</ul>



<p>I always recommend specifying venue and jurisdiction in California, particularly in the county where your business operates, to avoid potential disputes over where any legal proceedings should take place.</p>



<h2 class="wp-block-heading">California-Specific Legal Considerations</h2>



<p>Advisory agreements in California must navigate several state-specific legal considerations:</p>



<p><strong>California Labor Code</strong>: California has strict rules regarding worker classification. Misclassifying an advisor who is functionally an employee can lead to significant penalties, back taxes, and wage claims.</p>



<p><strong>California&#8217;s Prohibition on Non-Competes</strong>: California Business &amp; Professions Code Section 16600 generally renders non-compete agreements unenforceable. Your advisory agreement should avoid broad restrictions on an advisor&#8217;s future activities.</p>



<p><strong>Intellectual Property Assignment</strong>: California Labor Code Section 2870 limits an employer&#8217;s ability to claim ownership of an employee&#8217;s inventions developed entirely on their own time without using employer resources. Similar principles can apply to advisors, so IP assignment provisions must be carefully drafted.</p>



<p><strong>California Privacy Laws</strong>: With the California Consumer Privacy Act (CCPA) and California Privacy Rights Act (CPRA), businesses must consider data privacy implications when advisors handle consumer personal information.</p>



<p>Over the years, I&#8217;ve refined my approach to advisory agreements to account for these California-specific issues while still providing robust protection for my clients&#8217; business interests.</p>



<h2 class="wp-block-heading">Using the California Advisory Agreement Generator</h2>



<p>My California Advisory Agreement Generator helps you create a customized agreement tailored to your specific business relationship. The tool walks you through all critical decisions and generates a professional agreement that addresses California&#8217;s unique legal requirements.</p>



<p>To get the most value:</p>



<ol class="wp-block-list">
<li>Provide accurate information about both parties</li>



<li>Carefully consider the services description and time commitment</li>



<li>Select the appropriate compensation structure</li>



<li>Choose termination provisions that make sense for your business relationship</li>



<li>Consider whether standard or enhanced confidentiality provisions better serve your needs</li>



<li>Select appropriate IP assignment terms based on your relationship</li>



<li>Choose dispute resolution methods aligned with your business priorities</li>
</ol>



<p>After generating your agreement, review it carefully to ensure it accurately reflects your intentions. While this generator creates a solid starting point, complex advisory relationships may benefit from additional customization.</p>



<h2 class="wp-block-heading">FAQ: California Advisory Agreements</h2>



<h3 class="wp-block-heading">How is an advisor different from an employee or independent contractor?</h3>



<p>In California, advisors typically function as independent contractors with a more limited engagement than traditional consultants. While employees work under the company&#8217;s direct control and are entitled to various benefits and protections under California labor laws, advisors usually maintain their independence, often work with multiple companies simultaneously, and provide strategic guidance rather than day-to-day operational support. The distinction matters because misclassification can lead to significant legal exposure under California&#8217;s strict employment laws.</p>



<h3 class="wp-block-heading">Can I restrict my advisor from working with competitors in California?</h3>



<p>California strongly disfavors restrictions on professional mobility. While you generally cannot prevent an advisor from working with competitors, you can protect your business through well-crafted confidentiality provisions that prevent the advisor from using or disclosing your proprietary information. The key is focusing on protecting your sensitive information rather than trying to restrict the advisor&#8217;s future activities, which courts are unlikely to enforce.</p>



<h3 class="wp-block-heading">How should equity compensation be structured for advisors in California?</h3>



<p>Equity compensation for California advisors typically involves either stock options or restricted stock units with a vesting schedule tied to the advisory relationship. The agreement should carefully address vesting acceleration on termination, exercise periods, and potential tax implications. California securities laws may also apply to equity grants, so it&#8217;s important to ensure compliance with both federal and state requirements. I generally recommend a vesting schedule that aligns with the expected duration of the advisory relationship.</p>



<h3 class="wp-block-heading">What happens if my advisor creates intellectual property during our engagement?</h3>



<p>Without a proper agreement, ownership of intellectual property created by an advisor could be contested. A well-drafted California advisory agreement will include both work-for-hire language and assignment provisions to ensure the company obtains ownership of relevant intellectual property. However, California Labor Code Section 2870 principles may come into play, potentially limiting your ability to claim ownership of inventions developed entirely on the advisor&#8217;s own time without using your resources, which is why specificity about the scope of services is crucial.</p>



<h3 class="wp-block-heading">Do I need to file my advisory agreement with any California agency?</h3>



<p>Generally, advisory agreements don&#8217;t need to be filed with state agencies. However, if the advisor receives equity compensation, you may need to comply with federal and state securities laws, which could involve filings with the Securities and Exchange Commission and potentially the California Department of Financial Protection and Innovation. Additionally, if your company is publicly traded, certain advisory relationships may need to be disclosed in your securities filings.</p>



<p>Creating a proper advisory agreement is an investment in your business&#8217;s future. The time spent clarifying expectations and legal rights now can prevent costly disputes later. For situations involving complex advisory relationships or significant equity compensation, I recommend scheduling a consultation to discuss your specific needs.</p>
</div>
    </article>
  </main>

  <footer><p>Â© 2025 Terms.Law. All rights reserved.</p></footer>
</body>
</html>