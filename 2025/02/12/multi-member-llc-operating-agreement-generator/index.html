<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Member LLC Operating Agreement Generator | Terms.Law</title>
  <meta name="description" content="The Multi-Member LLC Operating Agreement Generator allows users to create a personalized operating agreement for their LLC. It defines governance structures, me">
  <link rel="canonical" href="https://terms.law/2025/02/12/multi-member-llc-operating-agreement-generator/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css">
</head>
<body>
  <div id="site-header"></div>
  <script src="/shared/header-loader.js"></script>

  <main>
    <article>
      <h1>Multi-Member LLC Operating Agreement Generator</h1>
      <div class="meta">Published: February 12, 2025 • Document Generators, Free Templates, Incorporation</div>
      <div class="content">
<div id="multi-member-llc-generator" class="terms-law-tool">
  <div class="tool-container">
    <div class="tool-header">
      <h2>Multiple Member LLC Operating Agreement Generator</h2>
      <p class="tool-intro">Create a customized operating agreement for your multi-member LLC. This comprehensive legal document establishes how your business is governed, outlines members&#8217; rights and responsibilities, and helps protect all members&#8217; limited liability status.</p>
    </div>
    
    <!-- Progress Bar -->
    <div class="tool-progress-container">
      <div class="tool-progress-bar">
        <div id="progress-bar"></div>
      </div>
      <div class="tool-progress-text"><span id="current-step">1</span>/<span id="total-steps">6</span></div>
    </div>
    
    <!-- Split View Container -->
    <div class="split-view-container">
      <!-- Left Side: Question Container -->
      <div id="question-container" class="question-panel">
        <!-- Questions will be inserted here by JavaScript -->
      </div>
      
      <!-- Right Side: Preview Container -->
      <div id="preview-container" class="preview-panel">
        <div class="preview-header">
          <h3>Operating Agreement Preview</h3>
          <p class="preview-note">This preview updates as you make selections</p>
        </div>
        <div class="preview-content">
          <div id="preview-text"></div>
        </div>
      </div>
    </div>
    
    <!-- Results Container -->
    <div id="results-container" style="display: none;">
      <div class="results-header">
        <h3>Your Multi-Member LLC Operating Agreement</h3>
        <p>Below is your completed operating agreement based on the information provided.</p>
      </div>
      
      <div class="agreement-text-container">
        <div id="agreement-text"></div>
      </div>
      
      <div class="copy-action">
        <button id="copy-btn" class="tool-btn copy-btn">Copy Agreement Text</button>
        <button id="download-btn" class="tool-btn download-btn">Download as DOCX</button>
        <span id="copy-message" class="copy-message"></span>
      </div>
      
      <div class="agreement-notes">
        <h4>Important Notes</h4>
        <p>This operating agreement template is provided as a starting point and may need further customization for your specific situation:</p>
        <ul>
          <li>Review the document thoroughly before using it officially</li>
          <li>Ensure all members understand and agree to the terms</li>
          <li>Consider having it reviewed by a qualified attorney</li>
          <li>Update the agreement as your business evolves</li>
        </ul>
      </div>
      
      <!-- CTA Buttons -->
      <div class="results-cta">
        <button id="recalculate-btn" class="tool-btn tool-btn-secondary">Start Over</button>
        <a href="#" class="tool-btn tool-btn-cta" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">Schedule Legal Consultation</a>
      </div>
    </div>
  </div>
</div>

<style>
/* Tool Styles */
.terms-law-tool {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  max-width: 1200px;
  margin: 0 auto;
  color: #333;
}

.tool-container {
  background-color: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  padding: 20px;
  margin-bottom: 30px;
  position: relative;
  z-index: 1;
}

.tool-header {
  text-align: center;
  margin-bottom: 20px;
}

.tool-header h2 {
  color: #2c3e50;
  font-size: 24px;
  margin-bottom: 8px;
}

.tool-intro {
  color: #555;
  font-size: 15px;
  line-height: 1.5;
  max-width: 800px;
  margin: 0 auto;
}

/* Split View Layout */
.split-view-container {
  display: flex;
  gap: 20px;
  margin-bottom: 20px;
}

.question-panel {
  flex: 1;
  max-width: 50%;
}

.preview-panel {
  flex: 1;
  border-left: 1px solid #eee;
  padding-left: 20px;
}

.preview-header {
  margin-bottom: 15px;
}

.preview-header h3 {
  font-size: 18px;
  color: #2c3e50;
  margin: 0 0 5px 0;
}

.preview-note {
  font-size: 13px;
  color: #777;
  font-style: italic;
  margin: 0;
}

.preview-content {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 15px;
  max-height: 500px;
  overflow-y: auto;
  transition: background-color 0.5s ease;
  position: relative;
  z-index: 2;
}

#preview-text {
  font-size: 13px;
  line-height: 1.5;
  color: #333;
  white-space: pre-wrap;
}

.highlight {
  background-color: #ffffd0;
  transition: background-color 0.3s ease;
}

/* Progress Bar */
.tool-progress-container {
  margin: 20px 0;
  position: relative;
}

.tool-progress-bar {
  height: 6px;
  background-color: #e0e0e0;
  border-radius: 3px;
  overflow: hidden;
}

#progress-bar {
  height: 100%;
  background-color: #3498db;
  width: 16.67%;
  transition: width 0.3s ease;
}

.tool-progress-text {
  text-align: right;
  font-size: 12px;
  color: #777;
  margin-top: 5px;
}

/* Question Styles */
.question-step {
  margin-bottom: 20px;
}

.question-step h3 {
  font-size: 18px;
  margin-bottom: 12px;
  color: #2c3e50;
}

.question-description {
  color: #555;
  font-size: 14px;
  margin-bottom: 15px;
  line-height: 1.5;
}

/* Input Styles */
.input-group {
  margin-bottom: 15px;
}

.input-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  font-size: 14px;
}

.text-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.number-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.date-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.select-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  background-color: white;
}

.textarea-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  min-height: 80px;
  resize: vertical;
}

.input-helper {
  font-size: 12px;
  color: #666;
  margin-top: 4px;
}

/* Add Member Button */
.add-member-btn {
  display: block;
  width: 100%;
  padding: 10px;
  margin-top: 15px;
  margin-bottom: 20px;
  background-color: #f1f1f1;
  border: 1px dashed #ccc;
  border-radius: 4px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
}

.add-member-btn:hover {
  background-color: #e5e5e5;
}

.member-card {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 15px;
  margin-bottom: 15px;
  position: relative;
}

.member-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.member-card-title {
  font-weight: 600;
  font-size: 15px;
  color: #2c3e50;
}

.remove-member-btn {
  background-color: #f8f9fa;
  color: #e74c3c;
  border: none;
  cursor: pointer;
  font-size: 18px;
  padding: 0;
  margin: 0;
  line-height: 1;
}

/* Radio Options */
.radio-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 8px;
}

.radio-option {
  display: flex;
  align-items: flex-start;
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.radio-option:hover {
  background-color: #f1f3f5;
  border-color: #d0d0d0;
}

.radio-option.selected {
  background-color: #e3f2fd;
  border-color: #90caf9;
}

.radio-option input[type="radio"] {
  margin-right: 10px;
  margin-top: 2px;
}

.radio-label {
  flex: 1;
}

.radio-label-title {
  font-weight: 600;
  display: block;
  margin-bottom: 3px;
  font-size: 14px;
}

.radio-label-desc {
  font-size: 12px;
  color: #666;
  line-height: 1.4;
}

/* Checkbox Styles */
.checkbox-group {
  margin-bottom: 15px;
}

.checkbox-option {
  display: flex;
  align-items: flex-start;
  margin-bottom: 10px;
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.checkbox-option:hover {
  background-color: #f1f3f5;
  border-color: #d0d0d0;
}

.checkbox-option.selected {
  background-color: #e3f2fd;
  border-color: #90caf9;
}

.checkbox-option input[type="checkbox"] {
  margin-right: 10px;
  margin-top: 2px;
}

.checkbox-label {
  font-size: 14px;
  flex: 1;
}

.checkbox-label-title {
  font-weight: 600;
  display: block;
  margin-bottom: 3px;
  font-size: 14px;
}

.checkbox-label-desc {
  font-size: 12px;
  color: #666;
  line-height: 1.4;
}

/* Navigation Buttons */
.tool-navigation {
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
}

.tool-btn {
  padding: 10px 18px;
  border-radius: 4px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  font-size: 14px;
  text-decoration: none;
}

.tool-btn-primary {
  background-color: #3498db;
  color: white;
}

.tool-btn-primary:hover {
  background-color: #2980b9;
}

.tool-btn-secondary {
  background-color: #ecf0f1;
  color: #34495e;
}

.tool-btn-secondary:hover {
  background-color: #dde4e6;
}

.tool-btn-secondary:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.tool-btn-cta {
  background-color: #2c3e50;
  color: white !important;
  display: inline-block;
  text-align: center;
}

.tool-btn-cta:hover {
  background-color: #1a252f;
}

/* Results Styles */
#results-container {
  opacity: 0;
  transition: opacity 0.5s ease;
}

#results-container.visible {
  opacity: 1;
}

.results-header {
  text-align: center;
  margin-bottom: 20px;
}

.results-header h3 {
  color: #2c3e50;
  font-size: 24px;
  margin-bottom: 8px;
}

.agreement-text-container {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  max-height: 500px;
  overflow-y: auto;
}

#agreement-text {
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  white-space: pre-wrap;
}

.copy-action {
  text-align: center;
  margin-bottom: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 15px;
}

.copy-btn {
  background-color: #3498db;
  color: white;
  flex: 0 1 auto;
}

.copy-btn:hover {
  background-color: #2980b9;
}

.download-btn {
  background-color: #27ae60;
  color: white;
  flex: 0 1 auto;
}

.download-btn:hover {
  background-color: #219653;
}

.copy-message {
  font-size: 14px;
  color: #27ae60;
  flex: 0 1 100%;
  margin-top: 5px;
}

.agreement-notes {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 25px;
}

.agreement-notes h4 {
  color: #856404;
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 18px;
}

.agreement-notes ul {
  padding-left: 20px;
  margin-bottom: 0;
}

.agreement-notes li {
  margin-bottom: 8px;
  font-size: 14px;
}

/* Call to Action */
.results-cta {
  margin-top: 30px;
  display: flex;
  justify-content: center;
  gap: 15px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .tool-container {
    padding: 15px;
  }
  
  .split-view-container {
    flex-direction: column;
  }
  
  .question-panel, 
  .preview-panel {
    max-width: 100%;
  }
  
  .preview-panel {
    border-left: none;
    border-top: 1px solid #eee;
    padding-left: 0;
    padding-top: 15px;
    margin-top: 15px;
  }
  
  .results-cta {
    flex-direction: column;
  }
  
  .tool-btn {
    width: 100%;
  }
  
  .copy-action {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }
  
  .copy-btn, .download-btn {
    margin: 0;
    width: 100%;
  }
  
  .copy-message {
    margin-left: 0;
    margin-bottom: 10px;
  }
}
</style>

<!-- Load Calendly Widget -->
<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

<!-- Add docx download capability -->
<script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Set current date for default values
  const today = new Date();
  const formattedDate = today.toISOString().split('T')[0];
  
  // Format dates for display
  const formatDateForDisplay = (dateString) => {
    const date = new Date(dateString);
    const options = { year: 'numeric', month: 'long', day: 'numeric' };
    return date.toLocaleDateString('en-US', options);
  };
  
  // Format currency values for display
  const formatCurrency = (amount) => {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD',
      minimumFractionDigits: 2
    }).format(amount);
  };
  
  // Questions Data
  const questions = [
    {
      id: 'company-info',
      title: 'Company Information',
      description: 'Enter the basic information about your LLC',
      fields: [
        {
          id: 'company-name',
          label: 'LLC Name',
          type: 'text',
          value: 'XYZ COMPANY LLC',
          helper: 'The full legal name of your LLC as registered with the state'
        },
        {
          id: 'formation-date',
          label: 'Formation Date',
          type: 'date',
          value: formattedDate,
          helper: 'The date your LLC was officially formed'
        },
        {
          id: 'state-of-formation',
          label: 'State of Formation',
          type: 'select',
          options: [
            { value: 'Alabama', label: 'Alabama' },
            { value: 'Alaska', label: 'Alaska' },
            { value: 'Arizona', label: 'Arizona' },
            { value: 'Arkansas', label: 'Arkansas' },
            { value: 'California', label: 'California', selected: true },
            { value: 'Colorado', label: 'Colorado' },
            { value: 'Connecticut', label: 'Connecticut' },
            { value: 'Delaware', label: 'Delaware' },
            { value: 'Florida', label: 'Florida' },
            { value: 'Georgia', label: 'Georgia' },
            { value: 'Hawaii', label: 'Hawaii' },
            { value: 'Idaho', label: 'Idaho' },
            { value: 'Illinois', label: 'Illinois' },
            { value: 'Indiana', label: 'Indiana' },
            { value: 'Iowa', label: 'Iowa' },
            { value: 'Kansas', label: 'Kansas' },
            { value: 'Kentucky', label: 'Kentucky' },
            { value: 'Louisiana', label: 'Louisiana' },
            { value: 'Maine', label: 'Maine' },
            { value: 'Maryland', label: 'Maryland' },
            { value: 'Massachusetts', label: 'Massachusetts' },
            { value: 'Michigan', label: 'Michigan' },
            { value: 'Minnesota', label: 'Minnesota' },
            { value: 'Mississippi', label: 'Mississippi' },
            { value: 'Missouri', label: 'Missouri' },
            { value: 'Montana', label: 'Montana' },
            { value: 'Nebraska', label: 'Nebraska' },
            { value: 'Nevada', label: 'Nevada' },
            { value: 'New Hampshire', label: 'New Hampshire' },
            { value: 'New Jersey', label: 'New Jersey' },
            { value: 'New Mexico', label: 'New Mexico' },
            { value: 'New York', label: 'New York' },
            { value: 'North Carolina', label: 'North Carolina' },
            { value: 'North Dakota', label: 'North Dakota' },
            { value: 'Ohio', label: 'Ohio' },
            { value: 'Oklahoma', label: 'Oklahoma' },
            { value: 'Oregon', label: 'Oregon' },
            { value: 'Pennsylvania', label: 'Pennsylvania' },
            { value: 'Rhode Island', label: 'Rhode Island' },
            { value: 'South Carolina', label: 'South Carolina' },
            { value: 'South Dakota', label: 'South Dakota' },
            { value: 'Tennessee', label: 'Tennessee' },
            { value: 'Texas', label: 'Texas' },
            { value: 'Utah', label: 'Utah' },
            { value: 'Vermont', label: 'Vermont' },
            { value: 'Virginia', label: 'Virginia' },
            { value: 'Washington', label: 'Washington' },
            { value: 'West Virginia', label: 'West Virginia' },
            { value: 'Wisconsin', label: 'Wisconsin' },
            { value: 'Wyoming', label: 'Wyoming' }
          ],
          helper: 'The state where your LLC was formed'
        },
        {
          id: 'principal-address',
          label: 'Principal Address',
          type: 'text',
          value: '123 Business St, San Diego, CA 92101',
          helper: 'The main address of your business'
        },
        {
          id: 'business-purpose',
          label: 'Business Purpose',
          type: 'textarea',
          value: 'The purpose of the Company is to engage in any lawful act or activity for which a Limited Liability Company may be organized under the laws of the state of formation.',
          helper: 'Brief description of your business activities (can be general)'
        }
      ]
    },
    {
      id: 'member-info',
      title: 'Member Information',
      description: 'Enter information about the members of your LLC',
      fields: [
        {
          id: 'members',
          label: 'Members',
          type: 'member-list',
          value: [
            {
              name: 'John Doe',
              address: '123 Member St, San Diego, CA 92101',
              contribution: '5000',
              percentage: '50'
            },
            {
              name: 'Jane Smith',
              address: '456 Partner Ave, San Diego, CA 92102',
              contribution: '5000',
              percentage: '50'
            }
          ],
          helper: 'Add all members of your LLC'
        }
      ]
    },
    {
      id: 'management',
      title: 'Management Structure',
      description: 'Define how your LLC will be managed',
      fields: [
        {
          id: 'management-type',
          label: 'Management Type',
          type: 'radio',
          options: [
            {
              value: 'member-managed',
              title: 'Member-Managed',
              description: 'All members participate in the day-to-day management of the LLC',
              selected: true
            },
            {
              value: 'manager-managed',
              title: 'Manager-Managed',
              description: 'One or more designated managers (who may or may not be members) control the LLC'
            }
          ],
          helper: 'Select how your LLC will be managed'
        },
        {
          id: 'manager-names',
          label: 'Manager Names',
          type: 'textarea',
          value: '',
          helper: 'List the full names of all initial managers, separated by commas',
          depends: 'management-type:manager-managed'
        },
        {
          id: 'voting-requirements',
          label: 'Voting Requirements',
          type: 'radio',
          options: [
            {
              value: 'majority',
              title: 'Majority Vote',
              description: 'Decisions require approval by members representing more than 50% of the membership interests',
              selected: true
            },
            {
              value: 'supermajority',
              title: 'Supermajority Vote',
              description: 'Decisions require approval by members representing at least 2/3 of the membership interests'
            },
            {
              value: 'unanimous',
              title: 'Unanimous Vote',
              description: 'Decisions require approval by all members'
            }
          ],
          helper: 'Select the voting threshold required for major company decisions'
        }
      ]
    },
    {
      id: 'capital-distributions',
      title: 'Capital & Distributions',
      description: 'Define how capital contributions and profit distributions will be handled',
      fields: [
        {
          id: 'additional-capital',
          label: 'Additional Capital Contributions',
          type: 'radio',
          options: [
            {
              value: 'voluntary',
              title: 'Voluntary Only',
              description: 'Members are not required to make additional capital contributions',
              selected: true
            },
            {
              value: 'required',
              title: 'May Be Required',
              description: 'Members may be required to make additional capital contributions if approved by vote'
            }
          ],
          helper: 'Specify whether additional capital contributions may be required after initial contributions'
        },
        {
          id: 'capital-accounts',
          label: 'Capital Accounts',
          type: 'radio',
          options: [
            {
              value: 'tax-basis',
              title: 'Tax Basis Accounting',
              description: 'Capital accounts will be maintained according to tax basis accounting',
              selected: true
            },
            {
              value: 'gaap',
              title: 'GAAP Accounting',
              description: 'Capital accounts will be maintained according to Generally Accepted Accounting Principles (GAAP)'
            }
          ],
          helper: 'Select how capital accounts will be maintained'
        },
        {
          id: 'distributions',
          label: 'Profit Distributions',
          type: 'radio',
          options: [
            {
              value: 'ownership',
              title: 'According to Ownership Percentage',
              description: 'Profits and losses will be allocated according to each member\'s ownership percentage',
              selected: true
            },
            {
              value: 'custom',
              title: 'Custom Allocation',
              description: 'Profits and losses will be allocated according to a custom formula or agreement'
            }
          ],
          helper: 'Select how profits and losses will be distributed among members'
        },
        {
          id: 'custom-allocation',
          label: 'Custom Allocation Details',
          type: 'textarea',
          value: '',
          helper: 'Describe the custom allocation formula or agreement',
          depends: 'distributions:custom'
        },
        {
          id: 'tax-distributions',
          label: 'Tax Distributions',
          type: 'checkbox',
          options: [
            { 
              id: 'include-tax-distributions', 
              label: 'Include tax distributions provision',
              desc: 'Ensure members receive enough distributions to cover tax obligations on the LLC\'s income',
              checked: true
            }
          ],
          helper: 'Choose whether to include provisions for tax distributions'
        }
      ]
    },
    {
      id: 'transfer-restrictions',
      title: 'Transfer Restrictions',
      description: 'Define how membership interests can be transferred',
      fields: [
        {
          id: 'transfer-consent',
          label: 'Transfers Require Consent',
          type: 'radio',
          options: [
            {
              value: 'unanimous',
              title: 'Unanimous Consent',
              description: 'Transfers of membership interests require consent from all members',
              selected: true
            },
            {
              value: 'majority',
              title: 'Majority Consent',
              description: 'Transfers of membership interests require consent from a majority of the remaining members'
            },
            {
              value: 'no-restriction',
              title: 'No Restriction',
              description: 'Members may freely transfer their interests without consent'
            }
          ],
          helper: 'Select the consent requirements for transferring membership interests'
        },
        {
          id: 'right-first-refusal',
          label: 'Right of First Refusal',
          type: 'checkbox',
          options: [
            { 
              id: 'include-rofr', 
              label: 'Include right of first refusal',
              desc: 'Members must first offer their interests to other members before selling to outside parties',
              checked: true
            }
          ],
          helper: 'Choose whether to include a right of first refusal provision'
        },
        {
          id: 'buy-sell-provision',
          label: 'Buy-Sell Provisions',
          type: 'checkbox',
          options: [
            { 
              id: 'include-buysell', 
              label: 'Include buy-sell provisions',
              desc: 'Include terms for buying out members in case of death, disability, or other triggering events',
              checked: true
            }
          ],
          helper: 'Choose whether to include buy-sell provisions'
        },
        {
          id: 'valuation-method',
          label: 'Valuation Method',
          type: 'radio',
          options: [
            {
              value: 'agreed-value',
              title: 'Agreed Value',
              description: 'Members periodically agree on a company value, recorded in writing',
              selected: true
            },
            {
              value: 'formula',
              title: 'Formula Value',
              description: 'Company value is determined by a pre-defined formula'
            },
            {
              value: 'appraisal',
              title: 'Appraisal',
              description: 'Company value is determined by professional appraisal'
            }
          ],
          helper: 'Select how company value will be determined for buy-sell purposes',
          depends: 'include-buysell:true'
        }
      ]
    },
    {
      id: 'dissolution',
      title: 'Dissolution & Miscellaneous',
      description: 'Define dissolution events and other miscellaneous provisions',
      fields: [
        {
          id: 'dissolution-events',
          label: 'Dissolution Events',
          type: 'checkbox',
          options: [
            { 
              id: 'dissolution-vote', 
              label: 'Vote of members',
              desc: 'The LLC may be dissolved by vote of the members',
              checked: true
            },
            { 
              id: 'dissolution-term', 
              label: 'End of term',
              desc: 'The LLC will dissolve at the end of a defined term',
              checked: false
            },
            { 
              id: 'dissolution-objective', 
              label: 'Completion of objective',
              desc: 'The LLC will dissolve upon completion of its stated objective',
              checked: false
            },
            { 
              id: 'dissolution-impossible', 
              label: 'Impossibility of continuing business',
              desc: 'The LLC will dissolve if it becomes impossible to continue the business',
              checked: true
            }
          ],
          helper: 'Select the events that will trigger dissolution of the LLC'
        },
        {
          id: 'dissolution-term-date',
          label: 'Term End Date',
          type: 'date',
          value: '',
          helper: 'If the LLC has a defined term, select the end date',
          depends: 'dissolution-term:true'
        },
        {
          id: 'dissolution-objective',
          label: 'Objective Description',
          type: 'text',
          value: '',
          helper: 'Describe the objective that, when completed, will trigger dissolution',
          depends: 'dissolution-objective:true'
        },
        {
          id: 'governing-law',
          label: 'Governing Law (State)',
          type: 'select',
          options: [
            { value: 'Alabama', label: 'Alabama' },
            { value: 'Alaska', label: 'Alaska' },
            { value: 'Arizona', label: 'Arizona' },
            { value: 'Arkansas', label: 'Arkansas' },
            { value: 'California', label: 'California', selected: true },
            { value: 'Colorado', label: 'Colorado' },
            { value: 'Connecticut', label: 'Connecticut' },
            { value: 'Delaware', label: 'Delaware' },
            { value: 'Florida', label: 'Florida' },
            { value: 'Georgia', label: 'Georgia' },
            { value: 'Hawaii', label: 'Hawaii' },
            { value: 'Idaho', label: 'Idaho' },
            { value: 'Illinois', label: 'Illinois' },
            { value: 'Indiana', label: 'Indiana' },
            { value: 'Iowa', label: 'Iowa' },
            { value: 'Kansas', label: 'Kansas' },
            { value: 'Kentucky', label: 'Kentucky' },
            { value: 'Louisiana', label: 'Louisiana' },
            { value: 'Maine', label: 'Maine' },
            { value: 'Maryland', label: 'Maryland' },
            { value: 'Massachusetts', label: 'Massachusetts' },
            { value: 'Michigan', label: 'Michigan' },
            { value: 'Minnesota', label: 'Minnesota' },
            { value: 'Mississippi', label: 'Mississippi' },
            { value: 'Missouri', label: 'Missouri' },
            { value: 'Montana', label: 'Montana' },
            { value: 'Nebraska', label: 'Nebraska' },
            { value: 'Nevada', label: 'Nevada' },
            { value: 'New Hampshire', label: 'New Hampshire' },
            { value: 'New Jersey', label: 'New Jersey' },
            { value: 'New Mexico', label: 'New Mexico' },
            { value: 'New York', label: 'New York' },
            { value: 'North Carolina', label: 'North Carolina' },
            { value: 'North Dakota', label: 'North Dakota' },
            { value: 'Ohio', label: 'Ohio' },
            { value: 'Oklahoma', label: 'Oklahoma' },
            { value: 'Oregon', label: 'Oregon' },
            { value: 'Pennsylvania', label: 'Pennsylvania' },
            { value: 'Rhode Island', label: 'Rhode Island' },
            { value: 'South Carolina', label: 'South Carolina' },
            { value: 'South Dakota', label: 'South Dakota' },
            { value: 'Tennessee', label: 'Tennessee' },
            { value: 'Texas', label: 'Texas' },
            { value: 'Utah', label: 'Utah' },
            { value: 'Vermont', label: 'Vermont' },
            { value: 'Virginia', label: 'Virginia' },
            { value: 'Washington', label: 'Washington' },
            { value: 'West Virginia', label: 'West Virginia' },
            { value: 'Wisconsin', label: 'Wisconsin' },
            { value: 'Wyoming', label: 'Wyoming' }
          ],
          helper: 'The state whose laws will govern this operating agreement'
        },
        {
          id: 'additional-provisions',
          label: 'Additional Provisions (Optional)',
          type: 'textarea',
          value: '',
          helper: 'Enter any additional provisions or terms you wish to include in the operating agreement'
        }
      ]
    }
  ];
  
  // DOM Elements
  const questionContainer = document.getElementById('question-container');
  const previewContainer = document.getElementById('preview-container');
  const previewText = document.getElementById('preview-text');
  const resultsContainer = document.getElementById('results-container');
  const progressBar = document.getElementById('progress-bar');
  const currentStepEl = document.getElementById('current-step');
  const totalStepsEl = document.getElementById('total-steps');
  const recalculateBtn = document.getElementById('recalculate-btn');
  const copyBtn = document.getElementById('copy-btn');
  const copyMessage = document.getElementById('copy-message');
  const downloadBtn = document.getElementById('download-btn');
  
  // Set up variables
  let currentStep = 0;
  const userAnswers = {};
  const totalSteps = questions.length;
  let highlightTimeoutId;
  let memberCount = 2; // Start with 2 default members
  
  // Initialize the tool
  function initTool() {
    // Set total steps
    totalStepsEl.textContent = totalSteps;
    
    // Initialize with default values
    questions.forEach(question => {
      question.fields.forEach(field => {
        if (field.type === 'select') {
          const selectedOption = field.options.find(option => option.selected);
          if (selectedOption) {
            userAnswers[field.id] = selectedOption.value;
          } else if (field.options.length > 0) {
            userAnswers[field.id] = field.options[0].value;
          }
        } else if (field.type === 'radio') {
          const selectedOption = field.options.find(option => option.selected);
          if (selectedOption) {
            userAnswers[field.id] = selectedOption.value;
          } else if (field.options.length > 0) {
            userAnswers[field.id] = field.options[0].value;
          }
        } else if (field.type === 'checkbox') {
          field.options.forEach(option => {
            userAnswers[option.id] = option.checked || false;
          });
        } else if (field.type === 'member-list') {
          userAnswers[field.id] = field.value || [];
        } else {
          userAnswers[field.id] = field.value || '';
        }
      });
    });
    
    // Generate initial preview
    updatePreview();
    
    // Show first question
    showQuestion(0);
    
    // Add event listener to recalculate button
    recalculateBtn.addEventListener('click', function() {
      resultsContainer.style.display = 'none';
      resultsContainer.classList.remove('visible');
      previewContainer.style.display = 'block';
      questionContainer.style.display = 'block';
      showQuestion(0);
      
      // Scroll to the top of the tool
      document.getElementById('multi-member-llc-generator').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start'
      });
    });
    
    // Add event listener to copy button
    copyBtn.addEventListener('click', function() {
      const agreementText = document.getElementById('agreement-text').innerText;
      
      try {
        navigator.clipboard.writeText(agreementText).then(function() {
          copyMessage.textContent = 'Agreement copied!';
          setTimeout(function() {
            copyMessage.textContent = '';
          }, 3000);
        }, function() {
          copyMessage.textContent = 'Unable to copy. Please select and copy manually.';
          setTimeout(function() {
            copyMessage.textContent = '';
          }, 3000);
        });
      } catch (e) {
        // Fallback for older browsers
        const textArea = document.createElement("textarea");
        textArea.value = agreementText;
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyMessage.textContent = 'Agreement copied!';
        } catch (err) {
          copyMessage.textContent = 'Unable to copy. Please select and copy manually.';
        }
        
        document.body.removeChild(textArea);
        setTimeout(function() {
          copyMessage.textContent = '';
        }, 3000);
      }
    });
    
    // Add event listener to download button
    downloadBtn.addEventListener('click', function() {
      generateDocx();
    });
  }
  
  // Generate DOCX file with better formatting
  function generateDocx() {
    try {
      // Access docx library
      const docx = window.docx;
      if (!docx) {
        throw new Error("DOCX library not loaded");
      }
      
      const companyName = userAnswers['company-name'] || 'XYZ COMPANY LLC';
      
      // Get agreement text
      const agreementText = document.getElementById('agreement-text').innerText;
      
      // Remove the title section from the text content - we'll add our own formatted title
      let processedText = agreementText;
      processedText = processedText.replace(/OPERATING AGREEMENT\s+\n/, '');
      
      // Parse sections for better formatting
      const lines = processedText.split('\n');
      const paragraphs = [];
      
      // Title - centered and bold
      paragraphs.push(
        new docx.Paragraph({
          alignment: docx.AlignmentType.CENTER,
          spacing: {
            before: 0,
            after: 0
          },
          children: [
            new docx.TextRun({
              text: "OPERATING AGREEMENT",
              bold: true,
              size: 11 * 2 // docx uses half-points, so 11pt = 22 half-points
            })
          ]
        })
      );
      
      // Process each line
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        
        if (!line) {
          continue; // Skip empty lines
        }
        
        // Create paragraphs
        if (line.startsWith("ARTICLE") || line === "WITNESSETH:" || line === "NOW, THEREFORE:" || line === "OF") {
          // Article heading - bold and centered
          paragraphs.push(
            new docx.Paragraph({
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  bold: true,
                  size: 11 * 2
                })
              ]
            })
          );
        } else if (/^[A-Z0-9\.\s]{5,}:$/.test(line) || /^[0-9]+\.\s+[A-Z]/.test(line)) {
          // Section headings or numbered sections
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  bold: true,
                  size: 11 * 2
                })
              ]
            })
          );
        } else {
          // Regular paragraph
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  size: 11 * 2 // 11pt font size
                })
              ]
            })
          );
        }
      }
      
      // Create document with enhanced formatting
      const doc = new docx.Document({
        styles: {
          default: {
            document: {
              run: {
                size: 11 * 2, // 11pt font size (in half-points)
                font: "Calibri"
              },
              paragraph: {
                spacing: {
                  line: 240, // 1.0x line spacing
                  before: 0,
                  after: 0,
                  afterAutoSpacing: false,
                  beforeAutoSpacing: false
                }
              }
            }
          }
        },
        sections: [{
          properties: {
            page: {
              margin: {
                top: 1440, // 1 inch in twips
                right: 1440,
                bottom: 1440,
                left: 1440
              }
            }
          },
          children: paragraphs
        }]
      });
      
      // Generate and save document
      docx.Packer.toBlob(doc)
        .then(blob => {
          const fileName = `multi_member_llc_operating_agreement.docx`;
          window.saveAs(blob, fileName);
        })
        .catch(error => {
          console.error("Error saving DOCX:", error);
          alert("Unable to download. Please use the copy button instead.");
        });
    } catch (error) {
      console.error("DOCX generation error:", error);
      alert("Unable to download. Please use the copy button instead.");
    }
  }
  
  // Show a specific question
  function showQuestion(index) {
    currentStep = index;
    currentStepEl.textContent = index + 1;
    
    // Update progress bar
    progressBar.style.width = `${((index + 1) / totalSteps) * 100}%`;
    
    // Get the current question
    const question = questions[index];
    
    // Create the question HTML
    let html = `
      <div class="question-step" id="step-${question.id}">
        <h3>${question.title}</h3>
        <p class="question-description">${question.description}</p>
    `;
    
    // Add fields
    question.fields.forEach(field => {
      // Check if the field should be shown based on dependencies
      if (field.depends) {
        const [dependsOn, dependsValue] = field.depends.split(':');
        if (dependsValue === 'true') {
          if (!userAnswers[dependsOn]) {
            return; // Skip this field if its dependency isn't met
          }
        } else {
          if (!userAnswers[dependsOn] || userAnswers[dependsOn] !== dependsValue) {
            return; // Skip this field if its dependency isn't met
          }
        }
      }
      
      if (field.type === 'text') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="text" id="${field.id}" class="text-input" value="${userAnswers[field.id] || ''}">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'number') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="number" id="${field.id}" class="number-input" value="${userAnswers[field.id] || ''}" step="0.01">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'date') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="date" id="${field.id}" class="date-input" value="${userAnswers[field.id] || ''}">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'select') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <select id="${field.id}" class="select-input">
        `;
        field.options.forEach(option => {
          const isSelected = userAnswers[field.id] === option.value;
          html += `<option value="${option.value}" ${isSelected ? 'selected' : ''}>${option.label}</option>`;
        });
        html += `
            </select>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'textarea') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <textarea id="${field.id}" class="textarea-input" rows="4">${userAnswers[field.id] || ''}</textarea>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'radio') {
        html += `
          <div class="input-group">
            <label>${field.label}</label>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
            <div class="radio-options">
        `;
        field.options.forEach(option => {
          const isSelected = userAnswers[field.id] === option.value;
          html += `
            <div class="radio-option ${isSelected ? 'selected' : ''}" data-value="${option.value}" data-field="${field.id}">
              <input type="radio" name="${field.id}" id="${field.id}-${option.value}" value="${option.value}" ${isSelected ? 'checked' : ''}>
              <div class="radio-label">
                <span class="radio-label-title">${option.title}</span>
                <span class="radio-label-desc">${option.description}</span>
              </div>
            </div>
          `;
        });
        html += `
            </div>
          </div>
        `;
      } else if (field.type === 'checkbox') {
        html += `
          <div class="checkbox-group">
            <label>${field.label}</label>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
        `;
        
        field.options.forEach(option => {
          const isChecked = userAnswers[option.id];
          html += `
            <div class="checkbox-option ${isChecked ? 'selected' : ''}" data-id="${option.id}">
              <input type="checkbox" id="${option.id}" ${isChecked ? 'checked' : ''}>
              <div class="checkbox-label">
                <span class="checkbox-label-title">${option.label}</span>
                <span class="checkbox-label-desc">${option.desc || ''}</span>
              </div>
            </div>
          `;
        });
        
        html += `</div>`;
      } else if (field.type === 'member-list') {
        html += `
          <div class="input-group">
            <label>${field.label}</label>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
            <div id="members-container">
        `;
        
        // Get the current member list
        const members = userAnswers[field.id] || [];
        
        // Render each member
        members.forEach((member, index) => {
          html += `
            <div class="member-card" data-member-index="${index}">
              <div class="member-card-header">
                <span class="member-card-title">Member ${index + 1}</span>
                <button type="button" class="remove-member-btn" data-member-index="${index}" ${members.length <= 2 ? 'disabled' : ''}>×</button>
              </div>
              <div class="input-group">
                <label>Full Name</label>
                <input type="text" class="text-input member-name" value="${member.name || ''}" data-member-index="${index}">
              </div>
              <div class="input-group">
                <label>Address</label>
                <input type="text" class="text-input member-address" value="${member.address || ''}" data-member-index="${index}">
              </div>
              <div class="input-group">
                <label>Initial Capital Contribution ($)</label>
                <input type="number" class="number-input member-contribution" value="${member.contribution || ''}" data-member-index="${index}">
              </div>
              <div class="input-group">
                <label>Ownership Percentage (%)</label>
                <input type="number" class="number-input member-percentage" value="${member.percentage || ''}" data-member-index="${index}">
              </div>
            </div>
          `;
        });
        
        html += `
            </div>
            <button type="button" id="add-member-btn" class="add-member-btn">+ Add Another Member</button>
          </div>
        `;
      }
    });
    
    html += `</div>`;
    
    // Add navigation buttons
    html += `
      <div class="tool-navigation">
        <button id="back-btn" class="tool-btn tool-btn-secondary" ${index === 0 ? 'disabled' : ''}>Back</button>
        <button id="continue-btn" class="tool-btn tool-btn-primary">${index === totalSteps - 1 ? 'Generate Agreement' : 'Continue'}</button>
      </div>
    `;
    
    // Set the HTML
    questionContainer.innerHTML = html;
    
    // Add event listeners for member list if on that step
    if (question.id === 'member-info') {
      // Add event listener to add member button
      document.getElementById('add-member-btn').addEventListener('click', function() {
        addMember();
      });
      
      // Add event listeners to remove member buttons
      const removeButtons = document.querySelectorAll('.remove-member-btn');
      removeButtons.forEach(button => {
        button.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-member-index'));
          removeMember(index);
        });
      });
      
      // Add event listeners to member input fields
      const memberInputs = document.querySelectorAll('.member-name, .member-address, .member-contribution, .member-percentage');
      memberInputs.forEach(input => {
        input.addEventListener('input', function() {
          const index = parseInt(this.getAttribute('data-member-index'));
          const field = this.classList.contains('member-name') ? 'name' :
                        this.classList.contains('member-address') ? 'address' :
                        this.classList.contains('member-contribution') ? 'contribution' : 'percentage';
          
          updateMember(index, field, this.value);
        });
      });
    }
    
    // Add event listeners to input fields for real-time preview updates
    const inputs = document.querySelectorAll('.text-input, .number-input, .date-input, .select-input, .textarea-input');
    inputs.forEach(input => {
      input.addEventListener('input', function() {
        // Skip member inputs as they're handled separately
        if (!this.classList.contains('member-name') && 
            !this.classList.contains('member-address') && 
            !this.classList.contains('member-contribution') && 
            !this.classList.contains('member-percentage')) {
          
          // Store the answer
          userAnswers[this.id] = this.value;
          
          // Update the preview with the section that changed
          updatePreview(this.id);
        }
      });
      
      // For select inputs, we need to use 'change' event instead of 'input'
      if (input.tagName.toLowerCase() === 'select') {
        input.addEventListener('change', function() {
          // Store the answer
          userAnswers[this.id] = this.value;
          
          // Update the preview with the section that changed
          updatePreview(this.id);
        });
      }
    });
    
    // Add event listeners to radio options
    const radioOptions = document.querySelectorAll('.radio-option');
    radioOptions.forEach(option => {
      option.addEventListener('click', function() {
        const fieldId = this.getAttribute('data-field');
        const value = this.getAttribute('data-value');
        
        // Update selection visually
        radioOptions.forEach(opt => {
          if (opt.getAttribute('data-field') === fieldId) {
            opt.classList.remove('selected');
          }
        });
        this.classList.add('selected');
        
        // Update the radio button
        this.querySelector('input').checked = true;
        
        // Store the answer
        userAnswers[fieldId] = value;
        
        // Check for dependent fields
        const dependentFields = questions[currentStep].fields.filter(field => 
          field.depends && field.depends.startsWith(fieldId + ':')
        );
        
        if (dependentFields.length > 0) {
          // Re-render the step to update visibility of dependent fields
          saveCurrentAnswers();
          showQuestion(currentStep);
        }
        
        // Update the preview with section that changed
        updatePreview(fieldId);
      });
    });
    
    // Add event listeners to checkbox options
    const checkboxOptions = document.querySelectorAll('.checkbox-option');
    checkboxOptions.forEach(option => {
      option.addEventListener('click', function() {
        const optionId = this.getAttribute('data-id');
        const checkbox = this.querySelector('input[type="checkbox"]');
        
        // Toggle selection
        this.classList.toggle('selected');
        checkbox.checked = !checkbox.checked;
        
        // Store the answer
        userAnswers[optionId] = checkbox.checked;
        
        // Check for dependent fields
        const dependentFields = questions[currentStep].fields.filter(field => 
          field.depends && field.depends === `${optionId}:true`
        );
        
        if (dependentFields.length > 0) {
          // Re-render the step to update visibility of dependent fields
          saveCurrentAnswers();
          showQuestion(currentStep);
        }
        
        // Update the preview with the section that changed
        updatePreview(optionId);
      });
    });
    
    // Add event listeners to the Back and Continue buttons
    document.getElementById('back-btn').addEventListener('click', function() {
      if (currentStep > 0) {
        // Save current answers
        saveCurrentAnswers();
        // Go to previous question
        showQuestion(currentStep - 1);
      }
    });
    
    document.getElementById('continue-btn').addEventListener('click', function() {
      // Save current answers
      saveCurrentAnswers();
      
      if (currentStep < totalSteps - 1) {
        // Go to next question
        showQuestion(currentStep + 1);
      } else {
        // Generate agreement
        generateAgreement();
      }
    });
  }
  
  // Add a new member
  function addMember() {
    // Get the current members list
    const members = userAnswers['members'] || [];
    
    // Calculate default percentage
    const defaultPercentage = Math.floor(100 / (members.length + 1));
    
    // Add a new member
    members.push({
      name: '',
      address: '',
      contribution: '',
      percentage: defaultPercentage.toString()
    });
    
    // Recalculate percentages to distribute equally
    const equalShare = Math.floor(100 / members.length);
    const remainder = 100 - (equalShare * members.length);
    
    members.forEach((member, index) => {
      member.percentage = (equalShare + (index < remainder ? 1 : 0)).toString();
    });
    
    // Update the user answers
    userAnswers['members'] = members;
    
    // Update member count
    memberCount++;
    
    // Re-render the current step
    showQuestion(currentStep);
    
    // Update the preview
    updatePreview('members');
  }
  
  // Remove a member
  function removeMember(index) {
    // Get the current members list
    const members = userAnswers['members'] || [];
    
    // Need at least 2 members
    if (members.length <= 2) {
      return;
    }
    
    // Remove the member
    members.splice(index, 1);
    
    // Recalculate percentages to distribute equally
    const equalShare = Math.floor(100 / members.length);
    const remainder = 100 - (equalShare * members.length);
    
    members.forEach((member, index) => {
      member.percentage = (equalShare + (index < remainder ? 1 : 0)).toString();
    });
    
    // Update the user answers
    userAnswers['members'] = members;
    
    // Update member count
    memberCount--;
    
    // Re-render the current step
    showQuestion(currentStep);
    
    // Update the preview
    updatePreview('members');
  }
  
  // Update a member field
  function updateMember(index, field, value) {
    // Get the current members list
    const members = userAnswers['members'] || [];
    
    // Update the field
    if (index >= 0 && index < members.length) {
      members[index][field] = value;
      
      // Update the user answers
      userAnswers['members'] = members;
      
      // Update the preview
      updatePreview('members');
    }
  }
  
  // Save the current answers from the form
  function saveCurrentAnswers() {
    const question = questions[currentStep];
    
    question.fields.forEach(field => {
      if (['text', 'number', 'date', 'select', 'textarea'].includes(field.type)) {
        const inputEl = document.getElementById(field.id);
        if (inputEl) {
          userAnswers[field.id] = inputEl.value;
        }
      } else if (field.type === 'radio') {
        const selectedRadio = document.querySelector(`input[name="${field.id}"]:checked`);
        if (selectedRadio) {
          userAnswers[field.id] = selectedRadio.value;
        }
      } else if (field.type === 'checkbox') {
        field.options.forEach(option => {
          const checkboxEl = document.getElementById(option.id);
          if (checkboxEl) {
            userAnswers[option.id] = checkboxEl.checked;
          }
        });
      } else if (field.type === 'member-list') {
        // Member list is handled by the updateMember function
      }
    });
  }
  
  // Get specific object sections for preview
  function getCompanyInfoSection() {
    const companyName = userAnswers['company-name'] || 'XYZ COMPANY LLC';
    const formationDate = userAnswers['formation-date'] ? formatDateForDisplay(userAnswers['formation-date']) : formatDateForDisplay(formattedDate);
    const stateOfFormation = userAnswers['state-of-formation'] || 'California';
    const principalAddress = userAnswers['principal-address'] || '123 Business St, San Diego, CA 92101';
    const businessPurpose = userAnswers['business-purpose'] || 'The purpose of the Company is to engage in any lawful act or activity for which a Limited Liability Company may be organized under the laws of the state of formation.';
    
    return `<div id="preview-company-info">OPERATING AGREEMENT
OF
${companyName}

This Operating Agreement (the "Agreement") of ${companyName} (the "Company") is entered into as of ${formationDate} by and among the members listed on Exhibit A attached hereto (individually a "Member" and collectively the "Members").

ARTICLE I
COMPANY FORMATION

1.1 FORMATION. The Company was formed on ${formationDate}, when its Articles of Organization were filed with the Secretary of State of ${stateOfFormation}.

1.2 NAME. The name of the Company is ${companyName}.

1.3 PRINCIPAL PLACE OF BUSINESS. The principal place of business of the Company is located at ${principalAddress}.

1.4 PURPOSE. ${businessPurpose}

1.5 TERM. The Company shall continue until dissolved in accordance with this Agreement or applicable law.</div>`;
  }
  
  function getMemberInfoSection() {
    const members = userAnswers['members'] || [];
    
    let memberInfoText = `<div id="preview-member-info">ARTICLE II
MEMBERSHIP INTERESTS, CAPITAL CONTRIBUTIONS, AND CAPITAL ACCOUNTS

2.1 MEMBERS. The names, addresses, initial capital contributions, and membership interests of the Members are set forth on Exhibit A attached hereto and incorporated herein by reference.

2.2 CAPITAL CONTRIBUTIONS. Each Member has contributed or agrees to contribute the amount of capital set forth on Exhibit A in exchange for the membership interest specified therein.

2.3 ADDITIONAL CAPITAL CONTRIBUTIONS. `;
    
    const additionalCapital = userAnswers['additional-capital'] || 'voluntary';
    if (additionalCapital === 'voluntary') {
      memberInfoText += 'No Member shall be required to make any additional capital contributions to the Company without such Member\'s consent. Additional capital contributions may be made by Members on a voluntary basis.';
    } else {
      memberInfoText += 'Members may be required to make additional capital contributions if approved in accordance with this Agreement. Such additional capital contributions shall be made by the Members in proportion to their respective membership interests, unless otherwise agreed.';
    }
    
    memberInfoText += `

2.4 MEMBERSHIP INTERESTS. The Company shall have one class of membership interests. Each Member's membership interest in the Company shall be expressed as a percentage, representing such Member's share of the profits, losses, and distributions of the Company, and such Member's right to vote on Company matters as set forth in this Agreement.

2.5 CAPITAL ACCOUNTS. A capital account shall be maintained for each Member in accordance with `;
    
    const capitalAccounts = userAnswers['capital-accounts'] || 'tax-basis';
    if (capitalAccounts === 'tax-basis') {
      memberInfoText += 'tax basis accounting and the applicable provisions of the Internal Revenue Code and Treasury Regulations.';
    } else {
      memberInfoText += 'generally accepted accounting principles (GAAP).';
    }
    
    memberInfoText += `

EXHIBIT A
MEMBERS, CAPITAL CONTRIBUTIONS, AND MEMBERSHIP INTERESTS

`;
    
    // Create table of members
    members.forEach((member, index) => {
      memberInfoText += `Member ${index + 1}:
Name: ${member.name || `[Member ${index + 1} Name]`}
Address: ${member.address || `[Member ${index + 1} Address]`}
Initial Capital Contribution: ${member.contribution ? formatCurrency(member.contribution) : '[Initial Contribution]'}
Membership Interest: ${member.percentage || '0'}%

`;
    });
    
    memberInfoText += '</div>';
    
    return memberInfoText;
  }
  
  function getManagementSection() {
    const managementType = userAnswers['management-type'] || 'member-managed';
    const managerNames = userAnswers['manager-names'] || '';
    const votingRequirements = userAnswers['voting-requirements'] || 'majority';
    
    let votingText = '';
    if (votingRequirements === 'majority') {
      votingText = 'a majority vote of the Members based on membership interests';
    } else if (votingRequirements === 'supermajority') {
      votingText = 'a vote of the Members representing at least two-thirds (2/3) of the membership interests';
    } else if (votingRequirements === 'unanimous') {
      votingText = 'a unanimous vote of all Members';
    }
    
    let managementSection = `<div id="preview-management">ARTICLE III
MANAGEMENT AND VOTING

3.1 MANAGEMENT. `;
    
    if (managementType === 'member-managed') {
      managementSection += `The Company shall be managed by its Members. The Members shall have full, exclusive, and complete authority, power, and discretion to manage and control the business and affairs of the Company, to make all decisions regarding those matters, and to perform any and all other acts or activities customary or incident to the management of the Company's business.`;
    } else {
      managementSection += `The Company shall be managed by one or more Managers. The initial Manager(s) shall be: ${managerNames || '[Manager Name(s)]'}. The Manager(s) shall have full, exclusive, and complete authority, power, and discretion to manage and control the business and affairs of the Company, to make all decisions regarding those matters, and to perform any and all other acts or activities customary or incident to the management of the Company's business.`;
    }
    
    managementSection += `

3.2 VOTING RIGHTS. Except as otherwise provided in this Agreement or required by law, all decisions requiring a vote of the Members shall be approved by ${votingText}.

3.3 MEETINGS. Meetings of the Members may be called by `;
    
    if (managementType === 'member-managed') {
      managementSection += `any Member`;
    } else {
      managementSection += `any Manager or by any Member`;
    }
    
    managementSection += ` upon at least ten (10) days' written notice to all Members, which notice shall specify the time and place of the meeting and the purpose for which the meeting is called. Attendance at a meeting shall constitute a waiver of notice. Members may participate in a meeting by means of conference telephone or similar communications equipment by which all Members participating can hear each other.

3.4 ACTION WITHOUT MEETING. Any action that may be taken at a meeting of the Members may be taken without a meeting if a consent in writing, setting forth the action so taken, is signed by all of the Members entitled to vote with respect to the subject matter thereof.`;
    
    if (managementType === 'manager-managed') {
      managementSection += `

3.5 REMOVAL AND REPLACEMENT OF MANAGERS. Any Manager may be removed, with or without cause, by a vote of Members holding at least two-thirds (2/3) of the membership interests. In the event of a vacancy in the position of Manager, a new Manager shall be appointed by a vote of the Members in accordance with Section 3.2.`;
    }
    
    managementSection += `</div>`;
    
    return managementSection;
  }
  
  function getAllocationSection() {
    const distributions = userAnswers['distributions'] || 'ownership';
    const customAllocation = userAnswers['custom-allocation'] || '';
    const includeTaxDistributions = userAnswers['include-tax-distributions'] || false;
    
    let allocationSection = `<div id="preview-allocations">ARTICLE IV
ALLOCATIONS AND DISTRIBUTIONS

4.1 ALLOCATIONS OF PROFITS AND LOSSES. Except as otherwise provided in this Agreement, profits and losses of the Company shall be allocated among the Members `;
    
    if (distributions === 'ownership') {
      allocationSection += `in proportion to their respective membership interests.`;
    } else {
      allocationSection += `as follows: ${customAllocation || '[Custom Allocation Formula]'}.`;
    }
    
    allocationSection += `

4.2 DISTRIBUTIONS. Distributions shall be made to the Members at such times and in such amounts as determined by `;
    
    const managementType = userAnswers['management-type'] || 'member-managed';
    
    if (managementType === 'member-managed') {
      allocationSection += `the Members in accordance with Article III. All distributions shall be made `;
    } else {
      allocationSection += `the Manager(s). All distributions shall be made `;
    }
    
    if (distributions === 'ownership') {
      allocationSection += `to the Members in proportion to their respective membership interests.`;
    } else {
      allocationSection += `according to the same formula as specified in Section 4.1.`;
    }
    
    if (includeTaxDistributions) {
      allocationSection += `

4.3 TAX DISTRIBUTIONS. Notwithstanding any other provision of this Agreement, the Company shall make distributions to each Member in amounts sufficient to enable the Member to pay federal and state income taxes attributable to the Member's allocable share of the Company's taxable income. Such tax distributions shall be made quarterly based on estimated taxes, with a final distribution after the close of each fiscal year based on the actual tax liability for such year.`;
    }
    
    allocationSection += `</div>`;
    
    return allocationSection;
  }
  
  function getTransferSection() {
    const transferConsent = userAnswers['transfer-consent'] || 'unanimous';
    const includeRofr = userAnswers['include-rofr'] || false;
    const includeBuySell = userAnswers['include-buysell'] || false;
    const valuationMethod = userAnswers['valuation-method'] || 'agreed-value';
    
    let transferSection = `<div id="preview-transfer">ARTICLE V
TRANSFER RESTRICTIONS

5.1 RESTRICTIONS ON TRANSFER. Except as provided in this Agreement, no Member shall transfer all or any portion of such Member's membership interest in the Company without `;
    
    if (transferConsent === 'unanimous') {
      transferSection += `the prior written consent of all other Members.`;
    } else if (transferConsent === 'majority') {
      transferSection += `the prior written consent of a majority in interest of the other Members.`;
    } else {
      transferSection += `restriction, provided that the transferee complies with the provisions of Section 5.2.`;
    }
    
    transferSection += `

5.2 CONDITIONS TO PERMITTED TRANSFERS. No transfer of a membership interest shall be effective unless and until: (a) the transferee agrees in writing to be bound by the terms of this Agreement, (b) the transfer complies with all applicable securities laws, and (c) the transfer does not cause the Company to be treated as an association taxable as a corporation.`;
    
    if (includeRofr) {
      transferSection += `

5.3 RIGHT OF FIRST REFUSAL. If a Member desires to transfer all or any portion of such Member's membership interest to a third party, the Member shall first offer to sell such interest to the other Members at the same price and on the same terms as those offered by the third party. The other Members shall have thirty (30) days from receipt of written notice of the proposed transfer to exercise their right to purchase the interest, in proportion to their respective membership interests or as otherwise agreed among them.`;
    }
    
    if (includeBuySell) {
      transferSection += `

5.4 BUY-SELL PROVISIONS. 

5.4.1 TRIGGERING EVENTS. Upon the death, disability, bankruptcy, or withdrawal of a Member (a "Departing Member"), the Company or the remaining Members shall have the option to purchase, and the Departing Member or such Member's estate shall be required to sell, the Departing Member's membership interest.

5.4.2 PURCHASE PRICE. The purchase price for the Departing Member's membership interest shall be determined based on `;
      
      if (valuationMethod === 'agreed-value') {
        transferSection += `an agreed value to be established by the Members annually and attached as an exhibit to this Agreement. If no such value has been agreed upon within the twelve (12) months preceding the triggering event, the value shall be determined by an independent appraiser selected by the Company.`;
      } else if (valuationMethod === 'formula') {
        transferSection += `a formula equal to [6] times the average annual cash flow of the Company for the [3] fiscal years preceding the triggering event, multiplied by the Departing Member's percentage interest.`;
      } else {
        transferSection += `an appraisal conducted by an independent appraiser selected by mutual agreement of the remaining Members and the Departing Member or such Member's estate.`;
      }
      
      transferSection += `

5.4.3 PAYMENT TERMS. The purchase price shall be paid in [12] equal monthly installments, with the first installment due within [30] days after determination of the purchase price.`;
    }
    
    transferSection += `</div>`;
    
    return transferSection;
  }
  
  function getDissolutionSection() {
    const dissolutionVote = userAnswers['dissolution-vote'] || false;
    const dissolutionTerm = userAnswers['dissolution-term'] || false;
    const dissolutionObjective = userAnswers['dissolution-objective'] || false;
    const dissolutionImpossible = userAnswers['dissolution-impossible'] || false;
    const dissolutionTermDate = userAnswers['dissolution-term-date'] || '';
    const dissolutionObjectiveDesc = userAnswers['dissolution-objective'] || '';
    const governingLaw = userAnswers['governing-law'] || 'California';
    const additionalProvisions = userAnswers['additional-provisions'] || '';
    
    let dissolutionSection = `<div id="preview-dissolution">ARTICLE VI
DISSOLUTION AND WINDING UP

6.1 DISSOLUTION EVENTS. The Company shall dissolve and its affairs shall be wound up upon the first to occur of the following:`;
    
    let dissolutionEvents = [];
    
    if (dissolutionVote) {
      dissolutionEvents.push(`The vote of the Members in accordance with Article III`);
    }
    
    if (dissolutionTerm && dissolutionTermDate) {
      dissolutionEvents.push(`${formatDateForDisplay(dissolutionTermDate)}, which is the end of the term of the Company`);
    }
    
    if (dissolutionObjective && dissolutionObjectiveDesc) {
      dissolutionEvents.push(`The completion of ${dissolutionObjectiveDesc}`);
    }
    
    if (dissolutionImpossible) {
      dissolutionEvents.push(`The entry of a judicial decree that it is no longer reasonably practicable to carry on the business of the Company in conformity with this Agreement`);
    }
    
    // Always include this option
    dissolutionEvents.push(`The occurrence of any event that makes it unlawful for the business of the Company to be carried on`);
    
    // Format the list
    dissolutionEvents.forEach((event, index) => {
      dissolutionSection += `\n\n6.1.${index + 1} ${event}.`;
    });
    
    dissolutionSection += `

6.2 WINDING UP. Upon dissolution, the Company shall cease carrying on its business and affairs and shall commence the winding up of the Company's business and affairs and liquidation of Company assets.

ARTICLE VII
MISCELLANEOUS PROVISIONS

7.1 GOVERNING LAW. This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw}.

7.2 ENTIRE AGREEMENT. This Agreement constitutes the entire agreement among the Members with respect to the subject matter hereof and supersedes all prior agreements and understandings, whether written or oral.

7.3 AMENDMENT. This Agreement may be amended only by a written instrument executed by all Members.

7.4 BINDING EFFECT. This Agreement shall be binding upon and inure to the benefit of the Members and their respective heirs, executors, administrators, successors, and permitted assigns.`;
    
    if (additionalProvisions) {
      dissolutionSection += `

ARTICLE VIII
ADDITIONAL PROVISIONS

${additionalProvisions}`;
    }
    
    dissolutionSection += `

IN WITNESS WHEREOF, the Members have executed this Operating Agreement as of the date first written above.

MEMBERS:`;
    
    // Add signature lines for each member
    const members = userAnswers['members'] || [];
    members.forEach((member) => {
      dissolutionSection += `

__________________________
${member.name || '[Member Name]'}`;
    });
    
    dissolutionSection += `</div>`;
    
    return dissolutionSection;
  }
  
  // Update the agreement preview based on current selections
  function updatePreview(changedSection = null) {
    // Remove any existing highlights
    if (highlightTimeoutId) {
      clearTimeout(highlightTimeoutId);
    }
    
    // Define the sections and their content
    const sections = {
      companyInfo: getCompanyInfoSection(),
      memberInfo: getMemberInfoSection(),
      management: getManagementSection(),
      allocations: getAllocationSection(),
      transfer: getTransferSection(),
      dissolution: getDissolutionSection()
    };
    
    // Combine all sections
    const previewHTML = 
        sections.companyInfo + '\n\n' + 
        sections.memberInfo + '\n\n' + 
        sections.management + '\n\n' + 
        sections.allocations + '\n\n' + 
        sections.transfer + '\n\n' + 
        sections.dissolution;
    
    // Set the preview HTML
    previewText.innerHTML = previewHTML;
    
    // If a section has changed, highlight it
    if (changedSection) {
      highlightChangedText(changedSection);
    }
  }
  
  // Highlight changed text in the preview
  function highlightChangedText(changedSection) {
    // Clear any existing highlights
    const existingHighlights = document.querySelectorAll('.highlight');
    existingHighlights.forEach(el => {
      el.classList.remove('highlight');
    });
    
    // Determine which section and text to highlight
    let sectionId = '';
    let textToFind = '';
    
    // Company Info fields
    if (['company-name', 'formation-date', 'state-of-formation', 'principal-address', 'business-purpose'].includes(changedSection)) {
      sectionId = 'preview-company-info';
      
      if (changedSection === 'company-name') {
        textToFind = userAnswers['company-name'] || 'XYZ COMPANY LLC';
      } else if (changedSection === 'formation-date') {
        const formattedDate = userAnswers['formation-date'] ? formatDateForDisplay(userAnswers['formation-date']) : formatDateForDisplay(formattedDate);
        textToFind = formattedDate;
      } else if (changedSection === 'state-of-formation') {
        textToFind = userAnswers['state-of-formation'] || 'California';
      } else if (changedSection === 'principal-address') {
        textToFind = userAnswers['principal-address'] || '123 Business St, San Diego, CA 92101';
      } else if (changedSection === 'business-purpose') {
        textToFind = userAnswers['business-purpose'] || 'The purpose of the Company is to engage in any lawful act or activity for which a Limited Liability Company may be organized under the laws of the state of formation.';
      }
    } 
    // Member Info fields
    else if (changedSection === 'members') {
      sectionId = 'preview-member-info';
      textToFind = 'EXHIBIT A';
    } 
    // Management fields
    else if (['management-type', 'manager-names', 'voting-requirements'].includes(changedSection)) {
      sectionId = 'preview-management';
      
      if (changedSection === 'management-type') {
        const managementType = userAnswers['management-type'] || 'member-managed';
        if (managementType === 'member-managed') {
          textToFind = 'The Company shall be managed by its Members';
        } else {
          textToFind = 'The Company shall be managed by one or more Managers';
        }
      } else if (changedSection === 'manager-names') {
        textToFind = userAnswers['manager-names'] || '[Manager Name(s)]';
      } else if (changedSection === 'voting-requirements') {
        const votingRequirements = userAnswers['voting-requirements'] || 'majority';
        if (votingRequirements === 'majority') {
          textToFind = 'a majority vote of the Members based on membership interests';
        } else if (votingRequirements === 'supermajority') {
          textToFind = 'a vote of the Members representing at least two-thirds (2/3) of the membership interests';
        } else if (votingRequirements === 'unanimous') {
          textToFind = 'a unanimous vote of all Members';
        }
      }
    } 
    // Capital & Distribution fields
    else if (['additional-capital', 'capital-accounts', 'distributions', 'custom-allocation', 'include-tax-distributions'].includes(changedSection)) {
      sectionId = 'preview-allocations';
      
      if (changedSection === 'additional-capital') {
        const additionalCapital = userAnswers['additional-capital'] || 'voluntary';
        if (additionalCapital === 'voluntary') {
          textToFind = 'No Member shall be required to make any additional capital contributions';
        } else {
          textToFind = 'Members may be required to make additional capital contributions';
        }
      } else if (changedSection === 'capital-accounts') {
        const capitalAccounts = userAnswers['capital-accounts'] || 'tax-basis';
        if (capitalAccounts === 'tax-basis') {
          textToFind = 'tax basis accounting';
        } else {
          textToFind = 'generally accepted accounting principles (GAAP)';
        }
      } else if (changedSection === 'distributions' || changedSection === 'custom-allocation') {
        const distributions = userAnswers['distributions'] || 'ownership';
        if (distributions === 'ownership') {
          textToFind = 'in proportion to their respective membership interests';
        } else {
          textToFind = userAnswers['custom-allocation'] || '[Custom Allocation Formula]';
        }
      } else if (changedSection === 'include-tax-distributions') {
        textToFind = 'TAX DISTRIBUTIONS';
      }
    } 
    // Transfer Restriction fields
    else if (['transfer-consent', 'include-rofr', 'include-buysell', 'valuation-method'].includes(changedSection)) {
      sectionId = 'preview-transfer';
      
      if (changedSection === 'transfer-consent') {
        const transferConsent = userAnswers['transfer-consent'] || 'unanimous';
        if (transferConsent === 'unanimous') {
          textToFind = 'the prior written consent of all other Members';
        } else if (transferConsent === 'majority') {
          textToFind = 'the prior written consent of a majority in interest of the other Members';
        } else {
          textToFind = 'restriction, provided that the transferee complies with the provisions of Section 5.2';
        }
      } else if (changedSection === 'include-rofr') {
        textToFind = 'RIGHT OF FIRST REFUSAL';
      } else if (changedSection === 'include-buysell') {
        textToFind = 'BUY-SELL PROVISIONS';
      } else if (changedSection === 'valuation-method') {
        const valuationMethod = userAnswers['valuation-method'] || 'agreed-value';
        if (valuationMethod === 'agreed-value') {
          textToFind = 'an agreed value to be established by the Members annually';
        } else if (valuationMethod === 'formula') {
          textToFind = 'a formula equal to';
        } else {
          textToFind = 'an appraisal conducted by an independent appraiser';
        }
      }
    } 
    // Dissolution fields
    else if (['dissolution-vote', 'dissolution-term', 'dissolution-objective', 'dissolution-impossible', 
              'dissolution-term-date', 'dissolution-objective', 'governing-law', 'additional-provisions'].includes(changedSection)) {
      sectionId = 'preview-dissolution';
      
      if (changedSection.startsWith('dissolution-')) {
        textToFind = 'DISSOLUTION EVENTS';
      } else if (changedSection === 'governing-law') {
        textToFind = 'State of ' + (userAnswers['governing-law'] || 'California');
      } else if (changedSection === 'additional-provisions') {
        textToFind = 'ADDITIONAL PROVISIONS';
      }
    }
    
    // Find and highlight the text
    if (sectionId && textToFind) {
      const sectionElement = document.getElementById(sectionId);
      if (sectionElement) {
        // First, we need to escape special characters for use in regex
        const escapedText = textToFind.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        
        // Create a simple regex to find the text
        const regex = new RegExp(`(${escapedText})`, 'g');
        
        // Create a temporary div, set its HTML to the section's innerHTML,
        // and then use replace to wrap the text with a span
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = sectionElement.innerHTML;
        
        // Replace the text with highlighted version
        tempDiv.innerHTML = tempDiv.innerHTML.replace(regex, '<span class="highlight">$1</span>');
        
        // Set the section's innerHTML to the new HTML
        sectionElement.innerHTML = tempDiv.innerHTML;
        
        // Make sure the highlighted text is visible
        const highlightedElement = sectionElement.querySelector('.highlight');
        if (highlightedElement) {
          // Ensure that the scrollContainer is visible
          const previewContent = document.querySelector('.preview-content');
          
          // Calculate positions to determine if scrolling is needed
          const containerRect = previewContent.getBoundingClientRect();
          const highlightRect = highlightedElement.getBoundingClientRect();
          
          // Only scroll if the highlighted element is not fully visible
          if (highlightRect.top < containerRect.top || highlightRect.bottom > containerRect.bottom) {
            highlightedElement.scrollIntoView({
              behavior: 'smooth',
              block: 'center'
            });
          }
        }
      }
    }
  }
  
  // Generate the agreement based on user selections
  function generateAgreement() {
    // Get all the sections and combine them
    const companyInfoSection = getCompanyInfoSection().replace('<div id="preview-company-info">', '').replace('</div>', '');
    const memberInfoSection = getMemberInfoSection().replace('<div id="preview-member-info">', '').replace('</div>', '');
    const managementSection = getManagementSection().replace('<div id="preview-management">', '').replace('</div>', '');
    const allocationSection = getAllocationSection().replace('<div id="preview-allocations">', '').replace('</div>', '');
    const transferSection = getTransferSection().replace('<div id="preview-transfer">', '').replace('</div>', '');
    const dissolutionSection = getDissolutionSection().replace('<div id="preview-dissolution">', '').replace('</div>', '');
    
    const agreementText = 
        companyInfoSection + '\n\n' + 
        memberInfoSection + '\n\n' + 
        managementSection + '\n\n' + 
        allocationSection + '\n\n' + 
        transferSection + '\n\n' + 
        dissolutionSection;
    
    // Display the agreement text
    const agreementTextElement = document.getElementById('agreement-text');
    agreementTextElement.textContent = agreementText;
    
    // Hide question container and preview container, and show results
    questionContainer.style.display = 'none';
    previewContainer.style.display = 'none';
    resultsContainer.style.display = 'block';
    
    // Add visible class after a slight delay for animation
    setTimeout(() => {
      resultsContainer.classList.add('visible');
    }, 50);
    
    // Scroll to the top of the results
    document.querySelector('.results-header').scrollIntoView({ behavior:'smooth' });
  }
  
  // Initialize the tool when the document is loaded
  initTool();
});
</script>



<h1 class="wp-block-heading has-text-align-center">Navigating Multi-Member LLC Operating Agreements</h1>



<p>As an attorney specializing in business formations, I&#8217;ve seen countless entrepreneurs stumble through the complex world of LLC operating agreements. A well-crafted operating agreement is not just a legal formality—it&#8217;s the constitutional blueprint of your business partnership that can prevent potential conflicts and protect your interests.</p>



<h2 class="wp-block-heading">Understanding Multi-Member LLC Operating Agreements</h2>



<p>A multi-member LLC operating agreement is a critical document that outlines how your business will be managed, how decisions will be made, and how profits and losses will be distributed among multiple owners. Unlike a single-member LLC, where management is straightforward, multi-member LLCs require careful negotiation and clear documentation of each member&#8217;s rights and responsibilities.</p>



<h2 class="wp-block-heading">Why a Comprehensive Operating Agreement Matters</h2>



<p>Think of an operating agreement like a prenuptial agreement for business partners. It defines:</p>



<ul class="wp-block-list">
<li>Ownership percentages</li>



<li>Capital contribution requirements</li>



<li>Decision-making processes</li>



<li>Profit and loss allocation</li>



<li>Transfer of membership interests</li>



<li>Dispute resolution mechanisms</li>



<li>Dissolution conditions</li>
</ul>



<p>Without a robust agreement, you&#8217;re leaving your business vulnerable to potential conflicts, misunderstandings, and costly legal disputes.</p>



<h2 class="wp-block-heading">How to Use the Multi-Member LLC Operating Agreement Generator</h2>



<p>Our interactive tool walks you through creating a comprehensive operating agreement in six key steps:</p>



<h3 class="wp-block-heading">Step 1: Company Information</h3>



<p>Here, you&#8217;ll provide fundamental details about your LLC:</p>



<ul class="wp-block-list">
<li>Official company name</li>



<li>Formation date</li>



<li>State of formation</li>



<li>Principal business address</li>



<li>Business purpose</li>
</ul>



<p>Pro Tip: Be precise with your company name and ensure it matches your state registration. The business purpose can be broad, but it should accurately reflect your intended business activities.</p>



<h3 class="wp-block-heading">Step 2: Member Information</h3>



<p>This critical section details each member&#8217;s:</p>



<ul class="wp-block-list">
<li>Full legal name</li>



<li>Address</li>



<li>Initial capital contribution</li>



<li>Ownership percentage</li>
</ul>



<p>The generator automatically adjusts ownership percentages when you add or remove members, ensuring the total always equals 100%. Remember, initial contributions don&#8217;t always have to be equal, but ownership percentages typically reflect these contributions.</p>



<h3 class="wp-block-heading">Step 3: Management Structure</h3>



<p>Choose between two primary management models:</p>



<ol class="wp-block-list">
<li>Member-Managed: All members participate in day-to-day management</li>



<li>Manager-Managed: Designated managers (who may or may not be members) control business operations</li>
</ol>



<p>Select voting requirements that match your business dynamics:</p>



<ul class="wp-block-list">
<li>Majority vote</li>



<li>Supermajority vote (2/3 approval)</li>



<li>Unanimous vote</li>
</ul>



<h3 class="wp-block-heading">Step 4: Capital and Distributions</h3>



<p>Define how additional capital might be contributed and how profits will be distributed:</p>



<ul class="wp-block-list">
<li>Voluntary vs. required additional contributions</li>



<li>Accounting method for capital accounts</li>



<li>Profit distribution based on ownership or a custom formula</li>



<li>Optional tax distribution provisions</li>
</ul>



<h3 class="wp-block-heading">Step 5: Transfer Restrictions</h3>



<p>Protect your business by establishing:</p>



<ul class="wp-block-list">
<li>Consent requirements for transferring membership interests</li>



<li>Right of first refusal</li>



<li>Buy-sell provisions</li>



<li>Valuation methods for membership interests</li>
</ul>



<h3 class="wp-block-heading">Step 6: Dissolution and Miscellaneous Provisions</h3>



<p>Specify conditions for dissolving the LLC, such as:</p>



<ul class="wp-block-list">
<li>Member vote</li>



<li>Completion of business objective</li>



<li>Expiration of a defined term</li>



<li>Inability to continue business operations</li>
</ul>



<h2 class="wp-block-heading">Key Considerations for Multi-Member LLCs</h2>



<h3 class="wp-block-heading">1. Communication is Crucial</h3>



<p>An operating agreement is more than a legal document—it&#8217;s a communication tool. Use clear, straightforward language that all members can understand.</p>



<h3 class="wp-block-heading">2. Be Specific About Roles and Expectations</h3>



<p>Clearly define each member&#8217;s responsibilities, voting rights, and financial obligations to prevent future misunderstandings.</p>



<h3 class="wp-block-heading">3. Plan for Various Scenarios</h3>



<p>Consider potential future events like:</p>



<ul class="wp-block-list">
<li>A member wanting to leave</li>



<li>Disagreements about business direction</li>



<li>Death or disability of a member</li>



<li>Potential sale of the business</li>
</ul>



<h3 class="wp-block-heading">4. Remain Flexible</h3>



<p>While your operating agreement should be comprehensive, include provisions for amendments as your business evolves.</p>



<h3 class="wp-block-heading">5. Seek Professional Review</h3>



<p>While our generator provides a robust template, every business is unique. I strongly recommend having an attorney review the final document to ensure it meets your specific needs.</p>



<h2 class="wp-block-heading">Potential Pitfalls to Avoid</h2>



<h3 class="wp-block-heading">Neglecting to Create an Operating Agreement</h3>



<p>Some entrepreneurs skip this step, assuming verbal agreements are sufficient. This is a critical mistake that can lead to costly legal battles.</p>



<h3 class="wp-block-heading">Unequal Contribution, Equal Ownership</h3>



<p>Just because members contribute different amounts doesn&#8217;t mean ownership should be equal. Carefully consider how initial and future contributions impact ownership percentages.</p>



<h3 class="wp-block-heading">Overlooking Dispute Resolution Mechanisms</h3>



<p>Without clear dispute resolution processes, minor disagreements can escalate into business-ending conflicts.</p>



<h2 class="wp-block-heading">Frequently Asked Questions</h2>



<h3 class="wp-block-heading">How Often Should We Update Our Operating Agreement?</h3>



<p>Review your operating agreement annually or whenever significant changes occur in your business, such as:</p>



<ul class="wp-block-list">
<li>New members joining</li>



<li>Substantial changes in business model</li>



<li>Major financial shifts</li>



<li>Changes in state laws affecting LLCs</li>
</ul>



<h3 class="wp-block-heading">Can We Modify the Operating Agreement Later?</h3>



<p>Absolutely. Most operating agreements include an amendment clause allowing modifications with member consent. Our generator includes provisions for future amendments.</p>



<h3 class="wp-block-heading">What Happens If a Member Wants to Leave?</h3>



<p>Your operating agreement should clearly outline:</p>



<ul class="wp-block-list">
<li>Procedures for member withdrawal</li>



<li>Valuation of membership interests</li>



<li>Buyout processes</li>



<li>Potential restrictions on competing businesses</li>
</ul>



<h3 class="wp-block-heading">Do We Need Lawyers to Create an Operating Agreement?</h3>



<p>While our generator provides a comprehensive template, consulting with a business attorney can provide personalized insights specific to your business context. Think of the generator as a robust starting point, not a substitute for legal advice.</p>



<h3 class="wp-block-heading">How Detailed Should Our Business Purpose Be?</h3>



<p>Balance specificity with flexibility. A too-narrow purpose can limit future opportunities, while an overly broad description might lack clarity. Generally, aim for a description that captures your current business model and potential future expansions.</p>



<h2 class="wp-block-heading">Final Thoughts</h2>



<p>A well-crafted multi-member LLC operating agreement is an investment in your business&#8217;s future. It provides clarity, prevents conflicts, and creates a solid foundation for successful collaboration. Use our generator as a strategic tool to develop a comprehensive, customized agreement that protects all members&#8217; interests.</p>



<p>Ready to create your operating agreement? Let&#8217;s get started. And remember, while this tool provides an excellent framework, every business is unique. When in doubt, consulting with a legal professional can provide tailored guidance for your specific situation.</p>
</div>
    
<div style="background: #f8f9fa; border-radius: 12px; padding: 24px; margin: 32px 0; border: 1px solid #e2e8f0;">
<h3 style="margin-top: 0; color: #1a1a2e; font-size: 1.2rem;">More from Terms.Law</h3>
<ul style="list-style: none; padding: 0; margin: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
<li><a href="/forum/" style="color: #6366f1; text-decoration: none;">💬 Community Forum</a></li>
<li><a href="/Demand-Letters/demand-letters-landing.html" style="color: #6366f1; text-decoration: none;">📄 Demand Letter Generators</a></li>
<li><a href="/Templates/contract-library-landing.html" style="color: #6366f1; text-decoration: none;">📋 Contract Templates</a></li>
<li><a href="/Blog/" style="color: #6366f1; text-decoration: none;">📰 Blog &amp; Guides</a></li>
</ul>
</div>
</article>
  </main>

  <footer><p>© Terms.Law. All rights reserved.</p></footer>
</body>
</html>