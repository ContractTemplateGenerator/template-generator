<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unpaid Invoice Demand Letter Generator | Professional Collection Tool</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Generate professional demand letters for unpaid invoices. Perfect for SaaS businesses, freelancers, contractors, and small businesses. Get paid faster with legally compliant collection letters.">
    <meta name="keywords" content="unpaid invoice, demand letter, collection letter, freelancer, SaaS, contractor, small business, accounts receivable">
    
    <!-- Styles -->
    <link rel="stylesheet" href="../Tenant-Security-Deposit-Generator/styles.css">
    <style>
        .invoice-form {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .form-row-three {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .preview-pane {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-height: 800px;
            overflow-y: auto;
        }
        
        .letter-content {
            line-height: 1.6;
            font-family: 'Times New Roman', serif;
            font-size: 14px;
        }
        
        .letter-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #000;
        }
        
        .letter-date {
            text-align: right;
            margin-bottom: 2rem;
        }
        
        .letter-body p {
            margin-bottom: 1rem;
        }
        
        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .invoice-table th,
        .invoice-table td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        
        .invoice-table th {
            background-color: #f3f4f6;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2563eb;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-row-three {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üíº Unpaid Invoice Demand Letter Generator</h1>
            <p>Professional collection letters for SaaS businesses, freelancers, contractors, and small businesses</p>
        </header>

        <div class="generator-layout">
            <!-- Input Form -->
            <div class="input-pane">
                <div class="invoice-form">
                    <h2>üìù Invoice & Business Details</h2>
                    
                    <!-- Business Information -->
                    <div class="form-section">
                        <h3>Your Business Information</h3>
                        <div class="form-group">
                            <label for="businessName">Business/Your Name *</label>
                            <input type="text" id="businessName" placeholder="ABC Consulting LLC" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="businessEmail">Email Address *</label>
                                <input type="email" id="businessEmail" placeholder="billing@abcconsulting.com" required>
                            </div>
                            <div class="form-group">
                                <label for="businessPhone">Phone Number</label>
                                <input type="tel" id="businessPhone" placeholder="(555) 123-4567">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="businessAddress">Business Address</label>
                            <textarea id="businessAddress" placeholder="123 Business Ave&#10;Suite 100&#10;City, State 12345"></textarea>
                        </div>
                    </div>

                    <!-- Client Information -->
                    <div class="form-section">
                        <h3>Client/Debtor Information</h3>
                        <div class="form-group">
                            <label for="clientName">Client Name/Company *</label>
                            <input type="text" id="clientName" placeholder="XYZ Corporation" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="clientEmail">Client Email</label>
                                <input type="email" id="clientEmail" placeholder="ap@xyzcorp.com">
                            </div>
                            <div class="form-group">
                                <label for="contactPerson">Contact Person</label>
                                <input type="text" id="contactPerson" placeholder="John Smith">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="clientAddress">Client Address</label>
                            <textarea id="clientAddress" placeholder="456 Client St&#10;City, State 67890"></textarea>
                        </div>
                    </div>

                    <!-- Invoice Details -->
                    <div class="form-section">
                        <h3>Invoice Details</h3>
                        <div class="form-row-three">
                            <div class="form-group">
                                <label for="invoiceNumber">Invoice Number *</label>
                                <input type="text" id="invoiceNumber" placeholder="INV-2024-001" required>
                            </div>
                            <div class="form-group">
                                <label for="invoiceDate">Invoice Date *</label>
                                <input type="date" id="invoiceDate" required>
                            </div>
                            <div class="form-group">
                                <label for="dueDate">Due Date *</label>
                                <input type="date" id="dueDate" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="totalAmount">Total Amount Owed *</label>
                                <input type="number" id="totalAmount" step="0.01" placeholder="5000.00" required>
                            </div>
                            <div class="form-group">
                                <label for="currency">Currency</label>
                                <select id="currency">
                                    <option value="USD">USD ($)</option>
                                    <option value="EUR">EUR (‚Ç¨)</option>
                                    <option value="GBP">GBP (¬£)</option>
                                    <option value="CAD">CAD ($)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="workDescription">Description of Work/Services *</label>
                            <textarea id="workDescription" placeholder="Web development services for e-commerce platform..." required></textarea>
                        </div>
                    </div>

                    <!-- Collection Options -->
                    <div class="form-section">
                        <h3>Collection Strategy</h3>
                        <div class="form-group">
                            <label for="demandTone">Letter Tone</label>
                            <select id="demandTone">
                                <option value="professional">Professional (Recommended)</option>
                                <option value="firm">Firm but Respectful</option>
                                <option value="urgent">Urgent Collection</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="paymentDeadline">Payment Deadline (Days from today)</label>
                                <select id="paymentDeadline">
                                    <option value="7">7 Days</option>
                                    <option value="10" selected>10 Days</option>
                                    <option value="14">14 Days</option>
                                    <option value="30">30 Days</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="interestRate">Late Fee/Interest Rate (%)</label>
                                <input type="number" id="interestRate" step="0.1" placeholder="1.5" value="1.5">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Additional Consequences</label>
                            <div class="checkbox-group">
                                <input type="checkbox" id="reportCredit" checked>
                                <label for="reportCredit">Report to Credit Agencies</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="collectionAgency" checked>
                                <label for="collectionAgency">Refer to Collection Agency</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="legalAction" checked>
                                <label for="legalAction">Pursue Legal Action</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="lienRights">
                                <label for="lienRights">File Mechanic's Lien (if applicable)</label>
                            </div>
                        </div>
                    </div>

                    <!-- Previous Communication -->
                    <div class="form-section">
                        <h3>Previous Attempts</h3>
                        <div class="form-group">
                            <label for="previousAttempts">Previous Collection Attempts</label>
                            <textarea id="previousAttempts" placeholder="Email sent on [date], phone call on [date], etc."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Preview -->
            <div class="preview-pane">
                <h2>üìÑ Live Preview</h2>
                <div class="letter-content" id="letterPreview">
                    <div class="letter-header">
                        <h2>DEMAND FOR PAYMENT</h2>
                        <p><strong>UNPAID INVOICE COLLECTION NOTICE</strong></p>
                    </div>
                    
                    <div class="letter-date">
                        <p id="currentDate"></p>
                    </div>
                    
                    <div class="letter-body">
                        <p><strong>TO:</strong> <span id="previewClientName">[Client Name]</span><br>
                        <span id="previewClientAddress">[Client Address]</span></p>
                        
                        <p><strong>FROM:</strong> <span id="previewBusinessName">[Your Business Name]</span><br>
                        <span id="previewBusinessAddress">[Your Business Address]</span><br>
                        Email: <span id="previewBusinessEmail">[Your Email]</span><br>
                        Phone: <span id="previewBusinessPhone">[Your Phone]</span></p>
                        
                        <p><strong>RE: DEMAND FOR PAYMENT - INVOICE #<span id="previewInvoiceNumber">[Invoice Number]</span></strong></p>
                        
                        <div id="letterBody">
                            <p>This letter serves as formal notice that your account is seriously past due. Despite our previous attempts to collect this debt, payment remains outstanding.</p>
                            
                            <p><strong>INVOICE DETAILS:</strong></p>
                            <table class="invoice-table">
                                <tr>
                                    <th>Invoice Number</th>
                                    <th>Invoice Date</th>
                                    <th>Due Date</th>
                                    <th>Amount Owed</th>
                                    <th>Days Overdue</th>
                                </tr>
                                <tr>
                                    <td id="tableInvoiceNumber">[Invoice Number]</td>
                                    <td id="tableInvoiceDate">[Invoice Date]</td>
                                    <td id="tableDueDate">[Due Date]</td>
                                    <td id="tableAmount">[Amount]</td>
                                    <td id="tableDaysOverdue">[Days Overdue]</td>
                                </tr>
                            </table>
                            
                            <p><strong>Services Provided:</strong> <span id="previewWorkDescription">[Work Description]</span></p>
                            
                            <p id="demandParagraph">You must pay this debt in full within <span id="previewDeadline">[X]</span> days of receiving this notice. Failure to respond will result in additional collection activities.</p>
                            
                            <p id="consequencesParagraph"><strong>Consequences of Non-Payment:</strong></p>
                            <ul id="consequencesList">
                                <li>Late fees and interest charges at [X]% per month</li>
                                <li>Reporting to credit bureaus</li>
                                <li>Referral to collection agency</li>
                                <li>Legal action and potential judgment</li>
                            </ul>
                            
                            <p><strong>PAYMENT INSTRUCTIONS:</strong><br>
                            Please remit payment immediately to avoid further collection action. Contact us at <span id="previewBusinessEmail2">[Your Email]</span> to arrange payment or discuss payment plans.</p>
                            
                            <p>This letter is an attempt to collect a debt. Any information obtained will be used for that purpose.</p>
                            
                            <p>Sincerely,<br><br>
                            <span id="previewBusinessName2">[Your Business Name]</span></p>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="updatePreview()">üîÑ Update Preview</button>
                    <button class="btn btn-success" onclick="copyToClipboard()">üìã Copy Letter</button>
                    <button class="btn btn-secondary" onclick="downloadLetter()">üì• Download as Word</button>
                    <button class="btn btn-secondary" onclick="printLetter()">üñ®Ô∏è Print Letter</button>
                </div>
            </div>
        </div>
    </div>

    <!-- PayPal Integration -->
    <script src="../Tenant-Security-Deposit-Generator/paywall-system.js"></script>
    
    <script>
        // Initialize the form
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString();
            
            // Set default invoice date to 30 days ago
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            document.getElementById('invoiceDate').value = thirtyDaysAgo.toISOString().split('T')[0];
            
            // Set default due date to 60 days ago
            const sixtyDaysAgo = new Date();
            sixtyDaysAgo.setDate(sixtyDaysAgo.getDate() - 60);
            document.getElementById('dueDate').value = sixtyDaysAgo.toISOString().split('T')[0];
            
            // Add event listeners for real-time updates
            const inputs = document.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
                input.addEventListener('change', updatePreview);
            });
            
            // Initial preview update
            updatePreview();
        });

        function updatePreview() {
            // Get form values
            const businessName = document.getElementById('businessName').value || '[Your Business Name]';
            const businessEmail = document.getElementById('businessEmail').value || '[Your Email]';
            const businessPhone = document.getElementById('businessPhone').value || '[Your Phone]';
            const businessAddress = document.getElementById('businessAddress').value || '[Your Business Address]';
            
            const clientName = document.getElementById('clientName').value || '[Client Name]';
            const clientAddress = document.getElementById('clientAddress').value || '[Client Address]';
            
            const invoiceNumber = document.getElementById('invoiceNumber').value || '[Invoice Number]';
            const invoiceDate = document.getElementById('invoiceDate').value || '[Invoice Date]';
            const dueDate = document.getElementById('dueDate').value || '[Due Date]';
            const totalAmount = document.getElementById('totalAmount').value || '[Amount]';
            const currency = document.getElementById('currency').value;
            const workDescription = document.getElementById('workDescription').value || '[Work Description]';
            
            const demandTone = document.getElementById('demandTone').value;
            const paymentDeadline = document.getElementById('paymentDeadline').value;
            const interestRate = document.getElementById('interestRate').value || '1.5';
            
            // Calculate days overdue
            let daysOverdue = 0;
            if (dueDate) {
                const dueDateObj = new Date(dueDate);
                const today = new Date();
                daysOverdue = Math.ceil((today - dueDateObj) / (1000 * 60 * 60 * 24));
            }
            
            // Format currency symbol
            const currencySymbol = currency === 'USD' ? '$' : currency === 'EUR' ? '‚Ç¨' : currency === 'GBP' ? '¬£' : '$';
            const formattedAmount = `${currencySymbol}${totalAmount}`;
            
            // Update preview elements
            document.getElementById('previewBusinessName').textContent = businessName;
            document.getElementById('previewBusinessName2').textContent = businessName;
            document.getElementById('previewBusinessEmail').textContent = businessEmail;
            document.getElementById('previewBusinessEmail2').textContent = businessEmail;
            document.getElementById('previewBusinessPhone').textContent = businessPhone;
            document.getElementById('previewBusinessAddress').textContent = businessAddress;
            
            document.getElementById('previewClientName').textContent = clientName;
            document.getElementById('previewClientAddress').textContent = clientAddress;
            
            document.getElementById('previewInvoiceNumber').textContent = invoiceNumber;
            document.getElementById('previewWorkDescription').textContent = workDescription;
            document.getElementById('previewDeadline').textContent = paymentDeadline;
            
            // Update table
            document.getElementById('tableInvoiceNumber').textContent = invoiceNumber;
            document.getElementById('tableInvoiceDate').textContent = invoiceDate;
            document.getElementById('tableDueDate').textContent = dueDate;
            document.getElementById('tableAmount').textContent = formattedAmount;
            document.getElementById('tableDaysOverdue').textContent = daysOverdue > 0 ? daysOverdue : '0';
            
            // Update tone-based content
            updateToneBasedContent(demandTone, paymentDeadline);
            
            // Update consequences
            updateConsequences(interestRate);
        }
        
        function updateToneBasedContent(tone, deadline) {
            const demandParagraph = document.getElementById('demandParagraph');
            
            switch(tone) {
                case 'professional':
                    demandParagraph.innerHTML = `We respectfully request payment of this outstanding invoice within <span class="highlight">${deadline} days</span> of receiving this notice. We value our business relationship and would prefer to resolve this matter amicably.`;
                    break;
                case 'firm':
                    demandParagraph.innerHTML = `Payment of this outstanding debt is required within <span class="highlight">${deadline} days</span> of receiving this notice. Continued non-payment will force us to pursue more aggressive collection measures.`;
                    break;
                case 'urgent':
                    demandParagraph.innerHTML = `<strong>IMMEDIATE PAYMENT REQUIRED:</strong> This debt must be paid in full within <span class="highlight">${deadline} days</span> or we will proceed with collection action without further notice.`;
                    break;
            }
        }
        
        function updateConsequences(interestRate) {
            const consequencesList = document.getElementById('consequencesList');
            let consequences = [];
            
            if (document.getElementById('reportCredit').checked) {
                consequences.push('Reporting this debt to credit bureaus, which may damage your credit score');
            }
            if (document.getElementById('collectionAgency').checked) {
                consequences.push('Referral to a professional collection agency');
            }
            if (document.getElementById('legalAction').checked) {
                consequences.push('Legal action seeking judgment, attorney fees, and court costs');
            }
            if (document.getElementById('lienRights').checked) {
                consequences.push('Filing of mechanic\'s lien against your property (where applicable)');
            }
            
            consequences.unshift(`Late fees and interest charges at ${interestRate}% per month`);
            
            consequencesList.innerHTML = consequences.map(c => `<li>${c}</li>`).join('');
        }

        function copyToClipboard() {
            const letterContent = document.getElementById('letterPreview').innerText;
            
            if (PaywallSystem && !PaywallSystem.hasAccess()) {
                PaywallSystem.showAccessDenied('copy');
                PaywallSystem.createPaywallModal();
                return;
            }
            
            navigator.clipboard.writeText(letterContent).then(() => {
                alert('Demand letter copied to clipboard!');
            }).catch(() => {
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = letterContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Demand letter copied to clipboard!');
            });
        }

        function downloadLetter() {
            if (PaywallSystem && !PaywallSystem.hasAccess()) {
                PaywallSystem.showAccessDenied('download');
                PaywallSystem.createPaywallModal();
                return;
            }
            
            const letterContent = document.getElementById('letterPreview').innerHTML;
            const fullDocument = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Demand Letter - Invoice ${document.getElementById('invoiceNumber').value}</title>
                    <style>
                        body { font-family: 'Times New Roman', serif; line-height: 1.6; margin: 1in; }
                        .letter-header { text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid #000; }
                        .letter-date { text-align: right; margin-bottom: 2rem; }
                        .invoice-table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
                        .invoice-table th, .invoice-table td { border: 1px solid #000; padding: 8px; text-align: left; }
                        .invoice-table th { background-color: #f3f4f6; }
                        .highlight { font-weight: bold; }
                    </style>
                </head>
                <body>
                    ${letterContent}
                </body>
                </html>
            `;
            
            const blob = new Blob([fullDocument], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `Demand_Letter_Invoice_${document.getElementById('invoiceNumber').value || 'Draft'}.doc`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function printLetter() {
            if (PaywallSystem && !PaywallSystem.hasAccess()) {
                PaywallSystem.showAccessDenied('print');
                PaywallSystem.createPaywallModal();
                return;
            }
            
            const letterContent = document.getElementById('letterPreview').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Demand Letter - Invoice ${document.getElementById('invoiceNumber').value}</title>
                    <style>
                        body { font-family: 'Times New Roman', serif; line-height: 1.6; margin: 1in; }
                        .letter-header { text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid #000; }
                        .letter-date { text-align: right; margin-bottom: 2rem; }
                        .invoice-table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
                        .invoice-table th, .invoice-table td { border: 1px solid #000; padding: 8px; text-align: left; }
                        .invoice-table th { background-color: #f3f4f6; }
                        @media print { 
                            body { margin: 0.5in; }
                            .action-buttons { display: none; }
                        }
                    </style>
                </head>
                <body>
                    ${letterContent}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Initialize PayPal if available
        if (typeof PaywallSystem !== 'undefined') {
            PaywallSystem.initializePayPal().catch(console.error);
        }
    </script>
</body>
</html>