<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-901N2Y3CDZ');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Loan Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a professional business loan agreement. Includes principal amount, interest rates, repayment schedule, collateral, and default provisions for commercial loans.">
    <link rel="canonical" href="https://terms.law/Templates/business-loan-agreement-generator.html">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 1rem 2rem; position: sticky; top: 0; z-index: 100; }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-links { display: flex; gap: 2rem; }
        .nav-links a { color: #94a3b8; text-decoration: none; }
        .nav-links a:hover { color: #fff; }
        .main-container { display: grid; grid-template-columns: 420px 1fr; gap: 2rem; max-width: 1600px; margin: 0 auto; padding: 2rem; }
        .form-panel { background: #fff; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); position: sticky; top: 100px; max-height: calc(100vh - 120px); overflow-y: auto; }
        .form-header { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
        .form-header h1 { font-size: 1.25rem; font-weight: 700; }
        .form-header p { font-size: 0.85rem; color: #64748b; }
        .form-section { margin-bottom: 1.5rem; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: #374151; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .section-title::before { content: ''; width: 3px; height: 16px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 2px; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 500; color: #475569; margin-bottom: 0.35rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.6rem 0.75rem; border: 1.5px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
        .help-text { font-size: 0.75rem; color: #94a3b8; margin-top: 0.25rem; }
        .checkbox-label { display: flex; align-items: flex-start; gap: 0.5rem; font-size: 0.8rem; color: #475569; cursor: pointer; margin-bottom: 0.5rem; }
        .checkbox-label input { margin-top: 0.15rem; }
        .preview-panel { background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: flex; flex-direction: column; }
        .preview-toolbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e2e8f0; background: #f8fafc; border-radius: 16px 16px 0 0; }
        .preview-title { font-weight: 600; color: #374151; }
        .preview-actions { display: flex; gap: 0.75rem; }
        .btn { padding: 0.6rem 1.25rem; border-radius: 8px; font-size: 0.85rem; font-weight: 500; cursor: pointer; border: none; }
        .btn-primary { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
        .btn-secondary { background: #fff; color: #374151; border: 1.5px solid #e2e8f0; }
        .preview-content { flex: 1; padding: 2rem; overflow-y: auto; }
        .document { background: white; max-width: 8.5in; margin: 0 auto; padding: 1in; box-shadow: 0 2px 20px rgba(0,0,0,0.08); border: 1px solid #e5e7eb; font-family: 'Times New Roman', serif; font-size: 11pt; line-height: 1.5; color: #000; }
        .document h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; border-bottom: 2px solid #000; padding-bottom: 0.5rem; }
        .document h2 { font-size: 11pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; }
        .document p { margin-bottom: 0.75rem; text-align: justify; }
        .document .parties-box { background: #f9f9f9; padding: 1rem; border: 1px solid #ddd; margin: 1rem 0; }
        .document .amount-box { text-align: center; font-size: 14pt; font-weight: bold; margin: 1.5rem 0; padding: 1rem; border: 2px solid #000; }
        .document .signature-block { margin-top: 3rem; }
        .document .signature-party { margin-bottom: 2.5rem; }
        .document .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 9pt; width: 60%; }
        .doc-highlight { background: linear-gradient(135deg, #fef3c7, #fde68a); padding: 0 3px; border-radius: 3px; }
        .loan-badge { display: inline-block; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.7rem; font-weight: 600; margin-left: 0.5rem; }
        .calc-box { background: #f0fdf4; border: 1px solid #22c55e; border-radius: 8px; padding: 1rem; margin-top: 1rem; }
        .calc-box h4 { font-size: 0.85rem; color: #16a34a; margin-bottom: 0.5rem; }
        .calc-box p { font-size: 0.8rem; color: #166534; margin-bottom: 0.25rem; }
        @media (max-width: 1200px) { .main-container { grid-template-columns: 1fr; } .form-panel { position: relative; top: 0; max-height: none; } }
        @media print { body * { visibility: hidden; } .document, .document * { visibility: visible; } .document { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: none; } }
        .footer { background: #0f172a; color: #94a3b8; padding: 2rem; text-align: center; font-size: 0.85rem; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" style="text-decoration:none"><span class="logo">Terms.Law</span></a>
            <nav class="nav-links">
                <a href="/Templates/contract-library-landing.html">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <aside class="form-panel">
            <div class="form-header">
                <h1>Business Loan Agreement <span class="loan-badge">Commercial</span></h1>
                <p>Create a formal business loan agreement for commercial lending</p>
            </div>

            <!-- Lender Information -->
            <div class="form-section">
                <div class="section-title">Lender Information</div>
                <div class="form-group">
                    <label for="lenderName">Lender Name</label>
                    <input type="text" id="lenderName" placeholder="First National Bank" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="lenderAddress">Lender Address</label>
                    <input type="text" id="lenderAddress" placeholder="100 Finance Street, City, State ZIP" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="lenderContact">Contact Person</label>
                    <input type="text" id="lenderContact" placeholder="James Wilson, Loan Officer" oninput="updatePreview()">
                </div>
            </div>

            <!-- Borrower Information -->
            <div class="form-section">
                <div class="section-title">Borrower Information</div>
                <div class="form-group">
                    <label for="borrowerName">Business Name</label>
                    <input type="text" id="borrowerName" placeholder="ABC Company, LLC" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="borrowerAddress">Business Address</label>
                    <input type="text" id="borrowerAddress" placeholder="456 Commerce Drive, City, State ZIP" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="borrowerEntity">Entity Type</label>
                    <select id="borrowerEntity" onchange="updatePreview()">
                        <option value="LLC">LLC</option>
                        <option value="Corporation">Corporation</option>
                        <option value="Partnership">Partnership</option>
                        <option value="Sole Proprietorship">Sole Proprietorship</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="borrowerState">State of Organization</label>
                    <input type="text" id="borrowerState" placeholder="Delaware" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="borrowerSignatory">Authorized Signatory</label>
                    <input type="text" id="borrowerSignatory" placeholder="John Smith, CEO" oninput="updatePreview()">
                </div>
            </div>

            <!-- Loan Terms -->
            <div class="form-section">
                <div class="section-title">Loan Terms</div>
                <div class="form-group">
                    <label for="principalAmount">Principal Amount ($)</label>
                    <input type="text" id="principalAmount" placeholder="250,000" oninput="updatePreview(); calculatePayment();">
                </div>
                <div class="form-group">
                    <label for="loanPurpose">Loan Purpose</label>
                    <select id="loanPurpose" onchange="updatePreview()">
                        <option value="working-capital">Working Capital</option>
                        <option value="equipment">Equipment Purchase</option>
                        <option value="real-estate">Real Estate Acquisition</option>
                        <option value="expansion">Business Expansion</option>
                        <option value="inventory">Inventory Financing</option>
                        <option value="refinance">Debt Refinancing</option>
                        <option value="other">Other Business Purpose</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="interestRate">Annual Interest Rate (%)</label>
                        <input type="text" id="interestRate" placeholder="8.5" oninput="updatePreview(); calculatePayment();">
                    </div>
                    <div class="form-group">
                        <label for="interestType">Interest Type</label>
                        <select id="interestType" onchange="updatePreview(); calculatePayment();">
                            <option value="fixed">Fixed Rate</option>
                            <option value="variable">Variable (Prime + margin)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="loanTerm">Loan Term</label>
                        <select id="loanTerm" onchange="updatePreview(); calculatePayment();">
                            <option value="12">12 Months</option>
                            <option value="24">24 Months</option>
                            <option value="36">36 Months</option>
                            <option value="48">48 Months</option>
                            <option value="60" selected>60 Months (5 Years)</option>
                            <option value="84">84 Months (7 Years)</option>
                            <option value="120">120 Months (10 Years)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="loanDate">Loan Date</label>
                        <input type="date" id="loanDate" onchange="updatePreview()">
                    </div>
                </div>
                <div class="calc-box" id="calcBox">
                    <h4>Estimated Payments</h4>
                    <p><strong>Monthly Payment:</strong> <span id="monthlyPayment">$0.00</span></p>
                    <p><strong>Total Interest:</strong> <span id="totalInterest">$0.00</span></p>
                    <p><strong>Total Repayment:</strong> <span id="totalRepayment">$0.00</span></p>
                </div>
            </div>

            <!-- Repayment Terms -->
            <div class="form-section">
                <div class="section-title">Repayment Terms</div>
                <div class="form-group">
                    <label for="repaymentSchedule">Repayment Schedule</label>
                    <select id="repaymentSchedule" onchange="updatePreview()">
                        <option value="monthly" selected>Monthly Payments</option>
                        <option value="quarterly">Quarterly Payments</option>
                        <option value="balloon">Interest Only + Balloon</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentDueDay">Payment Due Day</label>
                    <select id="paymentDueDay" onchange="updatePreview()">
                        <option value="1">1st of each month</option>
                        <option value="15">15th of each month</option>
                        <option value="last">Last business day of month</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="gracePeriod">Grace Period (Days)</label>
                        <select id="gracePeriod" onchange="updatePreview()">
                            <option value="0">No Grace Period</option>
                            <option value="5">5 Days</option>
                            <option value="10" selected>10 Days</option>
                            <option value="15">15 Days</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lateFee">Late Fee</label>
                        <select id="lateFee" onchange="updatePreview()">
                            <option value="5%">5% of payment</option>
                            <option value="flat-50">$50 flat fee</option>
                            <option value="flat-100">$100 flat fee</option>
                            <option value="greater">Greater of 5% or $50</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="prepaymentAllowed" checked onchange="updatePreview()">
                        Allow prepayment without penalty
                    </label>
                    <label class="checkbox-label" id="prepaymentPenaltyOption" style="display:none;">
                        <input type="checkbox" id="prepaymentPenalty" onchange="updatePreview()">
                        Prepayment penalty (2% of remaining balance in first 2 years)
                    </label>
                </div>
            </div>

            <!-- Security/Collateral -->
            <div class="form-section">
                <div class="section-title">Security & Collateral</div>
                <div class="form-group">
                    <label for="loanType">Loan Security Type</label>
                    <select id="loanType" onchange="updatePreview(); toggleCollateralFields();">
                        <option value="unsecured">Unsecured</option>
                        <option value="secured" selected>Secured (with collateral)</option>
                    </select>
                </div>
                <div id="collateralFields">
                    <div class="form-group">
                        <label for="collateralType">Collateral Type</label>
                        <select id="collateralType" onchange="updatePreview()">
                            <option value="equipment">Equipment</option>
                            <option value="inventory">Inventory</option>
                            <option value="accounts-receivable">Accounts Receivable</option>
                            <option value="real-estate">Real Estate</option>
                            <option value="blanket">Blanket Lien (all business assets)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="collateralDescription">Collateral Description</label>
                        <textarea id="collateralDescription" rows="2" placeholder="Describe the specific collateral..." oninput="updatePreview()"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="collateralValue">Estimated Collateral Value ($)</label>
                        <input type="text" id="collateralValue" placeholder="300,000" oninput="updatePreview()">
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="personalGuarantee" checked onchange="updatePreview()">
                        Require personal guarantee from owner(s)
                    </label>
                </div>
                <div class="form-group" id="guarantorField">
                    <label for="guarantorName">Guarantor Name(s)</label>
                    <input type="text" id="guarantorName" placeholder="John Smith" oninput="updatePreview()">
                </div>
            </div>

            <!-- Covenants -->
            <div class="form-section">
                <div class="section-title">Loan Covenants</div>
                <div class="form-group">
                    <label>Financial Covenants</label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="debtServiceCoverage" checked onchange="updatePreview()">
                        Maintain debt service coverage ratio of 1.25:1
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="currentRatio" checked onchange="updatePreview()">
                        Maintain current ratio of at least 1.5:1
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="netWorth" onchange="updatePreview()">
                        Maintain minimum tangible net worth
                    </label>
                </div>
                <div class="form-group">
                    <label>Reporting Requirements</label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="annualFinancials" checked onchange="updatePreview()">
                        Annual audited/reviewed financial statements
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="quarterlyFinancials" onchange="updatePreview()">
                        Quarterly financial statements
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="taxReturns" checked onchange="updatePreview()">
                        Annual tax returns within 30 days of filing
                    </label>
                </div>
            </div>

            <!-- Governing Law -->
            <div class="form-section">
                <div class="section-title">Governing Law</div>
                <div class="form-group">
                    <label for="governingState">State</label>
                    <select id="governingState" onchange="updatePreview()">
                        <option value="">Select State</option>
                        <option value="California">California</option>
                        <option value="Delaware">Delaware</option>
                        <option value="Florida">Florida</option>
                        <option value="New York">New York</option>
                        <option value="Texas">Texas</option>
                        <option value="Illinois">Illinois</option>
                        <option value="Pennsylvania">Pennsylvania</option>
                        <option value="Ohio">Ohio</option>
                        <option value="Georgia">Georgia</option>
                        <option value="North Carolina">North Carolina</option>
                    </select>
                </div>
            </div>
        </aside>

        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">Live Preview</span>
                <div class="preview-actions">
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                    <button class="btn btn-primary" onclick="downloadWord()">Download Word</button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; Terms.Law. For informational purposes only. Not legal advice.</p>
    </footer>

    <script>
        function toggleCollateralFields() {
            const loanType = document.getElementById('loanType').value;
            document.getElementById('collateralFields').style.display = loanType === 'secured' ? 'block' : 'none';
        }

        document.getElementById('prepaymentAllowed').addEventListener('change', function() {
            document.getElementById('prepaymentPenaltyOption').style.display = this.checked ? 'none' : 'block';
        });

        document.getElementById('personalGuarantee').addEventListener('change', function() {
            document.getElementById('guarantorField').style.display = this.checked ? 'block' : 'none';
        });

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            return new Date(dateStr).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount && amount !== 0) return '$0.00';
            const num = typeof amount === 'number' ? amount : parseFloat(String(amount).replace(/[^0-9.]/g, ''));
            return isNaN(num) ? '$0.00' : '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function calculatePayment() {
            const principal = parseFloat(getValue('principalAmount', '0').replace(/[^0-9.]/g, '')) || 0;
            const rate = parseFloat(getValue('interestRate', '0')) / 100 / 12;
            const term = parseInt(getValue('loanTerm', '60'));

            if (principal > 0 && rate > 0 && term > 0) {
                const payment = principal * (rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
                const totalRepayment = payment * term;
                const totalInterest = totalRepayment - principal;

                document.getElementById('monthlyPayment').textContent = formatCurrency(payment);
                document.getElementById('totalInterest').textContent = formatCurrency(totalInterest);
                document.getElementById('totalRepayment').textContent = formatCurrency(totalRepayment);
            } else {
                document.getElementById('monthlyPayment').textContent = '$0.00';
                document.getElementById('totalInterest').textContent = '$0.00';
                document.getElementById('totalRepayment').textContent = '$0.00';
            }
        }

        function updatePreview() {
            const lenderName = getValue('lenderName', '[LENDER NAME]');
            const lenderAddress = getValue('lenderAddress', '[LENDER ADDRESS]');
            const lenderContact = getValue('lenderContact', '[CONTACT]');
            const borrowerName = getValue('borrowerName', '[BORROWER NAME]');
            const borrowerAddress = getValue('borrowerAddress', '[BORROWER ADDRESS]');
            const borrowerEntity = getValue('borrowerEntity', 'LLC');
            const borrowerState = getValue('borrowerState', '[STATE]');
            const borrowerSignatory = getValue('borrowerSignatory', '[SIGNATORY]');
            const principalAmount = parseFloat(getValue('principalAmount', '0').replace(/[^0-9.]/g, '')) || 0;
            const loanPurpose = getValue('loanPurpose', 'working-capital');
            const interestRate = getValue('interestRate', '0');
            const interestType = getValue('interestType', 'fixed');
            const loanTerm = getValue('loanTerm', '60');
            const loanDate = formatDate(getValue('loanDate'));
            const repaymentSchedule = getValue('repaymentSchedule', 'monthly');
            const paymentDueDay = getValue('paymentDueDay', '1');
            const gracePeriod = getValue('gracePeriod', '10');
            const lateFee = getValue('lateFee', '5%');
            const prepaymentAllowed = getValue('prepaymentAllowed');
            const prepaymentPenalty = getValue('prepaymentPenalty');
            const loanType = getValue('loanType', 'secured');
            const collateralType = getValue('collateralType', 'equipment');
            const collateralDescription = getValue('collateralDescription', '[COLLATERAL DESCRIPTION]');
            const collateralValue = getValue('collateralValue', '0');
            const personalGuarantee = getValue('personalGuarantee');
            const guarantorName = getValue('guarantorName', '[GUARANTOR NAME]');
            const governingState = getValue('governingState', '[STATE]');

            // Covenants
            const debtServiceCoverage = getValue('debtServiceCoverage');
            const currentRatio = getValue('currentRatio');
            const netWorth = getValue('netWorth');
            const annualFinancials = getValue('annualFinancials');
            const quarterlyFinancials = getValue('quarterlyFinancials');
            const taxReturns = getValue('taxReturns');

            const rate = parseFloat(interestRate) / 100 / 12;
            const term = parseInt(loanTerm);
            let monthlyPayment = 0;
            if (principalAmount > 0 && rate > 0 && term > 0) {
                monthlyPayment = principalAmount * (rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            }

            const purposeText = {
                'working-capital': 'general working capital purposes',
                'equipment': 'the purchase of business equipment',
                'real-estate': 'commercial real estate acquisition',
                'expansion': 'business expansion activities',
                'inventory': 'inventory financing',
                'refinance': 'refinancing existing business debt',
                'other': 'legitimate business purposes'
            }[loanPurpose];

            const paymentDueText = paymentDueDay === '1' ? 'the first (1st) day of each month' :
                                  paymentDueDay === '15' ? 'the fifteenth (15th) day of each month' :
                                  'the last business day of each month';

            const lateFeeText = lateFee === '5%' ? 'five percent (5%) of the overdue payment' :
                               lateFee === 'flat-50' ? 'fifty dollars ($50)' :
                               lateFee === 'flat-100' ? 'one hundred dollars ($100)' :
                               'the greater of five percent (5%) of the overdue payment or fifty dollars ($50)';

            const collateralTypeText = {
                'equipment': 'business equipment',
                'inventory': 'business inventory',
                'accounts-receivable': 'accounts receivable',
                'real-estate': 'real property',
                'blanket': 'all business assets (blanket lien)'
            }[collateralType];

            const html = `
                <h1>BUSINESS LOAN AGREEMENT</h1>

                <p>This Business Loan Agreement ("Agreement") is entered into as of <span class="doc-highlight">${loanDate}</span> by and between:</p>

                <div class="parties-box">
                    <p><strong>LENDER:</strong> <span class="doc-highlight">${lenderName}</span><br>
                    Address: ${lenderAddress}<br>
                    Contact: ${lenderContact}</p>

                    <p style="margin-top: 1rem;"><strong>BORROWER:</strong> <span class="doc-highlight">${borrowerName}</span><br>
                    A ${borrowerEntity} organized under the laws of ${borrowerState}<br>
                    Address: ${borrowerAddress}</p>
                </div>

                <div class="amount-box">
                    PRINCIPAL AMOUNT: <span class="doc-highlight">${formatCurrency(principalAmount)}</span>
                </div>

                <h2>ARTICLE 1 - LOAN TERMS</h2>
                <p>1.1 <strong>Principal.</strong> Subject to the terms of this Agreement, Lender agrees to lend to Borrower the principal sum of <span class="doc-highlight">${formatCurrency(principalAmount)}</span> (the "Loan").</p>
                <p>1.2 <strong>Purpose.</strong> The proceeds of the Loan shall be used solely for <span class="doc-highlight">${purposeText}</span>. Borrower shall not use the Loan proceeds for any other purpose without Lender's prior written consent.</p>
                <p>1.3 <strong>Interest Rate.</strong> The Loan shall bear interest at ${interestType === 'fixed' ?
                    `a fixed annual rate of <span class="doc-highlight">${interestRate}%</span>` :
                    `a variable rate equal to the Prime Rate plus <span class="doc-highlight">${interestRate}%</span>, adjusted quarterly`}.</p>
                <p>1.4 <strong>Loan Term.</strong> The Loan shall mature <span class="doc-highlight">${loanTerm}</span> months from the date of this Agreement (the "Maturity Date"), at which time all outstanding principal, accrued interest, and other amounts due shall be payable in full.</p>

                <h2>ARTICLE 2 - REPAYMENT</h2>
                <p>2.1 <strong>Payment Schedule.</strong> ${repaymentSchedule === 'monthly' ?
                    `Borrower shall make equal monthly payments of principal and interest in the amount of approximately <span class="doc-highlight">${formatCurrency(monthlyPayment)}</span>, commencing on ${paymentDueText} following the date of this Agreement.` :
                    repaymentSchedule === 'quarterly' ?
                    `Borrower shall make equal quarterly payments of principal and interest, commencing on the last day of the first full quarter following the date of this Agreement.` :
                    `Borrower shall make monthly interest-only payments, with the entire principal balance due as a balloon payment on the Maturity Date.`}</p>
                <p>2.2 <strong>Payment Due Date.</strong> Each payment shall be due on ${paymentDueText}.</p>
                ${gracePeriod !== '0' ? `<p>2.3 <strong>Grace Period.</strong> A grace period of <span class="doc-highlight">${gracePeriod}</span> days shall be allowed after the due date before a payment is considered late.</p>` : ''}
                <p>2.${gracePeriod !== '0' ? '4' : '3'} <strong>Late Charges.</strong> If any payment is not received within the grace period, Borrower shall pay a late charge equal to ${lateFeeText}.</p>
                <p>2.${gracePeriod !== '0' ? '5' : '4'} <strong>Prepayment.</strong> ${prepaymentAllowed ?
                    'Borrower may prepay all or any portion of the outstanding principal at any time without penalty.' :
                    prepaymentPenalty ?
                    'Borrower may prepay the Loan, provided that if prepayment occurs within the first two (2) years, Borrower shall pay a prepayment penalty equal to two percent (2%) of the amount prepaid.' :
                    'Borrower may prepay the Loan at any time.'}</p>
                <p>2.${gracePeriod !== '0' ? '6' : '5'} <strong>Application of Payments.</strong> All payments shall be applied first to late charges, then to accrued interest, and finally to principal, unless otherwise directed by Lender.</p>

                ${loanType === 'secured' ? `<h2>ARTICLE 3 - SECURITY</h2>
                <p>3.1 <strong>Collateral.</strong> As security for the Loan, Borrower grants to Lender a first priority security interest in the following collateral: <span class="doc-highlight">${collateralTypeText}</span>.</p>
                <p>3.2 <strong>Collateral Description.</strong> <span class="doc-highlight">${collateralDescription}</span></p>
                <p>3.3 <strong>Estimated Value.</strong> The collateral has an estimated value of <span class="doc-highlight">${formatCurrency(parseFloat(collateralValue.replace(/[^0-9.]/g, '')) || 0)}</span>.</p>
                <p>3.4 <strong>Perfection.</strong> Borrower authorizes Lender to file UCC financing statements and take all other actions necessary to perfect Lender's security interest in the collateral.</p>
                <p>3.5 <strong>Insurance.</strong> Borrower shall maintain insurance on the collateral naming Lender as loss payee, in amounts and with carriers acceptable to Lender.</p>` : ''}

                ${personalGuarantee ? `<h2>ARTICLE ${loanType === 'secured' ? '4' : '3'} - PERSONAL GUARANTEE</h2>
                <p>${loanType === 'secured' ? '4' : '3'}.1 <strong>Guarantee.</strong> <span class="doc-highlight">${guarantorName}</span> (the "Guarantor") unconditionally guarantees to Lender the full and prompt payment of all amounts owed under this Agreement.</p>
                <p>${loanType === 'secured' ? '4' : '3'}.2 <strong>Continuing Guarantee.</strong> This guarantee is a continuing guarantee and shall remain in effect until all obligations under this Agreement have been fully satisfied.</p>
                <p>${loanType === 'secured' ? '4' : '3'}.3 <strong>Waiver.</strong> Guarantor waives any right to require Lender to proceed against Borrower or any collateral before seeking payment from Guarantor.</p>` : ''}

                <h2>ARTICLE ${loanType === 'secured' ? (personalGuarantee ? '5' : '4') : (personalGuarantee ? '4' : '3')} - REPRESENTATIONS AND WARRANTIES</h2>
                <p>Borrower represents and warrants that:</p>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    <li>Borrower is duly organized and in good standing under the laws of ${borrowerState}</li>
                    <li>Borrower has full power and authority to execute this Agreement and perform its obligations</li>
                    <li>All financial statements provided to Lender are true and accurate</li>
                    <li>There are no pending or threatened legal proceedings that could materially affect Borrower's ability to perform</li>
                    <li>Borrower is not in default under any other loan or material agreement</li>
                </ul>

                <h2>ARTICLE ${loanType === 'secured' ? (personalGuarantee ? '6' : '5') : (personalGuarantee ? '5' : '4')} - COVENANTS</h2>
                <p>During the term of this Agreement, Borrower covenants and agrees to:</p>
                <p><strong>Affirmative Covenants:</strong></p>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    <li>Maintain its corporate existence and good standing</li>
                    <li>Comply with all applicable laws and regulations</li>
                    <li>Maintain adequate insurance on all assets</li>
                    <li>Permit Lender to inspect books, records, and properties upon reasonable notice</li>
                    ${annualFinancials ? '<li>Provide annual audited or reviewed financial statements within 120 days of fiscal year end</li>' : ''}
                    ${quarterlyFinancials ? '<li>Provide quarterly unaudited financial statements within 45 days of quarter end</li>' : ''}
                    ${taxReturns ? '<li>Provide copies of federal tax returns within 30 days of filing</li>' : ''}
                </ul>
                <p><strong>Financial Covenants:</strong></p>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    ${debtServiceCoverage ? '<li>Maintain a debt service coverage ratio of at least 1.25 to 1.00</li>' : ''}
                    ${currentRatio ? '<li>Maintain a current ratio of at least 1.50 to 1.00</li>' : ''}
                    ${netWorth ? '<li>Maintain minimum tangible net worth as specified in Schedule A</li>' : ''}
                </ul>
                <p><strong>Negative Covenants.</strong> Without Lender's prior written consent, Borrower shall not:</p>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    <li>Incur additional indebtedness exceeding $25,000</li>
                    <li>Create liens on any assets (other than permitted liens)</li>
                    <li>Sell or dispose of substantial assets outside the ordinary course of business</li>
                    <li>Make distributions or dividends that would impair ability to service the Loan</li>
                    <li>Merge, consolidate, or substantially change the nature of its business</li>
                </ul>

                <h2>ARTICLE ${loanType === 'secured' ? (personalGuarantee ? '7' : '6') : (personalGuarantee ? '6' : '5')} - EVENTS OF DEFAULT</h2>
                <p>The following shall constitute Events of Default:</p>
                <ul style="margin-left: 2rem; margin-bottom: 1rem;">
                    <li>Failure to make any payment when due</li>
                    <li>Breach of any representation, warranty, or covenant</li>
                    <li>Filing of bankruptcy or insolvency proceedings</li>
                    <li>Material adverse change in Borrower's financial condition</li>
                    <li>Default under any other material agreement</li>
                    <li>Any judgment against Borrower exceeding $50,000</li>
                </ul>
                <p>Upon an Event of Default, Lender may declare all amounts immediately due and payable and exercise all remedies available under law.</p>

                <h2>ARTICLE ${loanType === 'secured' ? (personalGuarantee ? '8' : '7') : (personalGuarantee ? '7' : '6')} - DEFAULT INTEREST AND COSTS</h2>
                <p>Upon default, the interest rate shall increase by five percentage points (5%) above the rate otherwise in effect. Borrower shall pay all costs of collection, including reasonable attorneys' fees.</p>

                <h2>ARTICLE ${loanType === 'secured' ? (personalGuarantee ? '9' : '8') : (personalGuarantee ? '8' : '7')} - GENERAL PROVISIONS</h2>
                <p>This Agreement shall be governed by the laws of the State of <span class="doc-highlight">${governingState}</span>. This Agreement constitutes the entire agreement between the parties and may only be amended in writing signed by both parties. All notices shall be in writing and delivered to the addresses set forth above.</p>

                <div class="signature-block">
                    <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Business Loan Agreement as of the date first written above.</p>

                    <div class="signature-party">
                        <p><strong>LENDER: ${lenderName}</strong></p>
                        <div class="signature-line">Authorized Signature</div>
                        <p style="margin-top: 0.5rem;">Name: <span class="doc-highlight">${lenderContact}</span></p>
                        <div class="signature-line" style="width: 40%;">Date</div>
                    </div>

                    <div class="signature-party">
                        <p><strong>BORROWER: ${borrowerName}</strong></p>
                        <div class="signature-line">Authorized Signature</div>
                        <p style="margin-top: 0.5rem;">Name: <span class="doc-highlight">${borrowerSignatory}</span></p>
                        <div class="signature-line" style="width: 40%;">Date</div>
                    </div>

                    ${personalGuarantee ? `<div class="signature-party">
                        <p><strong>GUARANTOR:</strong></p>
                        <div class="signature-line">Signature</div>
                        <p style="margin-top: 0.5rem;"><span class="doc-highlight">${guarantorName}</span></p>
                        <div class="signature-line" style="width: 40%;">Date</div>
                    </div>` : ''}
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const borrowerName = getValue('borrowerName', 'Borrower');
            const html = `<!DOCTYPE html><html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word"><head><meta charset="UTF-8"><style>@page{margin:1in;}body{font-family:'Times New Roman',serif;font-size:12pt;line-height:1.6;margin:0;padding:0;}h1{text-align:center;font-size:18pt;text-transform:uppercase;border-bottom:2px solid #000;padding-bottom:0.5rem;}h2{font-size:12pt;margin-top:1.5rem;}p{margin-bottom:1rem;text-align:justify;}.parties-box{background:#f9f9f9;padding:1rem;border:1px solid #ddd;margin:1rem 0;}.amount-box{text-align:center;font-size:14pt;font-weight:bold;margin:1.5rem 0;padding:1rem;border:2px solid #000;}.signature-line{border-top:1px solid #000;margin-top:2.5rem;padding-top:0.35rem;font-size:10pt;width:60%;}.doc-highlight{background:#fff;}</style></head><body>${content}</body></html>`;
            const blob = new Blob([html], { type: 'application/msword' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Business_Loan_Agreement_${borrowerName.replace(/\s+/g, '_')}.doc`;
            link.click();
        }

        // Initialize
        updatePreview();
        calculatePayment();
        toggleCollateralFields();
    </script>
</body>
</html>
