<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Severance Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a professional severance agreement. Customizable template for employers providing separation packages with release of claims.">
    <link rel="canonical" href="https://templatebuilder.pro/Templates/severance-agreement-generator.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: #ffffff;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }

        /* Form Panel */
        .form-panel {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .form-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-header h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.25rem;
        }

        .form-header p {
            font-size: 0.85rem;
            color: #64748b;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: #475569;
            margin-bottom: 0.35rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.6rem 0.75rem;
            border: 1.5px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: #475569;
            cursor: pointer;
            padding: 0.4rem 0.6rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: #f1f5f9;
        }

        .checkbox-label input {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .checkbox-label input:checked + span {
            color: #3b82f6;
            font-weight: 500;
        }

        .info-box {
            background: #dbeafe;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.8rem;
            color: #1e40af;
            margin-bottom: 1rem;
        }

        .info-box strong {
            display: block;
            margin-bottom: 0.25rem;
        }

        /* Preview Panel */
        .preview-panel {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }

        .preview-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 16px 16px 0 0;
        }

        .preview-title {
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59,130,246,0.35);
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1.5px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .btn-edit {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245,158,11,0.35);
        }

        .btn-edit.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .preview-content {
            padding: 3rem;
            overflow-y: auto;
            flex: 1;
        }

        /* Document Styles */
        .document {
            max-width: 850px;
            margin: 0 auto;
            background: #fff;
            padding: 4rem;
            min-height: 1100px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            border: 1px solid #e5e7eb;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #000;
        }

        .document h1 {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document h2 {
            font-size: 12pt;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
        }

        .document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .document .center {
            text-align: center;
        }

        .document .parties {
            margin: 1.5rem 0;
        }

        .document .parties p {
            margin-bottom: 0.5rem;
        }

        .document .effective-date {
            text-align: center;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .document .clause {
            margin-bottom: 1.25rem;
        }

        .document .sub-clause {
            margin-left: 2rem;
            margin-bottom: 0.75rem;
        }

        .document .signature-block {
            margin-top: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .document .signature-party h3 {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 2rem;
            text-transform: uppercase;
        }

        .document .signature-line {
            border-top: 1px solid #000;
            margin-top: 2.5rem;
            padding-top: 0.35rem;
            font-size: 10pt;
        }

        .document .recitals {
            margin: 1.5rem 0;
            font-style: italic;
        }

        .document .recitals p {
            margin-bottom: 0.5rem;
        }

        .document .important-notice {
            border: 2px solid #000;
            padding: 1rem;
            margin: 1.5rem 0;
            font-weight: bold;
            text-align: center;
        }

        /* Highlighting */
        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 0 3px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .doc-highlight:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
        }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245,158,11,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0); }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        @keyframes flashContainer {
            0%, 100% { box-shadow: 0 2px 20px rgba(0,0,0,0.08); }
            50% { box-shadow: 0 0 30px rgba(245,158,11,0.5); }
        }

        .document-flash {
            animation: flashContainer 0.5s ease-out;
        }

        /* Edit Mode Styles */
        .document.edit-mode {
            background: #fffef5;
            border-color: #f59e0b;
        }

        .document.edit-mode .doc-highlight {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            cursor: text;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .form-panel {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }

            .document {
                padding: 2rem;
            }

            .preview-content {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }

            .document, .document * {
                visibility: visible;
            }

            .document {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
                padding: 1in;
            }

            .header, .form-panel, .preview-toolbar {
                display: none !important;
            }
        }

        /* Footer */
        .footer {
            background: #0f172a;
            color: #94a3b8;
            padding: 2rem;
            text-align: center;
            font-size: 0.85rem;
        }

        .footer a {
            color: #60a5fa;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">TemplateBuilder.pro</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Form Panel -->
        <aside class="form-panel">
            <div class="form-header">
                <h1>Severance Agreement</h1>
                <p>Generate a separation and release agreement</p>
            </div>

            <!-- Employer Information -->
            <div class="form-section">
                <div class="section-title">Employer Information</div>
                <div class="form-group">
                    <label for="employerName">Company Name</label>
                    <input type="text" id="employerName" placeholder="Acme Corporation" oninput="trackFieldEdit('employerName')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employerState">State</label>
                        <select id="employerState" onchange="trackFieldEdit('employerState')">
                            <option value="">Select State</option>
                            <option value="Alabama">Alabama</option>
                            <option value="Alaska">Alaska</option>
                            <option value="Arizona">Arizona</option>
                            <option value="Arkansas">Arkansas</option>
                            <option value="California">California</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Connecticut">Connecticut</option>
                            <option value="Delaware">Delaware</option>
                            <option value="Florida">Florida</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Hawaii">Hawaii</option>
                            <option value="Idaho">Idaho</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Indiana">Indiana</option>
                            <option value="Iowa">Iowa</option>
                            <option value="Kansas">Kansas</option>
                            <option value="Kentucky">Kentucky</option>
                            <option value="Louisiana">Louisiana</option>
                            <option value="Maine">Maine</option>
                            <option value="Maryland">Maryland</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Minnesota">Minnesota</option>
                            <option value="Mississippi">Mississippi</option>
                            <option value="Missouri">Missouri</option>
                            <option value="Montana">Montana</option>
                            <option value="Nebraska">Nebraska</option>
                            <option value="Nevada">Nevada</option>
                            <option value="New Hampshire">New Hampshire</option>
                            <option value="New Jersey">New Jersey</option>
                            <option value="New Mexico">New Mexico</option>
                            <option value="New York">New York</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="North Dakota">North Dakota</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Oklahoma">Oklahoma</option>
                            <option value="Oregon">Oregon</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Rhode Island">Rhode Island</option>
                            <option value="South Carolina">South Carolina</option>
                            <option value="South Dakota">South Dakota</option>
                            <option value="Tennessee">Tennessee</option>
                            <option value="Texas">Texas</option>
                            <option value="Utah">Utah</option>
                            <option value="Vermont">Vermont</option>
                            <option value="Virginia">Virginia</option>
                            <option value="Washington">Washington</option>
                            <option value="West Virginia">West Virginia</option>
                            <option value="Wisconsin">Wisconsin</option>
                            <option value="Wyoming">Wyoming</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="agreementDate">Agreement Date</label>
                        <input type="date" id="agreementDate" onchange="trackFieldEdit('agreementDate')">
                    </div>
                </div>
                <div class="form-group">
                    <label for="employerAddress">Company Address</label>
                    <input type="text" id="employerAddress" placeholder="123 Business Ave, Suite 100, City, State ZIP" oninput="trackFieldEdit('employerAddress')">
                </div>
            </div>

            <!-- Employee Information -->
            <div class="form-section">
                <div class="section-title">Employee Information</div>
                <div class="form-group">
                    <label for="employeeName">Employee Name</label>
                    <input type="text" id="employeeName" placeholder="John Smith" oninput="trackFieldEdit('employeeName')">
                </div>
                <div class="form-group">
                    <label for="employeeAddress">Employee Address</label>
                    <input type="text" id="employeeAddress" placeholder="456 Main Street, City, State ZIP" oninput="trackFieldEdit('employeeAddress')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="jobTitle">Job Title</label>
                        <input type="text" id="jobTitle" placeholder="Senior Manager" oninput="trackFieldEdit('jobTitle')">
                    </div>
                    <div class="form-group">
                        <label for="hireDate">Original Hire Date</label>
                        <input type="date" id="hireDate" onchange="trackFieldEdit('hireDate')">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="separationDate">Separation Date</label>
                        <input type="date" id="separationDate" onchange="trackFieldEdit('separationDate')">
                    </div>
                    <div class="form-group">
                        <label for="employeeAge">Employee Age</label>
                        <select id="employeeAge" onchange="trackFieldEdit('employeeAge')">
                            <option value="under-40">Under 40 Years Old</option>
                            <option value="40-or-over">40 Years or Older (OWBPA)</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="separationReason">Reason for Separation</label>
                    <select id="separationReason" onchange="trackFieldEdit('separationReason')">
                        <option value="layoff">Layoff/Reduction in Force</option>
                        <option value="position-elimination">Position Elimination</option>
                        <option value="restructuring">Restructuring</option>
                        <option value="mutual-agreement">Mutual Agreement</option>
                        <option value="resignation">Resignation</option>
                        <option value="termination">Termination Without Cause</option>
                    </select>
                </div>
            </div>

            <!-- Severance Package -->
            <div class="form-section">
                <div class="section-title">Severance Package</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="severanceAmount">Severance Amount ($)</label>
                        <input type="text" id="severanceAmount" placeholder="50,000" oninput="trackFieldEdit('severanceAmount')">
                    </div>
                    <div class="form-group">
                        <label for="severanceType">Payment Structure</label>
                        <select id="severanceType" onchange="trackFieldEdit('severanceType')">
                            <option value="lump-sum">Lump Sum</option>
                            <option value="installments">Installments</option>
                            <option value="salary-continuation">Salary Continuation</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" id="installmentDetails" style="display:none;">
                    <label for="installmentSchedule">Installment Schedule</label>
                    <input type="text" id="installmentSchedule" placeholder="12 equal monthly payments" oninput="trackFieldEdit('installmentSchedule')">
                </div>
                <div class="form-group" id="continuationDetails" style="display:none;">
                    <label for="continuationPeriod">Continuation Period</label>
                    <input type="text" id="continuationPeriod" placeholder="6 months" oninput="trackFieldEdit('continuationPeriod')">
                </div>
                <div class="form-group">
                    <label for="finalPaycheck">Final Paycheck Includes</label>
                    <select id="finalPaycheck" onchange="trackFieldEdit('finalPaycheck')">
                        <option value="wages-only">Earned Wages Only</option>
                        <option value="wages-plus-pto">Wages + Accrued PTO</option>
                        <option value="wages-pto-bonus">Wages + PTO + Pro-rated Bonus</option>
                    </select>
                </div>
            </div>

            <!-- Additional Benefits -->
            <div class="form-section">
                <div class="section-title">Additional Benefits</div>
                <div class="form-group">
                    <label>Include These Benefits</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="cobraCoverage" onchange="trackFieldEdit('cobraCoverage')" checked>
                            <span>COBRA Subsidy</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="outplacement" onchange="trackFieldEdit('outplacement')">
                            <span>Outplacement Services</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="acceleratedVesting" onchange="trackFieldEdit('acceleratedVesting')">
                            <span>Accelerated Vesting</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="referenceAgreement" onchange="trackFieldEdit('referenceAgreement')" checked>
                            <span>Reference Agreement</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="cobraDetails">
                    <label for="cobraPeriod">COBRA Subsidy Period</label>
                    <select id="cobraPeriod" onchange="trackFieldEdit('cobraPeriod')">
                        <option value="3 months">3 Months</option>
                        <option value="6 months" selected>6 Months</option>
                        <option value="12 months">12 Months</option>
                        <option value="18 months">18 Months (Full COBRA)</option>
                    </select>
                </div>
                <div class="form-group" id="outplacementDetails" style="display:none;">
                    <label for="outplacementValue">Outplacement Value ($)</label>
                    <input type="text" id="outplacementValue" placeholder="5,000" oninput="trackFieldEdit('outplacementValue')">
                </div>
                <div class="form-group" id="vestingDetails" style="display:none;">
                    <label for="vestingDescription">Vesting Details</label>
                    <input type="text" id="vestingDescription" placeholder="Immediate vesting of unvested stock options" oninput="trackFieldEdit('vestingDescription')">
                </div>
            </div>

            <!-- Release Terms -->
            <div class="form-section">
                <div class="section-title">Release Terms</div>
                <div class="form-group">
                    <label>Claims Released</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseTitle7" onchange="trackFieldEdit('releaseTitle7')" checked>
                            <span>Title VII</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseADA" onchange="trackFieldEdit('releaseADA')" checked>
                            <span>ADA</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseADEA" onchange="trackFieldEdit('releaseADEA')" checked>
                            <span>ADEA</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseFMLA" onchange="trackFieldEdit('releaseFMLA')" checked>
                            <span>FMLA</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseStateLaws" onchange="trackFieldEdit('releaseStateLaws')" checked>
                            <span>State Laws</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="releaseContract" onchange="trackFieldEdit('releaseContract')" checked>
                            <span>Contract Claims</span>
                        </label>
                    </div>
                </div>
                <div class="info-box" id="owbpaNotice">
                    <strong>OWBPA Compliance (40+ Employees)</strong>
                    For employees 40 or older, the agreement includes required OWBPA provisions: 21-day consideration period and 7-day revocation period.
                </div>
            </div>

            <!-- Restrictive Covenants -->
            <div class="form-section">
                <div class="section-title">Post-Employment Restrictions</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="confidentiality" onchange="trackFieldEdit('confidentiality')" checked>
                            <span>Confidentiality</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonDisparagement" onchange="trackFieldEdit('nonDisparagement')" checked>
                            <span>Non-Disparagement</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonSolicitation" onchange="trackFieldEdit('nonSolicitation')">
                            <span>Non-Solicitation</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonCompete" onchange="trackFieldEdit('nonCompete')">
                            <span>Non-Compete</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="cooperation" onchange="trackFieldEdit('cooperation')" checked>
                            <span>Cooperation Clause</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="nonSolicitationDetails" style="display:none;">
                    <label for="nonSolicitationPeriod">Non-Solicitation Period</label>
                    <select id="nonSolicitationPeriod" onchange="trackFieldEdit('nonSolicitationPeriod')">
                        <option value="6 months">6 Months</option>
                        <option value="1 year" selected>1 Year</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
                <div class="form-row" id="nonCompeteDetails" style="display:none;">
                    <div class="form-group">
                        <label for="nonCompetePeriod">Non-Compete Period</label>
                        <select id="nonCompetePeriod" onchange="trackFieldEdit('nonCompetePeriod')">
                            <option value="6 months">6 Months</option>
                            <option value="1 year" selected>1 Year</option>
                            <option value="2 years">2 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nonCompeteScope">Geographic Scope</label>
                        <input type="text" id="nonCompeteScope" placeholder="Within 50 miles" oninput="trackFieldEdit('nonCompeteScope')">
                    </div>
                </div>
            </div>

            <!-- Additional Terms -->
            <div class="form-section">
                <div class="section-title">Additional Terms</div>
                <div class="form-group">
                    <label>Additional Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="returnProperty" onchange="trackFieldEdit('returnProperty')" checked>
                            <span>Return of Property</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="noRehire" onchange="trackFieldEdit('noRehire')">
                            <span>No Rehire Clause</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="noAdmission" onchange="trackFieldEdit('noAdmission')" checked>
                            <span>No Admission of Liability</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="taxIndemnity" onchange="trackFieldEdit('taxIndemnity')" checked>
                            <span>Tax Indemnification</span>
                        </label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="considerationPeriod">Consideration Period</label>
                        <select id="considerationPeriod" onchange="trackFieldEdit('considerationPeriod')">
                            <option value="7 days">7 Days</option>
                            <option value="14 days">14 Days</option>
                            <option value="21 days" selected>21 Days (OWBPA)</option>
                            <option value="45 days">45 Days (Group Layoff)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="revocationPeriod">Revocation Period</label>
                        <select id="revocationPeriod" onchange="trackFieldEdit('revocationPeriod')">
                            <option value="none">None</option>
                            <option value="7 days" selected>7 Days (OWBPA)</option>
                        </select>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Preview Panel -->
        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-edit" onclick="toggleEditMode()" id="editBtn">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        <span id="editBtnText">Edit Document</span>
                    </button>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview">
                    <!-- Document content will be generated here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; TemplateBuilder.pro. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        // State
        let lastEditedField = null;
        let hasCustomEdits = false;
        let isEditMode = false;

        // Toggle visibility handlers
        document.getElementById('severanceType').addEventListener('change', function() {
            document.getElementById('installmentDetails').style.display = this.value === 'installments' ? 'block' : 'none';
            document.getElementById('continuationDetails').style.display = this.value === 'salary-continuation' ? 'block' : 'none';
        });
        document.getElementById('cobraCoverage').addEventListener('change', function() {
            document.getElementById('cobraDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('outplacement').addEventListener('change', function() {
            document.getElementById('outplacementDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('acceleratedVesting').addEventListener('change', function() {
            document.getElementById('vestingDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('nonSolicitation').addEventListener('change', function() {
            document.getElementById('nonSolicitationDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('nonCompete').addEventListener('change', function() {
            document.getElementById('nonCompeteDetails').style.display = this.checked ? 'flex' : 'none';
        });
        document.getElementById('employeeAge').addEventListener('change', function() {
            document.getElementById('owbpaNotice').style.display = this.value === '40-or-over' ? 'block' : 'none';
            // Auto-set consideration and revocation periods for OWBPA
            if (this.value === '40-or-over') {
                document.getElementById('considerationPeriod').value = '21 days';
                document.getElementById('revocationPeriod').value = '7 days';
            }
        });

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                if (!confirm('Regenerating the document will overwrite your custom edits. Continue?')) {
                    return;
                }
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/[^0-9.]/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        }

        function updatePreview() {
            const employerName = getValue('employerName', '[EMPLOYER NAME]');
            const employerState = getValue('employerState', '[STATE]');
            const employerAddress = getValue('employerAddress', '[EMPLOYER ADDRESS]');
            const agreementDate = formatDate(getValue('agreementDate'));
            const employeeName = getValue('employeeName', '[EMPLOYEE NAME]');
            const employeeAddress = getValue('employeeAddress', '[EMPLOYEE ADDRESS]');
            const jobTitle = getValue('jobTitle', '[JOB TITLE]');
            const hireDate = formatDate(getValue('hireDate'));
            const separationDate = formatDate(getValue('separationDate'));
            const employeeAge = getValue('employeeAge', 'under-40');
            const separationReason = getValue('separationReason', 'layoff');
            const severanceAmount = formatCurrency(getValue('severanceAmount'));
            const severanceType = getValue('severanceType', 'lump-sum');
            const finalPaycheck = getValue('finalPaycheck', 'wages-only');
            const considerationPeriod = getValue('considerationPeriod', '21 days');
            const revocationPeriod = getValue('revocationPeriod', '7 days');

            // Separation reason text
            const separationReasonText = {
                'layoff': 'a reduction in force',
                'position-elimination': 'the elimination of Employee\'s position',
                'restructuring': 'organizational restructuring',
                'mutual-agreement': 'mutual agreement of the parties',
                'resignation': 'Employee\'s resignation',
                'termination': 'termination of employment without cause'
            }[separationReason] || 'the separation of employment';

            // Severance payment text
            let severancePaymentText = '';
            if (severanceType === 'lump-sum') {
                severancePaymentText = `a lump sum payment of <span class="doc-highlight" data-field="severanceAmount" contenteditable="true">${severanceAmount}</span>, less applicable withholdings, payable within thirty (30) days after the Effective Date`;
            } else if (severanceType === 'installments') {
                const schedule = getValue('installmentSchedule', '[INSTALLMENT SCHEDULE]');
                severancePaymentText = `<span class="doc-highlight" data-field="severanceAmount" contenteditable="true">${severanceAmount}</span>, payable in <span class="doc-highlight" data-field="installmentSchedule" contenteditable="true">${schedule}</span>, less applicable withholdings`;
            } else {
                const period = getValue('continuationPeriod', '[CONTINUATION PERIOD]');
                severancePaymentText = `salary continuation at Employee's current rate for <span class="doc-highlight" data-field="continuationPeriod" contenteditable="true">${period}</span>, totaling approximately <span class="doc-highlight" data-field="severanceAmount" contenteditable="true">${severanceAmount}</span>, less applicable withholdings`;
            }

            // Final paycheck text
            const finalPaycheckText = {
                'wages-only': 'all earned but unpaid wages through the Separation Date',
                'wages-plus-pto': 'all earned but unpaid wages through the Separation Date, plus payment for all accrued but unused paid time off',
                'wages-pto-bonus': 'all earned but unpaid wages through the Separation Date, payment for all accrued but unused paid time off, and a pro-rated portion of any earned bonus'
            }[finalPaycheck] || 'all earned but unpaid wages through the Separation Date';

            // Build claims released text
            let claimsText = [];
            if (getValue('releaseTitle7')) claimsText.push('Title VII of the Civil Rights Act of 1964');
            if (getValue('releaseADA')) claimsText.push('the Americans with Disabilities Act');
            if (getValue('releaseADEA')) claimsText.push('the Age Discrimination in Employment Act');
            if (getValue('releaseFMLA')) claimsText.push('the Family and Medical Leave Act');
            if (getValue('releaseStateLaws')) claimsText.push('all applicable state anti-discrimination and employment laws');
            if (getValue('releaseContract')) claimsText.push('any claims arising under any employment agreement or contract');
            const claimsReleasedText = claimsText.length > 0 ? claimsText.join('; ') : '[CLAIMS TO BE RELEASED]';

            // OWBPA-specific text
            let owbpaText = '';
            if (employeeAge === '40-or-over') {
                owbpaText = `
                <h2>OLDER WORKERS BENEFIT PROTECTION ACT COMPLIANCE</h2>
                <p class="clause">In accordance with the Older Workers Benefit Protection Act ("OWBPA"), Employee acknowledges and agrees that:</p>
                <p class="sub-clause">(a) Employee has been advised in writing to consult with an attorney before signing this Agreement;</p>
                <p class="sub-clause">(b) Employee has been given a period of at least <span class="doc-highlight" data-field="considerationPeriod" contenteditable="true">${considerationPeriod}</span> to consider this Agreement before signing;</p>
                <p class="sub-clause">(c) Employee has <span class="doc-highlight" data-field="revocationPeriod" contenteditable="true">${revocationPeriod}</span> following the execution of this Agreement to revoke acceptance by providing written notice to Employer;</p>
                <p class="sub-clause">(d) This Agreement shall not become effective or enforceable until the revocation period has expired without revocation (the "Effective Date");</p>
                <p class="sub-clause">(e) Employee is knowingly and voluntarily waiving rights and claims under the Age Discrimination in Employment Act;</p>
                <p class="sub-clause">(f) Employee is not waiving any rights or claims that may arise after the date this Agreement is executed.</p>`;
            }

            // Build additional benefits text
            let additionalBenefitsText = '';

            if (getValue('cobraCoverage')) {
                const cobraPeriod = getValue('cobraPeriod', '6 months');
                additionalBenefitsText += `<p class="clause"><strong>COBRA Continuation Coverage.</strong> Employee may elect to continue health insurance coverage under COBRA. If Employee timely elects COBRA continuation coverage, Employer shall pay the employer portion of the COBRA premiums for a period of <span class="doc-highlight" data-field="cobraPeriod" contenteditable="true">${cobraPeriod}</span> following the Separation Date. Thereafter, Employee shall be responsible for the full COBRA premium.</p>`;
            }

            if (getValue('outplacement')) {
                const outplacementValue = formatCurrency(getValue('outplacementValue'));
                additionalBenefitsText += `<p class="clause"><strong>Outplacement Services.</strong> Employer shall provide Employee with outplacement services through a provider selected by Employer, with a value of up to <span class="doc-highlight" data-field="outplacementValue" contenteditable="true">${outplacementValue}</span>.</p>`;
            }

            if (getValue('acceleratedVesting')) {
                const vestingDescription = getValue('vestingDescription', '[VESTING DETAILS]');
                additionalBenefitsText += `<p class="clause"><strong>Equity Acceleration.</strong> Notwithstanding the terms of any equity award agreement, Employer agrees to: <span class="doc-highlight" data-field="vestingDescription" contenteditable="true">${vestingDescription}</span>.</p>`;
            }

            if (getValue('referenceAgreement')) {
                additionalBenefitsText += `<p class="clause"><strong>Reference.</strong> Upon request from a prospective employer, Employer agrees to provide a neutral reference consisting of Employee's dates of employment and last position held. Any such inquiries should be directed to the Human Resources department.</p>`;
            }

            // Build restrictive covenants text
            let covenantsText = '';
            let sectionNum = 5;

            if (getValue('confidentiality')) {
                covenantsText += `
                <h2>${sectionNum}. CONFIDENTIALITY</h2>
                <p class="clause">${sectionNum}.1 Employee agrees to maintain in strict confidence all Confidential Information of Employer. "Confidential Information" includes trade secrets, customer information, business plans, financial data, proprietary technology, and any other non-public information.</p>
                <p class="clause">${sectionNum}.2 Employee shall not disclose, publish, or otherwise reveal any Confidential Information to any third party, except as required by law or legal process.</p>
                <p class="clause">${sectionNum}.3 Employee agrees that the terms of this Agreement are confidential and shall not be disclosed to any third party, except to Employee's spouse, legal counsel, or tax advisor, or as required by law.</p>`;
                sectionNum++;
            }

            if (getValue('nonDisparagement')) {
                covenantsText += `
                <h2>${sectionNum}. NON-DISPARAGEMENT</h2>
                <p class="clause">${sectionNum}.1 Employee agrees not to make any disparaging, defamatory, or negative statements about Employer, its products, services, officers, directors, employees, or business practices.</p>
                <p class="clause">${sectionNum}.2 Employer agrees to instruct its officers and directors not to make any disparaging, defamatory, or negative statements about Employee.</p>
                <p class="clause">${sectionNum}.3 Nothing in this Section shall prevent either party from responding truthfully to legal process or government inquiry.</p>`;
                sectionNum++;
            }

            if (getValue('nonSolicitation')) {
                const nonSolicitationPeriod = getValue('nonSolicitationPeriod', '1 year');
                covenantsText += `
                <h2>${sectionNum}. NON-SOLICITATION</h2>
                <p class="clause">For a period of <span class="doc-highlight" data-field="nonSolicitationPeriod" contenteditable="true">${nonSolicitationPeriod}</span> following the Separation Date, Employee agrees not to:</p>
                <p class="sub-clause">(a) Solicit or attempt to solicit any customer or client of Employer with whom Employee had contact during employment;</p>
                <p class="sub-clause">(b) Solicit, recruit, or hire any employee of Employer.</p>`;
                sectionNum++;
            }

            if (getValue('nonCompete')) {
                const nonCompetePeriod = getValue('nonCompetePeriod', '1 year');
                const nonCompeteScope = getValue('nonCompeteScope', '[GEOGRAPHIC AREA]');
                covenantsText += `
                <h2>${sectionNum}. NON-COMPETE</h2>
                <p class="clause">For a period of <span class="doc-highlight" data-field="nonCompetePeriod" contenteditable="true">${nonCompetePeriod}</span> following the Separation Date, Employee agrees not to engage in any business that competes with Employer <span class="doc-highlight" data-field="nonCompeteScope" contenteditable="true">${nonCompeteScope}</span>. Employee acknowledges that this restriction is reasonable and supported by the severance consideration provided herein.</p>`;
                sectionNum++;
            }

            if (getValue('cooperation')) {
                covenantsText += `
                <h2>${sectionNum}. COOPERATION</h2>
                <p class="clause">Employee agrees to cooperate fully with Employer in connection with any pending or future litigation, investigation, or proceeding involving matters that arose during Employee's employment. Employer shall reimburse Employee for reasonable out-of-pocket expenses incurred in providing such cooperation and shall make reasonable efforts to schedule such cooperation around Employee's other commitments.</p>`;
                sectionNum++;
            }

            // Additional provisions
            let additionalProvisionsText = '';

            if (getValue('returnProperty')) {
                additionalProvisionsText += `<p class="clause"><strong>Return of Property.</strong> Employee represents that Employee has returned, or will return within five (5) business days of the Separation Date, all Employer property in Employee's possession or control, including documents, equipment, keys, access cards, credit cards, and any Confidential Information in any form.</p>`;
            }

            if (getValue('noRehire')) {
                additionalProvisionsText += `<p class="clause"><strong>No Rehire.</strong> Employee agrees not to seek or accept future employment with Employer or any of its affiliates. Employer shall have no obligation to consider Employee for any future positions.</p>`;
            }

            if (getValue('noAdmission')) {
                additionalProvisionsText += `<p class="clause"><strong>No Admission.</strong> This Agreement shall not be construed as an admission by either party of any liability, wrongdoing, or violation of law. Both parties deny any such liability or wrongdoing.</p>`;
            }

            if (getValue('taxIndemnity')) {
                additionalProvisionsText += `<p class="clause"><strong>Tax Matters.</strong> Employee acknowledges that Employer has made no representations regarding the tax consequences of the payments and benefits provided under this Agreement. Employee agrees to be responsible for any taxes owed on such payments and to indemnify Employer against any tax liability that may arise.</p>`;
            }

            const html = `
                <h1>SEVERANCE AGREEMENT AND GENERAL RELEASE</h1>

                <p class="effective-date">Date: <span class="doc-highlight" data-field="agreementDate" contenteditable="true">${agreementDate}</span></p>

                <div class="parties">
                    <p>This Severance Agreement and General Release ("Agreement") is entered into by and between:</p>
                    <p><strong>EMPLOYER:</strong> <span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span>, with its principal place of business at <span class="doc-highlight" data-field="employerAddress" contenteditable="true">${employerAddress}</span> ("Employer" or "Company")</p>
                    <p><strong>EMPLOYEE:</strong> <span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span>, residing at <span class="doc-highlight" data-field="employeeAddress" contenteditable="true">${employeeAddress}</span> ("Employee")</p>
                </div>

                <div class="recitals">
                    <p><strong>RECITALS</strong></p>
                    <p>WHEREAS, Employee has been employed by Employer as <span class="doc-highlight" data-field="jobTitle" contenteditable="true">${jobTitle}</span> since <span class="doc-highlight" data-field="hireDate" contenteditable="true">${hireDate}</span>;</p>
                    <p>WHEREAS, Employee's employment with Employer will end on <span class="doc-highlight" data-field="separationDate" contenteditable="true">${separationDate}</span> (the "Separation Date") due to ${separationReasonText};</p>
                    <p>WHEREAS, Employer wishes to provide Employee with certain severance benefits in exchange for Employee's release of claims and other covenants;</p>
                    <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements contained herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>
                </div>

                <h2>1. SEPARATION OF EMPLOYMENT</h2>
                <p class="clause">1.1 Employee's employment with Employer will terminate effective <span class="doc-highlight" data-field="separationDate" contenteditable="true">${separationDate}</span>.</p>
                <p class="clause">1.2 Regardless of whether Employee signs this Agreement, Employee shall receive ${finalPaycheckText}, payable in accordance with applicable law.</p>
                <p class="clause">1.3 Except as specifically provided in this Agreement, Employee shall not be entitled to any other compensation, benefits, bonuses, commissions, or payments of any kind from Employer.</p>

                <h2>2. SEVERANCE BENEFITS</h2>
                <p class="clause">2.1 <strong>Severance Payment.</strong> In exchange for Employee's execution of this Agreement and compliance with its terms, and provided Employee does not revoke this Agreement during any applicable revocation period, Employer agrees to provide Employee with ${severancePaymentText}.</p>
                ${additionalBenefitsText}
                <p class="clause">2.2 Employee acknowledges that the severance benefits provided under this Agreement are in addition to any amounts already owed to Employee and constitute adequate consideration for this Agreement.</p>

                <h2>3. GENERAL RELEASE OF CLAIMS</h2>
                <p class="clause">3.1 <strong>Release.</strong> In consideration of the severance benefits provided herein, Employee, on behalf of Employee and Employee's heirs, executors, administrators, successors, and assigns, hereby fully, finally, and forever releases and discharges Employer and its past, present, and future parent companies, subsidiaries, affiliates, predecessors, successors, assigns, and their respective officers, directors, employees, shareholders, members, managers, agents, attorneys, insurers, benefit plans, and plan administrators (collectively, the "Released Parties") from any and all claims, demands, actions, causes of action, obligations, damages, liabilities, and expenses of any kind whatsoever, whether known or unknown, suspected or unsuspected, that Employee ever had, now has, or may have against any of the Released Parties arising out of or related to Employee's employment with Employer or the termination thereof.</p>
                <p class="clause">3.2 <strong>Scope of Release.</strong> This release includes, but is not limited to, claims arising under: ${claimsReleasedText}; as well as any claims for wrongful discharge, breach of contract, breach of implied covenant, intentional or negligent infliction of emotional distress, defamation, fraud, or any other claim under federal, state, or local law.</p>
                <p class="clause">3.3 <strong>Exclusions.</strong> Notwithstanding the foregoing, this release does not include: (a) Employee's right to enforce this Agreement; (b) claims for unemployment insurance or workers' compensation benefits; (c) any vested rights under ERISA-covered benefit plans; (d) claims that cannot be waived by law; or (e) Employee's right to file a charge with or participate in an investigation by the EEOC or similar state agency (although Employee waives the right to recover monetary damages in such proceedings).</p>

                <h2>4. REPRESENTATIONS AND WARRANTIES</h2>
                <p class="clause">4.1 Employee represents and warrants that:</p>
                <p class="sub-clause">(a) Employee has not filed any claims, complaints, or actions against any of the Released Parties with any court or administrative agency;</p>
                <p class="sub-clause">(b) Employee has not assigned or transferred any claims released herein to any other person or entity;</p>
                <p class="sub-clause">(c) Employee has been paid all wages, bonuses, commissions, and benefits owed through the Separation Date, except as specifically provided herein;</p>
                <p class="sub-clause">(d) Employee has reported all hours worked and has been properly compensated for same;</p>
                <p class="sub-clause">(e) Employee has no knowledge of any facts that would give rise to a claim against Employer under any whistleblower protection law.</p>

                ${owbpaText}

                ${covenantsText}

                <h2>${sectionNum}. GENERAL PROVISIONS</h2>
                ${additionalProvisionsText}
                <p class="clause"><strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, without regard to its conflicts of law principles.</p>
                <p class="clause"><strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning its subject matter and supersedes all prior agreements and understandings, whether written or oral.</p>
                <p class="clause"><strong>Amendment.</strong> This Agreement may not be amended except by a written instrument signed by both parties.</p>
                <p class="clause"><strong>Severability.</strong> If any provision of this Agreement is held to be invalid or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                <p class="clause"><strong>Counterparts.</strong> This Agreement may be executed in counterparts, each of which shall be deemed an original.</p>

                <div class="important-notice">
                    EMPLOYEE IS ADVISED TO CONSULT WITH AN ATTORNEY BEFORE SIGNING THIS AGREEMENT.<br>
                    EMPLOYEE HAS <span class="doc-highlight" data-field="considerationPeriod" contenteditable="true">${considerationPeriod}</span> TO CONSIDER THIS AGREEMENT.
                    ${revocationPeriod !== 'none' ? `<br>EMPLOYEE HAS <span class="doc-highlight" data-field="revocationPeriod" contenteditable="true">${revocationPeriod}</span> AFTER SIGNING TO REVOKE.` : ''}
                </div>

                <p class="clause"><strong>Voluntary Agreement.</strong> Employee acknowledges that Employee has carefully read this Agreement, understands its terms and conditions, has had the opportunity to consult with independent legal counsel, has had sufficient time to consider this Agreement, and voluntarily agrees to its terms.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Employer</h3>
                        <p><span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Employee</h3>
                        <div class="signature-line">Signature</div>
                        <p class="signature-line"><span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span></p>
                        <div class="signature-line">Date</div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;

            // Add inline editing listeners
            document.querySelectorAll('.doc-highlight[contenteditable="true"]').forEach(el => {
                el.addEventListener('input', function() {
                    hasCustomEdits = true;
                    const fieldId = this.getAttribute('data-field');
                    const inputEl = document.getElementById(fieldId);
                    if (inputEl && inputEl.tagName !== 'SELECT') {
                        inputEl.value = this.textContent;
                    }
                });
            });

            // Scroll to and highlight edited field
            if (lastEditedField) {
                setTimeout(() => {
                    const el = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        el.classList.add('field-highlight-animation');
                        const doc = document.getElementById('documentPreview');
                        doc.classList.add('document-flash');
                        setTimeout(() => {
                            el.classList.remove('field-highlight-animation');
                            doc.classList.remove('document-flash');
                        }, 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            const doc = document.getElementById('documentPreview');
            const btn = document.getElementById('editBtn');
            const btnText = document.getElementById('editBtnText');

            if (isEditMode) {
                doc.classList.add('edit-mode');
                doc.setAttribute('contenteditable', 'true');
                btn.classList.add('active');
                btnText.textContent = 'Done Editing';
                hasCustomEdits = true;
            } else {
                doc.classList.remove('edit-mode');
                doc.setAttribute('contenteditable', 'false');
                btn.classList.remove('active');
                btnText.textContent = 'Edit Document';
            }
        }

        function printDocument() {
            window.print();
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const employeeName = getValue('employeeName', 'Employee');
            const employerName = getValue('employerName', 'Company');

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; max-width: 8.5in; margin: 1in auto; }
                        h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; }
                        h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
                        p { margin-bottom: 1rem; text-align: justify; }
                        .center { text-align: center; }
                        .effective-date { text-align: center; font-style: italic; margin-bottom: 2rem; }
                        .parties { margin: 1.5rem 0; }
                        .parties p { margin-bottom: 0.5rem; }
                        .clause { margin-bottom: 1.25rem; }
                        .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
                        .signature-block { margin-top: 3rem; display: flex; justify-content: space-between; }
                        .signature-party { width: 45%; }
                        .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
                        .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
                        .doc-highlight { background-color: #fff; }
                        .recitals { margin: 1.5rem 0; font-style: italic; }
                        .important-notice { border: 2px solid #000; padding: 1rem; margin: 1.5rem 0; font-weight: bold; text-align: center; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Severance Agreement - ${employeeName} - ${employerName}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('agreementDate').value = today;
            document.getElementById('separationDate').value = today;

            updatePreview();
        });
    </script>
</body>
</html>
