<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LLC Operating Agreement Generator | Single & Multi-Member | Terms.Law</title>
  <meta name="description" content="Free LLC Operating Agreement generator for single-member and multi-member LLCs. Customize management, profit sharing, and capital contributions. Attorney-drafted.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .member-card { background: var(--color-bg); border: 1px solid var(--color-border); border-radius: var(--radius-md); padding: 1rem; margin-bottom: 0.75rem; }
    .member-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; font-weight: 600; font-size: 0.85rem; }
    .member-remove { background: none; border: none; color: var(--color-danger); cursor: pointer; font-size: 1.1rem; }
    .add-member-btn { width: 100%; padding: 10px; background: var(--color-bg); border: 2px dashed var(--color-border); border-radius: var(--radius-md); color: var(--color-text-muted); font-weight: 600; cursor: pointer; font-size: 0.85rem; }
    .add-member-btn:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .doc-subtitle { text-align: center; font-size: 11px; color: var(--color-text-muted); margin-bottom: 25px; font-family: var(--font-sans); }
    .doc-article { font-size: 14px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 25px; margin-bottom: 5px; color: var(--doc-clause-title); text-align: center; }
    .doc-article-title { text-align: center; font-size: 12px; font-weight: bold; margin-bottom: 15px; color: var(--doc-clause-title); }
    .doc-section-header { font-size: 12px; font-weight: bold; margin-top: 15px; margin-bottom: 8px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; }
    .doc-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 12px; }
    .doc-table th, .doc-table td { border: 1px solid var(--color-border); padding: 8px 10px; text-align: left; }
    .doc-table th { background: var(--color-bg); font-weight: 600; font-size: 10px; text-transform: uppercase; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-signature-block { margin-top: 40px; page-break-inside: avoid; }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; }
    .doc-signature-line .sig-label { width: 80px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/" class="nav-link">Demands</a>
        <a href="/Templates/" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">LLC Formation Essential</div>
      <h1>LLC <span class="highlight">Operating Agreement</span> Generator</h1>
      <p class="hero-subtitle">Generate a comprehensive operating agreement for single-member or multi-member LLCs. Customize management structure, profit sharing, and member rights.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">LLC Information</h3>
        <div class="form-group">
          <label class="form-label">LLC Name</label>
          <input type="text" id="llcName" class="form-input" placeholder="Acme Ventures LLC" oninput="trackFieldEdit('llcName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Formation</label>
          <select id="formationState" class="form-select" onchange="trackFieldEdit('formationState')">
            <option value="Delaware">Delaware</option>
            <option value="Wyoming">Wyoming</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
            <option value="Florida">Florida</option>
            <option value="Nevada">Nevada</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Principal Office</label>
          <input type="text" id="principalOffice" class="form-input" placeholder="123 Business Ave, Wilmington, DE 19801" oninput="trackFieldEdit('principalOffice')">
        </div>
        <div class="form-group">
          <label class="form-label">Formation Date</label>
          <input type="date" id="formationDate" class="form-input" oninput="trackFieldEdit('formationDate')">
        </div>
        <div class="form-group">
          <label class="form-label">Business Purpose</label>
          <textarea id="businessPurpose" class="form-input" rows="2" placeholder="Any lawful business activity" oninput="trackFieldEdit('businessPurpose')">Any lawful business activity</textarea>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Members</h3>
        <div id="membersContainer"></div>
        <button type="button" class="add-member-btn" onclick="addMember()">+ Add Member</button>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Management</h3>
        <div class="form-group">
          <label class="form-label">Management Type</label>
          <select id="managementType" class="form-select" onchange="trackFieldEdit('managementType')">
            <option value="member">Member-Managed</option>
            <option value="manager">Manager-Managed</option>
          </select>
          <div class="form-hint">Member-managed: all members vote. Manager-managed: designated managers control.</div>
        </div>
        <div class="form-group" id="managerSection" style="display:none;">
          <label class="form-label">Manager Name(s)</label>
          <input type="text" id="managerNames" class="form-input" placeholder="John Smith, Jane Doe" oninput="trackFieldEdit('managerNames')">
        </div>
        <div class="form-group">
          <label class="form-label">Voting Threshold for Major Decisions</label>
          <select id="votingThreshold" class="form-select" onchange="trackFieldEdit('votingThreshold')">
            <option value="majority">Majority of membership interests</option>
            <option value="supermajority">Supermajority (2/3)</option>
            <option value="unanimous">Unanimous consent</option>
          </select>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Profit & Loss Allocation</h3>
        <div class="form-group">
          <label class="form-label">Allocation Method</label>
          <select id="allocationMethod" class="form-select" onchange="trackFieldEdit('allocationMethod')">
            <option value="ownership">Pro-rata based on ownership %</option>
            <option value="equal">Equal among all members</option>
            <option value="custom">Custom allocation</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Distribution Frequency</label>
          <select id="distributionFrequency" class="form-select" onchange="trackFieldEdit('distributionFrequency')">
            <option value="discretion">At manager/member discretion</option>
            <option value="quarterly">Quarterly</option>
            <option value="annually">Annually</option>
          </select>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Transfer Restrictions</h3>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="rofr" checked onchange="trackFieldEdit('rofr')">
            <span class="form-label" style="margin:0;">Right of First Refusal</span>
          </label>
          <div class="form-hint">Other members can match any outside offer</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="dragAlong" onchange="trackFieldEdit('dragAlong')">
            <span class="form-label" style="margin:0;">Drag-Along Rights</span>
          </label>
          <div class="form-hint">Majority can force minority to sell in acquisition</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="tagAlong" checked onchange="trackFieldEdit('tagAlong')">
            <span class="form-label" style="margin:0;">Tag-Along Rights</span>
          </label>
          <div class="form-hint">Minority can join majority sale</div>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Dissolution</h3>
        <div class="form-group">
          <label class="form-label">Dissolution Vote Required</label>
          <select id="dissolutionVote" class="form-select" onchange="trackFieldEdit('dissolutionVote')">
            <option value="unanimous">Unanimous consent</option>
            <option value="supermajority">Supermajority (2/3)</option>
            <option value="majority">Majority</option>
          </select>
        </div>
      </div>
    </aside>
    <div class="preview-panel">
      <div class="preview-toolbar">
        <div class="preview-title">Live Preview - Click highlighted text to edit</div>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title">LLC Operating Agreement</span>
          <span class="document-status">Live</span>
        </div>
        <div class="document-body" id="documentPreview"></div>
      </div>
    </div>
  </main>

  <!-- SEO Content Section -->
  <section class="seo-content" style="max-width: 900px; margin: 60px auto; padding: 0 24px;">
    <h2 style="font-size: 1.75rem; color: #1e40af; margin-bottom: 16px;">What is an LLC Operating Agreement?</h2>
    <p style="font-size: 1rem; line-height: 1.7; color: #374151; margin-bottom: 24px;">An LLC Operating Agreement is the foundational document that governs how your limited liability company operates. It defines ownership percentages, member rights and responsibilities, profit distribution, voting procedures, and what happens if a member leaves or the company dissolves. While not required in all states, having an Operating Agreement is essential for protecting your limited liability status and preventing disputes between members.</p>

    <h2 style="font-size: 1.75rem; color: #1e40af; margin-bottom: 16px;">Why Every LLC Needs an Operating Agreement</h2>
    <ul style="font-size: 1rem; line-height: 1.8; color: #374151; margin-bottom: 24px; padding-left: 24px;">
      <li><strong>Protects limited liability</strong> — Courts may "pierce the corporate veil" if you don't document your LLC as a separate entity</li>
      <li><strong>Overrides state default rules</strong> — Without an agreement, state law determines how your LLC operates</li>
      <li><strong>Required by banks</strong> — Most banks require an Operating Agreement to open a business account</li>
      <li><strong>Prevents member disputes</strong> — Clear rules prevent costly disagreements about profits, voting, and exits</li>
      <li><strong>Enables flexibility</strong> — Customize management structure, distributions, and decision-making for your business</li>
    </ul>

    <h2 style="font-size: 1.75rem; color: #1e40af; margin-bottom: 16px;">Member-Managed vs Manager-Managed LLCs</h2>
    <p style="font-size: 1rem; line-height: 1.7; color: #374151; margin-bottom: 24px;"><strong>Member-Managed:</strong> All members participate in daily operations and decision-making. Best for small LLCs where all owners are actively involved. Each member typically has authority to bind the company. <strong>Manager-Managed:</strong> Designated managers (who may or may not be members) handle operations while other members remain passive investors. Ideal for LLCs with silent partners, investors, or when you want to separate ownership from management.</p>

    <h2 style="font-size: 1.75rem; color: #1e40af; margin-bottom: 16px;">Key Provisions to Include</h2>
    <ul style="font-size: 1rem; line-height: 1.8; color: #374151; margin-bottom: 24px; padding-left: 24px;">
      <li><strong>Capital contributions</strong> — Initial investments and future contribution requirements</li>
      <li><strong>Profit and loss allocation</strong> — How earnings are divided (doesn't have to match ownership)</li>
      <li><strong>Voting rights</strong> — What decisions require unanimous consent vs. majority vote</li>
      <li><strong>Transfer restrictions</strong> — Right of first refusal, approval requirements for selling membership</li>
      <li><strong>Buyout provisions</strong> — What happens when a member wants out, dies, or becomes disabled</li>
      <li><strong>Dissolution terms</strong> — How to wind down the company and distribute assets</li>
    </ul>

    <h2 style="font-size: 1.75rem; color: #1e40af; margin-bottom: 16px;">Single-Member vs Multi-Member LLCs</h2>
    <p style="font-size: 1rem; line-height: 1.7; color: #374151; margin-bottom: 24px;">Even single-member LLCs benefit from an Operating Agreement. It reinforces the separation between you and your business, documents your management procedures, and prepares for future members. This generator creates appropriate agreements for both single-member and multi-member LLCs, with provisions tailored to your ownership structure.</p>
  </section>

  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>2024 Terms.Law - Sergei Tokmakov, Esq.</p>
  </footer>
  <div class="toast" id="toast"></div>
  <script>
    let lastEditedField = null;
    let members = [];

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('formationDate').value = new Date().toISOString().split('T')[0];
      addMember();
      document.getElementById('managementType').addEventListener('change', function() {
        document.getElementById('managerSection').style.display = this.value === 'manager' ? 'block' : 'none';
      });
      updatePreview();
    });

    function addMember() {
      members.push({ id: Date.now(), name: '', address: '', contribution: '', ownership: members.length === 0 ? '100' : '' });
      renderMembers();
      updatePreview();
    }

    function removeMember(id) {
      if (members.length <= 1) { showToast('At least 1 member required'); return; }
      members = members.filter(m => m.id !== id);
      renderMembers();
      updatePreview();
    }

    function updateMember(id, field, value) {
      const m = members.find(x => x.id === id);
      if (m) { m[field] = value; trackFieldEdit('members'); }
    }

    function renderMembers() {
      document.getElementById('membersContainer').innerHTML = members.map((m, i) => `
        <div class="member-card">
          <div class="member-card-header">Member ${i+1} <button class="member-remove" onclick="removeMember(${m.id})">×</button></div>
          <div class="form-group"><input type="text" class="form-input" placeholder="Full Name" value="${m.name}" onchange="updateMember(${m.id},'name',this.value)"></div>
          <div class="form-group"><input type="text" class="form-input" placeholder="Address" value="${m.address}" onchange="updateMember(${m.id},'address',this.value)"></div>
          <div class="form-row">
            <div class="form-group"><input type="text" class="form-input" placeholder="Capital $" value="${m.contribution}" onchange="updateMember(${m.id},'contribution',this.value)"></div>
            <div class="form-group"><input type="number" class="form-input" placeholder="Ownership %" value="${m.ownership}" onchange="updateMember(${m.id},'ownership',this.value)"></div>
          </div>
        </div>
      `).join('');
    }

    function trackFieldEdit(fieldId) { lastEditedField = fieldId; updatePreview(); }

    function formatCurrency(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(num);
    }

    function updatePreview() {
      const h = (v, p, f) => `<span class="doc-highlight${!v?' empty':''}" data-field="${f}" contenteditable="true">${v||'['+p+']'}</span>`;

      const llcName = document.getElementById('llcName').value;
      const formationState = document.getElementById('formationState').value;
      const principalOffice = document.getElementById('principalOffice').value;
      const formationDate = document.getElementById('formationDate').value;
      const businessPurpose = document.getElementById('businessPurpose').value;
      const managementType = document.getElementById('managementType').value;
      const managerNames = document.getElementById('managerNames').value;
      const votingThreshold = document.getElementById('votingThreshold').value;
      const allocationMethod = document.getElementById('allocationMethod').value;
      const distributionFrequency = document.getElementById('distributionFrequency').value;
      const rofr = document.getElementById('rofr').checked;
      const dragAlong = document.getElementById('dragAlong').checked;
      const tagAlong = document.getElementById('tagAlong').checked;
      const dissolutionVote = document.getElementById('dissolutionVote').value;

      const formattedDate = formationDate ? new Date(formationDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const isSingleMember = members.length === 1;
      const votingText = {majority:'a majority',supermajority:'two-thirds (2/3)',unanimous:'unanimous consent'}[votingThreshold];
      const dissolutionText = {majority:'a majority',supermajority:'two-thirds (2/3)',unanimous:'unanimous consent'}[dissolutionVote];
      const allocationText = {ownership:'in proportion to their respective Membership Interests',equal:'equally among all Members',custom:'as specified in Schedule A'}[allocationMethod];
      const distributionText = {discretion:'at the discretion of the managing Member(s) or Manager(s)',quarterly:'on a quarterly basis',annually:'on an annual basis'}[distributionFrequency];

      const membersTable = `<table class="doc-table"><thead><tr><th>Member</th><th>Capital Contribution</th><th>Membership Interest</th></tr></thead><tbody>${members.map(m=>`<tr><td>${m.name||'[Name]'}</td><td>${formatCurrency(m.contribution)||'[Amount]'}</td><td>${m.ownership||'[%]'}%</td></tr>`).join('')}</tbody></table>`;

      document.getElementById('documentPreview').innerHTML = `
        <div class="doc-title">OPERATING AGREEMENT</div>
        <div class="doc-subtitle">of ${h(llcName,'LLC Name','llcName')}<br>A ${h(formationState,'State','formationState')} Limited Liability Company</div>

        <p class="doc-paragraph">This Operating Agreement (this "<strong>Agreement</strong>") of ${h(llcName,'LLC Name','llcName')} (the "<strong>Company</strong>"), a ${h(formationState,'State','formationState')} limited liability company, is entered into effective as of ${h(formattedDate,'Date','formationDate')}, by and among the ${isSingleMember ? 'sole Member' : 'Members'} listed below.</p>

        <div class="doc-article">ARTICLE I</div>
        <div class="doc-article-title">FORMATION AND NAME</div>

        <p class="doc-paragraph"><strong>Section 1.1 Formation.</strong> The Company was formed as a limited liability company under the laws of the State of ${h(formationState,'State','formationState')} upon the filing of the Certificate of Formation with the Secretary of State.</p>

        <p class="doc-paragraph"><strong>Section 1.2 Name.</strong> The name of the Company is ${h(llcName,'LLC Name','llcName')}.</p>

        <p class="doc-paragraph"><strong>Section 1.3 Principal Office.</strong> The principal office of the Company shall be located at ${h(principalOffice,'[Principal Office Address]','principalOffice')}, or such other place as the ${managementType === 'manager' ? 'Manager(s)' : 'Member(s)'} may designate.</p>

        <p class="doc-paragraph"><strong>Section 1.4 Purpose.</strong> The purpose of the Company is to engage in ${h(businessPurpose,'any lawful business activity','businessPurpose')}.</p>

        <p class="doc-paragraph"><strong>Section 1.5 Duration.</strong> The Company shall have perpetual existence unless dissolved in accordance with this Agreement or applicable law.</p>

        <div class="doc-article">ARTICLE II</div>
        <div class="doc-article-title">MEMBERS AND CAPITAL</div>

        <p class="doc-paragraph"><strong>Section 2.1 Members.</strong> The ${isSingleMember ? 'sole Member' : 'Members'} of the Company, together with their initial capital contributions and Membership Interests, are as follows:</p>
        ${membersTable}

        <p class="doc-paragraph"><strong>Section 2.2 Additional Contributions.</strong> No Member shall be required to make any additional capital contributions to the Company beyond the initial capital contribution set forth above, unless approved by ${votingText} of the Membership Interests.</p>

        <p class="doc-paragraph"><strong>Section 2.3 No Interest on Capital.</strong> No Member shall be entitled to receive interest on any capital contribution.</p>

        <p class="doc-paragraph"><strong>Section 2.4 Return of Capital.</strong> Except as otherwise provided in this Agreement, no Member shall have the right to demand or receive the return of such Member's capital contribution.</p>

        <div class="doc-article">ARTICLE III</div>
        <div class="doc-article-title">MANAGEMENT</div>

        ${managementType === 'member' ? `
        <p class="doc-paragraph"><strong>Section 3.1 Member-Managed.</strong> The Company shall be managed by its Members. ${isSingleMember ? 'The sole Member shall have full authority to manage the Company.' : 'Each Member shall have the authority to bind the Company in the ordinary course of business.'}</p>

        <p class="doc-paragraph"><strong>Section 3.2 Voting.</strong> ${isSingleMember ? 'The sole Member shall make all decisions regarding the Company.' : `Members shall vote in proportion to their Membership Interests. Major decisions, including but not limited to admission of new Members, sale of substantially all assets, and merger, shall require ${votingText} of the Membership Interests.`}</p>
        ` : `
        <p class="doc-paragraph"><strong>Section 3.1 Manager-Managed.</strong> The Company shall be managed by one or more Managers. The initial Manager(s) shall be: ${h(managerNames,'[Manager Names]','managerNames')}.</p>

        <p class="doc-paragraph"><strong>Section 3.2 Powers of Managers.</strong> The Managers shall have full authority to manage the business and affairs of the Company and to make all decisions regarding the Company, except as otherwise provided in this Agreement.</p>

        <p class="doc-paragraph"><strong>Section 3.3 Member Voting.</strong> Members shall vote in proportion to their Membership Interests. Major decisions requiring Member approval (admission of new Members, sale of substantially all assets, merger, amendment of this Agreement) shall require ${votingText} of the Membership Interests.</p>

        <p class="doc-paragraph"><strong>Section 3.4 Removal of Managers.</strong> Any Manager may be removed with or without cause by ${votingText} of the Membership Interests.</p>
        `}

        <div class="doc-article">ARTICLE IV</div>
        <div class="doc-article-title">ALLOCATIONS AND DISTRIBUTIONS</div>

        <p class="doc-paragraph"><strong>Section 4.1 Allocation of Profits and Losses.</strong> The net profits and net losses of the Company shall be allocated among the Members ${allocationText}.</p>

        <p class="doc-paragraph"><strong>Section 4.2 Distributions.</strong> Distributions of available cash shall be made to the Members ${distributionText}. Distributions shall be made ${allocationMethod === 'equal' ? 'equally among all Members' : 'in proportion to their respective Membership Interests'}.</p>

        <p class="doc-paragraph"><strong>Section 4.3 Tax Distributions.</strong> The Company shall use reasonable efforts to distribute to each Member, no less than quarterly, an amount sufficient to pay such Member's estimated federal and state income tax liability attributable to Company income.</p>

        <div class="doc-article">ARTICLE V</div>
        <div class="doc-article-title">TRANSFER OF MEMBERSHIP INTERESTS</div>

        <p class="doc-paragraph"><strong>Section 5.1 Restrictions on Transfer.</strong> No Member may sell, assign, transfer, or otherwise dispose of all or any portion of such Member's Membership Interest without the prior written consent of ${isSingleMember ? 'the Company' : votingText + ' of the Membership Interests held by the non-transferring Members'}.</p>

        ${rofr ? `<p class="doc-paragraph"><strong>Section 5.2 Right of First Refusal.</strong> Before any Member may transfer any Membership Interest to a third party, such Member shall first offer to sell such Membership Interest to the other Members on the same terms. The other Members shall have thirty (30) days to accept such offer.</p>` : ''}

        ${tagAlong ? `<p class="doc-paragraph"><strong>Section 5.${rofr ? '3' : '2'} Tag-Along Rights.</strong> If any Member proposes to sell more than 50% of the total Membership Interests to a third party, each other Member shall have the right to participate in such sale on the same terms and conditions, on a pro-rata basis.</p>` : ''}

        ${dragAlong ? `<p class="doc-paragraph"><strong>Section 5.${rofr && tagAlong ? '4' : rofr || tagAlong ? '3' : '2'} Drag-Along Rights.</strong> If Members holding at least ${votingText} of the Membership Interests approve a sale of the Company to a third party, all Members shall be required to participate in such sale on the same terms and conditions.</p>` : ''}

        <div class="doc-article">ARTICLE VI</div>
        <div class="doc-article-title">DISSOLUTION</div>

        <p class="doc-paragraph"><strong>Section 6.1 Events of Dissolution.</strong> The Company shall be dissolved upon: (a) ${dissolutionText} of the Members to dissolve; (b) the sale of all or substantially all of the Company's assets; (c) entry of a decree of judicial dissolution; or (d) any other event causing dissolution under applicable law.</p>

        <p class="doc-paragraph"><strong>Section 6.2 Winding Up.</strong> Upon dissolution, the Company's affairs shall be wound up and its assets liquidated. After payment of all debts and liabilities, the remaining assets shall be distributed to the Members in accordance with their Membership Interests.</p>

        <div class="doc-article">ARTICLE VII</div>
        <div class="doc-article-title">MISCELLANEOUS</div>

        <p class="doc-paragraph"><strong>Section 7.1 Governing Law.</strong> This Agreement shall be governed by the laws of the State of ${h(formationState,'State','formationState')}.</p>

        <p class="doc-paragraph"><strong>Section 7.2 Amendment.</strong> This Agreement may be amended only by ${isSingleMember ? 'the sole Member' : votingText + ' of the Membership Interests'}.</p>

        <p class="doc-paragraph"><strong>Section 7.3 Entire Agreement.</strong> This Agreement constitutes the entire agreement among the Members with respect to the subject matter hereof.</p>

        <p class="doc-paragraph"><strong>Section 7.4 Severability.</strong> If any provision of this Agreement is held invalid, the remaining provisions shall continue in full force and effect.</p>

        <p class="doc-paragraph" style="text-align:center;margin-top:30px;">* * *</p>

        <p class="doc-paragraph"><strong>IN WITNESS WHEREOF</strong>, the undersigned have executed this Operating Agreement as of the date first written above.</p>

        ${members.map((m, i) => `
        <div class="doc-signature-block">
          <p style="font-weight:bold;font-size:11px;text-transform:uppercase;margin-bottom:10px;">Member ${i+1}</p>
          <div class="doc-signature-line"><span class="sig-label">Signature:</span><span class="sig-value"></span></div>
          <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value">${m.name || ''}</span></div>
          <div class="doc-signature-line"><span class="sig-label">Date:</span><span class="sig-value"></span></div>
        </div>
        `).join('')}
      `;

      if(lastEditedField){
        setTimeout(()=>{
          const el = document.querySelector(`[data-field="${lastEditedField}"]`);
          if(el){
            el.scrollIntoView({behavior:'smooth',block:'center'});
            el.classList.add('field-highlight-animation');
            setTimeout(()=>el.classList.remove('field-highlight-animation'),600);
          }
        },50);
      }
    }

    function showToast(msg,type=''){
      const t=document.getElementById('toast');
      t.textContent=msg;
      t.className='toast show'+(type?' '+type:'');
      setTimeout(()=>t.classList.remove('show'),3000);
    }

    function copyToClipboard(){
      const r=document.createRange();
      r.selectNode(document.getElementById('documentPreview'));
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(r);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      showToast('Copied!','success');
    }

    function downloadDocument(){
      const c=document.getElementById('documentPreview').innerHTML;
      const llcName = document.getElementById('llcName').value || 'LLC';
      const h=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Operating Agreement - ${llcName}</title><style>body{font-family:Georgia,serif;max-width:8.5in;margin:1in auto;line-height:1.8;font-size:12pt}.doc-title{text-align:center;font-size:16pt;font-weight:bold;text-transform:uppercase;letter-spacing:2px}.doc-subtitle{text-align:center;font-size:10pt;color:#666;margin-bottom:30px}.doc-article{text-align:center;font-size:13pt;font-weight:bold;text-transform:uppercase;margin-top:30px}.doc-article-title{text-align:center;font-size:11pt;font-weight:bold;margin-bottom:15px}.doc-paragraph{margin:12px 0;text-align:justify}.doc-table{width:100%;border-collapse:collapse;margin:15px 0}.doc-table th,.doc-table td{border:1px solid #ccc;padding:8px}.doc-table th{background:#f5f5f5}.doc-highlight{background:#fef3c7}.doc-signature-block{margin-top:30px}.doc-signature-line{display:flex;margin-bottom:8px;min-height:30px}.doc-signature-line .sig-label{width:80px;font-size:9pt;color:#666}.doc-signature-line .sig-value{flex:1;border-bottom:1px solid #333}</style></head><body>${c}</body></html>`;
      const b=new Blob([h],{type:'text/html'});
      const u=URL.createObjectURL(b);
      const a=document.createElement('a');
      a.href=u;
      a.download='LLC-Operating-Agreement.html';
      a.click();
      URL.revokeObjectURL(u);
      showToast('Downloaded!','success');
    }
  </script>
</body>
</html>
