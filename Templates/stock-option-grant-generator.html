<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Option Grant Generator | ISO & NSO Options | Terms.Law</title>
  <meta name="description" content="Free Stock Option Grant Agreement generator. Create ISO or NSO grants with customizable vesting, exercise price, and expiration terms. Attorney-drafted.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-text-light: #94a3b8;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; position: relative; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .option-type-card { background: var(--color-bg); border: 2px solid var(--color-border); border-radius: var(--radius-md); padding: 0.75rem; margin-bottom: 0.5rem; cursor: pointer; transition: all var(--transition-fast); }
    .option-type-card:hover { border-color: var(--color-primary-light); }
    .option-type-card.selected { border-color: var(--color-primary); background: rgba(30, 64, 175, 0.05); }
    .option-type-card input { display: none; }
    .option-type-name { font-weight: 600; font-size: 0.85rem; margin-bottom: 2px; }
    .option-type-desc { font-size: 0.75rem; color: var(--color-text-muted); }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .doc-subtitle { text-align: center; font-size: 11px; color: var(--color-text-muted); margin-bottom: 25px; font-family: var(--font-sans); }
    .doc-section-header { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; color: var(--doc-clause-title); border-bottom: 1px solid var(--color-border); padding-bottom: 4px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; text-align: justify; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 12px; }
    .doc-table th, .doc-table td { border: 1px solid var(--color-border); padding: 8px 10px; text-align: left; }
    .doc-table th { background: var(--color-bg); font-weight: 600; font-size: 10px; text-transform: uppercase; }
    .doc-signature-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px; }
    .doc-signature-party-title { font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 15px; color: var(--color-text-muted); }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; }
    .doc-signature-line .sig-label { width: 60px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; display: flex; align-items: flex-end; padding-bottom: 3px; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; box-shadow: var(--shadow-xl); transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .doc-signature-row { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/demand-letters-landing.html" class="nav-link">Demands</a>
        <a href="contract-library-landing.html" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">Equity Compensation</div>
      <h1><span class="highlight">Stock Option Grant</span> Generator</h1>
      <p class="hero-subtitle">Generate ISO or NSO stock option grant agreements with customizable vesting schedules, exercise prices, and termination provisions.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">Company Information</h3>
        <div class="form-group">
          <label class="form-label">Company Name</label>
          <input type="text" id="companyName" class="form-input" placeholder="Acme Inc." oninput="trackFieldEdit('companyName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select id="incState" class="form-select" onchange="trackFieldEdit('incState')">
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Plan Name</label>
          <input type="text" id="planName" class="form-input" placeholder="2024 Equity Incentive Plan" oninput="trackFieldEdit('planName')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Optionee Information</h3>
        <div class="form-group">
          <label class="form-label">Optionee Name</label>
          <input type="text" id="optioneeName" class="form-input" placeholder="Jane Smith" oninput="trackFieldEdit('optioneeName')">
        </div>
        <div class="form-group">
          <label class="form-label">Optionee Address</label>
          <input type="text" id="optioneeAddress" class="form-input" placeholder="789 Employee St, San Francisco, CA 94103" oninput="trackFieldEdit('optioneeAddress')">
        </div>
        <div class="form-group">
          <label class="form-label">Employee ID (optional)</label>
          <input type="text" id="employeeId" class="form-input" placeholder="EMP-001" oninput="trackFieldEdit('employeeId')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Option Type</h3>
        <label class="option-type-card" id="typeIsoCard">
          <input type="radio" name="optionType" value="ISO" checked onchange="updateOptionType()">
          <div class="option-type-name">Incentive Stock Option (ISO)</div>
          <div class="option-type-desc">Tax-advantaged. Employees only. $100K/year limit.</div>
        </label>
        <label class="option-type-card" id="typeNsoCard">
          <input type="radio" name="optionType" value="NSO" onchange="updateOptionType()">
          <div class="option-type-name">Non-Qualified Stock Option (NSO)</div>
          <div class="option-type-desc">No tax preference. Anyone eligible. No limit.</div>
        </label>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Grant Terms</h3>
        <div class="form-group">
          <label class="form-label">Number of Shares</label>
          <input type="number" id="numShares" class="form-input" placeholder="10000" oninput="trackFieldEdit('numShares')">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Exercise Price ($)</label>
            <input type="number" id="exercisePrice" class="form-input" placeholder="0.10" step="0.01" oninput="trackFieldEdit('exercisePrice')">
            <div class="form-hint">Per share FMV</div>
          </div>
          <div class="form-group">
            <label class="form-label">Grant Date</label>
            <input type="date" id="grantDate" class="form-input" oninput="trackFieldEdit('grantDate')">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Expiration (years from grant)</label>
          <select id="expirationYears" class="form-select" onchange="trackFieldEdit('expirationYears')">
            <option value="10">10 years (standard)</option>
            <option value="7">7 years</option>
            <option value="5">5 years</option>
          </select>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Vesting Schedule</h3>
        <div class="form-group">
          <label class="form-label">Vesting Period</label>
          <select id="vestingPeriod" class="form-select" onchange="trackFieldEdit('vestingPeriod')">
            <option value="4">4 years (standard)</option>
            <option value="3">3 years</option>
            <option value="2">2 years</option>
            <option value="1">1 year</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Cliff Period</label>
          <select id="cliffPeriod" class="form-select" onchange="trackFieldEdit('cliffPeriod')">
            <option value="12">12 months (standard)</option>
            <option value="6">6 months</option>
            <option value="0">No cliff</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Vesting Frequency</label>
          <select id="vestingFrequency" class="form-select" onchange="trackFieldEdit('vestingFrequency')">
            <option value="monthly">Monthly</option>
            <option value="quarterly">Quarterly</option>
            <option value="annually">Annually</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Vesting Start Date</label>
          <input type="date" id="vestingStartDate" class="form-input" oninput="trackFieldEdit('vestingStartDate')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Acceleration</h3>
        <div class="form-group">
          <label class="form-label">Change of Control Acceleration</label>
          <select id="acceleration" class="form-select" onchange="trackFieldEdit('acceleration')">
            <option value="double">Double trigger (standard)</option>
            <option value="single">Single trigger</option>
            <option value="none">None</option>
          </select>
          <div class="form-hint">Double: COC + termination within 12mo</div>
        </div>
      </div>
    </aside>
    <div class="preview-panel">
      <div class="preview-toolbar">
        <div class="preview-title">Live Preview - Click highlighted text to edit</div>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title">Stock Option Grant Agreement</span>
          <span class="document-status">Live</span>
        </div>
        <div class="document-body" id="documentPreview"></div>
      </div>
    </div>
  </main>
  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>2024 Terms.Law - Sergei Tokmakov, Esq.</p>
  </footer>
  <div class="toast" id="toast"></div>
  <script>
    let lastEditedField = null;

    document.addEventListener('DOMContentLoaded', function() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('grantDate').value = today;
      document.getElementById('vestingStartDate').value = today;
      updateOptionType();
      updatePreview();
    });

    function updateOptionType() {
      const type = document.querySelector('input[name="optionType"]:checked').value;
      document.querySelectorAll('.option-type-card').forEach(c => c.classList.remove('selected'));
      document.getElementById('type' + type.charAt(0).toUpperCase() + type.slice(1).toLowerCase() + 'Card').classList.add('selected');
      updatePreview();
    }

    function trackFieldEdit(fieldId) { lastEditedField = fieldId; updatePreview(); }

    function formatCurrency(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num);
    }

    function formatNumber(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US').format(num);
    }

    function getExpirationDate() {
      const grantDate = document.getElementById('grantDate').value;
      const years = parseInt(document.getElementById('expirationYears').value) || 10;
      if (!grantDate) return '';
      const date = new Date(grantDate + 'T00:00:00');
      date.setFullYear(date.getFullYear() + years);
      return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    function updatePreview() {
      const h = (v, p, f) => `<span class="doc-highlight${!v?' empty':''}" data-field="${f}" contenteditable="true">${v||'['+p+']'}</span>`;

      const companyName = document.getElementById('companyName').value;
      const incState = document.getElementById('incState').value;
      const planName = document.getElementById('planName').value;
      const optioneeName = document.getElementById('optioneeName').value;
      const optioneeAddress = document.getElementById('optioneeAddress').value;
      const employeeId = document.getElementById('employeeId').value;
      const optionType = document.querySelector('input[name="optionType"]:checked').value;
      const numShares = document.getElementById('numShares').value;
      const exercisePrice = document.getElementById('exercisePrice').value;
      const grantDate = document.getElementById('grantDate').value;
      const expirationYears = document.getElementById('expirationYears').value;
      const vestingPeriod = document.getElementById('vestingPeriod').value;
      const cliffPeriod = document.getElementById('cliffPeriod').value;
      const vestingFrequency = document.getElementById('vestingFrequency').value;
      const vestingStartDate = document.getElementById('vestingStartDate').value;
      const acceleration = document.getElementById('acceleration').value;

      const formattedGrantDate = grantDate ? new Date(grantDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const formattedVestingStart = vestingStartDate ? new Date(vestingStartDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const expirationDate = getExpirationDate();
      const formattedShares = formatNumber(numShares);
      const formattedPrice = formatCurrency(exercisePrice);
      const totalValue = numShares && exercisePrice ? formatCurrency(numShares * exercisePrice) : '';

      const optionTypeFull = optionType === 'ISO' ? 'Incentive Stock Option' : 'Non-Qualified Stock Option';
      const cliffText = cliffPeriod === '0' ? 'no cliff' : `a ${cliffPeriod}-month cliff`;
      const vestFreqText = {monthly:'monthly',quarterly:'quarterly',annually:'annually'}[vestingFrequency];

      let accelerationText = '';
      if (acceleration === 'double') {
        accelerationText = `
          <p class="doc-paragraph"><strong>6.1 Double-Trigger Acceleration.</strong> If (a) there is a Change of Control, and (b) within twelve (12) months following such Change of Control, the Optionee's Continuous Service is terminated without Cause or the Optionee resigns for Good Reason, then 100% of the then-unvested Option Shares shall immediately vest and become exercisable.</p>
        `;
      } else if (acceleration === 'single') {
        accelerationText = `
          <p class="doc-paragraph"><strong>6.1 Single-Trigger Acceleration.</strong> Upon a Change of Control, 100% of the then-unvested Option Shares shall immediately vest and become exercisable.</p>
        `;
      }

      const isoNotice = optionType === 'ISO' ? `
        <div class="doc-section-header">9. ISO Tax Treatment</div>
        <p class="doc-paragraph">This Option is intended to qualify as an Incentive Stock Option under Section 422 of the Internal Revenue Code. To obtain favorable tax treatment, the Optionee must not dispose of shares acquired upon exercise of this Option within two (2) years from the Grant Date or one (1) year from the date of exercise, whichever is later.</p>
        <p class="doc-paragraph">The aggregate fair market value (determined as of the Grant Date) of shares with respect to which ISOs first become exercisable by the Optionee during any calendar year shall not exceed $100,000. To the extent this limit is exceeded, Options shall be treated as Non-Qualified Stock Options.</p>
      ` : '';

      document.getElementById('documentPreview').innerHTML = `
        <div class="doc-title">STOCK OPTION GRANT AGREEMENT</div>
        <div class="doc-subtitle">${optionTypeFull} (${optionType})</div>

        <table class="doc-table">
          <tr><td style="width:35%;font-weight:bold;">Optionee:</td><td>${h(optioneeName,'Optionee Name','optioneeName')}</td></tr>
          <tr><td style="font-weight:bold;">Company:</td><td>${h(companyName,'Company Name','companyName')}</td></tr>
          <tr><td style="font-weight:bold;">Grant Date:</td><td>${h(formattedGrantDate,'Grant Date','grantDate')}</td></tr>
          <tr><td style="font-weight:bold;">Number of Shares:</td><td>${h(formattedShares,'10,000','numShares')}</td></tr>
          <tr><td style="font-weight:bold;">Exercise Price:</td><td>${h(formattedPrice,'$0.10','exercisePrice')} per share</td></tr>
          <tr><td style="font-weight:bold;">Total Exercise Price:</td><td>${totalValue || '[calculated]'}</td></tr>
          <tr><td style="font-weight:bold;">Expiration Date:</td><td>${h(expirationDate,'[Expiration Date]','expirationYears')}</td></tr>
          <tr><td style="font-weight:bold;">Option Type:</td><td>${optionTypeFull}</td></tr>
          ${employeeId ? `<tr><td style="font-weight:bold;">Employee ID:</td><td>${employeeId}</td></tr>` : ''}
        </table>

        <div class="doc-section-header">1. Grant of Option</div>
        <p class="doc-paragraph">${h(companyName,'Company Name','companyName')}, a ${h(incState,'Delaware','incState')} corporation (the "<strong>Company</strong>"), hereby grants to ${h(optioneeName,'Optionee Name','optioneeName')} (the "<strong>Optionee</strong>") an option to purchase ${h(formattedShares,'10,000','numShares')} shares of the Company's Common Stock (the "<strong>Option Shares</strong>") at an exercise price of ${h(formattedPrice,'$0.10','exercisePrice')} per share (the "<strong>Exercise Price</strong>"), subject to the terms of this Agreement and the ${h(planName,'Equity Incentive Plan','planName')} (the "<strong>Plan</strong>").</p>

        <div class="doc-section-header">2. Option Type</div>
        <p class="doc-paragraph">This Option is designated as ${optionType === 'ISO' ? 'an Incentive Stock Option ("ISO") under Section 422 of the Internal Revenue Code' : 'a Non-Qualified Stock Option ("NSO")'}.</p>

        <div class="doc-section-header">3. Vesting Schedule</div>
        <p class="doc-paragraph">The Option Shares shall vest over ${h(vestingPeriod+' years','4 years','vestingPeriod')} with ${cliffText}, vesting ${vestFreqText} thereafter, as follows:</p>
        <ul class="doc-list">
          <li><strong>Vesting Commencement Date:</strong> ${h(formattedVestingStart,'[Vesting Start]','vestingStartDate')}</li>
          ${cliffPeriod !== '0' ? `<li><strong>Cliff:</strong> ${(100/vestingPeriod * (cliffPeriod/12)).toFixed(1)}% of the Option Shares (${formatNumber(Math.floor(numShares * (1/vestingPeriod) * (cliffPeriod/12)))} shares) shall vest on the ${cliffPeriod}-month anniversary of the Vesting Commencement Date.</li>` : ''}
          <li><strong>Subsequent Vesting:</strong> The remaining Option Shares shall vest in equal ${vestFreqText} installments over the balance of the vesting period, subject to the Optionee's Continuous Service through each vesting date.</li>
        </ul>

        <div class="doc-section-header">4. Exercise of Option</div>
        <p class="doc-paragraph"><strong>4.1 Method of Exercise.</strong> The Optionee may exercise this Option, in whole or in part, by delivering to the Company: (a) a written notice of exercise specifying the number of shares to be purchased; and (b) payment of the aggregate Exercise Price by cash, check, wire transfer, or other method approved by the Board.</p>
        <p class="doc-paragraph"><strong>4.2 Early Exercise.</strong> ${optionType === 'ISO' ? 'Early exercise is not permitted for this ISO.' : 'Subject to Company approval, the Optionee may exercise unvested Option Shares, which shall remain subject to the Company\'s repurchase right at the Exercise Price until vested.'}</p>

        <div class="doc-section-header">5. Termination of Service</div>
        <p class="doc-paragraph"><strong>5.1 Voluntary Resignation or Termination Without Cause.</strong> If the Optionee's Continuous Service terminates for any reason other than death, Disability, or Cause, the Optionee may exercise any vested portion of this Option within three (3) months after termination.</p>
        <p class="doc-paragraph"><strong>5.2 Death or Disability.</strong> If the Optionee's Continuous Service terminates due to death or Disability, the Optionee (or estate) may exercise any vested portion within twelve (12) months after termination.</p>
        <p class="doc-paragraph"><strong>5.3 Termination for Cause.</strong> If terminated for Cause, this Option shall immediately terminate and be forfeited in its entirety.</p>
        <p class="doc-paragraph"><strong>5.4 Unvested Shares.</strong> Any unvested Option Shares shall be forfeited upon termination of Continuous Service.</p>

        ${acceleration !== 'none' ? `
        <div class="doc-section-header">6. Change of Control</div>
        ${accelerationText}
        <p class="doc-paragraph"><strong>6.2 Definition.</strong> "Change of Control" means: (a) acquisition of more than 50% of voting power; (b) sale of substantially all assets; or (c) merger or consolidation where existing stockholders hold less than 50% of the surviving entity.</p>
        ` : ''}

        <div class="doc-section-header">${acceleration !== 'none' ? '7' : '6'}. Restrictions on Transfer</div>
        <p class="doc-paragraph">This Option may not be transferred except by will or the laws of descent and distribution, and during the Optionee's lifetime may only be exercised by the Optionee.</p>

        <div class="doc-section-header">${acceleration !== 'none' ? '8' : '7'}. General Provisions</div>
        <p class="doc-paragraph"><strong>Plan Terms Control.</strong> This Agreement is subject to the terms of the Plan, which are incorporated by reference. In case of conflict, the Plan shall control.</p>
        <p class="doc-paragraph"><strong>No Employment Rights.</strong> This Option does not confer any right to continued employment or service.</p>
        <p class="doc-paragraph"><strong>Tax Obligations.</strong> The Optionee is responsible for all tax obligations arising from this Option. The Company may withhold taxes as required by law.</p>
        <p class="doc-paragraph"><strong>Governing Law.</strong> This Agreement shall be governed by the laws of ${h(incState,'Delaware','incState')}.</p>

        ${isoNotice}

        <p class="doc-paragraph" style="margin-top:30px;"><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Stock Option Grant Agreement as of the Grant Date.</p>

        <div class="doc-signature-row">
          <div>
            <div class="doc-signature-party-title">Company</div>
            <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Title:</span><span class="sig-value"></span></div>
          </div>
          <div>
            <div class="doc-signature-party-title">Optionee</div>
            <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value">${optioneeName || ''}</span></div>
            <div class="doc-signature-line"><span class="sig-label">Address:</span><span class="sig-value">${optioneeAddress || ''}</span></div>
          </div>
        </div>
      `;

      if(lastEditedField){
        setTimeout(()=>{
          const el = document.querySelector(`[data-field="${lastEditedField}"]`);
          if(el){
            el.scrollIntoView({behavior:'smooth',block:'center'});
            el.classList.add('field-highlight-animation');
            setTimeout(()=>el.classList.remove('field-highlight-animation'),600);
          }
        },50);
      }
    }

    function showToast(msg,type=''){
      const t=document.getElementById('toast');
      t.textContent=msg;
      t.className='toast show'+(type?' '+type:'');
      setTimeout(()=>t.classList.remove('show'),3000);
    }

    function copyToClipboard(){
      const r=document.createRange();
      r.selectNode(document.getElementById('documentPreview'));
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(r);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      showToast('Copied!','success');
    }

    function downloadDocument(){
      const c=document.getElementById('documentPreview').innerHTML;
      const optionType = document.querySelector('input[name="optionType"]:checked').value;
      const h=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Stock Option Grant Agreement</title><style>body{font-family:Georgia,serif;max-width:8.5in;margin:1in auto;line-height:1.8;font-size:12pt}.doc-title{text-align:center;font-size:14pt;font-weight:bold;text-transform:uppercase;letter-spacing:2px}.doc-subtitle{text-align:center;font-size:10pt;color:#666;margin-bottom:20px}.doc-section-header{font-weight:bold;text-transform:uppercase;margin-top:20px;border-bottom:1px solid #ccc;font-size:11pt}.doc-paragraph{margin:12px 0;text-align:justify}.doc-list{margin:12px 0 12px 20px}.doc-list li{margin-bottom:8px}.doc-table{width:100%;border-collapse:collapse;margin:15px 0}.doc-table th,.doc-table td{border:1px solid #ccc;padding:8px}.doc-highlight{background:#fef3c7}.doc-signature-row{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:40px}.doc-signature-party-title{font-weight:bold;text-transform:uppercase;margin-bottom:15px;font-size:10pt}.doc-signature-line{display:flex;margin-bottom:8px;min-height:30px}.doc-signature-line .sig-label{width:60px;font-size:9pt;color:#666}.doc-signature-line .sig-value{flex:1;border-bottom:1px solid #333}</style></head><body>${c}</body></html>`;
      const b=new Blob([h],{type:'text/html'});
      const u=URL.createObjectURL(b);
      const a=document.createElement('a');
      a.href=u;
      a.download=`Stock-Option-Grant-${optionType}.html`;
      a.click();
      URL.revokeObjectURL(u);
      showToast('Downloaded!','success');
    }
  </script>
</body>
</html>
