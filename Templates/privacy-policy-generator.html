<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privacy Policy Generator | Terms.Law</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1e40af; --primary-dark: #1e3a8a; --accent: #f59e0b; --background: #f8fafc; --surface: #ffffff; --text: #1e293b; --text-light: #64748b; --border: #e2e8f0; --success: #10b981; --warning: #f59e0b; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--background); color: var(--text); line-height: 1.6; }
        .navbar { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); padding: 1rem 2rem; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-container { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .nav-brand { display: flex; align-items: center; gap: 1rem; }
        .nav-logo { font-size: 1.5rem; font-weight: 700; color: white; text-decoration: none; }
        .nav-divider { color: rgba(255,255,255,0.5); }
        .nav-title { color: rgba(255,255,255,0.9); font-size: 1rem; }
        .nav-links { display: flex; gap: 1.5rem; }
        .nav-links a { color: rgba(255,255,255,0.85); text-decoration: none; font-size: 0.9rem; font-weight: 500; }
        .nav-links a:hover { color: white; }
        .main-container { max-width: 1400px; margin: 0 auto; padding: 2rem; display: grid; grid-template-columns: 420px 1fr; gap: 2rem; align-items: start; }
        .form-panel { background: var(--surface); border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); position: sticky; top: 80px; max-height: calc(100vh - 100px); overflow-y: auto; }
        .form-header { padding: 1.5rem; border-bottom: 1px solid var(--border); background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 12px 12px 0 0; }
        .form-header h2 { font-size: 1.25rem; color: var(--primary); margin-bottom: 0.25rem; }
        .form-header p { font-size: 0.85rem; color: var(--text-light); }
        .form-content { padding: 1.5rem; }
        .form-section { margin-bottom: 1.5rem; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: var(--primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border); }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 500; margin-bottom: 0.375rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.625rem 0.875rem; border: 1px solid var(--border); border-radius: 8px; font-size: 0.9rem; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(30,64,175,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
        .checkbox-group { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0; }
        .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; accent-color: var(--primary); }
        .checkbox-group label { margin-bottom: 0; cursor: pointer; }
        .form-actions { padding: 1.5rem; border-top: 1px solid var(--border); }
        .btn { padding: 0.875rem 1.5rem; border-radius: 8px; font-size: 0.95rem; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; border: none; width: 100%; }
        .btn-primary { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(30,64,175,0.3); }
        .btn-secondary { background: var(--surface); color: var(--text); border: 1px solid var(--border); }
        .btn-success { background: linear-gradient(135deg, var(--success) 0%, #059669 100%); color: white; }
        .preview-panel { background: var(--surface); border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .preview-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .preview-header h3 { font-size: 1rem; }
        .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .preview-actions .btn { padding: 0.5rem 1rem; font-size: 0.85rem; width: auto; }
        .edit-mode-toggle { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: #fef3c7; border-radius: 8px; font-size: 0.85rem; color: #92400e; }
        .document-container { padding: 2rem; max-width: 850px; margin: 0 auto; }
        .document { background: white; padding: 3rem; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.05); line-height: 1.8; font-size: 14px; }
        .document h1 { text-align: center; font-size: 1.5rem; margin-bottom: 1.5rem; }
        .document h2 { font-size: 1.1rem; margin-top: 1.5rem; margin-bottom: 0.75rem; }
        .document h3 { font-size: 1rem; margin-top: 1rem; margin-bottom: 0.5rem; }
        .document p { margin-bottom: 1rem; text-align: justify; }
        .document ul { margin-left: 1.5rem; margin-bottom: 1rem; }
        .document li { margin-bottom: 0.5rem; }
        .document table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 13px; }
        .document th, .document td { border: 1px solid var(--border); padding: 0.5rem; text-align: left; }
        .document th { background: #f8fafc; font-weight: 600; }
        .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 4px; border-radius: 3px; border-bottom: 2px solid var(--accent); }
        .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
        .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245,158,11,0.3); }
        @keyframes highlightPulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0.7); } 50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245,158,11,0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0); } }
        .field-highlight-animation { animation: highlightPulse 0.6s ease-out; background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important; }
        .full-edit-mode .document { border: 2px dashed var(--warning); }
        .full-edit-warning { display: none; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; font-size: 0.85rem; color: #92400e; }
        .full-edit-mode .full-edit-warning { display: block; }
        @media print { .navbar, .form-panel, .preview-header, .full-edit-warning { display: none !important; } .main-container { display: block; padding: 0; } .document { border: none; box-shadow: none; padding: 0; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
        @media (max-width: 1024px) { .main-container { grid-template-columns: 1fr; } .form-panel { position: relative; top: 0; max-height: none; } }
        @media (max-width: 640px) { .navbar { padding: 1rem; } .nav-links { display: none; } .main-container { padding: 1rem; } .document { padding: 1.5rem; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="https://terms.law" class="nav-logo">Terms.Law</a>
                <span class="nav-divider">|</span>
                <span class="nav-title">Privacy Policy Generator</span>
            </div>
            <div class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
                <a href="https://terms.law">Home</a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="form-panel">
            <div class="form-header">
                <h2>üîí Privacy Policy Details</h2>
                <p>Generate a customized privacy policy for your website or application</p>
            </div>

            <div class="form-content">
                <div class="form-section">
                    <div class="section-title">Company Information</div>
                    <div class="form-group">
                        <label for="companyName">Company/Website Name</label>
                        <input type="text" id="companyName" placeholder="Acme Inc." oninput="trackFieldEdit('companyName')">
                    </div>
                    <div class="form-group">
                        <label for="websiteUrl">Website URL</label>
                        <input type="text" id="websiteUrl" placeholder="https://www.example.com" oninput="trackFieldEdit('websiteUrl')">
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">Privacy Contact Email</label>
                        <input type="email" id="contactEmail" placeholder="privacy@example.com" oninput="trackFieldEdit('contactEmail')">
                    </div>
                    <div class="form-group">
                        <label for="companyAddress">Business Address</label>
                        <input type="text" id="companyAddress" placeholder="123 Main St, City, State ZIP" oninput="trackFieldEdit('companyAddress')">
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Data Collection</div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsEmail" checked onchange="trackFieldEdit('collectsEmail')">
                        <label for="collectsEmail">Email addresses</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsName" checked onchange="trackFieldEdit('collectsName')">
                        <label for="collectsName">Names</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsPhone" onchange="trackFieldEdit('collectsPhone')">
                        <label for="collectsPhone">Phone numbers</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsAddress" onchange="trackFieldEdit('collectsAddress')">
                        <label for="collectsAddress">Physical addresses</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsPayment" onchange="trackFieldEdit('collectsPayment')">
                        <label for="collectsPayment">Payment information</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsLocation" onchange="trackFieldEdit('collectsLocation')">
                        <label for="collectsLocation">Location data</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsDevice" checked onchange="trackFieldEdit('collectsDevice')">
                        <label for="collectsDevice">Device/browser information</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="collectsUsage" checked onchange="trackFieldEdit('collectsUsage')">
                        <label for="collectsUsage">Usage data (pages visited, clicks)</label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Cookies & Tracking</div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usesCookies" checked onchange="trackFieldEdit('usesCookies')">
                        <label for="usesCookies">Uses cookies</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usesAnalytics" checked onchange="trackFieldEdit('usesAnalytics')">
                        <label for="usesAnalytics">Uses analytics (Google Analytics, etc.)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usesAdvertising" onchange="trackFieldEdit('usesAdvertising')">
                        <label for="usesAdvertising">Uses advertising/retargeting cookies</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usesSocialMedia" onchange="trackFieldEdit('usesSocialMedia')">
                        <label for="usesSocialMedia">Social media integrations</label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Third-Party Sharing</div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sharesWithProviders" checked onchange="trackFieldEdit('sharesWithProviders')">
                        <label for="sharesWithProviders">Service providers (hosting, email, etc.)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sharesWithAnalytics" checked onchange="trackFieldEdit('sharesWithAnalytics')">
                        <label for="sharesWithAnalytics">Analytics providers</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sharesWithPayment" onchange="trackFieldEdit('sharesWithPayment')">
                        <label for="sharesWithPayment">Payment processors</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sharesWithAdvertisers" onchange="trackFieldEdit('sharesWithAdvertisers')">
                        <label for="sharesWithAdvertisers">Advertisers/marketing partners</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sellsData" onchange="trackFieldEdit('sellsData')">
                        <label for="sellsData">Sells or shares data for monetary value</label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Compliance</div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="gdprCompliant" onchange="trackFieldEdit('gdprCompliant')">
                        <label for="gdprCompliant">GDPR (EU users)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="ccpaCompliant" onchange="trackFieldEdit('ccpaCompliant')">
                        <label for="ccpaCompliant">CCPA/CPRA (California users)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="coppaCompliant" onchange="trackFieldEdit('coppaCompliant')">
                        <label for="coppaCompliant">COPPA (children under 13)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="caloppaCompliant" checked onchange="trackFieldEdit('caloppaCompliant')">
                        <label for="caloppaCompliant">CalOPPA (Do Not Track disclosure)</label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Data Retention & Security</div>
                    <div class="form-group">
                        <label for="retentionPeriod">Data Retention Period</label>
                        <select id="retentionPeriod" onchange="trackFieldEdit('retentionPeriod')">
                            <option value="asNeeded">As long as necessary for purposes</option>
                            <option value="1year">1 year after account closure</option>
                            <option value="3years">3 years after account closure</option>
                            <option value="7years">7 years (legal/tax requirements)</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usesEncryption" checked onchange="trackFieldEdit('usesEncryption')">
                        <label for="usesEncryption">Uses encryption (SSL/TLS)</label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Additional Options</div>
                    <div class="form-group">
                        <label for="lastUpdated">Last Updated Date</label>
                        <input type="date" id="lastUpdated" oninput="trackFieldEdit('lastUpdated')">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeContactForm" checked onchange="trackFieldEdit('includeContactForm')">
                        <label for="includeContactForm">Include contact form for privacy requests</label>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="updatePreview()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    Generate Privacy Policy
                </button>
            </div>
        </div>

        <div class="preview-panel" id="previewPanel">
            <div class="preview-header">
                <h3>Document Preview</h3>
                <div class="preview-actions">
                    <div class="edit-mode-toggle">
                        <input type="checkbox" id="fullEditMode" onchange="toggleFullEditMode()">
                        <label for="fullEditMode">Full Edit Mode</label>
                    </div>
                    <button class="btn btn-secondary" onclick="printDocument()">Print</button>
                    <button class="btn btn-success" onclick="downloadWord()">Download Word</button>
                </div>
            </div>
            <div class="document-container">
                <div class="full-edit-warning">‚ö†Ô∏è <strong>Full Edit Mode:</strong> Edit directly. Changes won't sync to form.</div>
                <div class="document" id="documentPreview">
                    <p style="text-align: center; color: var(--text-light); padding: 3rem;">Fill in the form and click "Generate Privacy Policy" to preview.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let lastEditedField = null;
        let hasCustomEdits = false;

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits && !confirm('Regenerating will overwrite custom edits. Continue?')) return;
            hasCustomEdits = false;
            lastEditedField = fieldId;
            updatePreview();
        }

        function toggleFullEditMode() {
            const isEnabled = document.getElementById('fullEditMode').checked;
            const panel = document.getElementById('previewPanel');
            const doc = document.getElementById('documentPreview');
            panel.classList.toggle('full-edit-mode', isEnabled);
            doc.contentEditable = isEnabled;
            if (isEnabled) doc.addEventListener('input', () => hasCustomEdits = true);
        }

        function formatDate(dateString) {
            if (!dateString) return new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            return new Date(dateString).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function updatePreview() {
            const companyName = document.getElementById('companyName').value.trim() || '[COMPANY NAME]';
            const websiteUrl = document.getElementById('websiteUrl').value.trim() || '[WEBSITE URL]';
            const contactEmail = document.getElementById('contactEmail').value.trim() || '[EMAIL]';
            const companyAddress = document.getElementById('companyAddress').value.trim() || '[ADDRESS]';

            const collectsEmail = document.getElementById('collectsEmail').checked;
            const collectsName = document.getElementById('collectsName').checked;
            const collectsPhone = document.getElementById('collectsPhone').checked;
            const collectsAddress = document.getElementById('collectsAddress').checked;
            const collectsPayment = document.getElementById('collectsPayment').checked;
            const collectsLocation = document.getElementById('collectsLocation').checked;
            const collectsDevice = document.getElementById('collectsDevice').checked;
            const collectsUsage = document.getElementById('collectsUsage').checked;

            const usesCookies = document.getElementById('usesCookies').checked;
            const usesAnalytics = document.getElementById('usesAnalytics').checked;
            const usesAdvertising = document.getElementById('usesAdvertising').checked;
            const usesSocialMedia = document.getElementById('usesSocialMedia').checked;

            const sharesWithProviders = document.getElementById('sharesWithProviders').checked;
            const sharesWithAnalytics = document.getElementById('sharesWithAnalytics').checked;
            const sharesWithPayment = document.getElementById('sharesWithPayment').checked;
            const sharesWithAdvertisers = document.getElementById('sharesWithAdvertisers').checked;
            const sellsData = document.getElementById('sellsData').checked;

            const gdprCompliant = document.getElementById('gdprCompliant').checked;
            const ccpaCompliant = document.getElementById('ccpaCompliant').checked;
            const coppaCompliant = document.getElementById('coppaCompliant').checked;
            const caloppaCompliant = document.getElementById('caloppaCompliant').checked;

            const retentionPeriod = document.getElementById('retentionPeriod').value;
            const usesEncryption = document.getElementById('usesEncryption').checked;
            const lastUpdated = formatDate(document.getElementById('lastUpdated').value);

            // Build data collection list
            let dataList = [];
            if (collectsName) dataList.push('Name (first and last)');
            if (collectsEmail) dataList.push('Email address');
            if (collectsPhone) dataList.push('Phone number');
            if (collectsAddress) dataList.push('Mailing address');
            if (collectsPayment) dataList.push('Payment information (credit card, billing address)');
            if (collectsLocation) dataList.push('Location data (IP address, GPS if permitted)');
            if (collectsDevice) dataList.push('Device information (browser type, operating system, device identifiers)');
            if (collectsUsage) dataList.push('Usage data (pages visited, time spent, clicks, referral source)');

            // Build cookies section
            let cookiesSection = '';
            if (usesCookies) {
                let cookieTypes = [];
                cookieTypes.push('<li><strong>Essential Cookies:</strong> Required for the website to function properly. These cannot be disabled.</li>');
                if (usesAnalytics) cookieTypes.push('<li><strong>Analytics Cookies:</strong> Help us understand how visitors interact with our website by collecting anonymous information.</li>');
                if (usesAdvertising) cookieTypes.push('<li><strong>Advertising Cookies:</strong> Used to deliver relevant advertisements and track ad campaign performance.</li>');
                if (usesSocialMedia) cookieTypes.push('<li><strong>Social Media Cookies:</strong> Enable sharing content on social media platforms and may track your activity.</li>');

                cookiesSection = `
                    <h2>Cookies and Tracking Technologies</h2>
                    <p>We use cookies and similar tracking technologies to collect and store information about your visit. Cookies are small data files stored on your device.</p>
                    <h3>Types of Cookies We Use</h3>
                    <ul>${cookieTypes.join('')}</ul>
                    <p><strong>Managing Cookies:</strong> Most web browsers allow you to control cookies through their settings. You can set your browser to refuse cookies or delete existing cookies. Note that disabling cookies may affect the functionality of our website.</p>
                `;
            }

            // Build third-party sharing section
            let thirdPartyList = [];
            if (sharesWithProviders) thirdPartyList.push('<li><strong>Service Providers:</strong> Companies that provide services on our behalf, such as hosting, email delivery, customer support, and data storage.</li>');
            if (sharesWithAnalytics) thirdPartyList.push('<li><strong>Analytics Partners:</strong> Services like Google Analytics that help us understand website usage and improve our services.</li>');
            if (sharesWithPayment) thirdPartyList.push('<li><strong>Payment Processors:</strong> Third-party payment services (e.g., Stripe, PayPal) that process transactions securely.</li>');
            if (sharesWithAdvertisers) thirdPartyList.push('<li><strong>Advertising Partners:</strong> Companies that help us deliver targeted advertising and measure campaign effectiveness.</li>');

            // GDPR Section
            let gdprSection = '';
            if (gdprCompliant) {
                gdprSection = `
                    <h2>Your Rights Under GDPR (European Union)</h2>
                    <p>If you are located in the European Economic Area (EEA), you have the following rights under the General Data Protection Regulation (GDPR):</p>
                    <ul>
                        <li><strong>Right of Access:</strong> You can request a copy of the personal data we hold about you.</li>
                        <li><strong>Right to Rectification:</strong> You can request correction of inaccurate or incomplete data.</li>
                        <li><strong>Right to Erasure:</strong> You can request deletion of your personal data ("right to be forgotten").</li>
                        <li><strong>Right to Restrict Processing:</strong> You can request that we limit how we use your data.</li>
                        <li><strong>Right to Data Portability:</strong> You can request your data in a structured, machine-readable format.</li>
                        <li><strong>Right to Object:</strong> You can object to processing based on legitimate interests or for direct marketing.</li>
                        <li><strong>Right to Withdraw Consent:</strong> You can withdraw consent at any time for processing based on consent.</li>
                    </ul>
                    <p>To exercise these rights, contact us at <span class="doc-highlight" contenteditable="true" data-field="contactEmail">${contactEmail}</span>. We will respond within 30 days.</p>
                    <p><strong>Legal Basis for Processing:</strong> We process your data based on: (a) your consent; (b) performance of a contract; (c) compliance with legal obligations; or (d) our legitimate interests.</p>
                `;
            }

            // CCPA Section
            let ccpaSection = '';
            if (ccpaCompliant) {
                ccpaSection = `
                    <h2>Your Rights Under CCPA/CPRA (California)</h2>
                    <p>If you are a California resident, you have the following rights under the California Consumer Privacy Act (CCPA) and California Privacy Rights Act (CPRA):</p>
                    <ul>
                        <li><strong>Right to Know:</strong> You can request information about the categories and specific pieces of personal information we collect, use, disclose, and sell.</li>
                        <li><strong>Right to Delete:</strong> You can request deletion of your personal information, subject to certain exceptions.</li>
                        <li><strong>Right to Correct:</strong> You can request correction of inaccurate personal information.</li>
                        <li><strong>Right to Opt-Out:</strong> You can opt out of the sale or sharing of your personal information.</li>
                        <li><strong>Right to Limit Use of Sensitive Information:</strong> You can limit how we use sensitive personal information.</li>
                        <li><strong>Right to Non-Discrimination:</strong> You will not receive discriminatory treatment for exercising your rights.</li>
                    </ul>
                    ${sellsData ? '<p><strong>Notice of Sale:</strong> We may sell or share your personal information with third parties for advertising purposes. To opt out, click "Do Not Sell My Personal Information" or contact us.</p>' : '<p><strong>Notice:</strong> We do not sell your personal information as defined under the CCPA.</p>'}
                    <p>To submit a request, contact us at <span class="doc-highlight" contenteditable="true" data-field="contactEmail">${contactEmail}</span>. We will verify your identity before processing your request.</p>
                `;
            }

            // COPPA Section
            let coppaSection = '';
            if (coppaCompliant) {
                coppaSection = `
                    <h2>Children's Privacy (COPPA)</h2>
                    <p>Our services are not directed to children under 13 years of age. We do not knowingly collect personal information from children under 13. If you are a parent or guardian and believe your child has provided us with personal information, please contact us at <span class="doc-highlight" contenteditable="true" data-field="contactEmail">${contactEmail}</span>.</p>
                    <p>If we learn we have collected personal information from a child under 13, we will promptly delete that information.</p>
                `;
            }

            // CalOPPA Section
            let caloppaSection = '';
            if (caloppaCompliant) {
                caloppaSection = `
                    <h2>Do Not Track Signals</h2>
                    <p>Some browsers offer a "Do Not Track" (DNT) feature that sends a signal to websites you visit indicating you do not want to be tracked. Currently, we ${usesAnalytics || usesAdvertising ? 'do not respond to DNT signals' : 'honor DNT signals and do not track users who have this setting enabled'}.</p>
                `;
            }

            // Retention text
            let retentionText = '';
            switch(retentionPeriod) {
                case 'asNeeded': retentionText = 'as long as necessary to fulfill the purposes for which it was collected and to comply with legal obligations'; break;
                case '1year': retentionText = 'for up to one (1) year after you close your account or cease using our services'; break;
                case '3years': retentionText = 'for up to three (3) years after you close your account or cease using our services'; break;
                case '7years': retentionText = 'for up to seven (7) years to comply with legal, tax, and regulatory requirements'; break;
            }

            const documentHTML = `
                <h1>Privacy Policy</h1>
                <p style="text-align: center; color: var(--text-light);">Last Updated: <span class="doc-highlight" contenteditable="true" data-field="lastUpdated">${lastUpdated}</span></p>

                <h2>Introduction</h2>
                <p><span class="doc-highlight" contenteditable="true" data-field="companyName">${companyName}</span> ("we," "us," or "our") respects your privacy and is committed to protecting the personal information you share with us. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you visit <span class="doc-highlight" contenteditable="true" data-field="websiteUrl">${websiteUrl}</span> and use our services.</p>
                <p>By using our website or services, you agree to the collection and use of information in accordance with this Privacy Policy. If you do not agree, please do not use our services.</p>

                <h2>Information We Collect</h2>
                <h3>Personal Information You Provide</h3>
                <p>We may collect the following types of personal information when you voluntarily provide it:</p>
                <ul>
                    ${dataList.map(item => `<li>${item}</li>`).join('')}
                </ul>

                <h3>Information Collected Automatically</h3>
                <p>When you visit our website, we may automatically collect certain information, including:</p>
                <ul>
                    <li>IP address and approximate location</li>
                    <li>Browser type and version</li>
                    <li>Operating system</li>
                    <li>Pages visited and time spent on each page</li>
                    <li>Referral source (how you arrived at our website)</li>
                    <li>Date and time of your visit</li>
                </ul>

                <h2>How We Use Your Information</h2>
                <p>We use the information we collect for the following purposes:</p>
                <ul>
                    <li>To provide, maintain, and improve our services</li>
                    <li>To process transactions and send related information</li>
                    <li>To send you updates, newsletters, and marketing communications (with your consent)</li>
                    <li>To respond to your comments, questions, and customer service requests</li>
                    <li>To analyze usage patterns and improve user experience</li>
                    <li>To detect, prevent, and address technical issues and security threats</li>
                    <li>To comply with legal obligations</li>
                </ul>

                ${cookiesSection}

                <h2>How We Share Your Information</h2>
                <p>We may share your information with the following types of third parties:</p>
                <ul>
                    ${thirdPartyList.join('')}
                    <li><strong>Legal Requirements:</strong> We may disclose your information if required by law, subpoena, or other legal process, or to protect our rights, privacy, safety, or property.</li>
                    <li><strong>Business Transfers:</strong> In the event of a merger, acquisition, or sale of assets, your information may be transferred to the acquiring entity.</li>
                </ul>
                ${sellsData ? '<p><strong>Sale of Information:</strong> We may sell or share certain personal information with third parties for advertising and marketing purposes. You have the right to opt out of this sale.</p>' : '<p><strong>No Sale of Information:</strong> We do not sell your personal information to third parties.</p>'}

                <h2>Data Security</h2>
                <p>We implement reasonable security measures to protect your personal information from unauthorized access, alteration, disclosure, or destruction. ${usesEncryption ? 'We use industry-standard SSL/TLS encryption to protect data transmitted to and from our website.' : ''}</p>
                <p>However, no method of transmission over the Internet or electronic storage is 100% secure. While we strive to protect your information, we cannot guarantee its absolute security.</p>

                <h2>Data Retention</h2>
                <p>We retain your personal information ${retentionText}. When your information is no longer needed, we will securely delete or anonymize it.</p>

                ${gdprSection}
                ${ccpaSection}
                ${coppaSection}
                ${caloppaSection}

                <h2>Your Choices</h2>
                <p>You have the following choices regarding your information:</p>
                <ul>
                    <li><strong>Account Information:</strong> You may update or correct your account information at any time by logging into your account.</li>
                    <li><strong>Marketing Communications:</strong> You may opt out of receiving marketing emails by clicking the "unsubscribe" link in any email or contacting us.</li>
                    <li><strong>Cookies:</strong> You can control cookies through your browser settings.</li>
                </ul>

                <h2>Third-Party Links</h2>
                <p>Our website may contain links to third-party websites. We are not responsible for the privacy practices of these websites. We encourage you to read the privacy policies of any third-party sites you visit.</p>

                <h2>Changes to This Privacy Policy</h2>
                <p>We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new Privacy Policy on this page and updating the "Last Updated" date. Your continued use of our services after any changes constitutes acceptance of the updated Privacy Policy.</p>

                <h2>Contact Us</h2>
                <p>If you have any questions about this Privacy Policy or our privacy practices, please contact us at:</p>
                <p><span class="doc-highlight" contenteditable="true" data-field="companyName">${companyName}</span><br>
                <span class="doc-highlight" contenteditable="true" data-field="companyAddress">${companyAddress}</span><br>
                Email: <span class="doc-highlight" contenteditable="true" data-field="contactEmail">${contactEmail}</span></p>
            `;

            document.getElementById('documentPreview').innerHTML = documentHTML;
            setupInlineEditing();

            if (lastEditedField) {
                setTimeout(() => {
                    const el = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        el.classList.add('field-highlight-animation');
                        setTimeout(() => el.classList.remove('field-highlight-animation'), 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function setupInlineEditing() {
            document.querySelectorAll('.doc-highlight[data-field]').forEach(field => {
                field.addEventListener('blur', function() {
                    const input = document.getElementById(this.dataset.field);
                    if (input) input.value = this.textContent.trim();
                    hasCustomEdits = true;
                });
            });
        }

        function printDocument() { window.print(); }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const name = document.getElementById('companyName').value.trim() || 'Company';
            const html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>Privacy Policy - ${name}</title>
                <style>body{font-family:'Times New Roman',serif;font-size:12pt;line-height:1.6;margin:1in;}
                h1{text-align:center;font-size:18pt;}h2{font-size:14pt;margin-top:18pt;}h3{font-size:12pt;margin-top:12pt;}
                p{margin-bottom:6pt;text-align:justify;}ul{margin-left:24pt;}
                .doc-highlight{background:none;border:none;padding:0;}</style></head>
                <body>${content}</body></html>`;
            const blob = new Blob([html], { type: 'application/msword' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `Privacy_Policy_${name.replace(/[^a-z0-9]/gi, '_')}.doc`;
            a.click();
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('lastUpdated').value = new Date().toISOString().split('T')[0];
        });
    </script>
</body>
</html>
