<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Independent Contractor Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a professional independent contractor agreement. Customizable template for businesses hiring freelancers and consultants.">
    <link rel="canonical" href="https://templatebuilder.pro/Templates/independent-contractor-agreement-generator.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: #ffffff;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }

        /* Form Panel */
        .form-panel {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .form-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-header h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.25rem;
        }

        .form-header p {
            font-size: 0.85rem;
            color: #64748b;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: #475569;
            margin-bottom: 0.35rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.6rem 0.75rem;
            border: 1.5px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: #475569;
            cursor: pointer;
            padding: 0.4rem 0.6rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: #f1f5f9;
        }

        .checkbox-label input {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .checkbox-label input:checked + span {
            color: #3b82f6;
            font-weight: 500;
        }

        /* Preview Panel */
        .preview-panel {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }

        .preview-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 16px 16px 0 0;
        }

        .preview-title {
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59,130,246,0.35);
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1.5px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .btn-edit {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245,158,11,0.35);
        }

        .btn-edit.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .preview-content {
            padding: 3rem;
            overflow-y: auto;
            flex: 1;
        }

        /* Document Styles */
        .document {
            max-width: 850px;
            margin: 0 auto;
            background: #fff;
            padding: 4rem;
            min-height: 1100px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            border: 1px solid #e5e7eb;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #000;
        }

        .document h1 {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document h2 {
            font-size: 12pt;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
        }

        .document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .document .center {
            text-align: center;
        }

        .document .parties {
            margin: 1.5rem 0;
        }

        .document .parties p {
            margin-bottom: 0.5rem;
        }

        .document .effective-date {
            text-align: center;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .document .clause {
            margin-bottom: 1.25rem;
        }

        .document .sub-clause {
            margin-left: 2rem;
            margin-bottom: 0.75rem;
        }

        .document .signature-block {
            margin-top: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .document .signature-party h3 {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 2rem;
            text-transform: uppercase;
        }

        .document .signature-line {
            border-top: 1px solid #000;
            margin-top: 2.5rem;
            padding-top: 0.35rem;
            font-size: 10pt;
        }

        .document .recitals {
            margin: 1.5rem 0;
            font-style: italic;
        }

        .document .recitals p {
            margin-bottom: 0.5rem;
        }

        .document .schedule {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
        }

        .document .schedule h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 1rem;
            text-transform: uppercase;
            text-align: center;
        }

        /* Highlighting */
        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 0 3px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .doc-highlight:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
        }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245,158,11,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0); }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        @keyframes flashContainer {
            0%, 100% { box-shadow: 0 2px 20px rgba(0,0,0,0.08); }
            50% { box-shadow: 0 0 30px rgba(245,158,11,0.5); }
        }

        .document-flash {
            animation: flashContainer 0.5s ease-out;
        }

        /* Edit Mode Styles */
        .document.edit-mode {
            background: #fffef5;
            border-color: #f59e0b;
        }

        .document.edit-mode .doc-highlight {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            cursor: text;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .form-panel {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }

            .document {
                padding: 2rem;
            }

            .preview-content {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }

            .document, .document * {
                visibility: visible;
            }

            .document {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
                padding: 1in;
            }

            .header, .form-panel, .preview-toolbar {
                display: none !important;
            }
        }

        /* Footer */
        .footer {
            background: #0f172a;
            color: #94a3b8;
            padding: 2rem;
            text-align: center;
            font-size: 0.85rem;
        }

        .footer a {
            color: #60a5fa;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">TemplateBuilder.pro</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Form Panel -->
        <aside class="form-panel">
            <div class="form-header">
                <h1>Independent Contractor Agreement</h1>
                <p>Generate a comprehensive contractor agreement</p>
            </div>

            <!-- Client Information -->
            <div class="form-section">
                <div class="section-title">Client Information</div>
                <div class="form-group">
                    <label for="clientName">Company/Client Name</label>
                    <input type="text" id="clientName" placeholder="Acme Corporation" oninput="trackFieldEdit('clientName')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="clientType">Client Type</label>
                        <select id="clientType" onchange="trackFieldEdit('clientType')">
                            <option value="corporation">Corporation</option>
                            <option value="llc">LLC</option>
                            <option value="partnership">Partnership</option>
                            <option value="sole proprietorship">Sole Proprietorship</option>
                            <option value="individual">Individual</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="clientState">State</label>
                        <select id="clientState" onchange="trackFieldEdit('clientState')">
                            <option value="">Select State</option>
                            <option value="Alabama">Alabama</option>
                            <option value="Alaska">Alaska</option>
                            <option value="Arizona">Arizona</option>
                            <option value="Arkansas">Arkansas</option>
                            <option value="California">California</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Connecticut">Connecticut</option>
                            <option value="Delaware">Delaware</option>
                            <option value="Florida">Florida</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Hawaii">Hawaii</option>
                            <option value="Idaho">Idaho</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Indiana">Indiana</option>
                            <option value="Iowa">Iowa</option>
                            <option value="Kansas">Kansas</option>
                            <option value="Kentucky">Kentucky</option>
                            <option value="Louisiana">Louisiana</option>
                            <option value="Maine">Maine</option>
                            <option value="Maryland">Maryland</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Minnesota">Minnesota</option>
                            <option value="Mississippi">Mississippi</option>
                            <option value="Missouri">Missouri</option>
                            <option value="Montana">Montana</option>
                            <option value="Nebraska">Nebraska</option>
                            <option value="Nevada">Nevada</option>
                            <option value="New Hampshire">New Hampshire</option>
                            <option value="New Jersey">New Jersey</option>
                            <option value="New Mexico">New Mexico</option>
                            <option value="New York">New York</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="North Dakota">North Dakota</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Oklahoma">Oklahoma</option>
                            <option value="Oregon">Oregon</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Rhode Island">Rhode Island</option>
                            <option value="South Carolina">South Carolina</option>
                            <option value="South Dakota">South Dakota</option>
                            <option value="Tennessee">Tennessee</option>
                            <option value="Texas">Texas</option>
                            <option value="Utah">Utah</option>
                            <option value="Vermont">Vermont</option>
                            <option value="Virginia">Virginia</option>
                            <option value="Washington">Washington</option>
                            <option value="West Virginia">West Virginia</option>
                            <option value="Wisconsin">Wisconsin</option>
                            <option value="Wyoming">Wyoming</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="clientAddress">Client Address</label>
                    <input type="text" id="clientAddress" placeholder="123 Business Ave, Suite 100, City, State ZIP" oninput="trackFieldEdit('clientAddress')">
                </div>
                <div class="form-group">
                    <label for="effectiveDate">Effective Date</label>
                    <input type="date" id="effectiveDate" onchange="trackFieldEdit('effectiveDate')">
                </div>
            </div>

            <!-- Contractor Information -->
            <div class="form-section">
                <div class="section-title">Contractor Information</div>
                <div class="form-group">
                    <label for="contractorName">Contractor Name</label>
                    <input type="text" id="contractorName" placeholder="John Smith or Smith Consulting LLC" oninput="trackFieldEdit('contractorName')">
                </div>
                <div class="form-group">
                    <label for="contractorType">Contractor Type</label>
                    <select id="contractorType" onchange="trackFieldEdit('contractorType')">
                        <option value="individual">Individual/Sole Proprietor</option>
                        <option value="llc">LLC</option>
                        <option value="corporation">Corporation</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="contractorAddress">Contractor Address</label>
                    <input type="text" id="contractorAddress" placeholder="456 Main Street, City, State ZIP" oninput="trackFieldEdit('contractorAddress')">
                </div>
            </div>

            <!-- Services -->
            <div class="form-section">
                <div class="section-title">Services & Deliverables</div>
                <div class="form-group">
                    <label for="serviceDescription">Description of Services</label>
                    <textarea id="serviceDescription" rows="3" placeholder="Software development, consulting, design work, etc." oninput="trackFieldEdit('serviceDescription')"></textarea>
                </div>
                <div class="form-group">
                    <label for="deliverables">Specific Deliverables</label>
                    <textarea id="deliverables" rows="3" placeholder="List specific deliverables, milestones, or work products" oninput="trackFieldEdit('deliverables')"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="startDate">Start Date</label>
                        <input type="date" id="startDate" onchange="trackFieldEdit('startDate')">
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date</label>
                        <input type="date" id="endDate" onchange="trackFieldEdit('endDate')">
                    </div>
                </div>
                <div class="form-group">
                    <label for="workLocation">Work Location</label>
                    <select id="workLocation" onchange="trackFieldEdit('workLocation')">
                        <option value="remote">Remote (Contractor's Location)</option>
                        <option value="client-site">Client's Premises</option>
                        <option value="hybrid">Combination/As Needed</option>
                    </select>
                </div>
            </div>

            <!-- Compensation -->
            <div class="form-section">
                <div class="section-title">Compensation</div>
                <div class="form-group">
                    <label for="paymentType">Payment Structure</label>
                    <select id="paymentType" onchange="handlePaymentTypeChange(); trackFieldEdit('paymentType')">
                        <option value="hourly">Hourly Rate</option>
                        <option value="fixed">Fixed Project Fee</option>
                        <option value="retainer">Monthly Retainer</option>
                        <option value="milestone">Milestone-Based</option>
                    </select>
                </div>
                <div class="form-row" id="hourlyFields">
                    <div class="form-group">
                        <label for="hourlyRate">Hourly Rate ($)</label>
                        <input type="text" id="hourlyRate" placeholder="150" oninput="trackFieldEdit('hourlyRate')">
                    </div>
                    <div class="form-group">
                        <label for="maxHours">Max Hours Per Week</label>
                        <input type="text" id="maxHours" placeholder="40" oninput="trackFieldEdit('maxHours')">
                    </div>
                </div>
                <div class="form-group" id="fixedFields" style="display:none;">
                    <label for="fixedAmount">Project Fee ($)</label>
                    <input type="text" id="fixedAmount" placeholder="25,000" oninput="trackFieldEdit('fixedAmount')">
                </div>
                <div class="form-group" id="retainerFields" style="display:none;">
                    <label for="retainerAmount">Monthly Retainer ($)</label>
                    <input type="text" id="retainerAmount" placeholder="5,000" oninput="trackFieldEdit('retainerAmount')">
                </div>
                <div class="form-group" id="milestoneFields" style="display:none;">
                    <label for="milestoneDetails">Milestone Payment Schedule</label>
                    <textarea id="milestoneDetails" rows="3" placeholder="Phase 1: $5,000 upon completion&#10;Phase 2: $10,000 upon completion&#10;Final: $5,000 upon delivery" oninput="trackFieldEdit('milestoneDetails')"></textarea>
                </div>
                <div class="form-group">
                    <label for="paymentTerms">Payment Terms</label>
                    <select id="paymentTerms" onchange="trackFieldEdit('paymentTerms')">
                        <option value="net-15">Net 15</option>
                        <option value="net-30" selected>Net 30</option>
                        <option value="net-45">Net 45</option>
                        <option value="net-60">Net 60</option>
                        <option value="upon-delivery">Upon Delivery</option>
                        <option value="advance">50% Advance, 50% on Completion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="invoiceFrequency">Invoice Frequency</label>
                    <select id="invoiceFrequency" onchange="trackFieldEdit('invoiceFrequency')">
                        <option value="weekly">Weekly</option>
                        <option value="bi-weekly">Bi-Weekly</option>
                        <option value="monthly" selected>Monthly</option>
                        <option value="upon-milestone">Upon Milestone Completion</option>
                        <option value="upon-completion">Upon Project Completion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Expense Reimbursement</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="expenseReimbursement" onchange="trackFieldEdit('expenseReimbursement')">
                            <span>Include Expense Reimbursement</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="expenseDetails" style="display:none;">
                    <label for="expenseLimit">Monthly Expense Limit ($)</label>
                    <input type="text" id="expenseLimit" placeholder="500" oninput="trackFieldEdit('expenseLimit')">
                </div>
            </div>

            <!-- Intellectual Property -->
            <div class="form-section">
                <div class="section-title">Intellectual Property</div>
                <div class="form-group">
                    <label for="ipOwnership">Work Product Ownership</label>
                    <select id="ipOwnership" onchange="trackFieldEdit('ipOwnership')">
                        <option value="client-owns">Client Owns All Work Product</option>
                        <option value="contractor-license">Contractor Retains, Licenses to Client</option>
                        <option value="joint">Joint Ownership</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="priorWork">Pre-Existing Materials</label>
                    <select id="priorWork" onchange="trackFieldEdit('priorWork')">
                        <option value="excluded">Excluded (Contractor Retains)</option>
                        <option value="licensed">Licensed to Client for Project Use</option>
                        <option value="listed">Will be Listed in Schedule</option>
                    </select>
                </div>
            </div>

            <!-- Terms & Conditions -->
            <div class="form-section">
                <div class="section-title">Terms & Conditions</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="confidentiality" onchange="trackFieldEdit('confidentiality')" checked>
                            <span>Confidentiality/NDA</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonCompete" onchange="trackFieldEdit('nonCompete')">
                            <span>Non-Compete</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonSolicitation" onchange="trackFieldEdit('nonSolicitation')">
                            <span>Non-Solicitation</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="indemnification" onchange="trackFieldEdit('indemnification')" checked>
                            <span>Indemnification</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="limitationLiability" onchange="trackFieldEdit('limitationLiability')" checked>
                            <span>Limitation of Liability</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="insurance" onchange="trackFieldEdit('insurance')">
                            <span>Insurance Requirements</span>
                        </label>
                    </div>
                </div>
                <div class="form-row" id="nonCompeteDetails" style="display:none;">
                    <div class="form-group">
                        <label for="nonCompetePeriod">Non-Compete Period</label>
                        <select id="nonCompetePeriod" onchange="trackFieldEdit('nonCompetePeriod')">
                            <option value="6 months">6 Months</option>
                            <option value="1 year" selected>1 Year</option>
                            <option value="2 years">2 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nonCompeteScope">Geographic Scope</label>
                        <input type="text" id="nonCompeteScope" placeholder="United States" oninput="trackFieldEdit('nonCompeteScope')">
                    </div>
                </div>
                <div class="form-group" id="nonSolicitationDetails" style="display:none;">
                    <label for="nonSolicitationPeriod">Non-Solicitation Period</label>
                    <select id="nonSolicitationPeriod" onchange="trackFieldEdit('nonSolicitationPeriod')">
                        <option value="6 months">6 Months</option>
                        <option value="1 year" selected>1 Year</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
                <div class="form-group" id="insuranceDetails" style="display:none;">
                    <label for="insuranceTypes">Required Insurance</label>
                    <input type="text" id="insuranceTypes" placeholder="General Liability ($1M), Professional Liability ($1M)" oninput="trackFieldEdit('insuranceTypes')">
                </div>
            </div>

            <!-- Termination -->
            <div class="form-section">
                <div class="section-title">Termination</div>
                <div class="form-group">
                    <label for="terminationNotice">Termination Notice Period</label>
                    <select id="terminationNotice" onchange="trackFieldEdit('terminationNotice')">
                        <option value="immediate">Immediate (No Notice)</option>
                        <option value="7 days">7 Days</option>
                        <option value="14 days">14 Days</option>
                        <option value="30 days" selected>30 Days</option>
                        <option value="60 days">60 Days</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="terminationForCause">Termination for Cause</label>
                    <select id="terminationForCause" onchange="trackFieldEdit('terminationForCause')">
                        <option value="immediate" selected>Immediate, No Cure Period</option>
                        <option value="cure-7">7-Day Cure Period</option>
                        <option value="cure-14">14-Day Cure Period</option>
                        <option value="cure-30">30-Day Cure Period</option>
                    </select>
                </div>
            </div>

            <!-- Dispute Resolution -->
            <div class="form-section">
                <div class="section-title">Dispute Resolution</div>
                <div class="form-group">
                    <label for="disputeResolution">Resolution Method</label>
                    <select id="disputeResolution" onchange="trackFieldEdit('disputeResolution')">
                        <option value="litigation">Litigation (Court)</option>
                        <option value="arbitration">Binding Arbitration</option>
                        <option value="mediation-then-arbitration">Mediation, then Arbitration</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="governingLaw">Governing Law State</label>
                    <select id="governingLaw" onchange="trackFieldEdit('governingLaw')">
                        <option value="">Same as Client State</option>
                        <option value="Alabama">Alabama</option>
                        <option value="Alaska">Alaska</option>
                        <option value="Arizona">Arizona</option>
                        <option value="Arkansas">Arkansas</option>
                        <option value="California">California</option>
                        <option value="Colorado">Colorado</option>
                        <option value="Connecticut">Connecticut</option>
                        <option value="Delaware">Delaware</option>
                        <option value="Florida">Florida</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Hawaii">Hawaii</option>
                        <option value="Idaho">Idaho</option>
                        <option value="Illinois">Illinois</option>
                        <option value="Indiana">Indiana</option>
                        <option value="Iowa">Iowa</option>
                        <option value="Kansas">Kansas</option>
                        <option value="Kentucky">Kentucky</option>
                        <option value="Louisiana">Louisiana</option>
                        <option value="Maine">Maine</option>
                        <option value="Maryland">Maryland</option>
                        <option value="Massachusetts">Massachusetts</option>
                        <option value="Michigan">Michigan</option>
                        <option value="Minnesota">Minnesota</option>
                        <option value="Mississippi">Mississippi</option>
                        <option value="Missouri">Missouri</option>
                        <option value="Montana">Montana</option>
                        <option value="Nebraska">Nebraska</option>
                        <option value="Nevada">Nevada</option>
                        <option value="New Hampshire">New Hampshire</option>
                        <option value="New Jersey">New Jersey</option>
                        <option value="New Mexico">New Mexico</option>
                        <option value="New York">New York</option>
                        <option value="North Carolina">North Carolina</option>
                        <option value="North Dakota">North Dakota</option>
                        <option value="Ohio">Ohio</option>
                        <option value="Oklahoma">Oklahoma</option>
                        <option value="Oregon">Oregon</option>
                        <option value="Pennsylvania">Pennsylvania</option>
                        <option value="Rhode Island">Rhode Island</option>
                        <option value="South Carolina">South Carolina</option>
                        <option value="South Dakota">South Dakota</option>
                        <option value="Tennessee">Tennessee</option>
                        <option value="Texas">Texas</option>
                        <option value="Utah">Utah</option>
                        <option value="Vermont">Vermont</option>
                        <option value="Virginia">Virginia</option>
                        <option value="Washington">Washington</option>
                        <option value="West Virginia">West Virginia</option>
                        <option value="Wisconsin">Wisconsin</option>
                        <option value="Wyoming">Wyoming</option>
                    </select>
                </div>
            </div>
        </aside>

        <!-- Preview Panel -->
        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-edit" onclick="toggleEditMode()" id="editBtn">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        <span id="editBtnText">Edit Document</span>
                    </button>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview">
                    <!-- Document content will be generated here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; TemplateBuilder.pro. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        // State
        let lastEditedField = null;
        let hasCustomEdits = false;
        let isEditMode = false;

        // Toggle visibility handlers
        document.getElementById('expenseReimbursement').addEventListener('change', function() {
            document.getElementById('expenseDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('nonCompete').addEventListener('change', function() {
            document.getElementById('nonCompeteDetails').style.display = this.checked ? 'flex' : 'none';
        });
        document.getElementById('nonSolicitation').addEventListener('change', function() {
            document.getElementById('nonSolicitationDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('insurance').addEventListener('change', function() {
            document.getElementById('insuranceDetails').style.display = this.checked ? 'block' : 'none';
        });

        function handlePaymentTypeChange() {
            const paymentType = document.getElementById('paymentType').value;
            document.getElementById('hourlyFields').style.display = paymentType === 'hourly' ? 'grid' : 'none';
            document.getElementById('fixedFields').style.display = paymentType === 'fixed' ? 'block' : 'none';
            document.getElementById('retainerFields').style.display = paymentType === 'retainer' ? 'block' : 'none';
            document.getElementById('milestoneFields').style.display = paymentType === 'milestone' ? 'block' : 'none';
        }

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                if (!confirm('Regenerating the document will overwrite your custom edits. Continue?')) {
                    return;
                }
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/[^0-9.]/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        }

        function updatePreview() {
            const clientName = getValue('clientName', '[CLIENT NAME]');
            const clientType = getValue('clientType', 'corporation');
            const clientState = getValue('clientState', '[STATE]');
            const clientAddress = getValue('clientAddress', '[CLIENT ADDRESS]');
            const effectiveDate = formatDate(getValue('effectiveDate'));
            const contractorName = getValue('contractorName', '[CONTRACTOR NAME]');
            const contractorType = getValue('contractorType', 'individual');
            const contractorAddress = getValue('contractorAddress', '[CONTRACTOR ADDRESS]');
            const serviceDescription = getValue('serviceDescription', '[DESCRIPTION OF SERVICES]');
            const deliverables = getValue('deliverables', '[SPECIFIC DELIVERABLES]');
            const startDate = formatDate(getValue('startDate'));
            const endDate = formatDate(getValue('endDate'));
            const workLocation = getValue('workLocation', 'remote');
            const paymentType = getValue('paymentType', 'hourly');
            const paymentTerms = getValue('paymentTerms', 'net-30');
            const invoiceFrequency = getValue('invoiceFrequency', 'monthly');
            const ipOwnership = getValue('ipOwnership', 'client-owns');
            const priorWork = getValue('priorWork', 'excluded');
            const terminationNotice = getValue('terminationNotice', '30 days');
            const terminationForCause = getValue('terminationForCause', 'immediate');
            const disputeResolution = getValue('disputeResolution', 'litigation');
            const governingLaw = getValue('governingLaw') || clientState;

            // Format payment type description
            let compensationText = '';
            if (paymentType === 'hourly') {
                const hourlyRate = formatCurrency(getValue('hourlyRate'));
                const maxHours = getValue('maxHours', '40');
                compensationText = `<span class="doc-highlight" data-field="hourlyRate" contenteditable="true">${hourlyRate}</span> per hour. Contractor shall not exceed <span class="doc-highlight" data-field="maxHours" contenteditable="true">${maxHours}</span> hours per week without prior written approval from Client`;
            } else if (paymentType === 'fixed') {
                const fixedAmount = formatCurrency(getValue('fixedAmount'));
                compensationText = `a fixed project fee of <span class="doc-highlight" data-field="fixedAmount" contenteditable="true">${fixedAmount}</span> for the complete performance of the Services`;
            } else if (paymentType === 'retainer') {
                const retainerAmount = formatCurrency(getValue('retainerAmount'));
                compensationText = `a monthly retainer of <span class="doc-highlight" data-field="retainerAmount" contenteditable="true">${retainerAmount}</span>, payable on the first day of each month`;
            } else if (paymentType === 'milestone') {
                const milestoneDetails = getValue('milestoneDetails', '[MILESTONE DETAILS]');
                compensationText = `milestone-based payments as follows:<br><span class="doc-highlight" data-field="milestoneDetails" contenteditable="true">${milestoneDetails.replace(/\n/g, '<br>')}</span>`;
            }

            // Payment terms text
            const paymentTermsText = {
                'net-15': 'within fifteen (15) days',
                'net-30': 'within thirty (30) days',
                'net-45': 'within forty-five (45) days',
                'net-60': 'within sixty (60) days',
                'upon-delivery': 'upon delivery and acceptance of work',
                'advance': 'fifty percent (50%) in advance and fifty percent (50%) upon completion'
            }[paymentTerms] || 'within thirty (30) days';

            // Invoice frequency text
            const invoiceFrequencyText = {
                'weekly': 'weekly',
                'bi-weekly': 'bi-weekly',
                'monthly': 'monthly',
                'upon-milestone': 'upon completion of each milestone',
                'upon-completion': 'upon project completion'
            }[invoiceFrequency] || 'monthly';

            // Work location text
            const workLocationText = {
                'remote': 'remotely from Contractor\'s own premises',
                'client-site': 'at Client\'s facilities as directed',
                'hybrid': 'at locations as mutually agreed upon by the parties'
            }[workLocation] || 'remotely from Contractor\'s own premises';

            // IP ownership text
            let ipText = '';
            if (ipOwnership === 'client-owns') {
                ipText = `<p class="clause">5.1 <strong>Work Product Assignment.</strong> Contractor agrees that all Work Product shall be considered "work made for hire" as defined by the Copyright Act. To the extent any Work Product does not qualify as work made for hire, Contractor hereby irrevocably assigns to Client all right, title, and interest in and to such Work Product, including all intellectual property rights therein.</p>
                <p class="clause">5.2 <strong>Moral Rights.</strong> To the extent permitted by applicable law, Contractor waives any moral rights in the Work Product and agrees not to assert any such rights against Client or its successors.</p>`;
            } else if (ipOwnership === 'contractor-license') {
                ipText = `<p class="clause">5.1 <strong>Contractor Ownership.</strong> Contractor shall retain all right, title, and interest in and to the Work Product, including all intellectual property rights therein.</p>
                <p class="clause">5.2 <strong>License Grant.</strong> Contractor hereby grants to Client a perpetual, non-exclusive, worldwide, royalty-free license to use, copy, modify, and distribute the Work Product for Client's business purposes.</p>`;
            } else {
                ipText = `<p class="clause">5.1 <strong>Joint Ownership.</strong> The Work Product shall be jointly owned by Client and Contractor, with each party having an undivided interest therein. Either party may use, license, or transfer its interest in the Work Product without accounting to the other party.</p>`;
            }

            // Pre-existing materials text
            let priorWorkText = '';
            if (priorWork === 'excluded') {
                priorWorkText = `<p class="clause">5.3 <strong>Pre-Existing Materials.</strong> Contractor's pre-existing materials, including any proprietary tools, methodologies, or code libraries ("Prior Work"), shall remain the sole property of Contractor and are expressly excluded from this assignment.</p>`;
            } else if (priorWork === 'licensed') {
                priorWorkText = `<p class="clause">5.3 <strong>Pre-Existing Materials.</strong> Contractor's pre-existing materials incorporated into the Work Product ("Prior Work") shall remain Contractor's property, but Contractor hereby grants Client a perpetual, non-exclusive, royalty-free license to use such Prior Work solely as incorporated into the Work Product.</p>`;
            } else {
                priorWorkText = `<p class="clause">5.3 <strong>Pre-Existing Materials.</strong> Any pre-existing materials that Contractor intends to incorporate into the Work Product shall be identified in Schedule A to this Agreement. Such materials shall remain Contractor's property but are licensed to Client for use with the Work Product.</p>`;
            }

            // Optional sections
            let optionalSectionsText = '';
            let sectionNum = 7;

            if (getValue('confidentiality')) {
                optionalSectionsText += `
                <h2>${sectionNum}. CONFIDENTIALITY</h2>
                <p class="clause">${sectionNum}.1 <strong>Confidential Information.</strong> "Confidential Information" means any non-public information disclosed by either party to the other, including but not limited to business plans, customer data, technical information, financial information, and trade secrets.</p>
                <p class="clause">${sectionNum}.2 <strong>Obligations.</strong> Each party agrees to: (a) hold the other party's Confidential Information in strict confidence; (b) not disclose such Confidential Information to any third party without prior written consent; (c) use such Confidential Information only for purposes of this Agreement; and (d) return or destroy all Confidential Information upon termination or request.</p>
                <p class="clause">${sectionNum}.3 <strong>Exceptions.</strong> Confidential Information does not include information that: (a) is or becomes publicly available through no fault of the receiving party; (b) was rightfully known to the receiving party prior to disclosure; (c) is rightfully obtained from a third party without restriction; or (d) is independently developed without use of the disclosing party's Confidential Information.</p>
                <p class="clause">${sectionNum}.4 <strong>Duration.</strong> The obligations of confidentiality shall survive termination of this Agreement for a period of three (3) years.</p>`;
                sectionNum++;
            }

            if (getValue('nonCompete')) {
                const nonCompetePeriod = getValue('nonCompetePeriod', '1 year');
                const nonCompeteScope = getValue('nonCompeteScope', 'the United States');
                optionalSectionsText += `
                <h2>${sectionNum}. NON-COMPETE</h2>
                <p class="clause">${sectionNum}.1 During the term of this Agreement and for a period of <span class="doc-highlight" data-field="nonCompetePeriod" contenteditable="true">${nonCompetePeriod}</span> following termination, Contractor agrees not to directly or indirectly engage in any business that competes with Client's business within <span class="doc-highlight" data-field="nonCompeteScope" contenteditable="true">${nonCompeteScope}</span>.</p>
                <p class="clause">${sectionNum}.2 Contractor acknowledges that this restriction is reasonable and necessary to protect Client's legitimate business interests and that Contractor has received adequate consideration for this covenant.</p>`;
                sectionNum++;
            }

            if (getValue('nonSolicitation')) {
                const nonSolicitationPeriod = getValue('nonSolicitationPeriod', '1 year');
                optionalSectionsText += `
                <h2>${sectionNum}. NON-SOLICITATION</h2>
                <p class="clause">${sectionNum}.1 During the term of this Agreement and for a period of <span class="doc-highlight" data-field="nonSolicitationPeriod" contenteditable="true">${nonSolicitationPeriod}</span> following termination, Contractor agrees not to:</p>
                <p class="sub-clause">(a) Solicit or attempt to solicit any customer, client, or prospective customer of Client with whom Contractor had contact during the term of this Agreement;</p>
                <p class="sub-clause">(b) Solicit, recruit, or hire any employee or contractor of Client.</p>`;
                sectionNum++;
            }

            if (getValue('indemnification')) {
                optionalSectionsText += `
                <h2>${sectionNum}. INDEMNIFICATION</h2>
                <p class="clause">${sectionNum}.1 <strong>Contractor Indemnification.</strong> Contractor shall indemnify, defend, and hold harmless Client and its officers, directors, employees, and agents from and against any and all claims, damages, losses, liabilities, costs, and expenses (including reasonable attorneys' fees) arising out of or relating to: (a) Contractor's breach of this Agreement; (b) Contractor's negligence or willful misconduct; (c) any claim that the Work Product infringes any third-party intellectual property rights; or (d) Contractor's failure to comply with applicable laws.</p>
                <p class="clause">${sectionNum}.2 <strong>Client Indemnification.</strong> Client shall indemnify, defend, and hold harmless Contractor from and against any and all claims, damages, losses, liabilities, costs, and expenses (including reasonable attorneys' fees) arising out of Client's breach of this Agreement or Client's use of the Work Product in a manner not authorized by this Agreement.</p>`;
                sectionNum++;
            }

            if (getValue('limitationLiability')) {
                optionalSectionsText += `
                <h2>${sectionNum}. LIMITATION OF LIABILITY</h2>
                <p class="clause">${sectionNum}.1 <strong>Exclusion of Damages.</strong> IN NO EVENT SHALL EITHER PARTY BE LIABLE TO THE OTHER FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING LOSS OF PROFITS, REVENUE, DATA, OR BUSINESS OPPORTUNITIES, REGARDLESS OF THE CAUSE OF ACTION OR THE FORM OF CLAIM, EVEN IF SUCH PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
                <p class="clause">${sectionNum}.2 <strong>Cap on Liability.</strong> EXCEPT FOR BREACHES OF CONFIDENTIALITY OBLIGATIONS, INDEMNIFICATION OBLIGATIONS, OR GROSS NEGLIGENCE OR WILLFUL MISCONDUCT, EACH PARTY'S TOTAL AGGREGATE LIABILITY UNDER THIS AGREEMENT SHALL NOT EXCEED THE TOTAL FEES PAID OR PAYABLE TO CONTRACTOR UNDER THIS AGREEMENT DURING THE TWELVE (12) MONTHS PRECEDING THE CLAIM.</p>`;
                sectionNum++;
            }

            if (getValue('insurance')) {
                const insuranceTypes = getValue('insuranceTypes', 'General Liability ($1,000,000 per occurrence)');
                optionalSectionsText += `
                <h2>${sectionNum}. INSURANCE</h2>
                <p class="clause">${sectionNum}.1 Contractor shall maintain the following insurance coverage during the term of this Agreement: <span class="doc-highlight" data-field="insuranceTypes" contenteditable="true">${insuranceTypes}</span>.</p>
                <p class="clause">${sectionNum}.2 Upon request, Contractor shall provide Client with certificates of insurance evidencing such coverage and naming Client as an additional insured.</p>`;
                sectionNum++;
            }

            // Expense reimbursement
            let expenseText = '';
            if (getValue('expenseReimbursement')) {
                const expenseLimit = formatCurrency(getValue('expenseLimit'));
                expenseText = `<p class="clause">3.4 <strong>Expense Reimbursement.</strong> Client shall reimburse Contractor for pre-approved, reasonable expenses incurred in connection with the Services, up to a maximum of <span class="doc-highlight" data-field="expenseLimit" contenteditable="true">${expenseLimit}</span> per month. Contractor shall submit receipts and documentation for all expenses.</p>`;
            }

            // Termination for cause text
            const causeText = {
                'immediate': 'immediately upon written notice',
                'cure-7': 'upon written notice if such breach is not cured within seven (7) days of notice',
                'cure-14': 'upon written notice if such breach is not cured within fourteen (14) days of notice',
                'cure-30': 'upon written notice if such breach is not cured within thirty (30) days of notice'
            }[terminationForCause] || 'immediately upon written notice';

            // Dispute resolution text
            let disputeText = '';
            if (disputeResolution === 'litigation') {
                disputeText = `Any dispute arising out of or relating to this Agreement shall be resolved exclusively in the state or federal courts located in <span class="doc-highlight" data-field="governingLaw" contenteditable="true">${governingLaw}</span>, and each party consents to the personal jurisdiction of such courts.`;
            } else if (disputeResolution === 'arbitration') {
                disputeText = `Any dispute arising out of or relating to this Agreement shall be resolved by binding arbitration administered by the American Arbitration Association in accordance with its Commercial Arbitration Rules. The arbitration shall take place in <span class="doc-highlight" data-field="governingLaw" contenteditable="true">${governingLaw}</span>, and the arbitrator's decision shall be final and binding.`;
            } else {
                disputeText = `Any dispute arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful within thirty (30) days, the dispute shall be resolved by binding arbitration administered by the American Arbitration Association in <span class="doc-highlight" data-field="governingLaw" contenteditable="true">${governingLaw}</span>.`;
            }

            const clientTypeText = {
                'corporation': 'a corporation organized under the laws of',
                'llc': 'a limited liability company organized under the laws of',
                'partnership': 'a partnership organized under the laws of',
                'sole proprietorship': 'a sole proprietorship doing business in',
                'individual': 'an individual residing in'
            }[clientType] || 'a corporation organized under the laws of';

            const contractorTypeText = {
                'individual': 'an individual',
                'llc': 'a limited liability company',
                'corporation': 'a corporation'
            }[contractorType] || 'an individual';

            const html = `
                <h1>INDEPENDENT CONTRACTOR AGREEMENT</h1>

                <p class="effective-date">Effective Date: <span class="doc-highlight" data-field="effectiveDate" contenteditable="true">${effectiveDate}</span></p>

                <div class="parties">
                    <p>This Independent Contractor Agreement ("Agreement") is entered into by and between:</p>
                    <p><strong>CLIENT:</strong> <span class="doc-highlight" data-field="clientName" contenteditable="true">${clientName}</span>, ${clientTypeText} <span class="doc-highlight" data-field="clientState" contenteditable="true">${clientState}</span>, with its principal place of business at <span class="doc-highlight" data-field="clientAddress" contenteditable="true">${clientAddress}</span> ("Client")</p>
                    <p><strong>CONTRACTOR:</strong> <span class="doc-highlight" data-field="contractorName" contenteditable="true">${contractorName}</span>, ${contractorTypeText}, with an address at <span class="doc-highlight" data-field="contractorAddress" contenteditable="true">${contractorAddress}</span> ("Contractor")</p>
                </div>

                <div class="recitals">
                    <p><strong>RECITALS</strong></p>
                    <p>WHEREAS, Client desires to engage Contractor to perform certain services, and Contractor desires to perform such services for Client, on the terms and conditions set forth herein;</p>
                    <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements contained herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>
                </div>

                <h2>1. ENGAGEMENT AND SERVICES</h2>
                <p class="clause">1.1 <strong>Engagement.</strong> Client hereby engages Contractor, and Contractor hereby accepts engagement, to perform the services described in this Agreement ("Services").</p>
                <p class="clause">1.2 <strong>Description of Services.</strong> Contractor shall provide the following services: <span class="doc-highlight" data-field="serviceDescription" contenteditable="true">${serviceDescription}</span></p>
                <p class="clause">1.3 <strong>Deliverables.</strong> Contractor shall deliver the following work products ("Deliverables" or "Work Product"): <span class="doc-highlight" data-field="deliverables" contenteditable="true">${deliverables}</span></p>
                <p class="clause">1.4 <strong>Term.</strong> This Agreement shall commence on <span class="doc-highlight" data-field="startDate" contenteditable="true">${startDate}</span> and shall continue until <span class="doc-highlight" data-field="endDate" contenteditable="true">${endDate}</span>, unless earlier terminated in accordance with the terms of this Agreement.</p>
                <p class="clause">1.5 <strong>Location.</strong> Contractor shall perform the Services <span class="doc-highlight" data-field="workLocation" contenteditable="true">${workLocationText}</span>.</p>

                <h2>2. INDEPENDENT CONTRACTOR STATUS</h2>
                <p class="clause">2.1 <strong>Independent Contractor.</strong> Contractor is an independent contractor and not an employee, agent, joint venturer, or partner of Client. Nothing in this Agreement shall be construed to create an employment relationship between Client and Contractor.</p>
                <p class="clause">2.2 <strong>No Authority.</strong> Contractor has no authority to bind Client or to enter into any agreement on Client's behalf. Contractor shall not represent to any third party that Contractor has any such authority.</p>
                <p class="clause">2.3 <strong>Control.</strong> Contractor shall have sole control over the manner and means of performing the Services, including the time, place, and method of performance. Client's only interest is in the results of the Services.</p>
                <p class="clause">2.4 <strong>Benefits.</strong> Contractor is not entitled to any employee benefits from Client, including but not limited to health insurance, retirement benefits, paid time off, or workers' compensation coverage.</p>
                <p class="clause">2.5 <strong>Taxes.</strong> Contractor is solely responsible for all federal, state, and local taxes arising from compensation received under this Agreement, including self-employment taxes. Contractor shall complete and provide Client with IRS Form W-9 (or applicable substitute form) prior to receiving any payment.</p>

                <h2>3. COMPENSATION</h2>
                <p class="clause">3.1 <strong>Fees.</strong> In consideration for the Services, Client shall pay Contractor ${compensationText}.</p>
                <p class="clause">3.2 <strong>Invoicing.</strong> Contractor shall submit invoices to Client <span class="doc-highlight" data-field="invoiceFrequency" contenteditable="true">${invoiceFrequencyText}</span>. Each invoice shall itemize the Services performed and hours worked (if applicable).</p>
                <p class="clause">3.3 <strong>Payment.</strong> Client shall pay all undisputed invoices <span class="doc-highlight" data-field="paymentTerms" contenteditable="true">${paymentTermsText}</span> of receipt. Late payments shall bear interest at the rate of 1.5% per month or the maximum rate permitted by law, whichever is less.</p>
                ${expenseText}

                <h2>4. CONTRACTOR'S REPRESENTATIONS AND WARRANTIES</h2>
                <p class="clause">4.1 Contractor represents and warrants that:</p>
                <p class="sub-clause">(a) Contractor has the right, power, and authority to enter into this Agreement and perform the Services;</p>
                <p class="sub-clause">(b) The Services will be performed in a professional, workmanlike manner in accordance with industry standards;</p>
                <p class="sub-clause">(c) The Work Product will be original and will not infringe upon any third-party intellectual property rights;</p>
                <p class="sub-clause">(d) Contractor has all licenses, permits, and qualifications required to perform the Services;</p>
                <p class="sub-clause">(e) Contractor is not bound by any agreement that would prevent Contractor from performing the Services or would create a conflict of interest.</p>

                <h2>5. INTELLECTUAL PROPERTY</h2>
                ${ipText}
                ${priorWorkText}
                <p class="clause">5.4 <strong>Assistance.</strong> Contractor agrees to execute any documents and take any actions reasonably requested by Client to perfect, register, or enforce Client's rights in the Work Product.</p>

                <h2>6. TERMINATION</h2>
                <p class="clause">6.1 <strong>Termination for Convenience.</strong> Either party may terminate this Agreement for any reason upon <span class="doc-highlight" data-field="terminationNotice" contenteditable="true">${terminationNotice}</span> prior written notice to the other party.</p>
                <p class="clause">6.2 <strong>Termination for Cause.</strong> Either party may terminate this Agreement <span class="doc-highlight" data-field="terminationForCause" contenteditable="true">${causeText}</span> for material breach by the other party.</p>
                <p class="clause">6.3 <strong>Effect of Termination.</strong> Upon termination:</p>
                <p class="sub-clause">(a) Contractor shall deliver to Client all Work Product completed to date and all Client materials in Contractor's possession;</p>
                <p class="sub-clause">(b) Client shall pay Contractor for all Services satisfactorily performed and all approved expenses incurred through the date of termination;</p>
                <p class="sub-clause">(c) All provisions that by their nature should survive termination shall survive, including confidentiality, intellectual property, indemnification, and limitation of liability.</p>

                ${optionalSectionsText}

                <h2>${sectionNum}. DISPUTE RESOLUTION</h2>
                <p class="clause">${disputeText}</p>

                <h2>${sectionNum + 1}. GENERAL PROVISIONS</h2>
                <p class="clause"><strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight" data-field="governingLaw" contenteditable="true">${governingLaw}</span>, without regard to its conflicts of law principles.</p>
                <p class="clause"><strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning its subject matter and supersedes all prior agreements and understandings, whether written or oral.</p>
                <p class="clause"><strong>Amendment.</strong> This Agreement may not be amended except by a written instrument signed by both parties.</p>
                <p class="clause"><strong>Waiver.</strong> No waiver of any provision of this Agreement shall be effective unless in writing, and no waiver shall be construed as a waiver of any other provision or of any subsequent breach.</p>
                <p class="clause"><strong>Severability.</strong> If any provision of this Agreement is held to be invalid or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                <p class="clause"><strong>Assignment.</strong> Contractor may not assign or transfer this Agreement or any rights or obligations hereunder without Client's prior written consent. Client may assign this Agreement to any successor to all or substantially all of its business or assets.</p>
                <p class="clause"><strong>Notices.</strong> All notices under this Agreement shall be in writing and shall be deemed given when delivered personally, sent by confirmed email, or sent by certified mail, return receipt requested, to the addresses set forth above.</p>
                <p class="clause"><strong>Counterparts.</strong> This Agreement may be executed in counterparts, each of which shall be deemed an original and all of which together shall constitute one and the same instrument.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Client</h3>
                        <p><span class="doc-highlight" data-field="clientName" contenteditable="true">${clientName}</span></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Contractor</h3>
                        <p><span class="doc-highlight" data-field="contractorName" contenteditable="true">${contractorName}</span></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title (if applicable)</div>
                        <div class="signature-line">Date</div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;

            // Add inline editing listeners
            document.querySelectorAll('.doc-highlight[contenteditable="true"]').forEach(el => {
                el.addEventListener('input', function() {
                    hasCustomEdits = true;
                    const fieldId = this.getAttribute('data-field');
                    const inputEl = document.getElementById(fieldId);
                    if (inputEl && inputEl.tagName !== 'SELECT') {
                        inputEl.value = this.textContent;
                    }
                });
            });

            // Scroll to and highlight edited field
            if (lastEditedField) {
                setTimeout(() => {
                    const el = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        el.classList.add('field-highlight-animation');
                        const doc = document.getElementById('documentPreview');
                        doc.classList.add('document-flash');
                        setTimeout(() => {
                            el.classList.remove('field-highlight-animation');
                            doc.classList.remove('document-flash');
                        }, 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            const doc = document.getElementById('documentPreview');
            const btn = document.getElementById('editBtn');
            const btnText = document.getElementById('editBtnText');

            if (isEditMode) {
                doc.classList.add('edit-mode');
                doc.setAttribute('contenteditable', 'true');
                btn.classList.add('active');
                btnText.textContent = 'Done Editing';
                hasCustomEdits = true;
            } else {
                doc.classList.remove('edit-mode');
                doc.setAttribute('contenteditable', 'false');
                btn.classList.remove('active');
                btnText.textContent = 'Edit Document';
            }
        }

        function printDocument() {
            window.print();
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const contractorName = getValue('contractorName', 'Contractor');
            const clientName = getValue('clientName', 'Client');

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; max-width: 8.5in; margin: 1in auto; }
                        h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; }
                        h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
                        p { margin-bottom: 1rem; text-align: justify; }
                        .center { text-align: center; }
                        .effective-date { text-align: center; font-style: italic; margin-bottom: 2rem; }
                        .parties { margin: 1.5rem 0; }
                        .parties p { margin-bottom: 0.5rem; }
                        .clause { margin-bottom: 1.25rem; }
                        .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
                        .signature-block { margin-top: 3rem; display: flex; justify-content: space-between; }
                        .signature-party { width: 45%; }
                        .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
                        .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
                        .doc-highlight { background-color: #fff; }
                        .recitals { margin: 1.5rem 0; font-style: italic; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Independent Contractor Agreement - ${contractorName} - ${clientName}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;
            document.getElementById('startDate').value = today;

            // Set end date to 1 year from now
            const endDate = new Date();
            endDate.setFullYear(endDate.getFullYear() + 1);
            document.getElementById('endDate').value = endDate.toISOString().split('T')[0];

            updatePreview();
        });
    </script>
</body>
</html>
