<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commission Agreement Generator | Sales Commission Contract Template</title>
    <meta name="description" content="Generate a professional sales commission agreement. Define commission rates, payment terms, and sales territories for employees or independent sales reps.">
    <link rel="canonical" href="https://terms.law/Templates/commission-agreement-generator.html">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is a commission agreement?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "A commission agreement is a legally binding contract between an employer (or company) and a salesperson that outlines the terms of commission-based compensation. It specifies how commissions are calculated, when they are earned, payment schedules, and other terms governing the sales relationship. This agreement protects both parties by clearly defining expectations and compensation structures."
                }
            },
            {
                "@type": "Question",
                "name": "What should a sales commission agreement include?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "A comprehensive sales commission agreement should include: the commission rate or structure (flat, tiered, or draw-based), the basis for calculating commissions (gross sales, net sales, or collected revenue), when commissions are considered earned, payment frequency and timing, territory or account assignments, clawback provisions for returns or cancellations, termination terms, and dispute resolution procedures."
                }
            },
            {
                "@type": "Question",
                "name": "How are commissions typically calculated?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Commissions are typically calculated using one of several methods: a flat percentage of sales (e.g., 10% of all sales), tiered structures where rates increase at higher sales volumes, base salary plus commission combinations, or draw against commission arrangements. The calculation may be based on gross sales, net sales (after returns and discounts), collected revenue, or gross profit margin, depending on what the agreement specifies."
                }
            },
            {
                "@type": "Question",
                "name": "When are commissions paid?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Commission payment timing varies by agreement but commonly occurs monthly, semi-monthly, bi-weekly, or quarterly. Commissions are typically paid within 15-30 days after the end of each commission period. The agreement should specify when commissions are 'earned' - whether at contract signing, when payment is received from the customer, when products are shipped, or when services are performed."
                }
            },
            {
                "@type": "Question",
                "name": "Can commission rates be changed after signing?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Commission rates generally cannot be changed unilaterally after signing without both parties agreeing to the modification. Most commission agreements include an amendment clause requiring written consent from both parties to modify terms. However, some agreements may include provisions allowing the company to adjust rates prospectively with advance notice. Any changes typically apply only to future sales, not to commissions already earned."
                }
            },
            {
                "@type": "Question",
                "name": "What happens to commissions if an employee leaves?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "When a salesperson leaves, they are typically entitled to receive commissions on all sales that were 'earned' (as defined in the agreement) before their termination date. Most agreements specify that commissions on sales closed after termination are not owed, regardless of when the sales process began. Some agreements include provisions for partial commissions on pipeline deals that close shortly after departure, and any unrecovered draws may need to be repaid depending on the agreement terms."
                }
            }
        ]
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 1rem 2rem; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo-link { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; }
        .logo { font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .nav-links { display: flex; gap: 2rem; align-items: center; }
        .nav-links a { color: #94a3b8; text-decoration: none; font-size: 0.95rem; transition: color 0.2s; }
        .nav-links a:hover { color: #ffffff; }
        .main-container { display: grid; grid-template-columns: 420px 1fr; gap: 2rem; max-width: 1600px; margin: 0 auto; padding: 2rem; min-height: calc(100vh - 80px); }
        .form-panel { background: #ffffff; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); height: fit-content; position: sticky; top: 100px; max-height: calc(100vh - 120px); overflow-y: auto; }
        .form-header { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
        .form-header h1 { font-size: 1.25rem; font-weight: 700; color: #0f172a; margin-bottom: 0.25rem; }
        .form-header p { font-size: 0.85rem; color: #64748b; }
        .form-section { margin-bottom: 1.5rem; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: #374151; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .section-title::before { content: ''; width: 3px; height: 16px; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); border-radius: 2px; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 500; color: #475569; margin-bottom: 0.35rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.6rem 0.75rem; border: 1.5px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; transition: all 0.2s; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .checkbox-label { display: flex; align-items: center; gap: 0.4rem; font-size: 0.8rem; color: #475569; cursor: pointer; padding: 0.4rem 0.6rem; border: 1px solid #e2e8f0; border-radius: 6px; transition: all 0.2s; }
        .checkbox-label:hover { background: #f1f5f9; }
        .checkbox-label input { width: 14px; height: 14px; cursor: pointer; }
        .checkbox-label input:checked + span { color: #3b82f6; font-weight: 500; }
        .info-box { background: #dbeafe; border: 1px solid #3b82f6; border-radius: 8px; padding: 0.75rem; font-size: 0.8rem; color: #1e40af; margin-bottom: 1rem; }
        .preview-panel { background: #ffffff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: flex; flex-direction: column; }
        .preview-toolbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e2e8f0; background: #f8fafc; border-radius: 16px 16px 0 0; }
        .preview-title { font-weight: 600; color: #374151; display: flex; align-items: center; gap: 0.5rem; }
        .preview-actions { display: flex; gap: 0.75rem; }
        .btn { padding: 0.6rem 1.25rem; border-radius: 8px; font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; display: flex; align-items: center; gap: 0.5rem; }
        .btn-primary { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59,130,246,0.35); }
        .btn-secondary { background: #ffffff; color: #374151; border: 1.5px solid #e2e8f0; }
        .btn-secondary:hover { background: #f1f5f9; border-color: #cbd5e1; }
        .preview-content { padding: 3rem; overflow-y: auto; flex: 1; }
        .document { max-width: 850px; margin: 0 auto; background: #fff; padding: 4rem; min-height: 1100px; box-shadow: 0 2px 20px rgba(0,0,0,0.08); border: 1px solid #e5e7eb; font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; }
        .document h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .document h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
        .document p { margin-bottom: 1rem; text-align: justify; }
        .document .center { text-align: center; }
        .document .parties { margin: 1.5rem 0; }
        .document .parties p { margin-bottom: 0.5rem; }
        .document .effective-date { text-align: center; margin-bottom: 2rem; font-style: italic; }
        .document .clause { margin-bottom: 1.25rem; }
        .document .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
        .document .signature-block { margin-top: 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; }
        .document .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
        .document .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
        .document table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        .document table th, .document table td { border: 1px solid #000; padding: 8px; text-align: left; }
        .document table th { background: #f3f4f6; font-weight: bold; }
        .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 0 3px; border-radius: 3px; transition: all 0.3s ease; }
        .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
        @media (max-width: 1200px) { .main-container { grid-template-columns: 1fr; } .form-panel { position: relative; top: 0; max-height: none; } }
        @media (max-width: 768px) { .main-container { padding: 1rem; } .document { padding: 2rem; } .preview-content { padding: 1rem; } .nav-links { display: none; } }
        @media print { body * { visibility: hidden; } .document, .document * { visibility: visible; } .document { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: none; padding: 1in; } .header, .form-panel, .preview-toolbar { display: none !important; } }
        .footer { background: #0f172a; color: #94a3b8; padding: 2rem; text-align: center; font-size: 0.85rem; }
        .footer a { color: #60a5fa; text-decoration: none; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">Terms.Law</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <aside class="form-panel">
            <div class="form-header">
                <h1>Commission Agreement</h1>
                <p>Sales commission structure and payment terms</p>
            </div>

            <div class="info-box">
                <strong>Clear Commission Terms Prevent Disputes</strong><br>
                Define exactly when commissions are earned, how they're calculated, and when they're paid to avoid misunderstandings.
            </div>

            <!-- Company Information -->
            <div class="form-section">
                <div class="section-title">Company Information</div>
                <div class="form-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" id="companyName" placeholder="Sales Corp, Inc." oninput="updatePreview()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="companyState">State</label>
                        <select id="companyState" onchange="updatePreview()">
                            <option value="">Select State</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Texas">Texas</option>
                            <option value="Florida">Florida</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Georgia">Georgia</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" onchange="updatePreview()">
                    </div>
                </div>
                <div class="form-group">
                    <label for="companyAddress">Company Address</label>
                    <input type="text" id="companyAddress" placeholder="123 Commerce Street, Suite 200, City, State ZIP" oninput="updatePreview()">
                </div>
            </div>

            <!-- Salesperson Information -->
            <div class="form-section">
                <div class="section-title">Salesperson Information</div>
                <div class="form-group">
                    <label for="salespersonName">Salesperson Name</label>
                    <input type="text" id="salespersonName" placeholder="Jane Sales" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="salespersonType">Relationship Type</label>
                    <select id="salespersonType" onchange="updatePreview()">
                        <option value="employee">Employee</option>
                        <option value="contractor">Independent Contractor</option>
                        <option value="agent">Sales Agent</option>
                        <option value="rep">Sales Representative</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="salespersonAddress">Address</label>
                    <input type="text" id="salespersonAddress" placeholder="456 Sales Avenue, City, State ZIP" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="jobTitle">Title/Role</label>
                    <input type="text" id="jobTitle" placeholder="Regional Sales Manager" oninput="updatePreview()">
                </div>
            </div>

            <!-- Commission Structure -->
            <div class="form-section">
                <div class="section-title">Commission Structure</div>
                <div class="form-group">
                    <label for="commissionType">Commission Type</label>
                    <select id="commissionType" onchange="handleCommissionTypeChange(); updatePreview()">
                        <option value="flat">Flat Percentage</option>
                        <option value="tiered">Tiered/Graduated</option>
                        <option value="split">Base + Commission</option>
                        <option value="draw">Draw Against Commission</option>
                    </select>
                </div>

                <div id="flatCommissionSection">
                    <div class="form-group">
                        <label for="flatRate">Commission Rate (%)</label>
                        <input type="number" id="flatRate" placeholder="10" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                </div>

                <div id="tieredCommissionSection" style="display: none;">
                    <div class="form-group">
                        <label for="tier1Threshold">Tier 1: Up to ($)</label>
                        <input type="text" id="tier1Threshold" placeholder="50,000" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="tier1Rate">Tier 1 Rate (%)</label>
                        <input type="number" id="tier1Rate" placeholder="5" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="tier2Threshold">Tier 2: Up to ($)</label>
                        <input type="text" id="tier2Threshold" placeholder="100,000" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="tier2Rate">Tier 2 Rate (%)</label>
                        <input type="number" id="tier2Rate" placeholder="8" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="tier3Rate">Tier 3 Rate (Above) (%)</label>
                        <input type="number" id="tier3Rate" placeholder="12" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                </div>

                <div id="splitCommissionSection" style="display: none;">
                    <div class="form-group">
                        <label for="baseSalary">Base Salary (Annual)</label>
                        <input type="text" id="baseSalary" placeholder="50,000" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="splitRate">Commission Rate (%)</label>
                        <input type="number" id="splitRate" placeholder="5" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                </div>

                <div id="drawCommissionSection" style="display: none;">
                    <div class="form-group">
                        <label for="drawAmount">Monthly Draw Amount</label>
                        <input type="text" id="drawAmount" placeholder="3,000" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="drawRate">Commission Rate (%)</label>
                        <input type="number" id="drawRate" placeholder="10" min="0" max="100" step="0.5" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="drawType">Draw Type</label>
                        <select id="drawType" onchange="updatePreview()">
                            <option value="recoverable">Recoverable (Must Repay)</option>
                            <option value="non-recoverable">Non-Recoverable (Guaranteed)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Commission Terms -->
            <div class="form-section">
                <div class="section-title">Payment Terms</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="commissionBasis">Commission Based On</label>
                        <select id="commissionBasis" onchange="updatePreview()">
                            <option value="gross-sales">Gross Sales</option>
                            <option value="net-sales">Net Sales</option>
                            <option value="collected">Collected Revenue</option>
                            <option value="profit">Gross Profit</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="paymentFrequency">Payment Frequency</label>
                        <select id="paymentFrequency" onchange="updatePreview()">
                            <option value="monthly">Monthly</option>
                            <option value="semi-monthly">Semi-Monthly</option>
                            <option value="bi-weekly">Bi-Weekly</option>
                            <option value="quarterly">Quarterly</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="earnedWhen">Commission Earned When</label>
                    <select id="earnedWhen" onchange="updatePreview()">
                        <option value="sale-closed">Sale Closed/Contract Signed</option>
                        <option value="payment-received">Payment Received from Customer</option>
                        <option value="product-shipped">Product Shipped/Delivered</option>
                        <option value="service-performed">Service Performed</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentTiming">Payment Timing</label>
                    <select id="paymentTiming" onchange="updatePreview()">
                        <option value="15">15 Days After Period End</option>
                        <option value="30">30 Days After Period End</option>
                        <option value="next-payroll">Next Regular Payroll</option>
                    </select>
                </div>
            </div>

            <!-- Territory & Products -->
            <div class="form-section">
                <div class="section-title">Territory & Products</div>
                <div class="form-group">
                    <label for="territoryType">Territory</label>
                    <select id="territoryType" onchange="handleTerritoryChange(); updatePreview()">
                        <option value="none">No Specific Territory</option>
                        <option value="exclusive">Exclusive Territory</option>
                        <option value="non-exclusive">Non-Exclusive Territory</option>
                    </select>
                </div>
                <div class="form-group" id="territoryDetails" style="display: none;">
                    <label for="territoryDescription">Territory Description</label>
                    <input type="text" id="territoryDescription" placeholder="Western United States, including CA, OR, WA, NV, AZ" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="productsServices">Products/Services Covered</label>
                    <textarea id="productsServices" rows="2" placeholder="All software products and professional services offered by Company" oninput="updatePreview()"></textarea>
                </div>
            </div>

            <!-- Additional Terms -->
            <div class="form-section">
                <div class="section-title">Additional Terms</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeQuota" onchange="toggleQuota(); updatePreview()">
                            <span>Sales Quota</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeClawback" onchange="updatePreview()" checked>
                            <span>Clawback</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeAcceleration" onchange="updatePreview()">
                            <span>Accelerators</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeCap" onchange="toggleCap(); updatePreview()">
                            <span>Commission Cap</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="quotaSection" style="display: none;">
                    <label for="quotaAmount">Quarterly Quota ($)</label>
                    <input type="text" id="quotaAmount" placeholder="100,000" oninput="updatePreview()">
                </div>
                <div class="form-group" id="capSection" style="display: none;">
                    <label for="capAmount">Annual Commission Cap ($)</label>
                    <input type="text" id="capAmount" placeholder="200,000" oninput="updatePreview()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="termLength">Agreement Term</label>
                        <select id="termLength" onchange="updatePreview()">
                            <option value="at-will">At-Will (No Fixed Term)</option>
                            <option value="1-year">1 Year</option>
                            <option value="2-year">2 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="terminationNotice">Termination Notice</label>
                        <select id="terminationNotice" onchange="updatePreview()">
                            <option value="immediate">None Required</option>
                            <option value="14">14 Days</option>
                            <option value="30">30 Days</option>
                        </select>
                    </div>
                </div>
            </div>
        </aside>

        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; Terms.Law. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        function handleCommissionTypeChange() {
            const type = document.getElementById('commissionType').value;
            document.getElementById('flatCommissionSection').style.display = type === 'flat' ? 'block' : 'none';
            document.getElementById('tieredCommissionSection').style.display = type === 'tiered' ? 'block' : 'none';
            document.getElementById('splitCommissionSection').style.display = type === 'split' ? 'block' : 'none';
            document.getElementById('drawCommissionSection').style.display = type === 'draw' ? 'block' : 'none';
        }

        function handleTerritoryChange() {
            const type = document.getElementById('territoryType').value;
            document.getElementById('territoryDetails').style.display = type !== 'none' ? 'block' : 'none';
        }

        function toggleQuota() {
            document.getElementById('quotaSection').style.display = document.getElementById('includeQuota').checked ? 'block' : 'none';
        }

        function toggleCap() {
            document.getElementById('capSection').style.display = document.getElementById('includeCap').checked ? 'block' : 'none';
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/[^0-9.]/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US');
        }

        function updatePreview() {
            const companyName = getValue('companyName', '[COMPANY NAME]');
            const companyState = getValue('companyState', '[STATE]');
            const companyAddress = getValue('companyAddress', '[COMPANY ADDRESS]');
            const effectiveDate = formatDate(getValue('effectiveDate'));
            const salespersonName = getValue('salespersonName', '[SALESPERSON NAME]');
            const salespersonType = getValue('salespersonType', 'employee');
            const salespersonAddress = getValue('salespersonAddress', '[SALESPERSON ADDRESS]');
            const jobTitle = getValue('jobTitle', '[TITLE]');
            const commissionType = getValue('commissionType', 'flat');
            const commissionBasis = getValue('commissionBasis', 'gross-sales');
            const paymentFrequency = getValue('paymentFrequency', 'monthly');
            const earnedWhen = getValue('earnedWhen', 'sale-closed');
            const paymentTiming = getValue('paymentTiming', '15');
            const termLength = getValue('termLength', 'at-will');
            const terminationNotice = getValue('terminationNotice', 'immediate');

            const typeLabel = {
                'employee': 'Employee',
                'contractor': 'Independent Contractor',
                'agent': 'Sales Agent',
                'rep': 'Sales Representative'
            }[salespersonType] || 'Salesperson';

            const basisText = {
                'gross-sales': 'gross sales revenue',
                'net-sales': 'net sales revenue (after returns, discounts, and allowances)',
                'collected': 'collected revenue (payments actually received from customers)',
                'profit': 'gross profit margin'
            }[commissionBasis] || 'sales';

            const earnedText = {
                'sale-closed': 'the sale is closed and a binding contract is executed with the customer',
                'payment-received': 'payment is received from the customer',
                'product-shipped': 'the product is shipped or delivered to the customer',
                'service-performed': 'the service is performed and accepted by the customer'
            }[earnedWhen] || 'the sale is completed';

            const frequencyText = {
                'monthly': 'monthly',
                'semi-monthly': 'semi-monthly (twice per month)',
                'bi-weekly': 'bi-weekly (every two weeks)',
                'quarterly': 'quarterly'
            }[paymentFrequency] || 'monthly';

            // Build commission structure description
            let commissionStructure = '';
            if (commissionType === 'flat') {
                const rate = getValue('flatRate', '[RATE]');
                commissionStructure = `
                    <p class="clause"><strong>Commission Rate:</strong> Salesperson shall earn a commission of <span class="doc-highlight">${rate}%</span> of ${basisText} for all qualifying sales.</p>
                `;
            } else if (commissionType === 'tiered') {
                const t1 = formatCurrency(getValue('tier1Threshold'));
                const t1r = getValue('tier1Rate', '[RATE]');
                const t2 = formatCurrency(getValue('tier2Threshold'));
                const t2r = getValue('tier2Rate', '[RATE]');
                const t3r = getValue('tier3Rate', '[RATE]');
                commissionStructure = `
                    <p class="clause"><strong>Tiered Commission Structure:</strong></p>
                    <table>
                        <tr><th>Sales Volume</th><th>Commission Rate</th></tr>
                        <tr><td>$0 - <span class="doc-highlight">${t1}</span></td><td><span class="doc-highlight">${t1r}%</span></td></tr>
                        <tr><td><span class="doc-highlight">${t1}</span> - <span class="doc-highlight">${t2}</span></td><td><span class="doc-highlight">${t2r}%</span></td></tr>
                        <tr><td>Above <span class="doc-highlight">${t2}</span></td><td><span class="doc-highlight">${t3r}%</span></td></tr>
                    </table>
                    <p class="clause">Commission tiers reset at the beginning of each calendar year.</p>
                `;
            } else if (commissionType === 'split') {
                const base = formatCurrency(getValue('baseSalary'));
                const rate = getValue('splitRate', '[RATE]');
                commissionStructure = `
                    <p class="clause"><strong>Base Salary:</strong> Salesperson shall receive a base salary of <span class="doc-highlight">${base}</span> per year, payable in accordance with Company's standard payroll schedule.</p>
                    <p class="clause"><strong>Commission Rate:</strong> In addition to base salary, Salesperson shall earn a commission of <span class="doc-highlight">${rate}%</span> of ${basisText} for all qualifying sales.</p>
                `;
            } else if (commissionType === 'draw') {
                const draw = formatCurrency(getValue('drawAmount'));
                const rate = getValue('drawRate', '[RATE]');
                const drawType = getValue('drawType', 'recoverable');
                const drawTypeText = drawType === 'recoverable'
                    ? 'The draw is recoverable, meaning any unearned draw amounts will be deducted from future commission payments. Upon termination, Salesperson shall repay any outstanding draw balance within thirty (30) days.'
                    : 'The draw is non-recoverable, meaning Salesperson is guaranteed to receive the draw amount regardless of commission earnings.';
                commissionStructure = `
                    <p class="clause"><strong>Draw Against Commission:</strong> Salesperson shall receive a monthly draw of <span class="doc-highlight">${draw}</span> against commissions earned.</p>
                    <p class="clause"><strong>Commission Rate:</strong> Salesperson shall earn a commission of <span class="doc-highlight">${rate}%</span> of ${basisText} for all qualifying sales.</p>
                    <p class="clause"><strong>Draw Terms:</strong> ${drawTypeText}</p>
                `;
            }

            // Territory section
            let territorySection = '';
            const territoryType = getValue('territoryType');
            if (territoryType !== 'none') {
                const territoryDesc = getValue('territoryDescription', '[TERRITORY DESCRIPTION]');
                const exclusiveText = territoryType === 'exclusive'
                    ? 'Company grants Salesperson an exclusive territory for sales activities. Company will not engage other salespersons to solicit sales within this territory during the term of this Agreement.'
                    : 'Company grants Salesperson a non-exclusive territory for sales activities. Company reserves the right to engage other salespersons in this territory.';
                territorySection = `
                    <h2>4. TERRITORY</h2>
                    <p class="clause">4.1 <strong>Defined Territory:</strong> Salesperson's territory shall include: <span class="doc-highlight">${territoryDesc}</span></p>
                    <p class="clause">4.2 <strong>Exclusivity:</strong> ${exclusiveText}</p>
                `;
            }

            // Additional sections
            let additionalSections = '';
            let sectionNum = territoryType !== 'none' ? 5 : 4;

            // Quota section
            if (getValue('includeQuota')) {
                const quota = formatCurrency(getValue('quotaAmount'));
                additionalSections += `
                    <h2>${sectionNum}. SALES QUOTA</h2>
                    <p class="clause">${sectionNum}.1 Salesperson shall have a minimum quarterly sales quota of <span class="doc-highlight">${quota}</span>.</p>
                    <p class="clause">${sectionNum}.2 Failure to meet quota for two consecutive quarters may result in termination of this Agreement or modification of commission terms at Company's discretion.</p>
                `;
                sectionNum++;
            }

            // Clawback section
            if (getValue('includeClawback')) {
                additionalSections += `
                    <h2>${sectionNum}. CLAWBACK AND ADJUSTMENTS</h2>
                    <p class="clause">${sectionNum}.1 <strong>Returns and Cancellations:</strong> If a customer returns products, cancels an order, or receives a refund within ninety (90) days of purchase, the commission paid on such sale shall be deducted from future commission payments.</p>
                    <p class="clause">${sectionNum}.2 <strong>Chargebacks:</strong> If a customer disputes a charge or initiates a chargeback, the commission paid on such sale shall be recovered from Salesperson.</p>
                    <p class="clause">${sectionNum}.3 <strong>Bad Debt:</strong> If a customer fails to pay within one hundred eighty (180) days and the account is written off as bad debt, any commission paid on such sale shall be deducted from future payments.</p>
                `;
                sectionNum++;
            }

            // Acceleration section
            if (getValue('includeAcceleration')) {
                additionalSections += `
                    <h2>${sectionNum}. PERFORMANCE ACCELERATORS</h2>
                    <p class="clause">${sectionNum}.1 <strong>Quota Achievement Bonus:</strong> If Salesperson achieves 100% of quota, Salesperson shall receive an additional 2% commission on all sales above quota for that period.</p>
                    <p class="clause">${sectionNum}.2 <strong>Overachievement:</strong> If Salesperson achieves 150% of quota, the commission rate on sales above 150% shall increase by an additional 3%.</p>
                `;
                sectionNum++;
            }

            // Cap section
            if (getValue('includeCap')) {
                const cap = formatCurrency(getValue('capAmount'));
                additionalSections += `
                    <h2>${sectionNum}. COMMISSION CAP</h2>
                    <p class="clause">${sectionNum}.1 Total commissions paid to Salesperson in any calendar year shall not exceed <span class="doc-highlight">${cap}</span>.</p>
                    <p class="clause">${sectionNum}.2 Once the cap is reached, Salesperson shall continue to perform duties but will not earn additional commissions until the next calendar year.</p>
                `;
                sectionNum++;
            }

            // Term and termination
            let termText = '';
            if (termLength === 'at-will') {
                termText = 'This Agreement shall continue until terminated by either party.';
            } else {
                const years = termLength === '1-year' ? 'one (1) year' : 'two (2) years';
                termText = `This Agreement shall have an initial term of ${years} from the Effective Date and shall automatically renew for successive one-year periods unless terminated.`;
            }

            let noticeText = '';
            if (terminationNotice === 'immediate') {
                noticeText = 'Either party may terminate this Agreement at any time, with or without cause, without prior notice.';
            } else {
                noticeText = `Either party may terminate this Agreement by providing ${terminationNotice} days' written notice to the other party.`;
            }

            // Products/Services
            const productsServices = getValue('productsServices', 'all products and services offered by Company');

            // Generate full document
            const html = `
                <h1>Sales Commission Agreement</h1>
                <p class="effective-date">Effective Date: <span class="doc-highlight">${effectiveDate}</span></p>

                <div class="parties">
                    <p>This Sales Commission Agreement ("Agreement") is entered into by and between:</p>
                    <p><strong>Company:</strong> <span class="doc-highlight">${companyName}</span>, with its principal place of business at <span class="doc-highlight">${companyAddress}</span> ("Company"); and</p>
                    <p><strong>Salesperson:</strong> <span class="doc-highlight">${salespersonName}</span>, residing at <span class="doc-highlight">${salespersonAddress}</span>, serving as <span class="doc-highlight">${jobTitle}</span> ("Salesperson").</p>
                </div>

                <p class="center"><strong>RECITALS</strong></p>
                <p><strong>WHEREAS,</strong> Company desires to engage Salesperson to sell Company's products and services; and</p>
                <p><strong>WHEREAS,</strong> Salesperson desires to sell Company's products and services in exchange for commission compensation;</p>
                <p><strong>NOW, THEREFORE,</strong> in consideration of the mutual promises contained herein, the parties agree as follows:</p>

                <h2>1. APPOINTMENT AND RELATIONSHIP</h2>
                <p class="clause">1.1 Company hereby appoints Salesperson as a${salespersonType === 'contractor' ? 'n independent contractor' : salespersonType === 'employee' ? 'n employee' : ' sales representative'} to sell Company's products and services.</p>
                <p class="clause">1.2 <strong>Products/Services:</strong> This Agreement covers sales of <span class="doc-highlight">${productsServices}</span>.</p>
                <p class="clause">1.3 Salesperson agrees to use best efforts to promote and sell Company's products and services in a professional manner consistent with Company's standards and policies.</p>

                <h2>2. COMMISSION STRUCTURE</h2>
                ${commissionStructure}
                <p class="clause"><strong>Commission Basis:</strong> Commissions shall be calculated based on ${basisText}.</p>

                <h2>3. WHEN COMMISSIONS ARE EARNED AND PAID</h2>
                <p class="clause">3.1 <strong>When Earned:</strong> A commission is earned when ${earnedText}.</p>
                <p class="clause">3.2 <strong>Payment Frequency:</strong> Earned commissions shall be paid ${frequencyText}.</p>
                <p class="clause">3.3 <strong>Payment Timing:</strong> Commission payments shall be made within ${paymentTiming === 'next-payroll' ? 'the next regular payroll cycle' : paymentTiming + ' days'} after the end of each commission period.</p>
                <p class="clause">3.4 <strong>Commission Statements:</strong> Company shall provide Salesperson with a detailed commission statement showing all sales, calculations, and any adjustments for each payment period.</p>

                ${territorySection}

                ${additionalSections}

                <h2>${sectionNum}. TERM AND TERMINATION</h2>
                <p class="clause">${sectionNum}.1 <strong>Term:</strong> ${termText}</p>
                <p class="clause">${sectionNum}.2 <strong>Termination:</strong> ${noticeText}</p>
                <p class="clause">${sectionNum}.3 <strong>Effect of Termination:</strong> Upon termination, Salesperson shall be entitled to receive commissions on all sales that were earned (as defined in Section 3.1) prior to the termination date. Salesperson shall not be entitled to commissions on sales closed after the termination date, regardless of when the sales process began.</p>
                <p class="clause">${sectionNum}.4 <strong>Pipeline Deals:</strong> For deals in progress at termination where Salesperson made substantial contribution, Company may, in its sole discretion, pay a partial commission if the deal closes within sixty (60) days of termination.</p>

                <h2>${sectionNum + 1}. GENERAL PROVISIONS</h2>
                <p class="clause">${sectionNum + 1}.1 <strong>Independent Review:</strong> Salesperson acknowledges having had the opportunity to review this Agreement and consult with independent legal counsel.</p>
                <p class="clause">${sectionNum + 1}.2 <strong>Entire Agreement:</strong> This Agreement constitutes the entire agreement between the parties regarding commission compensation and supersedes all prior agreements.</p>
                <p class="clause">${sectionNum + 1}.3 <strong>Amendment:</strong> This Agreement may only be amended by a written instrument signed by both parties.</p>
                <p class="clause">${sectionNum + 1}.4 <strong>Governing Law:</strong> This Agreement shall be governed by the laws of the State of <span class="doc-highlight">${companyState}</span>.</p>
                <p class="clause">${sectionNum + 1}.5 <strong>Severability:</strong> If any provision of this Agreement is held invalid, the remaining provisions shall continue in full force and effect.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Company</h3>
                        <p><strong><span class="doc-highlight">${companyName}</span></strong></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Salesperson</h3>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line"><span class="doc-highlight">${salespersonName}</span></div>
                        <div class="signature-line">Date</div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const html = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'>
                <head><meta charset="utf-8"><title>Commission Agreement</title>
                <style>
                    body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.6; }
                    h1 { text-align: center; font-size: 18pt; text-transform: uppercase; }
                    h2 { font-size: 12pt; text-transform: uppercase; margin-top: 18pt; }
                    p { margin-bottom: 12pt; text-align: justify; }
                    table { width: 100%; border-collapse: collapse; margin: 12pt 0; }
                    th, td { border: 1px solid black; padding: 6pt; text-align: left; }
                    th { background-color: #f3f4f6; }
                    .signature-block { margin-top: 36pt; }
                    .signature-line { border-top: 1px solid black; margin-top: 30pt; padding-top: 4pt; }
                </style></head>
                <body>${content}</body></html>
            `;
            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Commission-Agreement.doc';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;
            updatePreview();
        });
    </script>
</body>
</html>
