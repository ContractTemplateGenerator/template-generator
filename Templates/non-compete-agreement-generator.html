<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Non-Compete Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a professional non-compete agreement. Customizable template for employers protecting business interests with enforceable restrictive covenants.">
    <link rel="canonical" href="https://templatebuilder.pro/Templates/non-compete-agreement-generator.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: #ffffff;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }

        /* Form Panel */
        .form-panel {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .form-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-header h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.25rem;
        }

        .form-header p {
            font-size: 0.85rem;
            color: #64748b;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: #475569;
            margin-bottom: 0.35rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.6rem 0.75rem;
            border: 1.5px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: #475569;
            cursor: pointer;
            padding: 0.4rem 0.6rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: #f1f5f9;
        }

        .checkbox-label input {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .checkbox-label input:checked + span {
            color: #3b82f6;
            font-weight: 500;
        }

        .warning-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.8rem;
            color: #92400e;
            margin-bottom: 1rem;
        }

        .warning-box strong {
            display: block;
            margin-bottom: 0.25rem;
        }

        /* Preview Panel */
        .preview-panel {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }

        .preview-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 16px 16px 0 0;
        }

        .preview-title {
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59,130,246,0.35);
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1.5px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .btn-edit {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245,158,11,0.35);
        }

        .btn-edit.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .preview-content {
            padding: 3rem;
            overflow-y: auto;
            flex: 1;
        }

        /* Document Styles */
        .document {
            max-width: 850px;
            margin: 0 auto;
            background: #fff;
            padding: 4rem;
            min-height: 1100px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            border: 1px solid #e5e7eb;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #000;
        }

        .document h1 {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document h2 {
            font-size: 12pt;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
        }

        .document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .document .center {
            text-align: center;
        }

        .document .parties {
            margin: 1.5rem 0;
        }

        .document .parties p {
            margin-bottom: 0.5rem;
        }

        .document .effective-date {
            text-align: center;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .document .clause {
            margin-bottom: 1.25rem;
        }

        .document .sub-clause {
            margin-left: 2rem;
            margin-bottom: 0.75rem;
        }

        .document .signature-block {
            margin-top: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .document .signature-party h3 {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 2rem;
            text-transform: uppercase;
        }

        .document .signature-line {
            border-top: 1px solid #000;
            margin-top: 2.5rem;
            padding-top: 0.35rem;
            font-size: 10pt;
        }

        .document .recitals {
            margin: 1.5rem 0;
            font-style: italic;
        }

        .document .recitals p {
            margin-bottom: 0.5rem;
        }

        /* Highlighting */
        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 0 3px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .doc-highlight:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
        }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245,158,11,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0); }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        @keyframes flashContainer {
            0%, 100% { box-shadow: 0 2px 20px rgba(0,0,0,0.08); }
            50% { box-shadow: 0 0 30px rgba(245,158,11,0.5); }
        }

        .document-flash {
            animation: flashContainer 0.5s ease-out;
        }

        /* Edit Mode Styles */
        .document.edit-mode {
            background: #fffef5;
            border-color: #f59e0b;
        }

        .document.edit-mode .doc-highlight {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            cursor: text;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .form-panel {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }

            .document {
                padding: 2rem;
            }

            .preview-content {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }

            .document, .document * {
                visibility: visible;
            }

            .document {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
                padding: 1in;
            }

            .header, .form-panel, .preview-toolbar {
                display: none !important;
            }
        }

        /* Footer */
        .footer {
            background: #0f172a;
            color: #94a3b8;
            padding: 2rem;
            text-align: center;
            font-size: 0.85rem;
        }

        .footer a {
            color: #60a5fa;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">TemplateBuilder.pro</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Form Panel -->
        <aside class="form-panel">
            <div class="form-header">
                <h1>Non-Compete Agreement</h1>
                <p>Generate a restrictive covenant agreement</p>
            </div>

            <div class="warning-box">
                <strong>Important Legal Notice</strong>
                Non-compete agreements are subject to varying state laws. Some states (e.g., California, North Dakota, Oklahoma) largely prohibit non-competes. Always consult with a licensed attorney in your jurisdiction.
            </div>

            <!-- Employer Information -->
            <div class="form-section">
                <div class="section-title">Employer Information</div>
                <div class="form-group">
                    <label for="employerName">Company Name</label>
                    <input type="text" id="employerName" placeholder="Acme Corporation" oninput="trackFieldEdit('employerName')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employerState">State</label>
                        <select id="employerState" onchange="trackFieldEdit('employerState')">
                            <option value="">Select State</option>
                            <option value="Alabama">Alabama</option>
                            <option value="Alaska">Alaska</option>
                            <option value="Arizona">Arizona</option>
                            <option value="Arkansas">Arkansas</option>
                            <option value="California">California</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Connecticut">Connecticut</option>
                            <option value="Delaware">Delaware</option>
                            <option value="Florida">Florida</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Hawaii">Hawaii</option>
                            <option value="Idaho">Idaho</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Indiana">Indiana</option>
                            <option value="Iowa">Iowa</option>
                            <option value="Kansas">Kansas</option>
                            <option value="Kentucky">Kentucky</option>
                            <option value="Louisiana">Louisiana</option>
                            <option value="Maine">Maine</option>
                            <option value="Maryland">Maryland</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Minnesota">Minnesota</option>
                            <option value="Mississippi">Mississippi</option>
                            <option value="Missouri">Missouri</option>
                            <option value="Montana">Montana</option>
                            <option value="Nebraska">Nebraska</option>
                            <option value="Nevada">Nevada</option>
                            <option value="New Hampshire">New Hampshire</option>
                            <option value="New Jersey">New Jersey</option>
                            <option value="New Mexico">New Mexico</option>
                            <option value="New York">New York</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="North Dakota">North Dakota</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Oklahoma">Oklahoma</option>
                            <option value="Oregon">Oregon</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Rhode Island">Rhode Island</option>
                            <option value="South Carolina">South Carolina</option>
                            <option value="South Dakota">South Dakota</option>
                            <option value="Tennessee">Tennessee</option>
                            <option value="Texas">Texas</option>
                            <option value="Utah">Utah</option>
                            <option value="Vermont">Vermont</option>
                            <option value="Virginia">Virginia</option>
                            <option value="Washington">Washington</option>
                            <option value="West Virginia">West Virginia</option>
                            <option value="Wisconsin">Wisconsin</option>
                            <option value="Wyoming">Wyoming</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" onchange="trackFieldEdit('effectiveDate')">
                    </div>
                </div>
                <div class="form-group">
                    <label for="employerAddress">Company Address</label>
                    <input type="text" id="employerAddress" placeholder="123 Business Ave, Suite 100, City, State ZIP" oninput="trackFieldEdit('employerAddress')">
                </div>
                <div class="form-group">
                    <label for="businessDescription">Business Description</label>
                    <textarea id="businessDescription" rows="2" placeholder="Software development and technology consulting services" oninput="trackFieldEdit('businessDescription')"></textarea>
                </div>
            </div>

            <!-- Employee Information -->
            <div class="form-section">
                <div class="section-title">Employee/Contractor Information</div>
                <div class="form-group">
                    <label for="employeeName">Individual Name</label>
                    <input type="text" id="employeeName" placeholder="John Smith" oninput="trackFieldEdit('employeeName')">
                </div>
                <div class="form-group">
                    <label for="employeeType">Relationship Type</label>
                    <select id="employeeType" onchange="trackFieldEdit('employeeType')">
                        <option value="employee">Employee</option>
                        <option value="contractor">Independent Contractor</option>
                        <option value="consultant">Consultant</option>
                        <option value="partner">Business Partner</option>
                        <option value="seller">Seller (Business Sale)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="employeeAddress">Address</label>
                    <input type="text" id="employeeAddress" placeholder="456 Main Street, City, State ZIP" oninput="trackFieldEdit('employeeAddress')">
                </div>
                <div class="form-group">
                    <label for="jobTitle">Position/Title</label>
                    <input type="text" id="jobTitle" placeholder="Senior Software Engineer" oninput="trackFieldEdit('jobTitle')">
                </div>
            </div>

            <!-- Consideration -->
            <div class="form-section">
                <div class="section-title">Consideration</div>
                <div class="form-group">
                    <label for="considerationType">Type of Consideration</label>
                    <select id="considerationType" onchange="handleConsiderationChange(); trackFieldEdit('considerationType')">
                        <option value="employment">Initial Employment</option>
                        <option value="continued-employment">Continued Employment</option>
                        <option value="promotion">Promotion/Raise</option>
                        <option value="bonus">Signing Bonus</option>
                        <option value="stock">Stock Options/Equity</option>
                        <option value="business-sale">Business Sale Proceeds</option>
                        <option value="other">Other Compensation</option>
                    </select>
                </div>
                <div class="form-group" id="considerationDetails" style="display:none;">
                    <label for="considerationAmount">Consideration Details</label>
                    <input type="text" id="considerationAmount" placeholder="$10,000 signing bonus" oninput="trackFieldEdit('considerationAmount')">
                </div>
            </div>

            <!-- Non-Compete Terms -->
            <div class="form-section">
                <div class="section-title">Non-Compete Restrictions</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="restrictionPeriod">Restriction Period</label>
                        <select id="restrictionPeriod" onchange="trackFieldEdit('restrictionPeriod')">
                            <option value="6 months">6 Months</option>
                            <option value="1 year" selected>1 Year</option>
                            <option value="18 months">18 Months</option>
                            <option value="2 years">2 Years</option>
                            <option value="3 years">3 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="geographicScope">Geographic Scope</label>
                        <select id="geographicScope" onchange="handleGeographicChange(); trackFieldEdit('geographicScope')">
                            <option value="radius">Mile Radius</option>
                            <option value="county">County</option>
                            <option value="state">State(s)</option>
                            <option value="region">Region</option>
                            <option value="national">National</option>
                            <option value="custom">Custom Area</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" id="radiusDetails">
                    <label for="radiusMiles">Radius (Miles)</label>
                    <input type="text" id="radiusMiles" placeholder="25" oninput="trackFieldEdit('radiusMiles')">
                </div>
                <div class="form-group" id="customGeoDetails" style="display:none;">
                    <label for="customGeography">Geographic Description</label>
                    <input type="text" id="customGeography" placeholder="State of Texas and all contiguous states" oninput="trackFieldEdit('customGeography')">
                </div>
                <div class="form-group">
                    <label for="prohibitedActivities">Prohibited Activities</label>
                    <textarea id="prohibitedActivities" rows="3" placeholder="Engaging in software development, technology consulting, or similar services for competing businesses" oninput="trackFieldEdit('prohibitedActivities')"></textarea>
                </div>
                <div class="form-group">
                    <label for="competitorDefinition">Definition of Competitor</label>
                    <textarea id="competitorDefinition" rows="2" placeholder="Any business that provides software development, consulting, or technology services" oninput="trackFieldEdit('competitorDefinition')"></textarea>
                </div>
            </div>

            <!-- Additional Covenants -->
            <div class="form-section">
                <div class="section-title">Additional Restrictions</div>
                <div class="form-group">
                    <label>Include These Covenants</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonSolicitation" onchange="trackFieldEdit('nonSolicitation')" checked>
                            <span>Non-Solicitation (Customers)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonRecruitment" onchange="trackFieldEdit('nonRecruitment')" checked>
                            <span>Non-Recruitment (Employees)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="confidentiality" onchange="trackFieldEdit('confidentiality')" checked>
                            <span>Confidentiality</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonDisparagement" onchange="trackFieldEdit('nonDisparagement')">
                            <span>Non-Disparagement</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="solicitationDetails">
                    <label for="solicitationPeriod">Non-Solicitation Period</label>
                    <select id="solicitationPeriod" onchange="trackFieldEdit('solicitationPeriod')">
                        <option value="same as non-compete">Same as Non-Compete</option>
                        <option value="6 months">6 Months</option>
                        <option value="1 year">1 Year</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
                <div class="form-group" id="recruitmentDetails">
                    <label for="recruitmentPeriod">Non-Recruitment Period</label>
                    <select id="recruitmentPeriod" onchange="trackFieldEdit('recruitmentPeriod')">
                        <option value="same as non-compete">Same as Non-Compete</option>
                        <option value="6 months">6 Months</option>
                        <option value="1 year">1 Year</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
            </div>

            <!-- Enforcement -->
            <div class="form-section">
                <div class="section-title">Enforcement & Remedies</div>
                <div class="form-group">
                    <label>Remedies Available</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="injunctiveRelief" onchange="trackFieldEdit('injunctiveRelief')" checked>
                            <span>Injunctive Relief</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="monetaryDamages" onchange="trackFieldEdit('monetaryDamages')" checked>
                            <span>Monetary Damages</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="liquidatedDamages" onchange="trackFieldEdit('liquidatedDamages')">
                            <span>Liquidated Damages</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="attorneyFees" onchange="trackFieldEdit('attorneyFees')" checked>
                            <span>Attorney's Fees</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="liquidatedDetails" style="display:none;">
                    <label for="liquidatedAmount">Liquidated Damages Amount</label>
                    <input type="text" id="liquidatedAmount" placeholder="$50,000" oninput="trackFieldEdit('liquidatedAmount')">
                </div>
                <div class="form-group">
                    <label for="disputeResolution">Dispute Resolution</label>
                    <select id="disputeResolution" onchange="trackFieldEdit('disputeResolution')">
                        <option value="litigation" selected>Litigation (Court)</option>
                        <option value="arbitration">Binding Arbitration</option>
                        <option value="mediation-first">Mediation, then Litigation</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Additional Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="gardenLeave" onchange="trackFieldEdit('gardenLeave')">
                            <span>Garden Leave</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="blueÐŸencil" onchange="trackFieldEdit('bluePencil')" checked>
                            <span>Blue Pencil Clause</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="tolling" onchange="trackFieldEdit('tolling')" checked>
                            <span>Tolling (Pause for Breach)</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="gardenLeaveDetails" style="display:none;">
                    <label for="gardenLeavePeriod">Garden Leave Period</label>
                    <input type="text" id="gardenLeavePeriod" placeholder="30 days with full pay" oninput="trackFieldEdit('gardenLeavePeriod')">
                </div>
            </div>
        </aside>

        <!-- Preview Panel -->
        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-edit" onclick="toggleEditMode()" id="editBtn">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        <span id="editBtnText">Edit Document</span>
                    </button>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview">
                    <!-- Document content will be generated here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; TemplateBuilder.pro. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        // State
        let lastEditedField = null;
        let hasCustomEdits = false;
        let isEditMode = false;

        // Toggle visibility handlers
        document.getElementById('nonSolicitation').addEventListener('change', function() {
            document.getElementById('solicitationDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('nonRecruitment').addEventListener('change', function() {
            document.getElementById('recruitmentDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('liquidatedDamages').addEventListener('change', function() {
            document.getElementById('liquidatedDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('gardenLeave').addEventListener('change', function() {
            document.getElementById('gardenLeaveDetails').style.display = this.checked ? 'block' : 'none';
        });

        function handleConsiderationChange() {
            const type = document.getElementById('considerationType').value;
            const showDetails = ['bonus', 'stock', 'other', 'promotion'].includes(type);
            document.getElementById('considerationDetails').style.display = showDetails ? 'block' : 'none';
        }

        function handleGeographicChange() {
            const scope = document.getElementById('geographicScope').value;
            document.getElementById('radiusDetails').style.display = scope === 'radius' ? 'block' : 'none';
            document.getElementById('customGeoDetails').style.display = ['state', 'region', 'custom'].includes(scope) ? 'block' : 'none';
        }

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                if (!confirm('Regenerating the document will overwrite your custom edits. Continue?')) {
                    return;
                }
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[EFFECTIVE DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/[^0-9.]/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        }

        function updatePreview() {
            const employerName = getValue('employerName', '[EMPLOYER NAME]');
            const employerState = getValue('employerState', '[STATE]');
            const employerAddress = getValue('employerAddress', '[EMPLOYER ADDRESS]');
            const businessDescription = getValue('businessDescription', '[BUSINESS DESCRIPTION]');
            const effectiveDate = formatDate(getValue('effectiveDate'));
            const employeeName = getValue('employeeName', '[EMPLOYEE/CONTRACTOR NAME]');
            const employeeType = getValue('employeeType', 'employee');
            const employeeAddress = getValue('employeeAddress', '[EMPLOYEE ADDRESS]');
            const jobTitle = getValue('jobTitle', '[POSITION/TITLE]');
            const considerationType = getValue('considerationType', 'employment');
            const restrictionPeriod = getValue('restrictionPeriod', '1 year');
            const geographicScope = getValue('geographicScope', 'radius');
            const prohibitedActivities = getValue('prohibitedActivities', '[PROHIBITED ACTIVITIES]');
            const competitorDefinition = getValue('competitorDefinition', '[COMPETITOR DEFINITION]');
            const disputeResolution = getValue('disputeResolution', 'litigation');

            // Build geographic description
            let geographicText = '';
            if (geographicScope === 'radius') {
                const miles = getValue('radiusMiles', '25');
                geographicText = `within a <span class="doc-highlight" data-field="radiusMiles" contenteditable="true">${miles}</span>-mile radius of any location where Employer conducts business`;
            } else if (geographicScope === 'county') {
                geographicText = `within the county where Employer\'s principal place of business is located and all contiguous counties`;
            } else if (geographicScope === 'national') {
                geographicText = `anywhere within the United States`;
            } else {
                const customGeo = getValue('customGeography', '[GEOGRAPHIC AREA]');
                geographicText = `within <span class="doc-highlight" data-field="customGeography" contenteditable="true">${customGeo}</span>`;
            }

            // Consideration text
            let considerationText = '';
            if (considerationType === 'employment') {
                considerationText = 'the offer of employment and the compensation and benefits provided therewith';
            } else if (considerationType === 'continued-employment') {
                considerationText = 'continued employment and the compensation and benefits associated therewith';
            } else if (considerationType === 'promotion') {
                const amount = getValue('considerationAmount', '[PROMOTION/RAISE DETAILS]');
                considerationText = `the promotion/raise described as: <span class="doc-highlight" data-field="considerationAmount" contenteditable="true">${amount}</span>`;
            } else if (considerationType === 'bonus') {
                const amount = getValue('considerationAmount', '[BONUS AMOUNT]');
                considerationText = `a signing bonus of <span class="doc-highlight" data-field="considerationAmount" contenteditable="true">${amount}</span>`;
            } else if (considerationType === 'stock') {
                const amount = getValue('considerationAmount', '[EQUITY DETAILS]');
                considerationText = `stock options/equity grants as follows: <span class="doc-highlight" data-field="considerationAmount" contenteditable="true">${amount}</span>`;
            } else if (considerationType === 'business-sale') {
                considerationText = 'the purchase price and other valuable consideration received in connection with the sale of the business';
            } else {
                const amount = getValue('considerationAmount', '[CONSIDERATION DETAILS]');
                considerationText = `<span class="doc-highlight" data-field="considerationAmount" contenteditable="true">${amount}</span>`;
            }

            // Employee type text
            const employeeTypeText = {
                'employee': 'an employee',
                'contractor': 'an independent contractor',
                'consultant': 'a consultant',
                'partner': 'a business partner',
                'seller': 'a seller of the business'
            }[employeeType] || 'an employee';

            // Build optional sections
            let optionalSections = '';
            let sectionNum = 3;

            if (getValue('nonSolicitation')) {
                const solicitationPeriod = getValue('solicitationPeriod', 'same as non-compete');
                const periodText = solicitationPeriod === 'same as non-compete' ? restrictionPeriod : solicitationPeriod;
                optionalSections += `
                <h2>${sectionNum}. NON-SOLICITATION OF CUSTOMERS</h2>
                <p class="clause">${sectionNum}.1 During the Restricted Period and for a period of <span class="doc-highlight" data-field="solicitationPeriod" contenteditable="true">${periodText}</span> following the termination of ${employeeTypeText === 'an employee' ? 'employment' : 'the business relationship'}, Restricted Party agrees not to, directly or indirectly:</p>
                <p class="sub-clause">(a) Solicit, contact, or communicate with any Customer for the purpose of providing Competitive Services or inducing such Customer to reduce or terminate its business relationship with Employer;</p>
                <p class="sub-clause">(b) Accept business from any Customer for Competitive Services;</p>
                <p class="sub-clause">(c) Interfere with or disrupt any existing or prospective business relationship between Employer and any Customer.</p>
                <p class="clause">${sectionNum}.2 "Customer" means any person or entity that: (a) was a customer of Employer at any time during the last two (2) years of Restricted Party's relationship with Employer; (b) was actively solicited by Employer during such period; or (c) about whom Restricted Party obtained Confidential Information.</p>`;
                sectionNum++;
            }

            if (getValue('nonRecruitment')) {
                const recruitmentPeriod = getValue('recruitmentPeriod', 'same as non-compete');
                const periodText = recruitmentPeriod === 'same as non-compete' ? restrictionPeriod : recruitmentPeriod;
                optionalSections += `
                <h2>${sectionNum}. NON-RECRUITMENT OF EMPLOYEES</h2>
                <p class="clause">${sectionNum}.1 During the Restricted Period and for a period of <span class="doc-highlight" data-field="recruitmentPeriod" contenteditable="true">${periodText}</span> following the termination of the business relationship, Restricted Party agrees not to, directly or indirectly:</p>
                <p class="sub-clause">(a) Solicit, recruit, hire, or attempt to hire any employee or contractor of Employer;</p>
                <p class="sub-clause">(b) Induce or attempt to induce any employee or contractor to leave their position with Employer;</p>
                <p class="sub-clause">(c) Assist any third party in recruiting or hiring any employee or contractor of Employer.</p>
                <p class="clause">${sectionNum}.2 This restriction applies to any person who was an employee or contractor of Employer at any time during the last twelve (12) months of Restricted Party's relationship with Employer.</p>`;
                sectionNum++;
            }

            if (getValue('confidentiality')) {
                optionalSections += `
                <h2>${sectionNum}. CONFIDENTIALITY</h2>
                <p class="clause">${sectionNum}.1 <strong>Confidential Information.</strong> "Confidential Information" means all non-public information belonging to or relating to Employer, including but not limited to: trade secrets; customer lists and information; vendor and supplier information; pricing strategies; business plans; financial information; marketing strategies; proprietary technology; software and source code; product designs and specifications; manufacturing processes; and any other information that derives value from not being generally known.</p>
                <p class="clause">${sectionNum}.2 <strong>Non-Disclosure.</strong> Restricted Party agrees to hold all Confidential Information in strict confidence and not to disclose, publish, or otherwise reveal any Confidential Information to any third party during or after the business relationship, except as required in the performance of duties for Employer.</p>
                <p class="clause">${sectionNum}.3 <strong>Non-Use.</strong> Restricted Party agrees not to use any Confidential Information for any purpose other than the benefit of Employer, either during or after the business relationship.</p>
                <p class="clause">${sectionNum}.4 <strong>Return of Materials.</strong> Upon termination of the business relationship or upon Employer's request, Restricted Party shall immediately return all documents, materials, and other property containing Confidential Information and shall not retain any copies.</p>
                <p class="clause">${sectionNum}.5 <strong>Duration.</strong> The obligations in this Section shall survive termination of the business relationship indefinitely with respect to trade secrets, and for a period of five (5) years with respect to other Confidential Information.</p>`;
                sectionNum++;
            }

            if (getValue('nonDisparagement')) {
                optionalSections += `
                <h2>${sectionNum}. NON-DISPARAGEMENT</h2>
                <p class="clause">${sectionNum}.1 Restricted Party agrees not to make, publish, or communicate any disparaging, defamatory, or negative statements about Employer, its products, services, officers, directors, employees, or business practices, whether orally, in writing, or through electronic means.</p>
                <p class="clause">${sectionNum}.2 This restriction does not prohibit truthful statements made: (a) in response to legal process or government inquiry; (b) in connection with protected whistleblower activity; or (c) as otherwise required by law.</p>`;
                sectionNum++;
            }

            // Remedies section
            let remediesText = '';
            const remedies = [];

            if (getValue('injunctiveRelief')) {
                remedies.push('injunctive relief, including temporary restraining orders, preliminary injunctions, and permanent injunctions');
            }
            if (getValue('monetaryDamages')) {
                remedies.push('actual damages suffered by Employer');
            }
            if (getValue('liquidatedDamages')) {
                const amount = formatCurrency(getValue('liquidatedAmount'));
                remedies.push(`liquidated damages in the amount of <span class="doc-highlight" data-field="liquidatedAmount" contenteditable="true">${amount}</span>, which the parties agree represents a reasonable estimate of damages that would be difficult to calculate`);
            }
            if (getValue('attorneyFees')) {
                remedies.push('reasonable attorney\'s fees and costs incurred in enforcing this Agreement');
            }

            remediesText = remedies.length > 0 ? remedies.join('; ') : 'all remedies available at law or in equity';

            // Additional provisions
            let additionalProvisions = '';

            if (getValue('gardenLeave')) {
                const gardenPeriod = getValue('gardenLeavePeriod', '[GARDEN LEAVE PERIOD]');
                additionalProvisions += `<p class="clause"><strong>Garden Leave.</strong> Upon notice of termination by either party, Employer may, at its sole discretion, place Restricted Party on garden leave for <span class="doc-highlight" data-field="gardenLeavePeriod" contenteditable="true">${gardenPeriod}</span>, during which Restricted Party shall remain employed and receive full compensation but shall not be required to perform duties and may be excluded from the workplace.</p>`;
            }

            if (getValue('bluePencil')) {
                additionalProvisions += `<p class="clause"><strong>Blue Pencil/Reformation.</strong> If any provision of this Agreement is held to be unenforceable or invalid by a court of competent jurisdiction, the parties agree that such court shall have the power to modify or reform such provision to make it enforceable to the maximum extent permitted by law, rather than declaring the entire provision void.</p>`;
            }

            if (getValue('tolling')) {
                additionalProvisions += `<p class="clause"><strong>Tolling.</strong> If Restricted Party violates any provision of this Agreement, the Restricted Period shall be extended by the length of time during which such violation occurred, in addition to any other remedies available to Employer.</p>`;
            }

            // Dispute resolution text
            let disputeText = '';
            if (disputeResolution === 'litigation') {
                disputeText = `Any dispute arising out of or relating to this Agreement shall be resolved exclusively in the state or federal courts located in <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, and Restricted Party consents to the personal jurisdiction of such courts.`;
            } else if (disputeResolution === 'arbitration') {
                disputeText = `Any dispute arising out of or relating to this Agreement shall be resolved by binding arbitration administered by the American Arbitration Association in accordance with its Employment Arbitration Rules. The arbitration shall take place in <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>. Notwithstanding the foregoing, Employer may seek injunctive relief in any court of competent jurisdiction.`;
            } else {
                disputeText = `Any dispute arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful within thirty (30) days, the dispute shall be resolved by litigation in the courts of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>. Notwithstanding the foregoing, Employer may seek emergency injunctive relief without first mediating.`;
            }

            const html = `
                <h1>NON-COMPETE AGREEMENT</h1>

                <p class="effective-date">Effective Date: <span class="doc-highlight" data-field="effectiveDate" contenteditable="true">${effectiveDate}</span></p>

                <div class="parties">
                    <p>This Non-Compete Agreement ("Agreement") is entered into by and between:</p>
                    <p><strong>EMPLOYER:</strong> <span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span>, a company organized under the laws of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, with its principal place of business at <span class="doc-highlight" data-field="employerAddress" contenteditable="true">${employerAddress}</span> ("Employer")</p>
                    <p><strong>RESTRICTED PARTY:</strong> <span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span>, ${employeeTypeText} residing at <span class="doc-highlight" data-field="employeeAddress" contenteditable="true">${employeeAddress}</span>, currently serving or to serve as <span class="doc-highlight" data-field="jobTitle" contenteditable="true">${jobTitle}</span> ("Restricted Party")</p>
                </div>

                <div class="recitals">
                    <p><strong>RECITALS</strong></p>
                    <p>WHEREAS, Employer is engaged in the business of: <span class="doc-highlight" data-field="businessDescription" contenteditable="true">${businessDescription}</span>;</p>
                    <p>WHEREAS, Restricted Party ${employeeType === 'employee' ? 'is or will be employed by' : 'has or will have a business relationship with'} Employer in a capacity that involves access to Confidential Information, trade secrets, customer relationships, and other valuable business assets;</p>
                    <p>WHEREAS, Employer has a legitimate business interest in protecting its Confidential Information, customer relationships, goodwill, and investment in training and development;</p>
                    <p>WHEREAS, in consideration of ${considerationText}, Restricted Party agrees to the restrictive covenants set forth herein;</p>
                    <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements contained herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>
                </div>

                <h2>1. DEFINITIONS</h2>
                <p class="clause">1.1 <strong>"Competitive Services"</strong> means services that are the same as or substantially similar to those provided by Employer, including: <span class="doc-highlight" data-field="prohibitedActivities" contenteditable="true">${prohibitedActivities}</span>.</p>
                <p class="clause">1.2 <strong>"Competitor"</strong> means any person, business, or entity that provides or is preparing to provide Competitive Services, including: <span class="doc-highlight" data-field="competitorDefinition" contenteditable="true">${competitorDefinition}</span>.</p>
                <p class="clause">1.3 <strong>"Restricted Period"</strong> means the period beginning on the Effective Date and continuing until <span class="doc-highlight" data-field="restrictionPeriod" contenteditable="true">${restrictionPeriod}</span> after the termination of Restricted Party's ${employeeType === 'employee' ? 'employment' : 'business relationship'} with Employer for any reason.</p>
                <p class="clause">1.4 <strong>"Restricted Territory"</strong> means ${geographicText}.</p>

                <h2>2. NON-COMPETE COVENANT</h2>
                <p class="clause">2.1 <strong>Non-Competition.</strong> During the Restricted Period, Restricted Party agrees not to, directly or indirectly, within the Restricted Territory:</p>
                <p class="sub-clause">(a) Engage in, own, manage, operate, control, finance, or participate in the ownership, management, operation, control, or financing of any Competitor;</p>
                <p class="sub-clause">(b) Be employed by, serve as an officer, director, consultant, advisor, or agent of, or perform services for any Competitor;</p>
                <p class="sub-clause">(c) Have any ownership interest in any Competitor (excluding passive ownership of less than 2% of the outstanding shares of a publicly traded company);</p>
                <p class="sub-clause">(d) Assist, advise, or provide services to any person or entity in competing with Employer.</p>
                <p class="clause">2.2 <strong>Reasonableness.</strong> Restricted Party acknowledges and agrees that:</p>
                <p class="sub-clause">(a) The restrictions in this Agreement are reasonable and necessary to protect Employer's legitimate business interests;</p>
                <p class="sub-clause">(b) Restricted Party has received fair and adequate consideration for entering into this Agreement;</p>
                <p class="sub-clause">(c) The restrictions will not impose undue hardship on Restricted Party;</p>
                <p class="sub-clause">(d) Restricted Party has had the opportunity to consult with independent legal counsel before signing this Agreement.</p>

                ${optionalSections}

                <h2>${sectionNum}. REMEDIES</h2>
                <p class="clause">${sectionNum}.1 <strong>Irreparable Harm.</strong> Restricted Party acknowledges that a breach of this Agreement would cause irreparable harm to Employer that cannot be adequately compensated by monetary damages alone.</p>
                <p class="clause">${sectionNum}.2 <strong>Available Remedies.</strong> In the event of any breach or threatened breach of this Agreement, Employer shall be entitled to: ${remediesText}.</p>
                <p class="clause">${sectionNum}.3 <strong>Cumulative Remedies.</strong> All remedies available to Employer are cumulative and not exclusive of any other remedy to which Employer may be entitled.</p>

                <h2>${sectionNum + 1}. DISPUTE RESOLUTION</h2>
                <p class="clause">${disputeText}</p>

                <h2>${sectionNum + 2}. GENERAL PROVISIONS</h2>
                <p class="clause"><strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, without regard to its conflicts of law principles.</p>
                <p class="clause"><strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning its subject matter and supersedes all prior agreements and understandings, whether written or oral, relating to the subject matter hereof.</p>
                <p class="clause"><strong>Amendment.</strong> This Agreement may not be amended except by a written instrument signed by both parties.</p>
                <p class="clause"><strong>Waiver.</strong> No waiver of any provision of this Agreement shall be effective unless in writing, and no waiver shall constitute a waiver of any other provision or any subsequent breach.</p>
                <p class="clause"><strong>Severability.</strong> If any provision of this Agreement is held to be invalid, illegal, or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                ${additionalProvisions}
                <p class="clause"><strong>Assignment.</strong> This Agreement shall be binding upon and inure to the benefit of the parties and their respective heirs, executors, administrators, successors, and assigns. Employer may assign this Agreement to any successor to all or substantially all of its business. Restricted Party may not assign this Agreement.</p>
                <p class="clause"><strong>Notices.</strong> All notices under this Agreement shall be in writing and delivered personally, by certified mail return receipt requested, or by overnight courier to the addresses set forth above.</p>
                <p class="clause"><strong>Acknowledgment.</strong> RESTRICTED PARTY ACKNOWLEDGES THAT RESTRICTED PARTY HAS CAREFULLY READ THIS AGREEMENT, UNDERSTANDS ITS TERMS AND CONDITIONS, HAS HAD THE OPPORTUNITY TO CONSULT WITH INDEPENDENT LEGAL COUNSEL, AND VOLUNTARILY AGREES TO BE BOUND BY ITS PROVISIONS.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Employer</h3>
                        <p><span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Restricted Party</h3>
                        <div class="signature-line">Signature</div>
                        <p class="signature-line"><span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span></p>
                        <div class="signature-line">Date</div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;

            // Add inline editing listeners
            document.querySelectorAll('.doc-highlight[contenteditable="true"]').forEach(el => {
                el.addEventListener('input', function() {
                    hasCustomEdits = true;
                    const fieldId = this.getAttribute('data-field');
                    const inputEl = document.getElementById(fieldId);
                    if (inputEl && inputEl.tagName !== 'SELECT') {
                        inputEl.value = this.textContent;
                    }
                });
            });

            // Scroll to and highlight edited field
            if (lastEditedField) {
                setTimeout(() => {
                    const el = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        el.classList.add('field-highlight-animation');
                        const doc = document.getElementById('documentPreview');
                        doc.classList.add('document-flash');
                        setTimeout(() => {
                            el.classList.remove('field-highlight-animation');
                            doc.classList.remove('document-flash');
                        }, 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            const doc = document.getElementById('documentPreview');
            const btn = document.getElementById('editBtn');
            const btnText = document.getElementById('editBtnText');

            if (isEditMode) {
                doc.classList.add('edit-mode');
                doc.setAttribute('contenteditable', 'true');
                btn.classList.add('active');
                btnText.textContent = 'Done Editing';
                hasCustomEdits = true;
            } else {
                doc.classList.remove('edit-mode');
                doc.setAttribute('contenteditable', 'false');
                btn.classList.remove('active');
                btnText.textContent = 'Edit Document';
            }
        }

        function printDocument() {
            window.print();
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const employeeName = getValue('employeeName', 'Employee');
            const employerName = getValue('employerName', 'Company');

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; max-width: 8.5in; margin: 1in auto; }
                        h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; }
                        h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
                        p { margin-bottom: 1rem; text-align: justify; }
                        .center { text-align: center; }
                        .effective-date { text-align: center; font-style: italic; margin-bottom: 2rem; }
                        .parties { margin: 1.5rem 0; }
                        .parties p { margin-bottom: 0.5rem; }
                        .clause { margin-bottom: 1.25rem; }
                        .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
                        .signature-block { margin-top: 3rem; display: flex; justify-content: space-between; }
                        .signature-party { width: 45%; }
                        .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
                        .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
                        .doc-highlight { background-color: #fff; }
                        .recitals { margin: 1.5rem 0; font-style: italic; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Non-Compete Agreement - ${employeeName} - ${employerName}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;

            updatePreview();
        });
    </script>
</body>
</html>
