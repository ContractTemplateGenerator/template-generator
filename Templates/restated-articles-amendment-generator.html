<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restated Articles & Amendment Generator | Certificate of Amendment | Terms.Law</title>
  <meta name="description" content="Free generator for Restated Certificate of Incorporation and Certificate of Amendment. Update your corporate charter with name changes, stock increases, and more.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-text-light: #94a3b8;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; position: relative; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-textarea { min-height: 80px; resize: vertical; }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .document-body.full-edit-mode { outline: 3px solid var(--color-primary); background: #fffef8; }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .doc-subtitle { text-align: center; font-size: 12px; margin-bottom: 6px; }
    .doc-state-header { text-align: center; font-size: 11px; color: var(--color-text-muted); margin-bottom: 25px; font-family: var(--font-sans); }
    .doc-article-title { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; color: var(--doc-clause-title); text-align: center; }
    .doc-section-header { font-size: 11px; font-weight: bold; margin-top: 15px; margin-bottom: 8px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; text-align: justify; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-signature-block { margin-top: 40px; }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; max-width: 350px; }
    .doc-signature-line .sig-label { width: 100px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; display: flex; align-items: flex-end; padding-bottom: 3px; }
    .type-card { background: var(--color-bg); border: 2px solid var(--color-border); border-radius: var(--radius-md); padding: 0.75rem; margin-bottom: 0.5rem; cursor: pointer; transition: all var(--transition-fast); }
    .type-card:hover { border-color: var(--color-primary-light); }
    .type-card.selected { border-color: var(--color-primary); background: rgba(30, 64, 175, 0.05); }
    .type-card input { display: none; }
    .type-name { font-weight: 600; font-size: 0.85rem; margin-bottom: 2px; }
    .type-desc { font-size: 0.75rem; color: var(--color-text-muted); }
    .checkbox-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .checkbox-item { display: flex; align-items: center; gap: 0.5rem; }
    .checkbox-item input { width: 16px; height: 16px; }
    .checkbox-item label { font-size: 0.85rem; cursor: pointer; }
    .stock-class-card { background: var(--color-bg); border: 1px solid var(--color-border); border-radius: var(--radius-md); padding: 1rem; margin-bottom: 0.75rem; }
    .stock-class-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
    .stock-class-title { font-weight: 600; font-size: 0.85rem; }
    .btn-remove { background: none; border: none; color: var(--color-danger); cursor: pointer; font-size: 0.8rem; padding: 4px 8px; }
    .btn-remove:hover { text-decoration: underline; }
    .btn-add { width: 100%; padding: 10px; background: var(--color-bg); border: 2px dashed var(--color-border); border-radius: var(--radius-md); color: var(--color-text-muted); cursor: pointer; font-size: 0.85rem; transition: all var(--transition-fast); }
    .btn-add:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .amendment-item { background: var(--color-bg); border: 1px solid var(--color-border); border-radius: var(--radius-md); padding: 0.75rem; margin-bottom: 0.5rem; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; box-shadow: var(--shadow-xl); transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/" class="nav-link">Demands</a>
        <a href="/Templates/" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">Corporate Updates</div>
      <h1><span class="highlight">Restated Articles</span> & Amendment Generator</h1>
      <p class="hero-subtitle">Generate Certificate of Amendment or Amended and Restated Certificate of Incorporation. Update corporate name, stock structure, or add provisions.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">Document Type</h3>
        <label class="type-card selected" id="typeAmendmentCard">
          <input type="radio" name="docType" value="amendment" checked onchange="updateDocType()">
          <div class="type-name">Certificate of Amendment</div>
          <div class="type-desc">File specific changes to your articles</div>
        </label>
        <label class="type-card" id="typeRestatedCard">
          <input type="radio" name="docType" value="restated" onchange="updateDocType()">
          <div class="type-name">Amended & Restated Certificate</div>
          <div class="type-desc">Complete restatement with all changes integrated</div>
        </label>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Corporation Information</h3>
        <div class="form-group">
          <label class="form-label">Current Corporation Name</label>
          <input type="text" id="currentName" class="form-input" placeholder="Acme Corporation" oninput="trackFieldEdit('currentName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select id="incState" class="form-select" onchange="trackFieldEdit('incState')">
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
            <option value="Florida">Florida</option>
            <option value="Nevada">Nevada</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Date of Original Incorporation</label>
          <input type="date" id="originalDate" class="form-input" oninput="trackFieldEdit('originalDate')">
        </div>
        <div class="form-group">
          <label class="form-label">Amendment Effective Date</label>
          <input type="date" id="effectiveDate" class="form-input" oninput="trackFieldEdit('effectiveDate')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Amendments</h3>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="amendName" onchange="toggleAmendment('name')">
            <label for="amendName">Change Corporation Name</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="amendStock" onchange="toggleAmendment('stock')">
            <label for="amendStock">Change Authorized Stock</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="amendPurpose" onchange="toggleAmendment('purpose')">
            <label for="amendPurpose">Change Corporate Purpose</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="amendAgent" onchange="toggleAmendment('agent')">
            <label for="amendAgent">Change Registered Agent</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="amendProvisions" onchange="toggleAmendment('provisions')">
            <label for="amendProvisions">Add/Remove Provisions</label>
          </div>
        </div>
      </div>

      <!-- Name Change Section -->
      <div class="builder-section" id="nameSection" style="display: none;">
        <h3 class="builder-section-title">Name Change</h3>
        <div class="form-group">
          <label class="form-label">New Corporation Name</label>
          <input type="text" id="newName" class="form-input" placeholder="New Acme Inc." oninput="trackFieldEdit('newName')">
        </div>
      </div>

      <!-- Stock Change Section -->
      <div class="builder-section" id="stockSection" style="display: none;">
        <h3 class="builder-section-title">Stock Structure Changes</h3>
        <div id="stockClasses">
          <div class="stock-class-card" data-class-id="common">
            <div class="stock-class-header">
              <span class="stock-class-title">Common Stock</span>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">New Authorized Shares</label>
                <input type="number" class="form-input stock-shares" value="10000000" oninput="updatePreview()">
              </div>
              <div class="form-group">
                <label class="form-label">Par Value ($)</label>
                <input type="number" step="0.0001" class="form-input stock-par" value="0.0001" oninput="updatePreview()">
              </div>
            </div>
          </div>
        </div>
        <button class="btn-add" onclick="addStockClass()">+ Add Preferred Stock Class</button>
      </div>

      <!-- Purpose Change Section -->
      <div class="builder-section" id="purposeSection" style="display: none;">
        <h3 class="builder-section-title">Purpose Change</h3>
        <div class="form-group">
          <label class="form-label">New Corporate Purpose</label>
          <select id="purposeType" class="form-select" onchange="updatePreview()">
            <option value="general">General (Any Lawful Business)</option>
            <option value="specific">Specific Purpose</option>
          </select>
        </div>
        <div class="form-group" id="specificPurposeGroup" style="display: none;">
          <label class="form-label">Specific Purpose Description</label>
          <textarea id="specificPurpose" class="form-textarea" placeholder="To engage in the business of..." oninput="updatePreview()"></textarea>
        </div>
      </div>

      <!-- Registered Agent Section -->
      <div class="builder-section" id="agentSection" style="display: none;">
        <h3 class="builder-section-title">New Registered Agent</h3>
        <div class="form-group">
          <label class="form-label">Agent Name</label>
          <input type="text" id="agentName" class="form-input" placeholder="Registered Agent Services Inc." oninput="trackFieldEdit('agentName')">
        </div>
        <div class="form-group">
          <label class="form-label">Agent Address</label>
          <input type="text" id="agentAddress" class="form-input" placeholder="1209 Orange Street, Wilmington, DE 19801" oninput="trackFieldEdit('agentAddress')">
        </div>
      </div>

      <!-- Additional Provisions Section -->
      <div class="builder-section" id="provisionsSection" style="display: none;">
        <h3 class="builder-section-title">Provisions</h3>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="provLiability" onchange="updatePreview()">
            <label for="provLiability">Add Director Liability Limitation</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provIndemnification" onchange="updatePreview()">
            <label for="provIndemnification">Add Indemnification Provision</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provWrittenConsent" onchange="updatePreview()">
            <label for="provWrittenConsent">Permit Action by Written Consent</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provNoPreemptive" onchange="updatePreview()">
            <label for="provNoPreemptive">No Preemptive Rights</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provExclusiveForum" onchange="updatePreview()">
            <label for="provExclusiveForum">Exclusive Forum (Delaware Courts)</label>
          </div>
        </div>
      </div>

      <div class="builder-section">
        <h3 class="builder-section-title">Authorization</h3>
        <div class="form-group">
          <label class="form-label">Approved By</label>
          <select id="approvalType" class="form-select" onchange="updatePreview()">
            <option value="board">Board of Directors Only</option>
            <option value="both">Board and Stockholders</option>
            <option value="stockholders">Stockholders Only</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Board Approval Date</label>
          <input type="date" id="boardApprovalDate" class="form-input" oninput="updatePreview()">
        </div>
        <div class="form-group" id="stockholderDateGroup">
          <label class="form-label">Stockholder Approval Date</label>
          <input type="date" id="stockholderApprovalDate" class="form-input" oninput="updatePreview()">
        </div>
        <div class="form-group">
          <label class="form-label">Authorized Officer Name</label>
          <input type="text" id="officerName" class="form-input" placeholder="Jane Smith" oninput="trackFieldEdit('officerName')">
        </div>
        <div class="form-group">
          <label class="form-label">Officer Title</label>
          <select id="officerTitle" class="form-select" onchange="updatePreview()">
            <option value="President">President</option>
            <option value="Chief Executive Officer">Chief Executive Officer</option>
            <option value="Secretary">Secretary</option>
            <option value="Vice President">Vice President</option>
          </select>
        </div>
      </div>
    </aside>
    <section class="preview-panel">
      <div class="preview-toolbar">
        <span class="preview-title">LIVE PREVIEW</span>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="toggleFullEdit()">Full Edit Mode</button>
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title" id="docHeaderTitle">Certificate of Amendment</span>
          <span class="document-status">Auto-saved</span>
        </div>
        <div class="document-body" id="documentBody">
          <!-- Generated by JS -->
        </div>
      </div>
    </section>
  </main>
  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>Free legal document tools for startups and businesses</p>
  </footer>
  <div class="toast" id="toast"></div>

  <script>
    let stockClassCounter = 0;
    let fullEditMode = false;

    const fieldMap = {
      currentName: 'field-currentName',
      incState: 'field-incState',
      originalDate: 'field-originalDate',
      effectiveDate: 'field-effectiveDate',
      newName: 'field-newName',
      agentName: 'field-agentName',
      agentAddress: 'field-agentAddress',
      officerName: 'field-officerName'
    };

    function trackFieldEdit(fieldId) {
      updatePreview();
      const targetId = fieldMap[fieldId];
      if (targetId) {
        setTimeout(() => {
          const el = document.getElementById(targetId);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            el.classList.remove('field-highlight-animation');
            void el.offsetWidth;
            el.classList.add('field-highlight-animation');
          }
        }, 100);
      }
    }

    function updateDocType() {
      const type = document.querySelector('input[name="docType"]:checked').value;
      document.querySelectorAll('.type-card').forEach(card => card.classList.remove('selected'));
      document.getElementById(`type${type.charAt(0).toUpperCase() + type.slice(1)}Card`).classList.add('selected');
      document.getElementById('docHeaderTitle').textContent = type === 'amendment' ? 'Certificate of Amendment' : 'Amended & Restated Certificate';
      updatePreview();
    }

    function toggleAmendment(type) {
      const section = document.getElementById(`${type}Section`);
      const checkbox = document.getElementById(`amend${type.charAt(0).toUpperCase() + type.slice(1)}`);
      section.style.display = checkbox.checked ? 'block' : 'none';
      updatePreview();
    }

    function getVal(id, def = '') {
      const el = document.getElementById(id);
      return el ? (el.value || def) : def;
    }

    function getChecked(id) {
      const el = document.getElementById(id);
      return el ? el.checked : false;
    }

    function formatDate(dateStr) {
      if (!dateStr) return '[Date]';
      const d = new Date(dateStr);
      return d.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    function formatNumber(num) {
      return parseInt(num).toLocaleString();
    }

    function getStockClasses() {
      const classes = [];
      document.querySelectorAll('.stock-class-card').forEach(card => {
        const classId = card.dataset.classId;
        const shares = card.querySelector('.stock-shares').value || '0';
        const par = card.querySelector('.stock-par').value || '0.0001';
        classes.push({
          id: classId,
          name: classId === 'common' ? 'Common Stock' : `Series ${classId} Preferred Stock`,
          shares: shares,
          par: par
        });
      });
      return classes;
    }

    function addStockClass() {
      stockClassCounter++;
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const classLetter = letters[stockClassCounter - 1] || stockClassCounter;
      const container = document.getElementById('stockClasses');
      const card = document.createElement('div');
      card.className = 'stock-class-card';
      card.dataset.classId = classLetter;
      card.innerHTML = `
        <div class="stock-class-header">
          <span class="stock-class-title">Series ${classLetter} Preferred Stock</span>
          <button class="btn-remove" onclick="removeStockClass(this)">Remove</button>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">New Authorized Shares</label>
            <input type="number" class="form-input stock-shares" value="1000000" oninput="updatePreview()">
          </div>
          <div class="form-group">
            <label class="form-label">Par Value ($)</label>
            <input type="number" step="0.0001" class="form-input stock-par" value="0.0001" oninput="updatePreview()">
          </div>
        </div>
      `;
      container.appendChild(card);
      updatePreview();
    }

    function removeStockClass(btn) {
      btn.closest('.stock-class-card').remove();
      updatePreview();
    }

    function span(id, val) {
      const isEmpty = !val || val.startsWith('[');
      return `<span class="doc-highlight${isEmpty ? ' empty' : ''}" id="${id}" contenteditable="true">${val || '[Not Specified]'}</span>`;
    }

    function updatePreview() {
      const docType = document.querySelector('input[name="docType"]:checked').value;
      const currentName = getVal('currentName', '[Corporation Name]');
      const state = getVal('incState', 'Delaware');
      const originalDate = formatDate(getVal('originalDate'));
      const effectiveDate = formatDate(getVal('effectiveDate'));
      const approvalType = getVal('approvalType', 'board');
      const boardDate = formatDate(getVal('boardApprovalDate'));
      const stockholderDate = formatDate(getVal('stockholderApprovalDate'));
      const officerName = getVal('officerName', '[Officer Name]');
      const officerTitle = getVal('officerTitle', 'President');

      // Show/hide stockholder date based on approval type
      document.getElementById('stockholderDateGroup').style.display = approvalType !== 'board' ? 'block' : 'none';

      // Show/hide specific purpose
      const purposeType = getVal('purposeType', 'general');
      document.getElementById('specificPurposeGroup').style.display = purposeType === 'specific' ? 'block' : 'none';

      // Amendment sections
      const amendName = getChecked('amendName');
      const amendStock = getChecked('amendStock');
      const amendPurpose = getChecked('amendPurpose');
      const amendAgent = getChecked('amendAgent');
      const amendProvisions = getChecked('amendProvisions');

      const newName = getVal('newName', '[New Corporation Name]');
      const agentName = getVal('agentName', '[Registered Agent Name]');
      const agentAddress = getVal('agentAddress', '[Registered Agent Address]');
      const specificPurpose = getVal('specificPurpose', '');
      const stockClasses = getStockClasses();

      // Calculate total shares
      let totalShares = 0;
      stockClasses.forEach(sc => { totalShares += parseInt(sc.shares) || 0; });

      // State-specific document name
      const isDelaware = state === 'Delaware';
      const certName = isDelaware ? 'Certificate' : 'Articles';

      // Build amendments list for simple amendment
      let amendments = [];
      let articleNum = 1;

      if (docType === 'amendment') {
        // Simple Certificate of Amendment
        let amendmentsClauses = '';

        if (amendName) {
          amendmentsClauses += `
            <div class="doc-section-header">${articleNum}. Name Change</div>
            <p class="doc-paragraph">Article I of the ${certName} of Incorporation is hereby amended to read in its entirety as follows:</p>
            <p class="doc-paragraph" style="padding-left: 20px;">"The name of the corporation is ${span('field-newName', newName)}."</p>
          `;
          articleNum++;
        }

        if (amendStock) {
          amendmentsClauses += `
            <div class="doc-section-header">${articleNum}. Capital Stock</div>
            <p class="doc-paragraph">The article of the ${certName} of Incorporation relating to capital stock is hereby amended to read in its entirety as follows:</p>
            <p class="doc-paragraph" style="padding-left: 20px;">"The total number of shares of all classes of stock which the Corporation shall have authority to issue is ${formatNumber(totalShares)} shares, consisting of:</p>
            <ul class="doc-list" style="padding-left: 40px;">
              ${stockClasses.map(sc => `<li>${formatNumber(sc.shares)} shares of ${sc.name}, par value $${sc.par} per share</li>`).join('')}
            </ul>
            ${stockClasses.length > 1 ? `<p class="doc-paragraph" style="padding-left: 20px;">The designations, powers, preferences, and rights of each class or series of stock shall be as set forth in the Amended and Restated ${certName} of Incorporation or in a Certificate of Designation filed with the Secretary of State."</p>` : ''}
          `;
          articleNum++;
        }

        if (amendPurpose) {
          const purposeText = purposeType === 'specific' && specificPurpose ? specificPurpose : 'to engage in any lawful act or activity for which corporations may be organized under the General Corporation Law of ' + state;
          amendmentsClauses += `
            <div class="doc-section-header">${articleNum}. Purpose</div>
            <p class="doc-paragraph">The article of the ${certName} of Incorporation relating to purpose is hereby amended to read in its entirety as follows:</p>
            <p class="doc-paragraph" style="padding-left: 20px;">"The purpose of the Corporation is ${purposeText}."</p>
          `;
          articleNum++;
        }

        if (amendAgent) {
          amendmentsClauses += `
            <div class="doc-section-header">${articleNum}. Registered Agent</div>
            <p class="doc-paragraph">The article of the ${certName} of Incorporation relating to the registered agent is hereby amended to read in its entirety as follows:</p>
            <p class="doc-paragraph" style="padding-left: 20px;">"The name and address of the Corporation's registered agent in the State of ${state} is ${span('field-agentName', agentName)}, located at ${span('field-agentAddress', agentAddress)}."</p>
          `;
          articleNum++;
        }

        if (amendProvisions) {
          let provisionText = '';
          if (getChecked('provLiability')) {
            provisionText += `<p class="doc-paragraph" style="padding-left: 20px;"><strong>Director Liability Limitation.</strong> To the fullest extent permitted by the General Corporation Law of ${state}, as the same exists or may hereafter be amended, a director of the Corporation shall not be personally liable to the Corporation or its stockholders for monetary damages for breach of fiduciary duty as a director.</p>`;
          }
          if (getChecked('provIndemnification')) {
            provisionText += `<p class="doc-paragraph" style="padding-left: 20px;"><strong>Indemnification.</strong> The Corporation shall indemnify its directors and officers to the fullest extent authorized or permitted by applicable law, as now or hereafter in effect.</p>`;
          }
          if (getChecked('provWrittenConsent')) {
            provisionText += `<p class="doc-paragraph" style="padding-left: 20px;"><strong>Written Consent.</strong> Any action required or permitted to be taken at any annual or special meeting of stockholders may be taken without a meeting, without prior notice, and without a vote, if a consent or consents in writing, setting forth the action so taken, shall be signed by the holders of outstanding stock having not less than the minimum number of votes that would be necessary to authorize or take such action at a meeting.</p>`;
          }
          if (getChecked('provNoPreemptive')) {
            provisionText += `<p class="doc-paragraph" style="padding-left: 20px;"><strong>No Preemptive Rights.</strong> No stockholder of the Corporation shall have any preemptive right to subscribe for or purchase any shares of any class of stock of the Corporation, whether now or hereafter authorized.</p>`;
          }
          if (getChecked('provExclusiveForum')) {
            provisionText += `<p class="doc-paragraph" style="padding-left: 20px;"><strong>Exclusive Forum.</strong> Unless the Corporation consents in writing to an alternative forum, the Court of Chancery of the State of Delaware shall be the sole and exclusive forum for any derivative action, any action asserting a breach of fiduciary duty, any action under the General Corporation Law, or any action asserting a claim governed by the internal affairs doctrine.</p>`;
          }
          if (provisionText) {
            amendmentsClauses += `
              <div class="doc-section-header">${articleNum}. Additional Provisions</div>
              <p class="doc-paragraph">The following provisions are hereby added to the ${certName} of Incorporation:</p>
              ${provisionText}
            `;
            articleNum++;
          }
        }

        const approvalText = approvalType === 'board' ?
          `This amendment was duly adopted by the Board of Directors of the Corporation on ${boardDate}, without a vote of the stockholders, as permitted by ${isDelaware ? 'Section 242(b)(1) of the General Corporation Law of Delaware' : 'applicable state law'}.` :
          approvalType === 'stockholders' ?
          `This amendment was duly adopted by the stockholders of the Corporation on ${stockholderDate}.` :
          `This amendment was duly adopted by resolutions of the Board of Directors of the Corporation on ${boardDate}, declaring the amendment advisable, and by the stockholders of the Corporation on ${stockholderDate}, in accordance with ${isDelaware ? 'Section 242' : 'applicable provisions'} of the ${isDelaware ? 'General Corporation Law of Delaware' : state + ' Business Corporation Act'}.`;

        const html = `
          <div class="doc-title">${isDelaware ? 'CERTIFICATE' : 'ARTICLES'} OF AMENDMENT</div>
          <div class="doc-subtitle">OF</div>
          <div class="doc-subtitle">${isDelaware ? 'CERTIFICATE' : 'ARTICLES'} OF INCORPORATION</div>
          <div class="doc-subtitle">OF</div>
          <div class="doc-title" style="margin-bottom: 25px;">${span('field-currentName', currentName)}</div>

          <p class="doc-paragraph">${span('field-currentName', currentName)}, a corporation organized and existing under and by virtue of the ${isDelaware ? 'General Corporation Law of the State of Delaware' : state + ' Business Corporation Act'} (the "Corporation"), does hereby certify:</p>

          <p class="doc-paragraph"><strong>FIRST:</strong> The name of the Corporation is ${span('field-currentName', currentName)}. The original ${certName} of Incorporation of the Corporation was filed with the ${isDelaware ? 'Secretary of State of Delaware' : state + ' Secretary of State'} on ${span('field-originalDate', originalDate)}.</p>

          <p class="doc-paragraph"><strong>SECOND:</strong> The ${certName} of Incorporation of the Corporation is hereby amended as follows:</p>

          ${amendmentsClauses || '<p class="doc-paragraph" style="font-style: italic; color: #666;">Select amendments from the sidebar to generate content.</p>'}

          <p class="doc-paragraph"><strong>THIRD:</strong> ${approvalText}</p>

          <div class="doc-signature-block">
            <p class="doc-paragraph"><strong>IN WITNESS WHEREOF</strong>, the Corporation has caused this ${isDelaware ? 'Certificate' : 'Articles'} of Amendment to be executed by its duly authorized officer on this _____ day of _____________, 20____.</p>

            <div style="margin-top: 40px;">
              <p class="doc-paragraph" style="margin-bottom: 5px;"><strong>${currentName}</strong></p>
              <div class="doc-signature-line">
                <span class="sig-label">Signature:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Print Name:</span>
                <span class="sig-value">${span('field-officerName', officerName)}</span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Title:</span>
                <span class="sig-value">${officerTitle}</span>
              </div>
            </div>
          </div>
        `;

        document.getElementById('documentBody').innerHTML = html;
      } else {
        // Amended and Restated Certificate
        const corpName = amendName ? newName : currentName;
        const purposeText = amendPurpose ?
          (purposeType === 'specific' && specificPurpose ? specificPurpose : 'to engage in any lawful act or activity for which corporations may be organized under the General Corporation Law of ' + state) :
          'to engage in any lawful act or activity for which corporations may be organized under the General Corporation Law of ' + state;

        let provisionsSection = '';
        if (amendProvisions) {
          let provNum = 1;
          if (getChecked('provLiability')) {
            provisionsSection += `
              <div class="doc-section-header">${provNum}. Director Liability Limitation</div>
              <p class="doc-paragraph">To the fullest extent permitted by the General Corporation Law of ${state}, as the same exists or may hereafter be amended, a director of the Corporation shall not be personally liable to the Corporation or its stockholders for monetary damages for breach of fiduciary duty as a director, except for liability (i) for any breach of the director's duty of loyalty to the Corporation or its stockholders, (ii) for acts or omissions not in good faith or which involve intentional misconduct or a knowing violation of law, (iii) under Section 174 of the Delaware General Corporation Law, or (iv) for any transaction from which the director derived an improper personal benefit.</p>
            `;
            provNum++;
          }
          if (getChecked('provIndemnification')) {
            provisionsSection += `
              <div class="doc-section-header">${provNum}. Indemnification</div>
              <p class="doc-paragraph">The Corporation shall indemnify its directors and officers to the fullest extent authorized or permitted by applicable law, as now or hereafter in effect. The Corporation may purchase and maintain insurance on behalf of any person who is or was a director, officer, employee, or agent of the Corporation against any liability asserted against such person.</p>
            `;
            provNum++;
          }
          if (getChecked('provWrittenConsent')) {
            provisionsSection += `
              <div class="doc-section-header">${provNum}. Action by Written Consent</div>
              <p class="doc-paragraph">Any action required or permitted to be taken at any annual or special meeting of stockholders may be taken without a meeting, without prior notice, and without a vote, if a consent or consents in writing, setting forth the action so taken, shall be signed by the holders of outstanding stock having not less than the minimum number of votes that would be necessary to authorize or take such action at a meeting at which all shares entitled to vote thereon were present and voted.</p>
            `;
            provNum++;
          }
          if (getChecked('provNoPreemptive')) {
            provisionsSection += `
              <div class="doc-section-header">${provNum}. No Preemptive Rights</div>
              <p class="doc-paragraph">No stockholder of the Corporation shall have any preemptive right to subscribe for or purchase any shares of any class of stock of the Corporation, whether now or hereafter authorized, or any warrants, rights, or options to purchase any such stock, or any securities exchangeable for or convertible into any such stock.</p>
            `;
            provNum++;
          }
          if (getChecked('provExclusiveForum')) {
            provisionsSection += `
              <div class="doc-section-header">${provNum}. Exclusive Forum</div>
              <p class="doc-paragraph">Unless the Corporation consents in writing to the selection of an alternative forum, the Court of Chancery of the State of Delaware (or, if the Court of Chancery does not have jurisdiction, the federal district court for the District of Delaware) shall, to the fullest extent permitted by law, be the sole and exclusive forum for (i) any derivative action or proceeding brought on behalf of the Corporation, (ii) any action asserting a claim of breach of a fiduciary duty owed by any director, officer, or other employee of the Corporation to the Corporation or the Corporation's stockholders, (iii) any action asserting a claim against the Corporation or any director or officer of the Corporation arising pursuant to any provision of the General Corporation Law of Delaware or this ${certName} of Incorporation or the Bylaws of the Corporation, or (iv) any action asserting a claim against the Corporation or any director or officer of the Corporation governed by the internal affairs doctrine.</p>
            `;
            provNum++;
          }
        }

        const approvalText = approvalType === 'board' ?
          `This Amended and Restated ${certName} of Incorporation was duly adopted by the Board of Directors of the Corporation on ${boardDate}.` :
          `This Amended and Restated ${certName} of Incorporation was duly adopted by resolutions of the Board of Directors of the Corporation on ${boardDate}, declaring the amendment and restatement advisable, and by the stockholders of the Corporation on ${stockholderDate}, in accordance with ${isDelaware ? 'Section 242 and Section 245' : 'applicable provisions'} of the ${isDelaware ? 'General Corporation Law of Delaware' : state + ' Business Corporation Act'}.`;

        const html = `
          <div class="doc-title">AMENDED AND RESTATED</div>
          <div class="doc-title">${isDelaware ? 'CERTIFICATE' : 'ARTICLES'} OF INCORPORATION</div>
          <div class="doc-subtitle">OF</div>
          <div class="doc-title" style="margin-bottom: 25px;">${span('field-newName', corpName)}</div>

          <p class="doc-paragraph">${span('field-currentName', currentName)}, a corporation organized and existing under and by virtue of the ${isDelaware ? 'General Corporation Law of the State of Delaware' : state + ' Business Corporation Act'}, does hereby certify as follows:</p>

          <p class="doc-paragraph"><strong>1.</strong> The name of the Corporation is ${span('field-currentName', currentName)}. The Corporation was originally incorporated under the name "${currentName}" and the original ${certName} of Incorporation was filed with the ${isDelaware ? 'Secretary of State of Delaware' : state + ' Secretary of State'} on ${span('field-originalDate', originalDate)}.</p>

          <p class="doc-paragraph"><strong>2.</strong> ${approvalText}</p>

          <p class="doc-paragraph"><strong>3.</strong> The text of the ${certName} of Incorporation is hereby amended and restated in its entirety to read as follows:</p>

          <div style="border: 1px solid #ddd; padding: 20px; margin: 20px 0; background: #fafafa;">
            <div class="doc-article-title">ARTICLE I - NAME</div>
            <p class="doc-paragraph">The name of the Corporation is ${span('field-newName', corpName)}.</p>

            ${amendAgent ? `
              <div class="doc-article-title">ARTICLE II - REGISTERED AGENT</div>
              <p class="doc-paragraph">The address of the Corporation's registered office in the State of ${state} is ${span('field-agentAddress', agentAddress)}. The name of its registered agent at such address is ${span('field-agentName', agentName)}.</p>
            ` : ''}

            <div class="doc-article-title">ARTICLE ${amendAgent ? 'III' : 'II'} - PURPOSE</div>
            <p class="doc-paragraph">The purpose of the Corporation is ${purposeText}.</p>

            <div class="doc-article-title">ARTICLE ${amendAgent ? 'IV' : 'III'} - CAPITAL STOCK</div>
            ${amendStock ? `
              <p class="doc-paragraph">The total number of shares of all classes of stock which the Corporation shall have authority to issue is ${formatNumber(totalShares)} shares, consisting of:</p>
              <ul class="doc-list">
                ${stockClasses.map(sc => `<li>${formatNumber(sc.shares)} shares of ${sc.name}, par value $${sc.par} per share</li>`).join('')}
              </ul>
              ${stockClasses.length > 1 ? `<p class="doc-paragraph">The designations, powers, preferences, and relative, participating, optional, or other special rights, and the qualifications, limitations, or restrictions thereof, of each class or series of stock shall be set forth in a Certificate of Designation filed with the Secretary of State.</p>` : ''}
            ` : `
              <p class="doc-paragraph">The total number of shares of stock which the Corporation shall have authority to issue is [Number] shares of Common Stock, par value $0.0001 per share.</p>
            `}

            <div class="doc-article-title">ARTICLE ${amendAgent ? 'V' : 'IV'} - BOARD OF DIRECTORS</div>
            <p class="doc-paragraph">The business and affairs of the Corporation shall be managed by or under the direction of the Board of Directors. The number of directors of the Corporation shall be fixed from time to time by resolution of the Board of Directors.</p>

            ${provisionsSection ? `
              <div class="doc-article-title">ARTICLE ${amendAgent ? 'VI' : 'V'} - ADDITIONAL PROVISIONS</div>
              ${provisionsSection}
            ` : ''}
          </div>

          <div class="doc-signature-block">
            <p class="doc-paragraph"><strong>IN WITNESS WHEREOF</strong>, the Corporation has caused this Amended and Restated ${certName} of Incorporation to be executed by its duly authorized officer on this _____ day of _____________, 20____.</p>

            <div style="margin-top: 40px;">
              <p class="doc-paragraph" style="margin-bottom: 5px;"><strong>${corpName}</strong></p>
              <div class="doc-signature-line">
                <span class="sig-label">Signature:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Print Name:</span>
                <span class="sig-value">${span('field-officerName', officerName)}</span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Title:</span>
                <span class="sig-value">${officerTitle}</span>
              </div>
            </div>
          </div>
        `;

        document.getElementById('documentBody').innerHTML = html;
      }
    }

    function toggleFullEdit() {
      fullEditMode = !fullEditMode;
      document.getElementById('documentBody').classList.toggle('full-edit-mode', fullEditMode);
      showToast(fullEditMode ? 'Full edit mode enabled - edit any text directly' : 'Full edit mode disabled');
    }

    function copyToClipboard() {
      const content = document.getElementById('documentBody').innerText;
      navigator.clipboard.writeText(content).then(() => {
        showToast('Copied to clipboard!', 'success');
      });
    }

    function downloadDocument() {
      const content = document.getElementById('documentBody').innerHTML;
      const docType = document.querySelector('input[name="docType"]:checked').value;
      const corpName = getVal('currentName', 'Corporation');
      const docTitle = docType === 'amendment' ? 'Certificate of Amendment' : 'Amended and Restated Certificate';

      const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>${docTitle} - ${corpName}</title>
  <style>
    body { font-family: Georgia, 'Times New Roman', serif; font-size: 13px; line-height: 1.8; max-width: 8.5in; margin: 0 auto; padding: 1in; }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .doc-subtitle { text-align: center; font-size: 12px; margin-bottom: 6px; }
    .doc-article-title { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; text-align: center; }
    .doc-section-header { font-size: 11px; font-weight: bold; margin-top: 15px; margin-bottom: 8px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; }
    .doc-highlight { background: none; border: none; padding: 0; font-weight: normal; }
    .doc-signature-block { margin-top: 40px; }
    .doc-signature-line { margin-bottom: 8px; min-height: 30px; }
    .sig-label { display: inline-block; width: 100px; font-size: 10px; color: #666; }
    .sig-value { display: inline-block; border-bottom: 1px solid #333; min-width: 200px; }
  </style>
</head>
<body>${content}</body>
</html>`;

      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${docTitle.replace(/\s+/g, '-')}-${corpName.replace(/[^a-zA-Z0-9]/g, '-')}.html`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Document downloaded!', 'success');
    }

    function showToast(message, type = '') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'toast' + (type ? ' ' + type : '');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updatePreview();
    });
  </script>
</body>
</html>
