<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Board Resolution Generator | Corporate Resolution Builder | Terms.Law</title>
  <meta name="description" content="Free Board Resolution generator. Authorize business decisions, appoint officers, approve contracts. Attorney-drafted with real-time preview.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Calendly Widget -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

  <style>
    /* ============================================
       CSS VARIABLES - Professional Theme
       ============================================ */
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #0d9488;
      --color-accent-light: #14b8a6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;

      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-text-light: #94a3b8;

      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;

      /* Document preview colors */
      --doc-bg: #fefefe;
      --doc-border: #d1d5db;
      --doc-highlight: #fef3c7;
      --doc-highlight-border: #fcd34d;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --doc-section-num: #6366f1;

      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);

      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-xl: 20px;
      --radius-full: 9999px;

      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 1rem;
      --space-lg: 1.5rem;
      --space-xl: 2rem;
      --space-2xl: 3rem;
      --space-3xl: 4rem;

      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --max-width: 1280px;

      --transition-fast: 150ms ease;
      --transition-base: 200ms ease;
    }

    /* ============================================
       RESET & BASE
       ============================================ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
    }

    body {
      font-family: var(--font-sans);
      font-size: 16px;
      line-height: 1.6;
      color: var(--color-text);
      background: var(--color-bg);
    }

    a {
      color: var(--color-primary);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    a:hover {
      color: var(--color-primary-dark);
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 var(--space-lg);
    }

    /* ============================================
       HEADER - Dark Professional (Matching site)
       ============================================ */
    .site-header {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      padding: 0;
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 52px;
      max-width: var(--max-width);
      margin: 0 auto;
    }

    .header-nav {
      display: flex;
      align-items: center;
      gap: 0;
      height: 100%;
    }

    .nav-link {
      color: #94a3b8;
      font-size: 0.85rem;
      font-weight: 600;
      padding: 16px 24px;
      transition: all 150ms ease;
      text-decoration: none;
      height: 100%;
      display: flex;
      align-items: center;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 2px solid transparent;
      margin-bottom: -1px;
    }

    .nav-link:hover {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.05);
    }

    .nav-link.active {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.08);
      border-bottom-color: #3b82f6;
    }

    .nav-link.home-logo {
      padding: 12px 20px;
      font-size: 1.1rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      text-transform: none;
    }

    .nav-link.home-logo .logo-text {
      background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Breadcrumb Navigation */
    .breadcrumb {
      background: var(--color-surface);
      border-bottom: 1px solid var(--color-border);
      padding: var(--space-sm) 0;
    }

    .breadcrumb-content {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-size: 0.85rem;
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 var(--space-lg);
    }

    .breadcrumb-link {
      color: var(--color-text-muted);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    .breadcrumb-link:hover {
      color: var(--color-primary);
    }

    .breadcrumb-separator {
      color: var(--color-text-light);
    }

    .breadcrumb-current {
      color: var(--color-text);
      font-weight: 600;
    }

    /* ============================================
       HERO
       ============================================ */
    .hero {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      padding: var(--space-2xl) 0;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 50%;
      height: 100%;
      background: radial-gradient(ellipse at 70% 30%, rgba(59, 130, 246, 0.12) 0%, transparent 60%);
      pointer-events: none;
    }

    .hero-content {
      position: relative;
      z-index: 1;
      max-width: 800px;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px 6px 6px;
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: var(--radius-full);
      font-size: 0.8rem;
      color: #93c5fd;
      margin-bottom: var(--space-lg);
    }

    .hero-badge-icon {
      width: 22px;
      height: 22px;
      background: var(--color-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #fff;
    }

    .hero h1 {
      font-size: 2.25rem;
      font-weight: 800;
      color: #fff;
      line-height: 1.15;
      letter-spacing: -0.025em;
      margin-bottom: var(--space-md);
    }

    .hero h1 .highlight {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-subtitle {
      font-size: 1.1rem;
      color: #94a3b8;
      line-height: 1.7;
      margin-bottom: var(--space-lg);
      max-width: 650px;
    }

    .hero-subtitle strong {
      color: #e2e8f0;
    }

    .hero-features {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-lg);
    }

    .hero-feature {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #94a3b8;
      font-size: 0.9rem;
    }

    .hero-feature-icon {
      color: var(--color-accent-light);
    }

    /* ============================================
       MAIN LAYOUT - Split View
       ============================================ */
    .builder-layout {
      display: grid;
      grid-template-columns: 420px 1fr;
      gap: 0;
      min-height: calc(100vh - 200px);
    }

    @media (max-width: 1024px) {
      .builder-layout {
        grid-template-columns: 1fr;
      }
    }

    /* ============================================
       BUILDER SIDEBAR (Left Panel)
       ============================================ */
    .builder-sidebar {
      background: var(--color-surface);
      border-right: 1px solid var(--color-border);
      padding: var(--space-xl);
      overflow-y: auto;
      max-height: calc(100vh - 150px);
      position: sticky;
      top: 70px;
    }

    @media (max-width: 1024px) {
      .builder-sidebar {
        max-height: none;
        position: static;
      }
    }

    .builder-section {
      margin-bottom: var(--space-xl);
      padding-bottom: var(--space-xl);
      border-bottom: 1px solid var(--color-border-light);
    }

    .builder-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .builder-section-title {
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--color-text-muted);
      margin-bottom: var(--space-md);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .builder-section-title .icon {
      font-size: 1rem;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: var(--space-lg);
    }

    .form-label {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--color-text);
      margin-bottom: var(--space-sm);
    }

    .form-label .help-trigger {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      background: var(--color-border);
      color: var(--color-text-muted);
      border-radius: 50%;
      font-size: 10px;
      font-weight: 700;
      cursor: help;
      position: relative;
    }

    .form-label .help-trigger:hover .help-tooltip {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .help-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%) translateY(5px);
      width: 280px;
      background: var(--color-dark);
      color: #fff;
      padding: 12px 14px;
      border-radius: var(--radius-md);
      font-size: 0.8rem;
      font-weight: 400;
      line-height: 1.5;
      box-shadow: var(--shadow-xl);
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-base);
      z-index: 100;
      text-align: left;
    }

    .help-tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--color-dark);
    }

    .form-input,
    .form-textarea,
    .form-select {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      font-size: 0.95rem;
      font-family: inherit;
      transition: all var(--transition-fast);
      background: var(--color-surface);
    }

    .form-input:focus,
    .form-textarea:focus,
    .form-select:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .form-hint {
      font-size: 0.8rem;
      color: var(--color-text-muted);
      margin-top: 6px;
    }

    /* Info Boxes */
    .info-box {
      margin-top: 12px;
      padding: 12px 14px;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(13, 148, 136, 0.05));
      border-left: 3px solid var(--color-primary-light);
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
      font-size: 0.85rem;
      line-height: 1.5;
      color: var(--color-text-secondary);
    }

    .info-box-title {
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 4px;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }

    .info-box p {
      margin: 0;
    }

    /* Resolution Type Cards */
    .resolution-type-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-sm);
      margin-bottom: var(--space-md);
    }

    .resolution-type-card {
      padding: var(--space-md);
      background: var(--color-bg);
      border: 2px solid var(--color-border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--transition-fast);
      text-align: center;
    }

    .resolution-type-card:hover {
      border-color: var(--color-primary-light);
      background: rgba(59, 130, 246, 0.03);
    }

    .resolution-type-card.selected {
      border-color: var(--color-primary);
      background: rgba(59, 130, 246, 0.08);
    }

    .resolution-type-card .type-icon {
      font-size: 1.5rem;
      margin-bottom: var(--space-xs);
    }

    .resolution-type-card .type-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--color-text);
    }

    .resolution-type-card.selected .type-label {
      color: var(--color-primary);
    }

    /* ============================================
       SIGNATURE COMPONENTS
       ============================================ */
    .signature-type-toggle {
      display: flex;
      gap: 4px;
      margin-bottom: 12px;
    }

    .sig-toggle-btn {
      flex: 1;
      padding: 8px 12px;
      background: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-sm);
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--color-text-muted);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .sig-toggle-btn:hover {
      border-color: var(--color-primary-light);
    }

    .sig-toggle-btn.active {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: #fff;
    }

    .signature-draw-container {
      margin-bottom: 12px;
    }

    .signature-canvas {
      width: 100%;
      height: 100px;
      border: 2px dashed var(--color-border);
      border-radius: var(--radius-md);
      background: #fff;
      cursor: crosshair;
    }

    .signature-actions {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .signature-actions button {
      padding: 6px 12px;
      background: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-sm);
      font-size: 0.8rem;
      color: var(--color-text-muted);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .signature-actions button:hover {
      border-color: var(--color-primary);
      color: var(--color-primary);
    }

    .signature-type-container {
      display: none;
    }

    .signature-typed-input {
      font-family: 'Dancing Script', cursive;
      font-size: 1.5rem;
      text-align: center;
    }

    .signature-typed-preview {
      font-family: 'Dancing Script', cursive;
      font-size: 1.8rem;
      color: var(--color-text);
      text-align: center;
      padding: 10px;
      min-height: 60px;
      border: 2px dashed var(--color-border);
      border-radius: var(--radius-md);
      margin-bottom: 8px;
    }

    /* ============================================
       PREVIEW PANEL (Right Side)
       ============================================ */
    .preview-panel {
      background: var(--color-bg);
      padding: var(--space-xl);
      overflow-y: auto;
    }

    .preview-toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
      flex-wrap: wrap;
    }

    .preview-title {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--color-text-muted);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .preview-hint {
      font-size: 0.75rem;
      color: var(--color-text-muted);
      font-weight: 400;
      margin-left: var(--space-sm);
    }

    .preview-actions {
      display: flex;
      gap: var(--space-sm);
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
      border: none;
    }

    .btn-primary {
      background: var(--color-primary);
      color: #fff;
    }

    .btn-primary:hover {
      background: var(--color-primary-dark);
    }

    .btn-secondary {
      background: var(--color-surface);
      color: var(--color-text);
      border: 1px solid var(--color-border);
    }

    .btn-secondary:hover {
      border-color: var(--color-primary);
      color: var(--color-primary);
    }

    .btn-sm {
      padding: 8px 12px;
      font-size: 0.85rem;
    }

    #editModeBtn.active {
      background: var(--color-primary);
      color: #fff;
      border-color: var(--color-primary);
    }

    /* Edit Toolbar */
    .edit-toolbar {
      display: none;
      align-items: center;
      gap: 4px;
      padding: 8px 12px;
      background: var(--color-dark);
      border-radius: var(--radius-md);
      margin-top: var(--space-sm);
    }

    .edit-toolbar button {
      padding: 6px 10px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-sm);
      color: #fff;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .edit-toolbar button:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .edit-toolbar .cancel-btn {
      background: rgba(220, 38, 38, 0.3);
      border-color: rgba(220, 38, 38, 0.5);
    }

    .edit-toolbar .cancel-btn:hover {
      background: rgba(220, 38, 38, 0.5);
    }

    .toolbar-divider {
      width: 1px;
      height: 20px;
      background: rgba(255, 255, 255, 0.2);
      margin: 0 4px;
    }

    /* Document Container */
    .document-container {
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    .document-header {
      background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%);
      padding: var(--space-md) var(--space-lg);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .document-title {
      color: #fff;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .document-status {
      font-size: 0.75rem;
      color: var(--color-accent-light);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .document-body {
      padding: 50px;
      background: var(--doc-bg);
      font-family: var(--font-serif);
      font-size: 12pt;
      line-height: 1.6;
      color: var(--doc-text);
      min-height: 600px;
      max-height: 80vh;
      overflow-y: auto;
    }

    /* Full Edit Mode */
    .full-edit-mode {
      border: 2px dashed var(--color-primary) !important;
      background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%) !important;
    }

    .full-edit-mode:focus {
      outline: none;
    }

    .full-edit-mode .doc-highlight {
      background: transparent;
      border: none;
    }

    /* Document Styling */
    .doc-title {
      text-align: center;
      font-size: 18pt;
      font-weight: bold;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .doc-subtitle {
      text-align: center;
      font-size: 14pt;
      margin-bottom: 30px;
      color: var(--doc-text);
    }

    .doc-highlight {
      background: var(--doc-highlight);
      border-bottom: 2px solid var(--doc-highlight-border);
      padding: 1px 4px;
      border-radius: 2px;
      transition: all var(--transition-fast);
      cursor: text;
    }

    .doc-highlight:hover {
      background: #fef3c7;
      border-bottom-color: var(--color-primary);
      box-shadow: 0 0 0 2px rgba(30, 64, 175, 0.2);
    }

    .doc-highlight[contenteditable="true"]:focus {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
      background: #fef9c3;
    }

    .doc-highlight.empty {
      color: var(--color-text-muted);
      font-style: italic;
    }

    .doc-highlight.flash {
      animation: flashHighlight 1.5s ease;
    }

    @keyframes flashHighlight {
      0%, 100% { background: var(--doc-highlight); }
      25% { background: #fbbf24; box-shadow: 0 0 12px rgba(251, 191, 36, 0.5); }
      50% { background: #fde68a; }
      75% { background: #fbbf24; box-shadow: 0 0 8px rgba(251, 191, 36, 0.3); }
    }

    /* Flash animation for div/list elements (for resolution type changes) */
    div.flash,
    ul.flash,
    ol.flash {
      animation: flashContainer 1.5s ease;
    }

    @keyframes flashContainer {
      0%, 100% { background: transparent; }
      25% { background: rgba(251, 191, 36, 0.2); box-shadow: 0 0 12px rgba(251, 191, 36, 0.3); }
      50% { background: rgba(253, 230, 138, 0.3); }
      75% { background: rgba(251, 191, 36, 0.2); }
    }

    .doc-paragraph {
      margin-bottom: 16px;
      text-align: justify;
    }

    .doc-indent {
      margin-left: 28px;
    }

    .doc-list {
      margin-left: 28px;
      margin-bottom: 16px;
    }

    .doc-list li {
      margin-bottom: 8px;
    }

    .doc-clause-title {
      font-weight: bold;
      margin-top: 24px;
      margin-bottom: 12px;
      color: var(--doc-clause-title);
      text-transform: uppercase;
      font-size: 11pt;
      letter-spacing: 0.5px;
    }

    .doc-section-num {
      color: var(--doc-section-num);
      font-weight: 600;
    }

    .doc-signature-block {
      margin-top: 50px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .doc-signature-party {
      border-top: 1px solid var(--doc-border);
      padding-top: 20px;
    }

    .doc-signature-line {
      margin-top: 50px;
      padding-top: 8px;
      border-top: 1px solid var(--doc-text);
      max-width: 300px;
    }

    .doc-signature-image {
      max-height: 60px;
      margin-bottom: 8px;
    }

    .doc-signature-typed {
      font-family: 'Dancing Script', cursive;
      font-size: 28px;
      display: block;
      margin-bottom: 8px;
    }

    /* Attorney CTA */
    .attorney-cta {
      margin-top: var(--space-xl);
      padding: var(--space-lg);
      background: linear-gradient(135deg, rgba(30, 64, 175, 0.05), rgba(13, 148, 136, 0.05));
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      text-align: center;
    }

    .attorney-cta h3 {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--color-text);
      margin-bottom: var(--space-sm);
    }

    .attorney-cta p {
      font-size: 0.9rem;
      color: var(--color-text-muted);
      margin-bottom: var(--space-md);
    }

    .attorney-cta .btn {
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--color-dark);
      color: #fff;
      padding: 14px 24px;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      box-shadow: var(--shadow-xl);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 1.75rem;
      }

      .builder-layout {
        grid-template-columns: 1fr;
      }

      .builder-sidebar {
        max-height: none;
        position: static;
      }

      .document-body {
        padding: 30px 20px;
      }

      .resolution-type-grid {
        grid-template-columns: 1fr;
      }

      .preview-toolbar {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="../index.html" class="nav-link home-logo">
          <span class="logo-text">Terms.Law</span>
        </a>
        <a href="../Templates/contract-library-landing.html" class="nav-link active">Contracts</a>
        <a href="../Demand-Letters/demand-letters-landing.html" class="nav-link">Demand Letters</a>
        <a href="../Blog/blog-landing.html" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>

  <!-- Breadcrumb -->
  <nav class="breadcrumb">
    <div class="breadcrumb-content">
      <a href="../Templates/contract-library-landing.html" class="breadcrumb-link">Contracts</a>
      <span class="breadcrumb-separator">/</span>
      <a href="../Templates/contract-library-landing.html" class="breadcrumb-link">Governance</a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">Board Resolution Generator</span>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <div class="hero-content">
        <div class="hero-badge">
          <span class="hero-badge-icon">&#x2713;</span>
          Free Corporate Resolution Builder
        </div>
        <h1>Board <span class="highlight">Resolution</span> Generator</h1>
        <p class="hero-subtitle">
          Create professional board resolutions to <strong>authorize business decisions</strong>,
          appoint officers, approve contracts, or document any official corporate action.
          Attorney-drafted language with real-time preview.
        </p>
        <div class="hero-features">
          <span class="hero-feature">
            <span class="hero-feature-icon">&#x2713;</span>
            Multiple Resolution Types
          </span>
          <span class="hero-feature">
            <span class="hero-feature-icon">&#x2713;</span>
            Electronic Signatures
          </span>
          <span class="hero-feature">
            <span class="hero-feature-icon">&#x2713;</span>
            Instant Download
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Builder -->
  <main class="builder-layout">
    <!-- LEFT: Form Inputs -->
    <aside class="builder-sidebar">
      <!-- Company Information -->
      <div class="builder-section">
        <div class="builder-section-title">
          <span class="icon">&#x1F3E2;</span>
          Company Information
        </div>
        <div class="form-group">
          <label class="form-label">Company Name</label>
          <input type="text" class="form-input" id="companyName" placeholder="Acme Corporation" oninput="trackFieldEdit('companyName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select class="form-select" id="companyState" onchange="trackFieldEdit('companyState')">
            <option value="">Select state...</option>
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
            <option value="Florida">Florida</option>
            <option value="Nevada">Nevada</option>
            <option value="Wyoming">Wyoming</option>
            <option value="Illinois">Illinois</option>
            <option value="Pennsylvania">Pennsylvania</option>
            <option value="Ohio">Ohio</option>
            <option value="Georgia">Georgia</option>
            <option value="North Carolina">North Carolina</option>
            <option value="Michigan">Michigan</option>
            <option value="New Jersey">New Jersey</option>
            <option value="Virginia">Virginia</option>
            <option value="Washington">Washington</option>
            <option value="Arizona">Arizona</option>
            <option value="Massachusetts">Massachusetts</option>
            <option value="Tennessee">Tennessee</option>
            <option value="Indiana">Indiana</option>
            <option value="Missouri">Missouri</option>
            <option value="Maryland">Maryland</option>
            <option value="Wisconsin">Wisconsin</option>
            <option value="Colorado">Colorado</option>
            <option value="Minnesota">Minnesota</option>
            <option value="South Carolina">South Carolina</option>
            <option value="Alabama">Alabama</option>
            <option value="Louisiana">Louisiana</option>
            <option value="Kentucky">Kentucky</option>
            <option value="Oregon">Oregon</option>
            <option value="Oklahoma">Oklahoma</option>
            <option value="Connecticut">Connecticut</option>
            <option value="Utah">Utah</option>
            <option value="Iowa">Iowa</option>
            <option value="Nevada">Nevada</option>
            <option value="Arkansas">Arkansas</option>
            <option value="Mississippi">Mississippi</option>
            <option value="Kansas">Kansas</option>
            <option value="New Mexico">New Mexico</option>
            <option value="Nebraska">Nebraska</option>
            <option value="West Virginia">West Virginia</option>
            <option value="Idaho">Idaho</option>
            <option value="Hawaii">Hawaii</option>
            <option value="New Hampshire">New Hampshire</option>
            <option value="Maine">Maine</option>
            <option value="Montana">Montana</option>
            <option value="Rhode Island">Rhode Island</option>
            <option value="South Dakota">South Dakota</option>
            <option value="North Dakota">North Dakota</option>
            <option value="Alaska">Alaska</option>
            <option value="Vermont">Vermont</option>
            <option value="District of Columbia">District of Columbia</option>
          </select>
        </div>
      </div>

      <!-- Resolution Type -->
      <div class="builder-section">
        <div class="builder-section-title">
          <span class="icon">&#x1F4CB;</span>
          Resolution Type
        </div>
        <div class="resolution-type-grid">
          <div class="resolution-type-card selected" data-type="officer" onclick="selectResolutionType(this)">
            <div class="type-icon">&#x1F464;</div>
            <div class="type-label">Appoint Officer</div>
          </div>
          <div class="resolution-type-card" data-type="contract" onclick="selectResolutionType(this)">
            <div class="type-icon">&#x1F4DD;</div>
            <div class="type-label">Approve Contract</div>
          </div>
          <div class="resolution-type-card" data-type="bank" onclick="selectResolutionType(this)">
            <div class="type-icon">&#x1F3E6;</div>
            <div class="type-label">Bank Account</div>
          </div>
          <div class="resolution-type-card" data-type="general" onclick="selectResolutionType(this)">
            <div class="type-icon">&#x2699;</div>
            <div class="type-label">General Action</div>
          </div>
        </div>
      </div>

      <!-- Resolution Details (conditional) -->
      <div class="builder-section" id="officerSection">
        <div class="builder-section-title">
          <span class="icon">&#x1F464;</span>
          Officer Appointment
        </div>
        <div class="form-group">
          <label class="form-label">Officer Name</label>
          <input type="text" class="form-input" id="officerName" placeholder="John Smith" oninput="trackFieldEdit('officerName')">
        </div>
        <div class="form-group">
          <label class="form-label">Position/Title</label>
          <select class="form-select" id="officerTitle" onchange="trackFieldEdit('officerTitle')">
            <option value="Chief Executive Officer">Chief Executive Officer (CEO)</option>
            <option value="President">President</option>
            <option value="Chief Financial Officer">Chief Financial Officer (CFO)</option>
            <option value="Chief Operating Officer">Chief Operating Officer (COO)</option>
            <option value="Secretary">Secretary</option>
            <option value="Treasurer">Treasurer</option>
            <option value="Vice President">Vice President</option>
            <option value="Director">Director</option>
          </select>
        </div>
        <div class="info-box">
          <div class="info-box-title">Note</div>
          <p>The appointed officer will have the authority and duties customary for their position as defined in the company's bylaws.</p>
        </div>
      </div>

      <div class="builder-section" id="contractSection" style="display: none;">
        <div class="builder-section-title">
          <span class="icon">&#x1F4DD;</span>
          Contract Approval
        </div>
        <div class="form-group">
          <label class="form-label">Contract Description</label>
          <input type="text" class="form-input" id="contractDescription" placeholder="Software License Agreement with Vendor Inc." oninput="trackFieldEdit('contractDescription')">
        </div>
        <div class="form-group">
          <label class="form-label">Contract Value (if applicable)</label>
          <input type="text" class="form-input" id="contractValue" placeholder="$50,000" oninput="trackFieldEdit('contractValue')">
        </div>
        <div class="form-group">
          <label class="form-label">Authorized Signer</label>
          <input type="text" class="form-input" id="authorizedSigner" placeholder="Jane Doe, CEO" oninput="trackFieldEdit('authorizedSigner')">
        </div>
      </div>

      <div class="builder-section" id="bankSection" style="display: none;">
        <div class="builder-section-title">
          <span class="icon">&#x1F3E6;</span>
          Bank Account Authorization
        </div>
        <div class="form-group">
          <label class="form-label">Bank Name</label>
          <input type="text" class="form-input" id="bankName" placeholder="First National Bank" oninput="trackFieldEdit('bankName')">
        </div>
        <div class="form-group">
          <label class="form-label">Account Type</label>
          <select class="form-select" id="accountType" onchange="trackFieldEdit('accountType')">
            <option value="business checking">Business Checking Account</option>
            <option value="business savings">Business Savings Account</option>
            <option value="merchant services">Merchant Services Account</option>
            <option value="line of credit">Business Line of Credit</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Authorized Signers</label>
          <input type="text" class="form-input" id="bankSigners" placeholder="John Smith, Jane Doe" oninput="trackFieldEdit('bankSigners')">
          <div class="form-hint">Separate multiple names with commas</div>
        </div>
      </div>

      <div class="builder-section" id="generalSection" style="display: none;">
        <div class="builder-section-title">
          <span class="icon">&#x2699;</span>
          General Resolution
        </div>
        <div class="form-group">
          <label class="form-label">Resolution Title</label>
          <input type="text" class="form-input" id="generalTitle" placeholder="Approval of Annual Budget" oninput="trackFieldEdit('generalTitle')">
        </div>
        <div class="form-group">
          <label class="form-label">
            Resolution Text
            <span class="help-trigger">?
              <span class="help-tooltip">Describe the specific action being authorized. Be clear and specific about what is being resolved.</span>
            </span>
          </label>
          <textarea class="form-textarea" id="generalText" placeholder="RESOLVED, that the Board of Directors hereby authorizes and approves..." oninput="trackFieldEdit('generalText')"></textarea>
        </div>
      </div>

      <!-- Meeting Details -->
      <div class="builder-section">
        <div class="builder-section-title">
          <span class="icon">&#x1F4C5;</span>
          Meeting Details
        </div>
        <div class="form-group">
          <label class="form-label">Resolution Date</label>
          <input type="date" class="form-input" id="resolutionDate" onchange="trackFieldEdit('resolutionDate')">
        </div>
        <div class="form-group">
          <label class="form-label">Meeting Type</label>
          <select class="form-select" id="meetingType" onchange="trackFieldEdit('meetingType')">
            <option value="regular">Regular Meeting of the Board</option>
            <option value="special">Special Meeting of the Board</option>
            <option value="unanimous">Unanimous Written Consent</option>
          </select>
        </div>
      </div>

      <!-- Secretary Certification -->
      <div class="builder-section">
        <div class="builder-section-title">
          <span class="icon">&#x270D;</span>
          Secretary Certification
        </div>
        <div class="form-group">
          <label class="form-label">Secretary Name</label>
          <input type="text" class="form-input" id="secretaryName" placeholder="Jane Doe" oninput="trackFieldEdit('secretaryName')">
        </div>

        <!-- Signature -->
        <div class="form-group">
          <label class="form-label">Secretary Signature</label>
          <div class="signature-type-toggle">
            <button type="button" class="sig-toggle-btn active" data-type="draw" onclick="setSignatureType('draw')">
              Draw
            </button>
            <button type="button" class="sig-toggle-btn" data-type="type" onclick="setSignatureType('type')">
              Type
            </button>
          </div>

          <div class="signature-draw-container" id="sigDrawContainer">
            <canvas class="signature-canvas" id="signatureCanvas"></canvas>
            <div class="signature-actions">
              <button type="button" onclick="clearSignature()">Clear</button>
            </div>
          </div>

          <div class="signature-type-container" id="sigTypeContainer">
            <div class="signature-typed-preview" id="signatureTypedPreview"></div>
            <input type="text" class="form-input signature-typed-input" id="signatureTyped" placeholder="Type your name" oninput="updateTypedSignature()">
          </div>
        </div>
      </div>

    </aside>

    <!-- RIGHT: Document Preview -->
    <div class="preview-panel">
      <div class="preview-toolbar">
        <div class="preview-title">
          <span class="icon">&#x1F4C4;</span>
          Live Document Preview
          <span class="preview-hint">(click any highlighted text to edit inline)</span>
        </div>
        <div class="preview-actions">
          <button class="btn btn-secondary btn-sm" id="editModeBtn" onclick="toggleFullEditMode()">
            &#x270F;&#xFE0F; Edit Mode
          </button>
          <button class="btn btn-secondary btn-sm" onclick="copyDocument()">
            &#x1F4CB; Copy
          </button>
          <button class="btn btn-secondary btn-sm" onclick="downloadWord()">
            &#x1F4DD; .docx
          </button>
          <button class="btn btn-primary btn-sm" onclick="downloadPDF()">
            &#x2B07;&#xFE0F; Download PDF
          </button>
        </div>
      </div>

      <div class="document-container">
        <div class="document-header">
          <div class="document-title">Board Resolution</div>
          <div class="document-status">Ready to download</div>
        </div>
        <div class="document-body" id="documentPreview">
          <!-- Document content will be generated here -->
        </div>
      </div>

      <!-- Attorney CTA -->
      <div class="attorney-cta">
        <h3>Need a Custom Corporate Resolution?</h3>
        <p>Our attorneys can draft complex resolutions for mergers, acquisitions, or special situations.</p>
        <button class="btn btn-primary" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30min'});return false;">
          Schedule Consultation
        </button>
      </div>
    </div>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script>
    // ============================================
    // STATE VARIABLES
    // ============================================
    let resolutionType = 'officer';
    let isFullEditMode = false;
    let savedDocumentHTML = '';
    let hasCustomEdits = false; // Track if user made custom edits in full edit mode

    // Signature data
    const signatureData = { type: 'draw', data: null };

    // Track which field was just edited
    let lastEditedField = null;

    function trackFieldEdit(fieldId) {
      // Check if user has unsaved custom edits
      if (hasCustomEdits) {
        const proceed = confirm(
          'You have custom edits in the document preview.\n\n' +
          'Changing form inputs will regenerate the document and your custom edits will be lost.\n\n' +
          'Click OK to regenerate, or Cancel to keep your edits.'
        );
        if (!proceed) {
          return; // Don't update preview, keep custom edits
        }
        // User chose to proceed - clear the custom edits flag
        hasCustomEdits = false;
      }
      lastEditedField = fieldId;
      updatePreview();
    }

    // ============================================
    // INITIALIZATION
    // ============================================
    document.addEventListener('DOMContentLoaded', function() {
      // Set today's date as default
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('resolutionDate').value = today;

      // Initialize signature canvas
      initSignatureCanvas();

      updatePreview();
      setupInlineEditing();
    });

    // ============================================
    // RESOLUTION TYPE SELECTION
    // ============================================
    function selectResolutionType(card) {
      // Remove selected from all cards
      document.querySelectorAll('.resolution-type-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');

      resolutionType = card.dataset.type;

      // Hide all conditional sections
      document.getElementById('officerSection').style.display = 'none';
      document.getElementById('contractSection').style.display = 'none';
      document.getElementById('bankSection').style.display = 'none';
      document.getElementById('generalSection').style.display = 'none';

      // Show relevant section
      if (resolutionType === 'officer') {
        document.getElementById('officerSection').style.display = 'block';
      } else if (resolutionType === 'contract') {
        document.getElementById('contractSection').style.display = 'block';
      } else if (resolutionType === 'bank') {
        document.getElementById('bankSection').style.display = 'block';
      } else if (resolutionType === 'general') {
        document.getElementById('generalSection').style.display = 'block';
      }

      // Track field for scroll-to-view
      lastEditedField = 'resolutionContent';
      updatePreview();
    }

    // ============================================
    // SIGNATURE HANDLING
    // ============================================
    function initSignatureCanvas() {
      const canvas = document.getElementById('signatureCanvas');
      const ctx = canvas.getContext('2d');
      let isDrawing = false;

      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;

      ctx.strokeStyle = '#0f172a';
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      function startDrawing(e) {
        isDrawing = true;
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX || e.touches[0].clientX) - rect.left;
        const y = (e.clientY || e.touches[0].clientY) - rect.top;
        ctx.beginPath();
        ctx.moveTo(x, y);
      }

      function draw(e) {
        if (!isDrawing) return;
        e.preventDefault();
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX || e.touches[0].clientX) - rect.left;
        const y = (e.clientY || e.touches[0].clientY) - rect.top;
        ctx.lineTo(x, y);
        ctx.stroke();
        signatureData.data = canvas.toDataURL();
        updatePreview();
      }

      function stopDrawing() {
        isDrawing = false;
      }

      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseout', stopDrawing);
      canvas.addEventListener('touchstart', startDrawing);
      canvas.addEventListener('touchmove', draw);
      canvas.addEventListener('touchend', stopDrawing);
    }

    function clearSignature() {
      const canvas = document.getElementById('signatureCanvas');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      signatureData.data = null;
      updatePreview();
    }

    function setSignatureType(type) {
      document.querySelectorAll('.sig-toggle-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.type === type);
      });

      document.getElementById('sigDrawContainer').style.display = type === 'draw' ? 'block' : 'none';
      document.getElementById('sigTypeContainer').style.display = type === 'type' ? 'block' : 'none';

      signatureData.type = type;
      updatePreview();
    }

    function updateTypedSignature() {
      const input = document.getElementById('signatureTyped');
      const preview = document.getElementById('signatureTypedPreview');
      preview.textContent = input.value;
      signatureData.data = input.value;
      updatePreview();
    }

    // ============================================
    // DOCUMENT PREVIEW
    // ============================================
    function updatePreview() {
      // Don't update if in full edit mode (preserve user's custom edits)
      if (isFullEditMode) return;

      // Helper function for highlighted editable fields
      const h = (value, placeholder, fieldId) => {
        const isEmpty = !value || value.startsWith('[');
        const displayValue = isEmpty ? `[${placeholder}]` : value;
        const emptyClass = isEmpty ? ' empty' : '';
        return `<span class="doc-highlight${emptyClass}" data-field="${fieldId}" contenteditable="true">${displayValue}</span>`;
      };

      const companyName = document.getElementById('companyName').value || '';
      const companyState = document.getElementById('companyState').value || '';
      const resolutionDate = document.getElementById('resolutionDate').value ?
        formatDate(document.getElementById('resolutionDate').value) : '';
      const meetingType = document.getElementById('meetingType').value;
      const secretaryName = document.getElementById('secretaryName').value || '';

      const meetingTypeText = {
        'regular': 'a regular meeting',
        'special': 'a special meeting',
        'unanimous': 'unanimous written consent'
      }[meetingType];

      let html = `
        <div class="doc-title">
          RESOLUTION OF THE BOARD OF DIRECTORS
        </div>
        <div class="doc-subtitle">
          of ${h(companyName, 'COMPANY NAME', 'companyName')}
        </div>

        <p class="doc-paragraph">
          The undersigned, being the Secretary of ${h(companyName, 'COMPANY NAME', 'companyName')},
          a ${h(companyState, 'STATE', 'companyState')} corporation (the "<strong>Corporation</strong>"),
          hereby certifies that the following resolution was duly adopted by ${meetingTypeText} of the
          Board of Directors of the Corporation held on ${h(resolutionDate, 'DATE', 'resolutionDate')},
          at which a quorum was present and acting throughout.
        </p>

        <p class="doc-clause-title">Resolution</p>
      `;

      // Add resolution content based on type - wrapped in div for scroll-to-view
      html += `<div data-field="resolutionContent">`;

      if (resolutionType === 'officer') {
        const officerName = document.getElementById('officerName').value || '';
        const officerTitle = document.getElementById('officerTitle').value;

        html += `
          <p class="doc-paragraph">
            <strong>RESOLVED</strong>, that ${h(officerName, 'OFFICER NAME', 'officerName')} is hereby
            appointed as ${h(officerTitle, 'TITLE', 'officerTitle')} of the Corporation, effective immediately,
            to serve until their successor is duly elected and qualified or until their earlier resignation,
            removal, or death.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that ${h(officerName, 'OFFICER NAME', 'officerName')} shall
            have all powers, duties, and responsibilities customarily associated with the position of
            ${h(officerTitle, 'TITLE', 'officerTitle')} as set forth in the Corporation's Bylaws.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the officers of the Corporation are hereby authorized
            to execute and deliver any and all documents and to take any and all actions necessary or
            appropriate to effectuate the foregoing resolution.
          </p>
        `;
      } else if (resolutionType === 'contract') {
        const contractDescription = document.getElementById('contractDescription').value || '';
        const contractValue = document.getElementById('contractValue').value || '';
        const authorizedSigner = document.getElementById('authorizedSigner').value || '';

        html += `
          <p class="doc-paragraph">
            <strong>RESOLVED</strong>, that the Corporation is hereby authorized to enter into
            ${h(contractDescription, 'CONTRACT DESCRIPTION', 'contractDescription')}
            ${contractValue ? `with a value of ${h(contractValue, 'VALUE', 'contractValue')}` : ''},
            substantially in the form presented to the Board.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that ${h(authorizedSigner, 'AUTHORIZED SIGNER', 'authorizedSigner')}
            is hereby authorized to negotiate, execute, and deliver said agreement on behalf of the Corporation,
            with such changes thereto as such officer may approve, such approval to be conclusively evidenced
            by such officer's execution thereof.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the officers of the Corporation are hereby authorized
            to execute and deliver any and all documents and to take any and all actions necessary or
            appropriate to effectuate the foregoing resolution.
          </p>
        `;
      } else if (resolutionType === 'bank') {
        const bankName = document.getElementById('bankName').value || '';
        const accountType = document.getElementById('accountType').value;
        const bankSigners = document.getElementById('bankSigners').value || '';

        html += `
          <p class="doc-paragraph">
            <strong>RESOLVED</strong>, that the Corporation is hereby authorized to open and maintain
            a ${accountType} at ${h(bankName, 'BANK NAME', 'bankName')} (the "<strong>Bank</strong>").
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the following individuals are hereby authorized as
            signatories on said account, with full authority to deposit funds, withdraw funds, execute
            checks, drafts, and other orders for payment of money, and to perform all acts necessary
            to manage the account: ${h(bankSigners, 'AUTHORIZED SIGNERS', 'bankSigners')}.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the Bank is hereby authorized to honor, receive,
            certify, or pay all items without inquiry as to the circumstances of issue or the disposition
            of the proceeds thereof, and without limit as to amount.
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the Secretary is hereby authorized to certify to the
            Bank the names and signatures of the authorized signatories and to execute any documentation
            required by the Bank to open and maintain said account.
          </p>
        `;
      } else if (resolutionType === 'general') {
        const generalTitle = document.getElementById('generalTitle').value || '';
        const generalText = document.getElementById('generalText').value || '';

        html += `
          <p class="doc-paragraph" style="font-weight: 600; margin-bottom: 8px;">
            Re: ${h(generalTitle, 'RESOLUTION TITLE', 'generalTitle')}
          </p>

          <p class="doc-paragraph">
            ${generalText ? h(generalText, 'RESOLUTION TEXT', 'generalText') :
              '<span class="doc-highlight empty" data-field="generalText" contenteditable="true">[Enter your resolution text in the sidebar...]</span>'}
          </p>

          <p class="doc-paragraph">
            <strong>FURTHER RESOLVED</strong>, that the officers of the Corporation are hereby authorized
            to execute and deliver any and all documents and to take any and all actions necessary or
            appropriate to effectuate the foregoing resolution.
          </p>
        `;
      }

      // Close resolution content wrapper
      html += `</div>`;

      // Certification
      html += `
        <p class="doc-clause-title">Secretary's Certification</p>

        <p class="doc-paragraph">
          I, ${h(secretaryName, 'SECRETARY NAME', 'secretaryName')}, Secretary of ${h(companyName, 'COMPANY NAME', 'companyName')},
          do hereby certify that:
        </p>

        <p class="doc-paragraph doc-indent">
          (i) The foregoing is a true and correct copy of a resolution duly adopted by the Board of Directors
          of the Corporation on the date set forth above;
        </p>

        <p class="doc-paragraph doc-indent">
          (ii) Such resolution has not been modified, rescinded, or revoked and is in full force and effect
          as of the date hereof; and
        </p>

        <p class="doc-paragraph doc-indent">
          (iii) The Corporation is duly organized, validly existing, and in good standing under the laws of
          the State of ${h(companyState, 'STATE', 'companyState')}.
        </p>

        <p class="doc-paragraph">
          IN WITNESS WHEREOF, I have executed this certificate as of ${h(resolutionDate, 'DATE', 'resolutionDate')}.
        </p>

        <div class="doc-signature-block">
          <div class="doc-signature-party">
      `;

      // Signature
      if (signatureData.type === 'draw' && signatureData.data) {
        html += `<img src="${signatureData.data}" class="doc-signature-image" alt="Signature">`;
      } else if (signatureData.type === 'type' && signatureData.data) {
        html += `<span class="doc-signature-typed">${signatureData.data}</span>`;
      }

      html += `
            <div class="doc-signature-line">
              ${h(secretaryName, 'SECRETARY NAME', 'secretaryName')}<br>
              Secretary
            </div>
          </div>
        </div>
      `;

      document.getElementById('documentPreview').innerHTML = html;
      addHighlightClickHandlers();

      // Flash the field that was just updated and scroll to it
      if (lastEditedField) {
        // Try to find any element with this data-field (not just .doc-highlight)
        const highlight = document.querySelector(`[data-field="${lastEditedField}"]`);
        if (highlight) {
          highlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
          highlight.classList.add('flash');
          setTimeout(() => highlight.classList.remove('flash'), 1500);
        }
        lastEditedField = null;
      }
    }

    // ============================================
    // INLINE EDITING
    // ============================================
    const fieldInputMap = {
      'companyName': { inputId: 'companyName', type: 'text' },
      'companyState': { inputId: 'companyState', type: 'select' },
      'resolutionDate': { inputId: 'resolutionDate', type: 'date' },
      'secretaryName': { inputId: 'secretaryName', type: 'text' },
      'officerName': { inputId: 'officerName', type: 'text' },
      'officerTitle': { inputId: 'officerTitle', type: 'select' },
      'contractDescription': { inputId: 'contractDescription', type: 'text' },
      'contractValue': { inputId: 'contractValue', type: 'text' },
      'authorizedSigner': { inputId: 'authorizedSigner', type: 'text' },
      'bankName': { inputId: 'bankName', type: 'text' },
      'accountType': { inputId: 'accountType', type: 'select' },
      'bankSigners': { inputId: 'bankSigners', type: 'text' },
      'generalTitle': { inputId: 'generalTitle', type: 'text' },
      'generalText': { inputId: 'generalText', type: 'textarea' }
    };

    function setupInlineEditing() {
      const docPreview = document.getElementById('documentPreview');

      docPreview.addEventListener('blur', function(e) {
        if (e.target.classList.contains('doc-highlight') && e.target.dataset.field && !isFullEditMode) {
          handleInlineEdit(e.target);
        }
      }, true);

      docPreview.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && e.target.classList.contains('doc-highlight') && !isFullEditMode) {
          e.preventDefault();
          e.target.blur();
        }
      });

      docPreview.addEventListener('focus', function(e) {
        if (e.target.classList.contains('doc-highlight') && e.target.classList.contains('empty')) {
          const text = e.target.textContent;
          if (text.startsWith('[') && text.endsWith(']')) {
            e.target.textContent = '';
            e.target.classList.remove('empty');
          }
        }
      }, true);
    }

    function handleInlineEdit(element) {
      const fieldId = element.dataset.field;
      const newValue = element.textContent.trim();
      const mapping = fieldInputMap[fieldId];

      if (!mapping) return;

      const inputEl = document.getElementById(mapping.inputId);
      if (!inputEl) return;

      if (mapping.type === 'date') {
        const parsedDate = parseDateString(newValue);
        if (parsedDate) {
          inputEl.value = parsedDate;
        } else {
          showToast('Invalid date format');
        }
      } else if (mapping.type === 'select') {
        const options = Array.from(inputEl.options);
        const matchedOption = options.find(opt =>
          opt.text.toLowerCase() === newValue.toLowerCase() ||
          opt.value.toLowerCase() === newValue.toLowerCase()
        );
        if (matchedOption) {
          inputEl.value = matchedOption.value;
        } else {
          showToast('Please select from the dropdown in the sidebar');
        }
      } else if (mapping.type === 'textarea') {
        inputEl.value = newValue;
      } else {
        inputEl.value = newValue;
      }

      updatePreview();
    }

    function parseDateString(dateStr) {
      try {
        const date = new Date(dateStr);
        if (isNaN(date.getTime())) return null;
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      } catch {
        return null;
      }
    }

    // ============================================
    // FULL EDIT MODE
    // ============================================
    function toggleFullEditMode() {
      const docBody = document.getElementById('documentPreview');
      const toggleBtn = document.getElementById('editModeBtn');
      const toolbar = document.querySelector('.preview-toolbar');

      if (!isFullEditMode) {
        isFullEditMode = true;
        savedDocumentHTML = docBody.innerHTML;
        docBody.contentEditable = 'true';
        docBody.classList.add('full-edit-mode');
        toggleBtn.innerHTML = '&#x2713; Save Edits';
        toggleBtn.classList.add('active');

        showToast('Full Edit Mode: You can now freely edit any text in the document');

        if (!document.getElementById('editToolbar')) {
          const editToolbar = document.createElement('div');
          editToolbar.id = 'editToolbar';
          editToolbar.className = 'edit-toolbar';
          editToolbar.innerHTML = `
            <button onclick="document.execCommand('bold')" title="Bold"><strong>B</strong></button>
            <button onclick="document.execCommand('italic')" title="Italic"><em>I</em></button>
            <button onclick="document.execCommand('underline')" title="Underline"><u>U</u></button>
            <span class="toolbar-divider"></span>
            <button onclick="addNewParagraph()" title="Add Paragraph">&#182;+</button>
            <span class="toolbar-divider"></span>
            <button onclick="cancelEditMode()" class="cancel-btn" title="Cancel">&#x2715; Cancel</button>
          `;
          toolbar.appendChild(editToolbar);
        }
        document.getElementById('editToolbar').style.display = 'flex';
      } else {
        saveFullEdits();
      }
    }

    function saveFullEdits() {
      const docBody = document.getElementById('documentPreview');
      const toggleBtn = document.getElementById('editModeBtn');

      isFullEditMode = false;
      hasCustomEdits = true; // Mark that user has custom edits to protect
      docBody.contentEditable = 'false';
      docBody.classList.remove('full-edit-mode');
      toggleBtn.innerHTML = '&#x270F;&#xFE0F; Edit Mode';
      toggleBtn.classList.remove('active');

      if (document.getElementById('editToolbar')) {
        document.getElementById('editToolbar').style.display = 'none';
      }

      showToast('Edits saved! Form changes will ask before overwriting.');
    }

    function cancelEditMode() {
      const docBody = document.getElementById('documentPreview');
      const toggleBtn = document.getElementById('editModeBtn');

      if (savedDocumentHTML) {
        docBody.innerHTML = savedDocumentHTML;
      }

      isFullEditMode = false;
      hasCustomEdits = false; // User cancelled, no custom edits to protect
      docBody.contentEditable = 'false';
      docBody.classList.remove('full-edit-mode');
      toggleBtn.innerHTML = '&#x270F;&#xFE0F; Edit Mode';
      toggleBtn.classList.remove('active');

      if (document.getElementById('editToolbar')) {
        document.getElementById('editToolbar').style.display = 'none';
      }

      showToast('Changes discarded');
      addHighlightClickHandlers();
    }

    function addNewParagraph() {
      document.execCommand('insertHTML', false, '<p class="doc-paragraph">New paragraph text here...</p>');
    }

    // ============================================
    // UTILITY FUNCTIONS
    // ============================================
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
    }

    function scrollToField(fieldId) {
      const field = document.getElementById(fieldId);
      if (field) {
        field.scrollIntoView({ behavior: 'smooth', block: 'center' });
        field.focus();
        field.classList.add('field-highlight');
        setTimeout(() => field.classList.remove('field-highlight'), 2000);
      }
    }

    function addHighlightClickHandlers() {
      document.querySelectorAll('.doc-highlight[data-field]').forEach(el => {
        el.style.cursor = 'pointer';
      });
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // ============================================
    // DOWNLOAD FUNCTIONS
    // ============================================
    function copyDocument() {
      const docBody = document.getElementById('documentPreview');
      const text = docBody.innerText;
      navigator.clipboard.writeText(text).then(() => {
        showToast('Document copied to clipboard!');
      });
    }

    function downloadWord() {
      const docBody = document.getElementById('documentPreview');
      const html = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <style>
            body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; margin: 1in; }
            .doc-title { text-align: center; font-size: 14pt; font-weight: bold; margin-bottom: 8pt; text-transform: uppercase; }
            .doc-subtitle { text-align: center; margin-bottom: 24pt; }
            .doc-clause-title { font-weight: bold; margin-top: 18pt; margin-bottom: 12pt; text-transform: uppercase; }
            .doc-paragraph { margin-bottom: 12pt; text-align: justify; }
            .doc-indent { margin-left: 0.5in; }
            .doc-highlight { background: #fef3c7; padding: 1px 4px; }
            .doc-signature-block { margin-top: 36pt; }
            .doc-signature-line { margin-top: 36pt; border-top: 1px solid black; padding-top: 4pt; }
          </style>
        </head>
        <body>${docBody.innerHTML}</body>
        </html>
      `;

      const blob = new Blob([html], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'Board-Resolution.doc';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      showToast('Word document downloaded!');
    }

    function downloadPDF() {
      showToast('Preparing PDF... (Print dialog will open)');
      window.print();
    }

    // Print styles
    const printStyles = document.createElement('style');
    printStyles.textContent = `
      @media print {
        .site-header, .hero, .breadcrumb, .builder-sidebar, .preview-toolbar, .attorney-cta,
        .toast { display: none !important; }
        .builder-layout { display: block !important; }
        .preview-panel { padding: 0 !important; background: white !important; }
        .document-container { box-shadow: none !important; border: none !important; }
        .document-header { display: none !important; }
        .document-body { max-height: none !important; overflow: visible !important; }
        .doc-highlight { background: transparent !important; border: none !important; }
      }
    `;
    document.head.appendChild(printStyles);
  </script>

</body>
</html>
