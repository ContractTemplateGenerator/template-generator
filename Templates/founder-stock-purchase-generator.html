<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Founder Stock Purchase Agreement + 83(b) Election | Terms.Law</title>
  <meta name="description" content="Free Founder Stock Purchase Agreement generator with 83(b) election letter. Customize vesting, repurchase rights, and tax election. Attorney-drafted.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-text-light: #94a3b8;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; position: relative; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .doc-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
    .doc-tab { flex: 1; padding: 10px 16px; border: 2px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-surface); font-weight: 600; font-size: 0.85rem; cursor: pointer; text-align: center; transition: all var(--transition-fast); }
    .doc-tab:hover { border-color: var(--color-primary-light); }
    .doc-tab.active { border-color: var(--color-primary); background: rgba(30, 64, 175, 0.05); color: var(--color-primary); }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 6px; }
    .doc-subtitle { text-align: center; font-size: 11px; color: var(--color-text-muted); margin-bottom: 25px; font-family: var(--font-sans); }
    .doc-section-header { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; color: var(--doc-clause-title); border-bottom: 1px solid var(--color-border); padding-bottom: 4px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; text-align: justify; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 12px; }
    .doc-table th, .doc-table td { border: 1px solid var(--color-border); padding: 8px 10px; text-align: left; }
    .doc-table th { background: var(--color-bg); font-weight: 600; font-size: 10px; text-transform: uppercase; }
    .doc-signature-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px; }
    .doc-signature-party-title { font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 15px; color: var(--color-text-muted); }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; }
    .doc-signature-line .sig-label { width: 60px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; display: flex; align-items: flex-end; padding-bottom: 3px; }
    .warning-box { background: #fef3c7; border: 1px solid #f59e0b; border-radius: var(--radius-md); padding: 12px 16px; margin: 15px 0; font-family: var(--font-sans); font-size: 12px; }
    .warning-box strong { color: #b45309; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; box-shadow: var(--shadow-xl); transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .doc-signature-row { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/" class="nav-link">Demands</a>
        <a href="/Templates/" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">Tax-Optimized Founder Equity</div>
      <h1><span class="highlight">Founder Stock Purchase</span> + 83(b) Generator</h1>
      <p class="hero-subtitle">Generate a Restricted Stock Purchase Agreement with vesting and repurchase rights, plus the critical 83(b) election letter for tax optimization.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">Company Information</h3>
        <div class="form-group">
          <label class="form-label">Company Name</label>
          <input type="text" id="companyName" class="form-input" placeholder="Acme Inc." oninput="trackFieldEdit('companyName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select id="incState" class="form-select" onchange="trackFieldEdit('incState')">
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Company Address</label>
          <input type="text" id="companyAddress" class="form-input" placeholder="123 Startup Way, San Francisco, CA 94102" oninput="trackFieldEdit('companyAddress')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Founder Information</h3>
        <div class="form-group">
          <label class="form-label">Founder Name</label>
          <input type="text" id="founderName" class="form-input" placeholder="John Smith" oninput="trackFieldEdit('founderName')">
        </div>
        <div class="form-group">
          <label class="form-label">Founder Address</label>
          <input type="text" id="founderAddress" class="form-input" placeholder="456 Founder Lane, Palo Alto, CA 94301" oninput="trackFieldEdit('founderAddress')">
        </div>
        <div class="form-group">
          <label class="form-label">SSN (for 83(b) only)</label>
          <input type="text" id="founderSSN" class="form-input" placeholder="XXX-XX-XXXX" oninput="trackFieldEdit('founderSSN')">
          <div class="form-hint">Required for IRS 83(b) election</div>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Stock Terms</h3>
        <div class="form-group">
          <label class="form-label">Number of Shares</label>
          <input type="number" id="numShares" class="form-input" placeholder="1000000" oninput="trackFieldEdit('numShares')">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Price Per Share ($)</label>
            <input type="number" id="pricePerShare" class="form-input" placeholder="0.0001" step="0.0001" oninput="trackFieldEdit('pricePerShare')">
          </div>
          <div class="form-group">
            <label class="form-label">FMV Per Share ($)</label>
            <input type="number" id="fmvPerShare" class="form-input" placeholder="0.0001" step="0.0001" oninput="trackFieldEdit('fmvPerShare')">
            <div class="form-hint">Fair market value</div>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Purchase Date</label>
          <input type="date" id="purchaseDate" class="form-input" oninput="trackFieldEdit('purchaseDate')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Vesting Schedule</h3>
        <div class="form-group">
          <label class="form-label">Vesting Period</label>
          <select id="vestingPeriod" class="form-select" onchange="trackFieldEdit('vestingPeriod')">
            <option value="4">4 years (standard)</option>
            <option value="3">3 years</option>
            <option value="2">2 years</option>
            <option value="1">1 year</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Cliff Period</label>
          <select id="cliffPeriod" class="form-select" onchange="trackFieldEdit('cliffPeriod')">
            <option value="12">12 months (standard)</option>
            <option value="6">6 months</option>
            <option value="0">No cliff</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Vesting Start Date</label>
          <input type="date" id="vestingStartDate" class="form-input" oninput="trackFieldEdit('vestingStartDate')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Acceleration</h3>
        <div class="form-group">
          <label class="form-label">Change of Control</label>
          <select id="acceleration" class="form-select" onchange="trackFieldEdit('acceleration')">
            <option value="double">Double trigger</option>
            <option value="single">Single trigger</option>
            <option value="none">None</option>
          </select>
        </div>
      </div>
    </aside>
    <div class="preview-panel">
      <div class="preview-toolbar">
        <div class="preview-title">Live Preview - Click highlighted text to edit</div>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="doc-tabs">
        <button class="doc-tab active" onclick="switchTab('agreement')">Stock Purchase Agreement</button>
        <button class="doc-tab" onclick="switchTab('83b')">83(b) Election Letter</button>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title" id="docTitle">Restricted Stock Purchase Agreement</span>
          <span class="document-status">Live</span>
        </div>
        <div class="document-body" id="documentPreview"></div>
      </div>
    </div>
  </main>
  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>2024 Terms.Law - Sergei Tokmakov, Esq.</p>
  </footer>
  <div class="toast" id="toast"></div>
  <script>
    let lastEditedField = null;
    let currentTab = 'agreement';

    document.addEventListener('DOMContentLoaded', function() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('purchaseDate').value = today;
      document.getElementById('vestingStartDate').value = today;
      updatePreview();
    });

    function switchTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.doc-tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`.doc-tab:${tab === 'agreement' ? 'first-child' : 'last-child'}`).classList.add('active');
      document.getElementById('docTitle').textContent = tab === 'agreement' ? 'Restricted Stock Purchase Agreement' : '83(b) Election Letter';
      updatePreview();
    }

    function trackFieldEdit(fieldId) { lastEditedField = fieldId; updatePreview(); }

    function formatCurrency(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 4 }).format(num);
    }

    function formatNumber(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US').format(num);
    }

    function get83bDeadline() {
      const purchaseDate = document.getElementById('purchaseDate').value;
      if (!purchaseDate) return '';
      const date = new Date(purchaseDate + 'T00:00:00');
      date.setDate(date.getDate() + 30);
      return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    function updatePreview() {
      const h = (v, p, f) => `<span class="doc-highlight${!v?' empty':''}" data-field="${f}" contenteditable="true">${v||'['+p+']'}</span>`;

      const companyName = document.getElementById('companyName').value;
      const incState = document.getElementById('incState').value;
      const companyAddress = document.getElementById('companyAddress').value;
      const founderName = document.getElementById('founderName').value;
      const founderAddress = document.getElementById('founderAddress').value;
      const founderSSN = document.getElementById('founderSSN').value;
      const numShares = document.getElementById('numShares').value;
      const pricePerShare = document.getElementById('pricePerShare').value;
      const fmvPerShare = document.getElementById('fmvPerShare').value;
      const purchaseDate = document.getElementById('purchaseDate').value;
      const vestingPeriod = document.getElementById('vestingPeriod').value;
      const cliffPeriod = document.getElementById('cliffPeriod').value;
      const vestingStartDate = document.getElementById('vestingStartDate').value;
      const acceleration = document.getElementById('acceleration').value;

      const formattedPurchaseDate = purchaseDate ? new Date(purchaseDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const formattedVestingStart = vestingStartDate ? new Date(vestingStartDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const formattedShares = formatNumber(numShares);
      const formattedPrice = formatCurrency(pricePerShare);
      const formattedFMV = formatCurrency(fmvPerShare);
      const totalPrice = numShares && pricePerShare ? formatCurrency(numShares * pricePerShare) : '';
      const totalFMV = numShares && fmvPerShare ? formatCurrency(numShares * fmvPerShare) : '';
      const deadline83b = get83bDeadline();

      const cliffText = cliffPeriod === '0' ? 'no cliff' : `a ${cliffPeriod}-month cliff`;

      let accelerationText = '';
      if (acceleration === 'double') {
        accelerationText = `<p class="doc-paragraph"><strong>7.1 Double-Trigger Acceleration.</strong> If (a) there is a Change of Control, and (b) within twelve (12) months following such Change of Control, the Purchaser's Continuous Service is terminated without Cause or the Purchaser resigns for Good Reason, then the Company's Repurchase Option shall lapse with respect to 100% of the then-unvested Shares.</p>`;
      } else if (acceleration === 'single') {
        accelerationText = `<p class="doc-paragraph"><strong>7.1 Single-Trigger Acceleration.</strong> Upon a Change of Control, the Company's Repurchase Option shall lapse with respect to 100% of the then-unvested Shares.</p>`;
      }

      if (currentTab === 'agreement') {
        document.getElementById('documentPreview').innerHTML = `
          <div class="doc-title">RESTRICTED STOCK PURCHASE AGREEMENT</div>
          <p class="doc-subtitle">${h(formattedPurchaseDate,'Purchase Date','purchaseDate')}</p>

          <p class="doc-paragraph">This Restricted Stock Purchase Agreement (this "<strong>Agreement</strong>") is entered into between ${h(companyName,'Company Name','companyName')}, a ${h(incState,'Delaware','incState')} corporation (the "<strong>Company</strong>"), and ${h(founderName,'Founder Name','founderName')} (the "<strong>Purchaser</strong>").</p>

          <div class="doc-section-header">1. Purchase and Sale of Stock</div>
          <p class="doc-paragraph"><strong>1.1 Sale and Issuance.</strong> Subject to the terms and conditions of this Agreement, the Company hereby agrees to sell to the Purchaser, and the Purchaser hereby agrees to purchase from the Company, ${h(formattedShares,'1,000,000','numShares')} shares of Common Stock of the Company (the "<strong>Shares</strong>") at a purchase price of ${h(formattedPrice,'$0.0001','pricePerShare')} per share, for an aggregate purchase price of ${totalPrice || '[calculated]'} (the "<strong>Purchase Price</strong>").</p>
          <p class="doc-paragraph"><strong>1.2 Payment.</strong> Payment of the Purchase Price shall be made by cash, check, or cancellation of indebtedness concurrently with the execution of this Agreement.</p>

          <div class="doc-section-header">2. Repurchase Option</div>
          <p class="doc-paragraph"><strong>2.1 Grant of Option.</strong> The Purchaser hereby grants to the Company an option (the "<strong>Repurchase Option</strong>") to repurchase all or any portion of the Unvested Shares (as defined below) at the original Purchase Price per share upon termination of the Purchaser's Continuous Service.</p>
          <p class="doc-paragraph"><strong>2.2 Unvested Shares.</strong> The term "<strong>Unvested Shares</strong>" means Shares that have not yet vested pursuant to the vesting schedule set forth in Section 3.</p>

          <div class="doc-section-header">3. Vesting Schedule</div>
          <p class="doc-paragraph">The Shares shall vest as follows, subject to the Purchaser's Continuous Service on each vesting date:</p>
          <ul class="doc-list">
            <li><strong>Vesting Commencement Date:</strong> ${h(formattedVestingStart,'[Vesting Start]','vestingStartDate')}</li>
            ${cliffPeriod !== '0' ? `<li><strong>Cliff:</strong> ${(100/vestingPeriod * (cliffPeriod/12)).toFixed(1)}% of the Shares (${formatNumber(Math.floor(numShares * (1/vestingPeriod) * (cliffPeriod/12)))} shares) shall vest on the ${cliffPeriod}-month anniversary of the Vesting Commencement Date.</li>` : ''}
            <li><strong>Monthly Vesting:</strong> The remaining Shares shall vest in equal monthly installments over the ${vestingPeriod}-year vesting period.</li>
          </ul>

          <div class="doc-section-header">4. Exercise of Repurchase Option</div>
          <p class="doc-paragraph">Upon termination of the Purchaser's Continuous Service for any reason, the Company may exercise the Repurchase Option by delivering written notice within ninety (90) days following such termination. The repurchase price shall be the original Purchase Price per share.</p>

          <div class="doc-section-header">5. Restrictions on Transfer</div>
          <p class="doc-paragraph">The Purchaser shall not sell, assign, transfer, pledge, or otherwise dispose of any Unvested Shares except to the Company pursuant to the Repurchase Option. Any purported transfer in violation hereof shall be void.</p>

          <div class="doc-section-header">6. Tax Matters</div>
          <p class="doc-paragraph"><strong>6.1 Section 83(b) Election.</strong> The Purchaser understands that Section 83 of the Internal Revenue Code taxes as ordinary income the difference between the Purchase Price and the fair market value of the Shares on the date the Shares vest.</p>
          <div class="warning-box">
            <strong>IMPORTANT:</strong> The Purchaser may elect to be taxed at the time of purchase by filing an election under Section 83(b) of the Internal Revenue Code with the IRS within 30 days of the purchase date. This Agreement includes an 83(b) election form. <strong>Deadline: ${deadline83b || '[30 days from purchase]'}</strong>
          </div>
          <p class="doc-paragraph"><strong>6.2 No Tax Advice.</strong> The Purchaser acknowledges that the Company has made no representations concerning the tax consequences of this Agreement and that the Purchaser should consult with a tax advisor.</p>

          ${acceleration !== 'none' ? `
          <div class="doc-section-header">7. Change of Control</div>
          ${accelerationText}
          ` : ''}

          <div class="doc-section-header">${acceleration !== 'none' ? '8' : '7'}. General Provisions</div>
          <p class="doc-paragraph"><strong>Governing Law.</strong> This Agreement shall be governed by the laws of ${h(incState,'Delaware','incState')}.</p>
          <p class="doc-paragraph"><strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning the subject matter hereof.</p>
          <p class="doc-paragraph"><strong>Amendments.</strong> This Agreement may only be amended by a written instrument signed by both parties.</p>

          <p class="doc-paragraph" style="margin-top:30px;"><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Agreement as of the date first written above.</p>

          <div class="doc-signature-row">
            <div>
              <div class="doc-signature-party-title">Company</div>
              <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
              <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value"></span></div>
              <div class="doc-signature-line"><span class="sig-label">Title:</span><span class="sig-value"></span></div>
            </div>
            <div>
              <div class="doc-signature-party-title">Purchaser</div>
              <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
              <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value">${founderName || ''}</span></div>
              <div class="doc-signature-line"><span class="sig-label">Address:</span><span class="sig-value">${founderAddress || ''}</span></div>
            </div>
          </div>
        `;
      } else {
        // 83(b) Election Letter
        document.getElementById('documentPreview').innerHTML = `
          <div class="doc-title">ELECTION UNDER SECTION 83(b)</div>
          <div class="doc-subtitle">OF THE INTERNAL REVENUE CODE OF 1986</div>

          <div class="warning-box">
            <strong>CRITICAL DEADLINE:</strong> This election MUST be filed with the IRS within 30 days of the stock purchase date. <strong>Mail by: ${deadline83b || '[30 days from purchase]'}</strong> via certified mail, return receipt requested.
          </div>

          <p class="doc-paragraph">The undersigned taxpayer hereby elects, pursuant to Section 83(b) of the Internal Revenue Code of 1986, as amended, to include in gross income as compensation for services the excess (if any) of the fair market value of the shares described below over the amount paid for such shares.</p>

          <div class="doc-section-header">1. Taxpayer Information</div>
          <table class="doc-table">
            <tr><td style="width:35%;font-weight:bold;">Name:</td><td>${h(founderName,'Taxpayer Name','founderName')}</td></tr>
            <tr><td style="font-weight:bold;">Address:</td><td>${h(founderAddress,'Taxpayer Address','founderAddress')}</td></tr>
            <tr><td style="font-weight:bold;">Social Security Number:</td><td>${h(founderSSN,'XXX-XX-XXXX','founderSSN')}</td></tr>
            <tr><td style="font-weight:bold;">Taxable Year:</td><td>${purchaseDate ? new Date(purchaseDate+'T00:00:00').getFullYear() : '[Year]'}</td></tr>
          </table>

          <div class="doc-section-header">2. Property Description</div>
          <table class="doc-table">
            <tr><td style="width:35%;font-weight:bold;">Description of Property:</td><td>${h(formattedShares,'[Number]','numShares')} shares of Common Stock of ${h(companyName,'Company Name','companyName')}</td></tr>
            <tr><td style="font-weight:bold;">Date Transferred:</td><td>${h(formattedPurchaseDate,'[Date]','purchaseDate')}</td></tr>
            <tr><td style="font-weight:bold;">Nature of Restrictions:</td><td>The shares are subject to vesting over ${vestingPeriod} years with ${cliffText}. Unvested shares are subject to repurchase by the Company at the original purchase price upon termination of service.</td></tr>
          </table>

          <div class="doc-section-header">3. Valuation</div>
          <table class="doc-table">
            <tr><td style="width:50%;font-weight:bold;">Fair Market Value at Time of Transfer:</td><td>${h(formattedFMV,'$0.0001','fmvPerShare')} per share</td></tr>
            <tr><td style="font-weight:bold;">Total Fair Market Value:</td><td>${totalFMV || '[calculated]'}</td></tr>
            <tr><td style="font-weight:bold;">Amount Paid for Property:</td><td>${h(formattedPrice,'$0.0001','pricePerShare')} per share</td></tr>
            <tr><td style="font-weight:bold;">Total Amount Paid:</td><td>${totalPrice || '[calculated]'}</td></tr>
            <tr><td style="font-weight:bold;"><strong>Excess (Taxable Amount):</strong></td><td><strong>${numShares && fmvPerShare && pricePerShare ? formatCurrency(numShares * (fmvPerShare - pricePerShare)) : '[calculated]'}</strong></td></tr>
          </table>

          <div class="doc-section-header">4. Statement</div>
          <p class="doc-paragraph">The undersigned has submitted a copy of this statement to the person for whom the services were performed (${h(companyName,'Company Name','companyName')}).</p>

          <p class="doc-paragraph">The undersigned is the person performing the services in connection with which the property was transferred.</p>

          <p class="doc-paragraph">This statement is executed on ${h(formattedPurchaseDate,'[Date]','purchaseDate')}.</p>

          <div class="doc-signature-row" style="grid-template-columns: 1fr;">
            <div>
              <div class="doc-signature-party-title">Taxpayer Signature</div>
              <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
              <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value">${founderName || ''}</span></div>
              <div class="doc-signature-line"><span class="sig-label">Date:</span><span class="sig-value"></span></div>
            </div>
          </div>

          <div class="warning-box" style="margin-top:30px;">
            <strong>FILING INSTRUCTIONS:</strong><br>
            1. Mail the ORIGINAL to the IRS Service Center where you file your tax return<br>
            2. Keep a copy for your records<br>
            3. Provide a copy to ${companyName || 'the Company'}<br>
            4. Attach a copy to your federal income tax return for ${purchaseDate ? new Date(purchaseDate+'T00:00:00').getFullYear() : 'this year'}<br><br>
            <strong>IRS Mailing Address:</strong> Depends on your state. Visit <a href="https://www.irs.gov/filing/where-to-file-paper-tax-returns-with-or-without-a-payment" target="_blank">IRS.gov</a> for the correct address.
          </div>
        `;
      }

      if(lastEditedField){
        setTimeout(()=>{
          const el = document.querySelector(`[data-field="${lastEditedField}"]`);
          if(el){
            el.scrollIntoView({behavior:'smooth',block:'center'});
            el.classList.add('field-highlight-animation');
            setTimeout(()=>el.classList.remove('field-highlight-animation'),600);
          }
        },50);
      }
    }

    function showToast(msg,type=''){
      const t=document.getElementById('toast');
      t.textContent=msg;
      t.className='toast show'+(type?' '+type:'');
      setTimeout(()=>t.classList.remove('show'),3000);
    }

    function copyToClipboard(){
      const r=document.createRange();
      r.selectNode(document.getElementById('documentPreview'));
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(r);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      showToast('Copied!','success');
    }

    function downloadDocument(){
      const c=document.getElementById('documentPreview').innerHTML;
      const docType = currentTab === 'agreement' ? 'Stock-Purchase-Agreement' : '83b-Election';
      const h=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${currentTab === 'agreement' ? 'Restricted Stock Purchase Agreement' : '83(b) Election'}</title><style>body{font-family:Georgia,serif;max-width:8.5in;margin:1in auto;line-height:1.8;font-size:12pt}.doc-title{text-align:center;font-size:14pt;font-weight:bold;text-transform:uppercase;letter-spacing:2px}.doc-subtitle{text-align:center;font-size:10pt;color:#666;margin-bottom:20px}.doc-section-header{font-weight:bold;text-transform:uppercase;margin-top:20px;border-bottom:1px solid #ccc;font-size:11pt}.doc-paragraph{margin:12px 0;text-align:justify}.doc-list{margin:12px 0 12px 20px}.doc-list li{margin-bottom:8px}.doc-table{width:100%;border-collapse:collapse;margin:15px 0}.doc-table th,.doc-table td{border:1px solid #ccc;padding:8px}.doc-highlight{background:#fef3c7}.warning-box{background:#fef3c7;border:1px solid #f59e0b;padding:12px 16px;margin:15px 0;font-family:sans-serif;font-size:11pt}.doc-signature-row{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:40px}.doc-signature-party-title{font-weight:bold;text-transform:uppercase;margin-bottom:15px;font-size:10pt}.doc-signature-line{display:flex;margin-bottom:8px;min-height:30px}.doc-signature-line .sig-label{width:60px;font-size:9pt;color:#666}.doc-signature-line .sig-value{flex:1;border-bottom:1px solid #333}</style></head><body>${c}</body></html>`;
      const b=new Blob([h],{type:'text/html'});
      const u=URL.createObjectURL(b);
      const a=document.createElement('a');
      a.href=u;
      a.download=`${docType}.html`;
      a.click();
      URL.revokeObjectURL(u);
      showToast('Downloaded!','success');
    }
  </script>
</body>
</html>
