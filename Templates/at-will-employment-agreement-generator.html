<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>At-Will Employment Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a professional at-will employment agreement. Customizable template for employers and employees with clear terms and conditions.">
    <link rel="canonical" href="https://templatebuilder.pro/Templates/at-will-employment-agreement-generator.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: #ffffff;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }

        /* Form Panel */
        .form-panel {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .form-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .form-header h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.25rem;
        }

        .form-header p {
            font-size: 0.85rem;
            color: #64748b;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: #475569;
            margin-bottom: 0.35rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.6rem 0.75rem;
            border: 1.5px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: #475569;
            cursor: pointer;
            padding: 0.4rem 0.6rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: #f1f5f9;
        }

        .checkbox-label input {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .checkbox-label input:checked + span {
            color: #3b82f6;
            font-weight: 500;
        }

        /* Preview Panel */
        .preview-panel {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }

        .preview-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 16px 16px 0 0;
        }

        .preview-title {
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59,130,246,0.35);
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1.5px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .btn-edit {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245,158,11,0.35);
        }

        .btn-edit.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .preview-content {
            padding: 3rem;
            overflow-y: auto;
            flex: 1;
        }

        /* Document Styles */
        .document {
            max-width: 850px;
            margin: 0 auto;
            background: #fff;
            padding: 4rem;
            min-height: 1100px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            border: 1px solid #e5e7eb;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #000;
        }

        .document h1 {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document h2 {
            font-size: 12pt;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
        }

        .document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .document .center {
            text-align: center;
        }

        .document .parties {
            margin: 1.5rem 0;
        }

        .document .parties p {
            margin-bottom: 0.5rem;
        }

        .document .effective-date {
            text-align: center;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .document .clause {
            margin-bottom: 1.25rem;
        }

        .document .clause-number {
            font-weight: bold;
        }

        .document .sub-clause {
            margin-left: 2rem;
            margin-bottom: 0.75rem;
        }

        .document .signature-block {
            margin-top: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .document .signature-party h3 {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 2rem;
            text-transform: uppercase;
        }

        .document .signature-line {
            border-top: 1px solid #000;
            margin-top: 2.5rem;
            padding-top: 0.35rem;
            font-size: 10pt;
        }

        .document .recitals {
            margin: 1.5rem 0;
            font-style: italic;
        }

        .document .recitals p {
            margin-bottom: 0.5rem;
        }

        .document .schedule {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
        }

        .document .schedule h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 1rem;
            text-transform: uppercase;
            text-align: center;
        }

        /* Highlighting */
        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 0 3px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .doc-highlight:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
        }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245,158,11,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245,158,11,0); }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        @keyframes flashContainer {
            0%, 100% { box-shadow: 0 2px 20px rgba(0,0,0,0.08); }
            50% { box-shadow: 0 0 30px rgba(245,158,11,0.5); }
        }

        .document-flash {
            animation: flashContainer 0.5s ease-out;
        }

        /* Edit Mode Styles */
        .document.edit-mode {
            background: #fffef5;
            border-color: #f59e0b;
        }

        .document.edit-mode .doc-highlight {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            cursor: text;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .form-panel {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }

            .document {
                padding: 2rem;
            }

            .preview-content {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }

            .document, .document * {
                visibility: visible;
            }

            .document {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
                padding: 1in;
            }

            .header, .form-panel, .preview-toolbar {
                display: none !important;
            }
        }

        /* Footer */
        .footer {
            background: #0f172a;
            color: #94a3b8;
            padding: 2rem;
            text-align: center;
            font-size: 0.85rem;
        }

        .footer a {
            color: #60a5fa;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">TemplateBuilder.pro</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/contract-library-landing.html">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Form Panel -->
        <aside class="form-panel">
            <div class="form-header">
                <h1>At-Will Employment Agreement</h1>
                <p>Generate a comprehensive at-will employment contract</p>
            </div>

            <!-- Employer Information -->
            <div class="form-section">
                <div class="section-title">Employer Information</div>
                <div class="form-group">
                    <label for="employerName">Company Name</label>
                    <input type="text" id="employerName" placeholder="Acme Corporation" oninput="trackFieldEdit('employerName')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employerState">State</label>
                        <select id="employerState" onchange="trackFieldEdit('employerState')">
                            <option value="">Select State</option>
                            <option value="Alabama">Alabama</option>
                            <option value="Alaska">Alaska</option>
                            <option value="Arizona">Arizona</option>
                            <option value="Arkansas">Arkansas</option>
                            <option value="California">California</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Connecticut">Connecticut</option>
                            <option value="Delaware">Delaware</option>
                            <option value="Florida">Florida</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Hawaii">Hawaii</option>
                            <option value="Idaho">Idaho</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Indiana">Indiana</option>
                            <option value="Iowa">Iowa</option>
                            <option value="Kansas">Kansas</option>
                            <option value="Kentucky">Kentucky</option>
                            <option value="Louisiana">Louisiana</option>
                            <option value="Maine">Maine</option>
                            <option value="Maryland">Maryland</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Minnesota">Minnesota</option>
                            <option value="Mississippi">Mississippi</option>
                            <option value="Missouri">Missouri</option>
                            <option value="Montana">Montana</option>
                            <option value="Nebraska">Nebraska</option>
                            <option value="Nevada">Nevada</option>
                            <option value="New Hampshire">New Hampshire</option>
                            <option value="New Jersey">New Jersey</option>
                            <option value="New Mexico">New Mexico</option>
                            <option value="New York">New York</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="North Dakota">North Dakota</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Oklahoma">Oklahoma</option>
                            <option value="Oregon">Oregon</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Rhode Island">Rhode Island</option>
                            <option value="South Carolina">South Carolina</option>
                            <option value="South Dakota">South Dakota</option>
                            <option value="Tennessee">Tennessee</option>
                            <option value="Texas">Texas</option>
                            <option value="Utah">Utah</option>
                            <option value="Vermont">Vermont</option>
                            <option value="Virginia">Virginia</option>
                            <option value="Washington">Washington</option>
                            <option value="West Virginia">West Virginia</option>
                            <option value="Wisconsin">Wisconsin</option>
                            <option value="Wyoming">Wyoming</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" onchange="trackFieldEdit('effectiveDate')">
                    </div>
                </div>
                <div class="form-group">
                    <label for="employerAddress">Company Address</label>
                    <input type="text" id="employerAddress" placeholder="123 Business Ave, Suite 100, City, State ZIP" oninput="trackFieldEdit('employerAddress')">
                </div>
            </div>

            <!-- Employee Information -->
            <div class="form-section">
                <div class="section-title">Employee Information</div>
                <div class="form-group">
                    <label for="employeeName">Employee Full Name</label>
                    <input type="text" id="employeeName" placeholder="John Smith" oninput="trackFieldEdit('employeeName')">
                </div>
                <div class="form-group">
                    <label for="employeeAddress">Employee Address</label>
                    <input type="text" id="employeeAddress" placeholder="456 Main Street, City, State ZIP" oninput="trackFieldEdit('employeeAddress')">
                </div>
            </div>

            <!-- Position Details -->
            <div class="form-section">
                <div class="section-title">Position Details</div>
                <div class="form-group">
                    <label for="jobTitle">Job Title</label>
                    <input type="text" id="jobTitle" placeholder="Software Engineer" oninput="trackFieldEdit('jobTitle')">
                </div>
                <div class="form-group">
                    <label for="department">Department</label>
                    <input type="text" id="department" placeholder="Engineering" oninput="trackFieldEdit('department')">
                </div>
                <div class="form-group">
                    <label for="reportsTo">Reports To</label>
                    <input type="text" id="reportsTo" placeholder="VP of Engineering" oninput="trackFieldEdit('reportsTo')">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employmentType">Employment Type</label>
                        <select id="employmentType" onchange="trackFieldEdit('employmentType')">
                            <option value="full-time">Full-Time</option>
                            <option value="part-time">Part-Time</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="workLocation">Work Location</label>
                        <select id="workLocation" onchange="trackFieldEdit('workLocation')">
                            <option value="on-site">On-Site</option>
                            <option value="remote">Remote</option>
                            <option value="hybrid">Hybrid</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="workSchedule">Work Schedule</label>
                    <input type="text" id="workSchedule" placeholder="Monday through Friday, 9:00 AM to 5:00 PM" oninput="trackFieldEdit('workSchedule')">
                </div>
                <div class="form-group">
                    <label for="jobDuties">Primary Job Duties</label>
                    <textarea id="jobDuties" rows="3" placeholder="Design, develop, and maintain software applications..." oninput="trackFieldEdit('jobDuties')"></textarea>
                </div>
            </div>

            <!-- Compensation -->
            <div class="form-section">
                <div class="section-title">Compensation</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="salaryAmount">Base Salary/Wage</label>
                        <input type="text" id="salaryAmount" placeholder="85,000" oninput="trackFieldEdit('salaryAmount')">
                    </div>
                    <div class="form-group">
                        <label for="payFrequency">Pay Frequency</label>
                        <select id="payFrequency" onchange="trackFieldEdit('payFrequency')">
                            <option value="annually">Annually (Salary)</option>
                            <option value="per hour">Per Hour</option>
                            <option value="bi-weekly">Bi-Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="paySchedule">Pay Schedule</label>
                    <select id="paySchedule" onchange="trackFieldEdit('paySchedule')">
                        <option value="bi-weekly">Bi-Weekly (Every Two Weeks)</option>
                        <option value="semi-monthly">Semi-Monthly (1st and 15th)</option>
                        <option value="monthly">Monthly</option>
                        <option value="weekly">Weekly</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="exemptStatus">FLSA Exempt Status</label>
                    <select id="exemptStatus" onchange="trackFieldEdit('exemptStatus')">
                        <option value="exempt">Exempt (Not Eligible for Overtime)</option>
                        <option value="non-exempt">Non-Exempt (Eligible for Overtime)</option>
                    </select>
                </div>
            </div>

            <!-- Additional Compensation -->
            <div class="form-section">
                <div class="section-title">Additional Compensation</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeBonus" onchange="trackFieldEdit('includeBonus')">
                            <span>Bonus</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeCommission" onchange="trackFieldEdit('includeCommission')">
                            <span>Commission</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeEquity" onchange="trackFieldEdit('includeEquity')">
                            <span>Equity/Stock Options</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeSigningBonus" onchange="trackFieldEdit('includeSigningBonus')">
                            <span>Signing Bonus</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="bonusDetails" style="display:none;">
                    <label for="bonusAmount">Bonus Details</label>
                    <input type="text" id="bonusAmount" placeholder="Up to 15% of annual salary based on performance" oninput="trackFieldEdit('bonusAmount')">
                </div>
                <div class="form-group" id="commissionDetails" style="display:none;">
                    <label for="commissionStructure">Commission Structure</label>
                    <input type="text" id="commissionStructure" placeholder="5% on all closed sales" oninput="trackFieldEdit('commissionStructure')">
                </div>
                <div class="form-group" id="equityDetails" style="display:none;">
                    <label for="equityGrant">Equity Grant Details</label>
                    <input type="text" id="equityGrant" placeholder="10,000 stock options vesting over 4 years" oninput="trackFieldEdit('equityGrant')">
                </div>
                <div class="form-group" id="signingBonusDetails" style="display:none;">
                    <label for="signingBonusAmount">Signing Bonus Amount</label>
                    <input type="text" id="signingBonusAmount" placeholder="$5,000 payable upon start date" oninput="trackFieldEdit('signingBonusAmount')">
                </div>
            </div>

            <!-- Benefits -->
            <div class="form-section">
                <div class="section-title">Benefits</div>
                <div class="form-group">
                    <label>Employee Benefits</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="healthInsurance" onchange="trackFieldEdit('healthInsurance')" checked>
                            <span>Health Insurance</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="dentalVision" onchange="trackFieldEdit('dentalVision')" checked>
                            <span>Dental/Vision</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="retirement401k" onchange="trackFieldEdit('retirement401k')" checked>
                            <span>401(k)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="paidTimeOff" onchange="trackFieldEdit('paidTimeOff')" checked>
                            <span>Paid Time Off</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="lifeInsurance" onchange="trackFieldEdit('lifeInsurance')">
                            <span>Life Insurance</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="disability" onchange="trackFieldEdit('disability')">
                            <span>Disability Insurance</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="ptoAmount">PTO Days Per Year</label>
                    <input type="text" id="ptoAmount" placeholder="15 days" oninput="trackFieldEdit('ptoAmount')">
                </div>
                <div class="form-group">
                    <label for="benefitsStartDate">Benefits Start</label>
                    <select id="benefitsStartDate" onchange="trackFieldEdit('benefitsStartDate')">
                        <option value="first day of employment">First Day of Employment</option>
                        <option value="first of the month following start date">First of Month Following Start</option>
                        <option value="after 30 days of employment">After 30 Days</option>
                        <option value="after 60 days of employment">After 60 Days</option>
                        <option value="after 90 days of employment">After 90 Days</option>
                    </select>
                </div>
            </div>

            <!-- Restrictive Covenants -->
            <div class="form-section">
                <div class="section-title">Restrictive Covenants</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="confidentiality" onchange="trackFieldEdit('confidentiality')" checked>
                            <span>Confidentiality</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonCompete" onchange="trackFieldEdit('nonCompete')">
                            <span>Non-Compete</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="nonSolicitation" onchange="trackFieldEdit('nonSolicitation')">
                            <span>Non-Solicitation</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="workForHire" onchange="trackFieldEdit('workForHire')" checked>
                            <span>Work for Hire/IP</span>
                        </label>
                    </div>
                </div>
                <div class="form-row" id="nonCompeteDetails" style="display:none;">
                    <div class="form-group">
                        <label for="nonCompetePeriod">Non-Compete Period</label>
                        <select id="nonCompetePeriod" onchange="trackFieldEdit('nonCompetePeriod')">
                            <option value="6 months">6 Months</option>
                            <option value="1 year" selected>1 Year</option>
                            <option value="18 months">18 Months</option>
                            <option value="2 years">2 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nonCompeteRadius">Geographic Scope</label>
                        <input type="text" id="nonCompeteRadius" placeholder="25 miles" oninput="trackFieldEdit('nonCompeteRadius')">
                    </div>
                </div>
                <div class="form-group" id="nonSolicitationDetails" style="display:none;">
                    <label for="nonSolicitationPeriod">Non-Solicitation Period</label>
                    <select id="nonSolicitationPeriod" onchange="trackFieldEdit('nonSolicitationPeriod')">
                        <option value="6 months">6 Months</option>
                        <option value="1 year" selected>1 Year</option>
                        <option value="18 months">18 Months</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
            </div>

            <!-- Additional Terms -->
            <div class="form-section">
                <div class="section-title">Additional Terms</div>
                <div class="form-group">
                    <label>Include These Provisions</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="probationPeriod" onchange="trackFieldEdit('probationPeriod')">
                            <span>Probationary Period</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="arbitration" onchange="trackFieldEdit('arbitration')">
                            <span>Arbitration Clause</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="drugTesting" onchange="trackFieldEdit('drugTesting')">
                            <span>Drug Testing</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="backgroundCheck" onchange="trackFieldEdit('backgroundCheck')">
                            <span>Background Check</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="probationDetails" style="display:none;">
                    <label for="probationLength">Probationary Period Length</label>
                    <select id="probationLength" onchange="trackFieldEdit('probationLength')">
                        <option value="30 days">30 Days</option>
                        <option value="60 days">60 Days</option>
                        <option value="90 days" selected>90 Days</option>
                        <option value="6 months">6 Months</option>
                    </select>
                </div>
            </div>
        </aside>

        <!-- Preview Panel -->
        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-edit" onclick="toggleEditMode()" id="editBtn">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        <span id="editBtnText">Edit Document</span>
                    </button>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview">
                    <!-- Document content will be generated here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; TemplateBuilder.pro. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        // State
        let lastEditedField = null;
        let hasCustomEdits = false;
        let isEditMode = false;

        // Toggle visibility handlers
        document.getElementById('includeBonus').addEventListener('change', function() {
            document.getElementById('bonusDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('includeCommission').addEventListener('change', function() {
            document.getElementById('commissionDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('includeEquity').addEventListener('change', function() {
            document.getElementById('equityDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('includeSigningBonus').addEventListener('change', function() {
            document.getElementById('signingBonusDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('nonCompete').addEventListener('change', function() {
            document.getElementById('nonCompeteDetails').style.display = this.checked ? 'flex' : 'none';
        });
        document.getElementById('nonSolicitation').addEventListener('change', function() {
            document.getElementById('nonSolicitationDetails').style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('probationPeriod').addEventListener('change', function() {
            document.getElementById('probationDetails').style.display = this.checked ? 'block' : 'none';
        });

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                if (!confirm('Regenerating the document will overwrite your custom edits. Continue?')) {
                    return;
                }
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[EFFECTIVE DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/[^0-9.]/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        }

        function updatePreview() {
            const employerName = getValue('employerName', '[EMPLOYER NAME]');
            const employerState = getValue('employerState', '[STATE]');
            const employerAddress = getValue('employerAddress', '[EMPLOYER ADDRESS]');
            const effectiveDate = formatDate(getValue('effectiveDate'));
            const employeeName = getValue('employeeName', '[EMPLOYEE NAME]');
            const employeeAddress = getValue('employeeAddress', '[EMPLOYEE ADDRESS]');
            const jobTitle = getValue('jobTitle', '[JOB TITLE]');
            const department = getValue('department', '[DEPARTMENT]');
            const reportsTo = getValue('reportsTo', '[SUPERVISOR]');
            const employmentType = getValue('employmentType', 'full-time');
            const workLocation = getValue('workLocation', 'on-site');
            const workSchedule = getValue('workSchedule', '[WORK SCHEDULE]');
            const jobDuties = getValue('jobDuties', '[JOB DUTIES]');
            const salaryAmount = formatCurrency(getValue('salaryAmount'));
            const payFrequency = getValue('payFrequency', 'annually');
            const paySchedule = getValue('paySchedule', 'bi-weekly');
            const exemptStatus = getValue('exemptStatus', 'exempt');
            const ptoAmount = getValue('ptoAmount', '[PTO DAYS]');
            const benefitsStartDate = getValue('benefitsStartDate', 'first day of employment');

            // Build benefits list
            let benefitsList = [];
            if (getValue('healthInsurance')) benefitsList.push('health insurance');
            if (getValue('dentalVision')) benefitsList.push('dental and vision insurance');
            if (getValue('retirement401k')) benefitsList.push('401(k) retirement plan');
            if (getValue('paidTimeOff')) benefitsList.push(`paid time off (${ptoAmount} days per year)`);
            if (getValue('lifeInsurance')) benefitsList.push('life insurance');
            if (getValue('disability')) benefitsList.push('short-term and long-term disability insurance');
            const benefitsText = benefitsList.length > 0 ? benefitsList.join(', ') : 'benefits as described in the Employee Handbook';

            // Additional compensation sections
            let additionalCompText = '';
            if (getValue('includeBonus')) {
                const bonusAmount = getValue('bonusAmount', '[BONUS DETAILS]');
                additionalCompText += `<p class="sub-clause"><strong>(b) Bonus:</strong> Employee may be eligible for a discretionary bonus: <span class="doc-highlight" data-field="bonusAmount" contenteditable="true">${bonusAmount}</span>. Bonuses are not guaranteed and are at the sole discretion of the Employer.</p>`;
            }
            if (getValue('includeCommission')) {
                const commissionStructure = getValue('commissionStructure', '[COMMISSION STRUCTURE]');
                additionalCompText += `<p class="sub-clause"><strong>(${getValue('includeBonus') ? 'c' : 'b'}) Commission:</strong> Employee shall be eligible for commission compensation as follows: <span class="doc-highlight" data-field="commissionStructure" contenteditable="true">${commissionStructure}</span>, subject to the terms of any applicable commission plan.</p>`;
            }
            if (getValue('includeEquity')) {
                const equityGrant = getValue('equityGrant', '[EQUITY GRANT DETAILS]');
                const letterIndex = getValue('includeBonus') && getValue('includeCommission') ? 'd' : (getValue('includeBonus') || getValue('includeCommission') ? 'c' : 'b');
                additionalCompText += `<p class="sub-clause"><strong>(${letterIndex}) Equity:</strong> Subject to approval by the Company's Board of Directors and execution of a stock option agreement, Employee shall receive: <span class="doc-highlight" data-field="equityGrant" contenteditable="true">${equityGrant}</span>.</p>`;
            }
            if (getValue('includeSigningBonus')) {
                const signingBonusAmount = getValue('signingBonusAmount', '[SIGNING BONUS]');
                additionalCompText += `<p class="sub-clause"><strong>Signing Bonus:</strong> Employee shall receive a one-time signing bonus of <span class="doc-highlight" data-field="signingBonusAmount" contenteditable="true">${signingBonusAmount}</span>. If Employee voluntarily terminates employment within twelve (12) months of the start date, Employee agrees to repay the signing bonus on a pro-rated basis.</p>`;
            }

            // Restrictive covenants
            let covenantsText = '';
            let covenantNum = 1;

            if (getValue('confidentiality')) {
                covenantsText += `
                <h2>7. CONFIDENTIALITY</h2>
                <p class="clause">7.1 Employee acknowledges that during employment, Employee will have access to and become acquainted with trade secrets, proprietary information, and confidential information belonging to Employer ("Confidential Information"). Confidential Information includes, but is not limited to, business plans, customer lists, financial information, marketing strategies, product designs, software code, and any other information that derives economic value from not being generally known.</p>
                <p class="clause">7.2 Employee agrees to hold all Confidential Information in strict confidence and not to disclose, publish, or otherwise reveal any Confidential Information to any third party during or after employment, except as required in the performance of Employee's duties or as authorized in writing by Employer.</p>
                <p class="clause">7.3 Upon termination of employment, or upon Employer's request, Employee shall return all documents, materials, and other property containing or relating to Confidential Information.</p>`;
            }

            if (getValue('nonCompete')) {
                const nonCompetePeriod = getValue('nonCompetePeriod', '1 year');
                const nonCompeteRadius = getValue('nonCompeteRadius', '25 miles');
                covenantsText += `
                <h2>${getValue('confidentiality') ? '8' : '7'}. NON-COMPETE</h2>
                <p class="clause">${getValue('confidentiality') ? '8' : '7'}.1 During employment and for a period of <span class="doc-highlight" data-field="nonCompetePeriod" contenteditable="true">${nonCompetePeriod}</span> following termination of employment for any reason, Employee agrees not to directly or indirectly engage in any business that competes with Employer within <span class="doc-highlight" data-field="nonCompeteRadius" contenteditable="true">${nonCompeteRadius}</span> of any location where Employer conducts business.</p>
                <p class="clause">${getValue('confidentiality') ? '8' : '7'}.2 "Compete" means to own, manage, operate, consult for, be employed by, or have any interest in any business that is substantially similar to or competitive with Employer's business.</p>
                <p class="clause">${getValue('confidentiality') ? '8' : '7'}.3 Employee acknowledges that this restriction is reasonable and necessary to protect Employer's legitimate business interests.</p>`;
            }

            if (getValue('nonSolicitation')) {
                const nonSolicitationPeriod = getValue('nonSolicitationPeriod', '1 year');
                const sectionNum = 7 + (getValue('confidentiality') ? 1 : 0) + (getValue('nonCompete') ? 1 : 0);
                covenantsText += `
                <h2>${sectionNum}. NON-SOLICITATION</h2>
                <p class="clause">${sectionNum}.1 During employment and for a period of <span class="doc-highlight" data-field="nonSolicitationPeriod" contenteditable="true">${nonSolicitationPeriod}</span> following termination of employment for any reason, Employee agrees not to:</p>
                <p class="sub-clause">(a) Solicit or attempt to solicit any customer, client, or prospective customer of Employer with whom Employee had contact or about whom Employee obtained Confidential Information during employment;</p>
                <p class="sub-clause">(b) Solicit, recruit, or hire, or attempt to solicit, recruit, or hire any employee, consultant, or contractor of Employer.</p>`;
            }

            if (getValue('workForHire')) {
                const sectionNum = 7 + (getValue('confidentiality') ? 1 : 0) + (getValue('nonCompete') ? 1 : 0) + (getValue('nonSolicitation') ? 1 : 0);
                covenantsText += `
                <h2>${sectionNum}. WORK PRODUCT AND INTELLECTUAL PROPERTY</h2>
                <p class="clause">${sectionNum}.1 Employee agrees that all inventions, discoveries, developments, improvements, and works of authorship, whether or not patentable or copyrightable, that Employee makes, conceives, or first reduces to practice during employment and that relate to Employer's business or result from work performed for Employer ("Work Product") shall be the sole and exclusive property of Employer.</p>
                <p class="clause">${sectionNum}.2 Employee hereby assigns and agrees to assign to Employer all right, title, and interest in and to any Work Product, including all intellectual property rights therein.</p>
                <p class="clause">${sectionNum}.3 Employee agrees to execute any documents and take any actions reasonably requested by Employer to effect, perfect, or evidence such assignment and Employer's ownership of Work Product.</p>`;
            }

            // Additional terms
            let additionalTermsText = '';

            if (getValue('probationPeriod')) {
                const probationLength = getValue('probationLength', '90 days');
                additionalTermsText += `
                <h2>PROBATIONARY PERIOD</h2>
                <p class="clause">Employee's employment shall be subject to a probationary period of <span class="doc-highlight" data-field="probationLength" contenteditable="true">${probationLength}</span> from the start date. During this period, Employer shall evaluate Employee's performance, skills, and suitability for continued employment. Completion of the probationary period does not alter the at-will nature of employment.</p>`;
            }

            if (getValue('arbitration')) {
                additionalTermsText += `
                <h2>ARBITRATION</h2>
                <p class="clause">Any dispute, controversy, or claim arising out of or relating to this Agreement or Employee's employment shall be resolved by binding arbitration in accordance with the rules of the American Arbitration Association. The arbitration shall take place in <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, and the decision of the arbitrator shall be final and binding. Each party shall bear its own costs and attorneys' fees unless the arbitrator determines otherwise. This arbitration provision does not apply to claims for workers' compensation benefits, unemployment insurance, or claims that cannot legally be subject to arbitration.</p>`;
            }

            if (getValue('drugTesting')) {
                additionalTermsText += `
                <h2>DRUG AND ALCOHOL POLICY</h2>
                <p class="clause">Employee agrees to comply with Employer's drug and alcohol policy and may be required to submit to drug and/or alcohol testing as a condition of employment or continued employment, in accordance with applicable law. Refusal to submit to testing or a positive test result may result in termination of employment.</p>`;
            }

            if (getValue('backgroundCheck')) {
                additionalTermsText += `
                <h2>BACKGROUND CHECK</h2>
                <p class="clause">This offer of employment is contingent upon satisfactory completion of a background check, which may include verification of employment history, education, criminal records, and other relevant information. Employee authorizes Employer to conduct such investigations as permitted by law.</p>`;
            }

            const workLocationText = workLocation === 'on-site' ? 'at Employer\'s facilities' : (workLocation === 'remote' ? 'remotely from Employee\'s location' : 'in a hybrid arrangement combining on-site and remote work');
            const employmentTypeText = employmentType === 'full-time' ? 'full-time' : 'part-time';
            const exemptText = exemptStatus === 'exempt' ? 'exempt from overtime pay requirements under the Fair Labor Standards Act' : 'non-exempt and eligible for overtime pay in accordance with applicable law';

            const html = `
                <h1>AT-WILL EMPLOYMENT AGREEMENT</h1>

                <p class="effective-date">Effective Date: <span class="doc-highlight" data-field="effectiveDate" contenteditable="true">${effectiveDate}</span></p>

                <div class="parties">
                    <p>This At-Will Employment Agreement ("Agreement") is entered into by and between:</p>
                    <p><strong>EMPLOYER:</strong> <span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span>, a company organized under the laws of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, with its principal place of business at <span class="doc-highlight" data-field="employerAddress" contenteditable="true">${employerAddress}</span> ("Employer" or "Company")</p>
                    <p><strong>EMPLOYEE:</strong> <span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span>, an individual residing at <span class="doc-highlight" data-field="employeeAddress" contenteditable="true">${employeeAddress}</span> ("Employee")</p>
                </div>

                <div class="recitals">
                    <p><strong>RECITALS</strong></p>
                    <p>WHEREAS, Employer desires to employ Employee, and Employee desires to be employed by Employer, on the terms and conditions set forth in this Agreement;</p>
                    <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements contained herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>
                </div>

                <h2>1. EMPLOYMENT AND AT-WILL STATUS</h2>
                <p class="clause">1.1 Employer agrees to employ Employee, and Employee agrees to be employed by Employer, subject to the terms and conditions of this Agreement.</p>
                <p class="clause">1.2 <strong>AT-WILL EMPLOYMENT:</strong> EMPLOYEE'S EMPLOYMENT WITH EMPLOYER IS "AT-WILL." THIS MEANS THAT EITHER EMPLOYEE OR EMPLOYER MAY TERMINATE THE EMPLOYMENT RELATIONSHIP AT ANY TIME, FOR ANY REASON OR NO REASON, WITH OR WITHOUT CAUSE OR NOTICE. NO REPRESENTATIVE OF EMPLOYER, OTHER THAN THE CHIEF EXECUTIVE OFFICER IN A SIGNED WRITING, HAS THE AUTHORITY TO ALTER THIS AT-WILL ARRANGEMENT OR TO ENTER INTO ANY AGREEMENT FOR EMPLOYMENT FOR A SPECIFIED PERIOD OF TIME.</p>
                <p class="clause">1.3 Nothing in this Agreement or any other document shall be construed to create an express or implied contract of employment for any specific duration.</p>

                <h2>2. POSITION AND DUTIES</h2>
                <p class="clause">2.1 Employee shall be employed in the position of <span class="doc-highlight" data-field="jobTitle" contenteditable="true">${jobTitle}</span> in the <span class="doc-highlight" data-field="department" contenteditable="true">${department}</span> department, reporting to <span class="doc-highlight" data-field="reportsTo" contenteditable="true">${reportsTo}</span>.</p>
                <p class="clause">2.2 Employee shall perform the following duties and responsibilities: <span class="doc-highlight" data-field="jobDuties" contenteditable="true">${jobDuties}</span></p>
                <p class="clause">2.3 Employee shall devote Employee's full professional time, attention, and best efforts to the performance of Employee's duties. Employee may not engage in any other employment or business activity that interferes with Employee's duties or creates a conflict of interest without prior written approval from Employer.</p>
                <p class="clause">2.4 Employer reserves the right to modify Employee's job title, duties, and reporting relationships as business needs require.</p>

                <h2>3. WORK SCHEDULE AND LOCATION</h2>
                <p class="clause">3.1 Employee's position is classified as <span class="doc-highlight" data-field="employmentType" contenteditable="true">${employmentTypeText}</span>.</p>
                <p class="clause">3.2 Employee's regular work schedule shall be <span class="doc-highlight" data-field="workSchedule" contenteditable="true">${workSchedule}</span>, subject to modification based on business needs.</p>
                <p class="clause">3.3 Employee shall perform duties <span class="doc-highlight" data-field="workLocation" contenteditable="true">${workLocationText}</span>, as directed by Employer.</p>

                <h2>4. COMPENSATION</h2>
                <p class="clause">4.1 <strong>(a) Base Compensation:</strong> Employee shall receive base compensation of <span class="doc-highlight" data-field="salaryAmount" contenteditable="true">${salaryAmount}</span> <span class="doc-highlight" data-field="payFrequency" contenteditable="true">${payFrequency}</span>, payable in accordance with Employer's standard payroll practices on a <span class="doc-highlight" data-field="paySchedule" contenteditable="true">${paySchedule}</span> basis, less applicable withholdings and deductions.</p>
                ${additionalCompText}
                <p class="clause">4.2 Employee's position is classified as <span class="doc-highlight" data-field="exemptStatus" contenteditable="true">${exemptText}</span>.</p>
                <p class="clause">4.3 Employer reserves the right to review and adjust Employee's compensation at any time, in its sole discretion.</p>

                <h2>5. BENEFITS</h2>
                <p class="clause">5.1 Employee shall be eligible to participate in the following employee benefit programs, subject to the terms and conditions of each program: <span class="doc-highlight" data-field="benefits" contenteditable="true">${benefitsText}</span>.</p>
                <p class="clause">5.2 Benefits eligibility shall commence on <span class="doc-highlight" data-field="benefitsStartDate" contenteditable="true">${benefitsStartDate}</span>.</p>
                <p class="clause">5.3 Employer reserves the right to modify, suspend, or discontinue any benefit program at any time, in its sole discretion and in accordance with applicable law.</p>

                <h2>6. TERMINATION</h2>
                <p class="clause">6.1 As stated in Section 1.2, either party may terminate this Agreement and Employee's employment at any time, for any reason or no reason, with or without cause or notice.</p>
                <p class="clause">6.2 Upon termination of employment for any reason, Employee shall:</p>
                <p class="sub-clause">(a) Return all Company property, including documents, equipment, keys, access cards, and materials;</p>
                <p class="sub-clause">(b) Cooperate with any transition activities as reasonably requested;</p>
                <p class="sub-clause">(c) Continue to comply with all post-employment obligations under this Agreement.</p>
                <p class="clause">6.3 Employer shall pay Employee all earned but unpaid wages and accrued but unused paid time off (if applicable) in accordance with applicable law.</p>

                ${covenantsText}

                ${additionalTermsText}

                <h2>GENERAL PROVISIONS</h2>
                <p class="clause"><strong>Entire Agreement:</strong> This Agreement constitutes the entire agreement between the parties concerning employment and supersedes all prior agreements, understandings, negotiations, and discussions, whether oral or written.</p>
                <p class="clause"><strong>Amendment:</strong> This Agreement may not be amended or modified except by a written instrument signed by both parties.</p>
                <p class="clause"><strong>Severability:</strong> If any provision of this Agreement is held to be invalid or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                <p class="clause"><strong>Governing Law:</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight" data-field="employerState" contenteditable="true">${employerState}</span>, without regard to its conflicts of law principles.</p>
                <p class="clause"><strong>Acknowledgment:</strong> Employee acknowledges that Employee has read this Agreement, understands its terms, and agrees to be bound by its provisions. Employee acknowledges that Employee has had the opportunity to consult with an attorney before signing this Agreement.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Employer</h3>
                        <p><span class="doc-highlight" data-field="employerName" contenteditable="true">${employerName}</span></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Employee</h3>
                        <div class="signature-line">Signature</div>
                        <p class="signature-line"><span class="doc-highlight" data-field="employeeName" contenteditable="true">${employeeName}</span></p>
                        <div class="signature-line">Date</div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;

            // Add inline editing listeners
            document.querySelectorAll('.doc-highlight[contenteditable="true"]').forEach(el => {
                el.addEventListener('input', function() {
                    hasCustomEdits = true;
                    const fieldId = this.getAttribute('data-field');
                    const inputEl = document.getElementById(fieldId);
                    if (inputEl && inputEl.tagName !== 'SELECT') {
                        inputEl.value = this.textContent;
                    }
                });
            });

            // Scroll to and highlight edited field
            if (lastEditedField) {
                setTimeout(() => {
                    const el = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        el.classList.add('field-highlight-animation');
                        const doc = document.getElementById('documentPreview');
                        doc.classList.add('document-flash');
                        setTimeout(() => {
                            el.classList.remove('field-highlight-animation');
                            doc.classList.remove('document-flash');
                        }, 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            const doc = document.getElementById('documentPreview');
            const btn = document.getElementById('editBtn');
            const btnText = document.getElementById('editBtnText');

            if (isEditMode) {
                doc.classList.add('edit-mode');
                doc.setAttribute('contenteditable', 'true');
                btn.classList.add('active');
                btnText.textContent = 'Done Editing';
                hasCustomEdits = true;
            } else {
                doc.classList.remove('edit-mode');
                doc.setAttribute('contenteditable', 'false');
                btn.classList.remove('active');
                btnText.textContent = 'Edit Document';
            }
        }

        function printDocument() {
            window.print();
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const employeeName = getValue('employeeName', 'Employee');
            const employerName = getValue('employerName', 'Company');

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; max-width: 8.5in; margin: 1in auto; }
                        h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; }
                        h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
                        p { margin-bottom: 1rem; text-align: justify; }
                        .center { text-align: center; }
                        .effective-date { text-align: center; font-style: italic; margin-bottom: 2rem; }
                        .parties { margin: 1.5rem 0; }
                        .parties p { margin-bottom: 0.5rem; }
                        .clause { margin-bottom: 1.25rem; }
                        .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
                        .signature-block { margin-top: 3rem; display: flex; justify-content: space-between; }
                        .signature-party { width: 45%; }
                        .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
                        .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
                        .doc-highlight { background-color: #fff; }
                        .recitals { margin: 1.5rem 0; font-style: italic; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `At-Will Employment Agreement - ${employeeName} - ${employerName}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;

            updatePreview();
        });
    </script>
</body>
</html>
