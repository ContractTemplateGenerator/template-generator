<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software License Agreement Generator | Terms.Law</title>
    <meta name="description" content="Free Software License Agreement generator. Create perpetual or subscription licenses with support terms, warranties, and usage restrictions.">
    <link rel="canonical" href="https://terms.law/Templates/software-license-agreement-generator.html">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the difference between perpetual and subscription software licenses?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A perpetual license grants indefinite rights to use the software after a one-time payment. A subscription license requires ongoing payments (monthly or annual) and usage rights end when the subscription expires or is cancelled."
          }
        },
        {
          "@type": "Question",
          "name": "What restrictions are typically included in software license agreements?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Common restrictions include: prohibiting reverse engineering, modification, sublicensing, and competitive analysis. Licenses also typically limit the number of users, devices, and specify whether the license is transferable."
          }
        },
        {
          "@type": "Question",
          "name": "What is a software maintenance and support agreement?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A maintenance and support agreement covers technical assistance, bug fixes, and software updates. Support levels range from standard business hours to 24/7 premium support, often for an additional annual fee."
          }
        },
        {
          "@type": "Question",
          "name": "What warranties should be included in a software license agreement?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Common warranties include: software will perform substantially as documented, no third-party IP infringement, and the licensor has authority to grant the license. Warranty periods typically range from 30 days to 1 year."
          }
        },
        {
          "@type": "Question",
          "name": "What happens when a software license is terminated?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Upon termination, all license rights end immediately. The licensee must cease using the software, destroy all copies, and certify compliance. Provisions for IP ownership, confidentiality, and liability typically survive termination."
          }
        },
        {
          "@type": "Question",
          "name": "What is a site-wide software license?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A site-wide license allows unlimited users at a single location or organization to use the software. This is cost-effective for large organizations compared to per-seat licensing, though it may be limited to specific physical or legal boundaries."
          }
        }
      ]
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e40af;
            --primary-dark: #1e3a8a;
            --secondary: #475569;
            --accent: #f59e0b;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand { display: flex; align-items: center; gap: 1rem; }
        .nav-logo { font-size: 1.5rem; font-weight: 700; color: white; text-decoration: none; }
        .nav-divider { color: rgba(255, 255, 255, 0.5); }
        .nav-title { color: rgba(255, 255, 255, 0.9); font-size: 1rem; }
        .nav-links { display: flex; gap: 1.5rem; align-items: center; }
        .nav-links a { color: rgba(255, 255, 255, 0.85); text-decoration: none; font-size: 0.9rem; font-weight: 500; transition: color 0.2s; }
        .nav-links a:hover { color: white; }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            align-items: start;
        }

        .form-panel {
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 80px;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .form-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px 12px 0 0;
        }

        .form-header h2 { font-size: 1.25rem; color: var(--primary); margin-bottom: 0.25rem; }
        .form-header p { font-size: 0.85rem; color: var(--text-light); }
        .form-content { padding: 1.5rem; }
        .form-section { margin-bottom: 1.5rem; }
        .form-section:last-child { margin-bottom: 0; }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
        }

        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 500; color: var(--text); margin-bottom: 0.375rem; }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-group textarea { resize: vertical; min-height: 80px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0;
        }

        .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; accent-color: var(--primary); }
        .checkbox-group label { margin-bottom: 0; cursor: pointer; }

        .form-actions {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }

        .btn-secondary { background: var(--surface); color: var(--text); border: 1px solid var(--border); }
        .btn-secondary:hover { background: var(--background); }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .preview-panel {
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .preview-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .preview-header h3 { font-size: 1rem; color: var(--text); }
        .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .preview-actions .btn { padding: 0.5rem 1rem; font-size: 0.85rem; }

        .edit-mode-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #fef3c7;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #92400e;
        }

        .edit-mode-toggle input { accent-color: var(--warning); }
        .document-container { padding: 2rem; max-width: 850px; margin: 0 auto; }

        .document {
            background: white;
            padding: 3rem;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            line-height: 1.8;
            font-size: 14px;
        }

        .document h1 { text-align: center; font-size: 1.5rem; margin-bottom: 0.5rem; color: var(--text); }
        .document h2 { font-size: 1.1rem; margin-top: 1.5rem; margin-bottom: 0.75rem; color: var(--text); }
        .document p { margin-bottom: 1rem; text-align: justify; }
        .document .parties { text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border); }
        .document .section { margin-bottom: 1.5rem; }
        .document .section-number { font-weight: 600; }
        .document .subsection { margin-left: 1.5rem; margin-bottom: 0.5rem; }

        .signature-block { margin-top: 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; }
        .signature-party h4 { margin-bottom: 0.5rem; font-weight: 600; }
        .signature-line { border-top: 1px solid var(--text); margin-top: 3rem; padding-top: 0.5rem; }
        .signature-field { margin-top: 1rem; }
        .signature-field span { display: block; font-size: 0.85rem; color: var(--text-light); }

        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 1px 4px;
            border-radius: 3px;
            border-bottom: 2px solid var(--accent);
            transition: all 0.2s;
        }

        .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
        .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        .full-edit-mode .document { border: 2px dashed var(--warning); }

        .full-edit-warning {
            display: none;
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.85rem;
            color: #92400e;
        }

        .full-edit-mode .full-edit-warning { display: block; }

        @media print {
            .navbar, .form-panel, .preview-header, .full-edit-warning { display: none !important; }
            .main-container { display: block; padding: 0; }
            .preview-panel { box-shadow: none; }
            .document-container { padding: 0; }
            .document { border: none; box-shadow: none; padding: 0; }
            .doc-highlight { background: none !important; border: none !important; padding: 0 !important; }
        }

        @media (max-width: 1024px) {
            .main-container { grid-template-columns: 1fr; }
            .form-panel { position: relative; top: 0; max-height: none; }
        }

        @media (max-width: 640px) {
            .navbar { padding: 1rem; }
            .nav-links { display: none; }
            .main-container { padding: 1rem; }
            .document { padding: 1.5rem; }
            .signature-block { grid-template-columns: 1fr; gap: 2rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="https://terms.law" class="nav-logo">Terms.Law</a>
                <span class="nav-divider">|</span>
                <span class="nav-title">Software License Agreement Generator</span>
            </div>
            <div class="nav-links">
                <a href="/Templates/contract-library-landing.html">Contract Library</a>
                <a href="/Blog/">Blog</a>
                <a href="https://terms.law">Home</a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="form-panel">
            <div class="form-header">
                <h2>üíª License Agreement Details</h2>
                <p>Generate a software license agreement for downloadable or on-premise software</p>
            </div>

            <div class="form-content">
                <!-- Licensor Information -->
                <div class="form-section">
                    <div class="section-title">Licensor (Software Owner)</div>
                    <div class="form-group">
                        <label for="licensorName">Company Name</label>
                        <input type="text" id="licensorName" placeholder="Tech Solutions Inc." oninput="trackFieldEdit('licensorName')">
                    </div>
                    <div class="form-group">
                        <label for="licensorAddress">Business Address</label>
                        <input type="text" id="licensorAddress" placeholder="123 Software Lane, Austin, TX 78701" oninput="trackFieldEdit('licensorAddress')">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="licensorState">State</label>
                            <select id="licensorState" onchange="trackFieldEdit('licensorState')">
                                <option value="">Select State</option>
                                <option value="Delaware">Delaware</option>
                                <option value="California">California</option>
                                <option value="New York">New York</option>
                                <option value="Texas">Texas</option>
                                <option value="Florida">Florida</option>
                                <option value="Washington">Washington</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="licensorEntity">Entity Type</label>
                            <select id="licensorEntity" onchange="trackFieldEdit('licensorEntity')">
                                <option value="Corporation">Corporation</option>
                                <option value="LLC">LLC</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Licensee Information -->
                <div class="form-section">
                    <div class="section-title">Licensee (Customer)</div>
                    <div class="form-group">
                        <label for="licenseeName">Company/Individual Name</label>
                        <input type="text" id="licenseeName" placeholder="Customer Corp" oninput="trackFieldEdit('licenseeName')">
                    </div>
                    <div class="form-group">
                        <label for="licenseeAddress">Address</label>
                        <input type="text" id="licenseeAddress" placeholder="456 Business Ave, New York, NY 10001" oninput="trackFieldEdit('licenseeAddress')">
                    </div>
                    <div class="form-group">
                        <label for="licenseeContact">Contact Person</label>
                        <input type="text" id="licenseeContact" placeholder="John Smith" oninput="trackFieldEdit('licenseeContact')">
                    </div>
                </div>

                <!-- Software Details -->
                <div class="form-section">
                    <div class="section-title">Software Details</div>
                    <div class="form-group">
                        <label for="softwareName">Software Name</label>
                        <input type="text" id="softwareName" placeholder="Enterprise Suite Pro" oninput="trackFieldEdit('softwareName')">
                    </div>
                    <div class="form-group">
                        <label for="softwareVersion">Version</label>
                        <input type="text" id="softwareVersion" placeholder="3.0" oninput="trackFieldEdit('softwareVersion')">
                    </div>
                    <div class="form-group">
                        <label for="softwareDescription">Description</label>
                        <textarea id="softwareDescription" placeholder="Enterprise resource planning software for managing business operations..." oninput="trackFieldEdit('softwareDescription')"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="deliveryMethod">Delivery Method</label>
                        <select id="deliveryMethod" onchange="trackFieldEdit('deliveryMethod')">
                            <option value="download">Electronic Download</option>
                            <option value="physical">Physical Media (USB/DVD)</option>
                            <option value="onpremise">On-Premise Installation</option>
                        </select>
                    </div>
                </div>

                <!-- License Type -->
                <div class="form-section">
                    <div class="section-title">License Type</div>
                    <div class="form-group">
                        <label for="licenseType">License Model</label>
                        <select id="licenseType" onchange="trackFieldEdit('licenseType'); toggleLicenseFields()">
                            <option value="perpetual">Perpetual License</option>
                            <option value="subscription">Subscription License</option>
                            <option value="sitewide">Site-Wide License</option>
                            <option value="enterprise">Enterprise License</option>
                        </select>
                    </div>
                    <div class="form-group" id="termGroup" style="display: none;">
                        <label for="licenseTerm">License Term</label>
                        <select id="licenseTerm" onchange="trackFieldEdit('licenseTerm')">
                            <option value="1year">1 Year</option>
                            <option value="2year">2 Years</option>
                            <option value="3year">3 Years</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userLimit">Number of Users/Seats</label>
                            <input type="number" id="userLimit" placeholder="10" value="10" oninput="trackFieldEdit('userLimit')">
                        </div>
                        <div class="form-group">
                            <label for="deviceLimit">Number of Devices</label>
                            <input type="number" id="deviceLimit" placeholder="10" value="10" oninput="trackFieldEdit('deviceLimit')">
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="transferable" onchange="trackFieldEdit('transferable')">
                        <label for="transferable">License is transferable</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="sublicensable" onchange="trackFieldEdit('sublicensable')">
                        <label for="sublicensable">Sublicensing permitted</label>
                    </div>
                </div>

                <!-- Pricing -->
                <div class="form-section">
                    <div class="section-title">Pricing & Payment</div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" oninput="trackFieldEdit('effectiveDate')">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="licenseFee">License Fee ($)</label>
                            <input type="number" id="licenseFee" placeholder="5000.00" step="0.01" oninput="trackFieldEdit('licenseFee')">
                        </div>
                        <div class="form-group">
                            <label for="paymentType">Payment Type</label>
                            <select id="paymentType" onchange="trackFieldEdit('paymentType')">
                                <option value="onetime">One-Time Payment</option>
                                <option value="annual">Annual</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="paymentTerms">Payment Due</label>
                        <select id="paymentTerms" onchange="trackFieldEdit('paymentTerms')">
                            <option value="upfront">Upon Execution</option>
                            <option value="net30">Net 30</option>
                            <option value="net15">Net 15</option>
                        </select>
                    </div>
                </div>

                <!-- Support & Maintenance -->
                <div class="form-section">
                    <div class="section-title">Support & Maintenance</div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeSupport" checked onchange="trackFieldEdit('includeSupport'); toggleSupportFields()">
                        <label for="includeSupport">Include maintenance and support</label>
                    </div>
                    <div id="supportFields">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="supportFee">Annual Support Fee ($)</label>
                                <input type="number" id="supportFee" placeholder="1000.00" step="0.01" oninput="trackFieldEdit('supportFee')">
                            </div>
                            <div class="form-group">
                                <label for="supportLevel">Support Level</label>
                                <select id="supportLevel" onchange="trackFieldEdit('supportLevel')">
                                    <option value="standard">Standard (Business Hours)</option>
                                    <option value="priority">Priority (Extended)</option>
                                    <option value="premium">Premium (24/7)</option>
                                </select>
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="includeUpdates" checked onchange="trackFieldEdit('includeUpdates')">
                            <label for="includeUpdates">Include software updates</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="includeUpgrades" onchange="trackFieldEdit('includeUpgrades')">
                            <label for="includeUpgrades">Include major version upgrades</label>
                        </div>
                    </div>
                </div>

                <!-- Restrictions -->
                <div class="form-section">
                    <div class="section-title">Use Restrictions</div>
                    <div class="form-group">
                        <label for="useScope">Permitted Use</label>
                        <select id="useScope" onchange="trackFieldEdit('useScope')">
                            <option value="internal">Internal business use only</option>
                            <option value="commercial">Commercial use permitted</option>
                            <option value="development">Development/testing only</option>
                            <option value="educational">Educational use only</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="noReverseEngineer" checked onchange="trackFieldEdit('noReverseEngineer')">
                        <label for="noReverseEngineer">Prohibit reverse engineering</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="noModification" checked onchange="trackFieldEdit('noModification')">
                        <label for="noModification">Prohibit modification</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="noCompetitive" checked onchange="trackFieldEdit('noCompetitive')">
                        <label for="noCompetitive">Prohibit competitive analysis</label>
                    </div>
                </div>

                <!-- Legal Terms -->
                <div class="form-section">
                    <div class="section-title">Legal Terms</div>
                    <div class="form-group">
                        <label for="warrantyPeriod">Warranty Period</label>
                        <select id="warrantyPeriod" onchange="trackFieldEdit('warrantyPeriod')">
                            <option value="30days">30 Days</option>
                            <option value="90days" selected>90 Days</option>
                            <option value="1year">1 Year</option>
                            <option value="none">No Warranty</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="governingLaw">Governing Law</label>
                        <select id="governingLaw" onchange="trackFieldEdit('governingLaw')">
                            <option value="">Same as Licensor State</option>
                            <option value="Delaware">Delaware</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Texas">Texas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="liabilityLimit">Liability Limit</label>
                        <select id="liabilityLimit" onchange="trackFieldEdit('liabilityLimit')">
                            <option value="feesPaid" selected>Total fees paid</option>
                            <option value="12months">12 months of fees</option>
                            <option value="custom">Custom amount</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="updatePreview()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Generate Agreement
                </button>
            </div>
        </div>

        <div class="preview-panel" id="previewPanel">
            <div class="preview-header">
                <h3>Document Preview</h3>
                <div class="preview-actions">
                    <div class="edit-mode-toggle">
                        <input type="checkbox" id="fullEditMode" onchange="toggleFullEditMode()">
                        <label for="fullEditMode">Full Edit Mode</label>
                    </div>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 6 2 18 2 18 9"></polyline>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-success" onclick="downloadWord()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>

            <div class="document-container">
                <div class="full-edit-warning">
                    ‚ö†Ô∏è <strong>Full Edit Mode Active:</strong> You can now directly edit any text in the document.
                    Changes will NOT sync back to the form. Regenerating will overwrite your edits.
                </div>
                <div class="document" id="documentPreview">
                    <p style="text-align: center; color: var(--text-light); padding: 3rem;">
                        Fill in the form fields and click "Generate Agreement" to preview your document.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let lastEditedField = null;
        let hasCustomEdits = false;

        function toggleLicenseFields() {
            const licenseType = document.getElementById('licenseType').value;
            document.getElementById('termGroup').style.display = licenseType === 'subscription' ? 'block' : 'none';
        }

        function toggleSupportFields() {
            const includeSupport = document.getElementById('includeSupport').checked;
            document.getElementById('supportFields').style.display = includeSupport ? 'block' : 'none';
        }

        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                const proceed = confirm('You have made custom edits. Regenerating will overwrite them. Continue?');
                if (!proceed) return;
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        function toggleFullEditMode() {
            const isEnabled = document.getElementById('fullEditMode').checked;
            const previewPanel = document.getElementById('previewPanel');
            const documentEl = document.getElementById('documentPreview');

            if (isEnabled) {
                previewPanel.classList.add('full-edit-mode');
                documentEl.contentEditable = true;
                documentEl.addEventListener('input', () => hasCustomEdits = true);
            } else {
                previewPanel.classList.remove('full-edit-mode');
                documentEl.contentEditable = false;
            }
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2 }).format(amount);
        }

        function formatDate(dateString) {
            if (!dateString) return '[DATE]';
            return new Date(dateString).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function getLicenseTypeText(type) {
            switch(type) {
                case 'perpetual': return 'perpetual, non-exclusive';
                case 'subscription': return 'term-based, non-exclusive';
                case 'sitewide': return 'site-wide, non-exclusive';
                case 'enterprise': return 'enterprise-wide, non-exclusive';
                default: return 'non-exclusive';
            }
        }

        function getTermText(term) {
            switch(term) {
                case '1year': return 'one (1) year';
                case '2year': return 'two (2) years';
                case '3year': return 'three (3) years';
                default: return 'one (1) year';
            }
        }

        function getWarrantyText(period) {
            switch(period) {
                case '30days': return 'thirty (30) days';
                case '90days': return 'ninety (90) days';
                case '1year': return 'one (1) year';
                case 'none': return null;
                default: return 'ninety (90) days';
            }
        }

        function getSupportLevelText(level) {
            switch(level) {
                case 'standard': return 'during Licensor\'s regular business hours (9:00 AM to 5:00 PM, Monday through Friday, excluding holidays)';
                case 'priority': return 'during extended hours (7:00 AM to 9:00 PM, Monday through Friday)';
                case 'premium': return '24 hours per day, 7 days per week, including holidays';
                default: return 'during regular business hours';
            }
        }

        function getUseScopeText(scope) {
            switch(scope) {
                case 'internal': return 'solely for Licensee\'s internal business purposes';
                case 'commercial': return 'for Licensee\'s internal business purposes and commercial operations';
                case 'development': return 'solely for development and testing purposes';
                case 'educational': return 'solely for educational and non-commercial purposes';
                default: return 'for internal business purposes';
            }
        }

        function updatePreview() {
            const licensorName = document.getElementById('licensorName').value.trim() || '[LICENSOR NAME]';
            const licensorAddress = document.getElementById('licensorAddress').value.trim() || '[LICENSOR ADDRESS]';
            const licensorState = document.getElementById('licensorState').value || '[STATE]';
            const licensorEntity = document.getElementById('licensorEntity').value;

            const licenseeName = document.getElementById('licenseeName').value.trim() || '[LICENSEE NAME]';
            const licenseeAddress = document.getElementById('licenseeAddress').value.trim() || '[LICENSEE ADDRESS]';
            const licenseeContact = document.getElementById('licenseeContact').value.trim() || '[CONTACT NAME]';

            const softwareName = document.getElementById('softwareName').value.trim() || '[SOFTWARE NAME]';
            const softwareVersion = document.getElementById('softwareVersion').value.trim() || '[VERSION]';
            const softwareDescription = document.getElementById('softwareDescription').value.trim() || '[Software description]';
            const deliveryMethod = document.getElementById('deliveryMethod').value;

            const licenseType = document.getElementById('licenseType').value;
            const licenseTerm = document.getElementById('licenseTerm').value;
            const userLimit = document.getElementById('userLimit').value || '10';
            const deviceLimit = document.getElementById('deviceLimit').value || '10';
            const transferable = document.getElementById('transferable').checked;
            const sublicensable = document.getElementById('sublicensable').checked;

            const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
            const licenseFee = parseFloat(document.getElementById('licenseFee').value) || 0;
            const paymentType = document.getElementById('paymentType').value;
            const paymentTerms = document.getElementById('paymentTerms').value;

            const includeSupport = document.getElementById('includeSupport').checked;
            const supportFee = parseFloat(document.getElementById('supportFee').value) || 0;
            const supportLevel = document.getElementById('supportLevel').value;
            const includeUpdates = document.getElementById('includeUpdates').checked;
            const includeUpgrades = document.getElementById('includeUpgrades').checked;

            const useScope = document.getElementById('useScope').value;
            const noReverseEngineer = document.getElementById('noReverseEngineer').checked;
            const noModification = document.getElementById('noModification').checked;
            const noCompetitive = document.getElementById('noCompetitive').checked;

            const warrantyPeriod = document.getElementById('warrantyPeriod').value;
            const governingLaw = document.getElementById('governingLaw').value || licensorState;
            const liabilityLimit = document.getElementById('liabilityLimit').value;

            // Build restrictions list
            let restrictions = [];
            if (noReverseEngineer) restrictions.push('reverse engineer, decompile, disassemble, or otherwise attempt to derive the source code of the Software');
            if (noModification) restrictions.push('modify, adapt, alter, translate, or create derivative works based on the Software');
            if (noCompetitive) restrictions.push('use the Software to develop or assist in the development of any product or service that competes with the Software');
            restrictions.push('rent, lease, lend, sell, sublicense, assign, or transfer rights to the Software' + (sublicensable ? ' (except as expressly permitted herein)' : ''));
            restrictions.push('remove, alter, or obscure any proprietary notices on the Software');

            // Build term section
            let termSection = '';
            if (licenseType === 'perpetual') {
                termSection = `<p>3.1 <strong>Term.</strong> This license is perpetual and shall continue indefinitely unless terminated in accordance with this Agreement.</p>`;
            } else {
                termSection = `
                    <p>3.1 <strong>Term.</strong> The initial license term shall be <span class="doc-highlight" contenteditable="true" data-field="licenseTerm">${getTermText(licenseTerm)}</span> commencing on the Effective Date (the "Initial Term").</p>
                    <p>3.2 <strong>Renewal.</strong> This Agreement shall automatically renew for successive periods equal to the Initial Term unless either party provides written notice of non-renewal at least thirty (30) days prior to the end of the then-current term.</p>
                `;
            }

            // Build support section
            let supportSection = '';
            if (includeSupport) {
                supportSection = `
                    <div class="section">
                        <h2><span class="section-number">6.</span> MAINTENANCE AND SUPPORT</h2>
                        <p>6.1 <strong>Support Services.</strong> Subject to Licensee's payment of the Support Fee, Licensor shall provide technical support <span class="doc-highlight" contenteditable="true" data-field="supportLevel">${getSupportLevelText(supportLevel)}</span>.</p>
                        <p>6.2 <strong>Support Fee.</strong> The annual support and maintenance fee shall be <span class="doc-highlight" contenteditable="true" data-field="supportFee">${formatCurrency(supportFee)}</span>, payable in advance for each support year.</p>
                        ${includeUpdates ? '<p>6.3 <strong>Updates.</strong> Support includes all minor updates, bug fixes, and patches released by Licensor during the support period.</p>' : ''}
                        ${includeUpgrades ? '<p>6.' + (includeUpdates ? '4' : '3') + ' <strong>Upgrades.</strong> Support includes major version upgrades at no additional license fee, though support fees may be adjusted for major versions.</p>' : ''}
                        <p>6.${includeUpdates && includeUpgrades ? '5' : (includeUpdates || includeUpgrades ? '4' : '3')} <strong>Support Exclusions.</strong> Support does not include: (a) issues caused by unauthorized modifications; (b) issues caused by third-party software; (c) on-site support (unless separately agreed); or (d) training services.</p>
                    </div>
                `;
            }

            // Build warranty section
            let warrantySection = '';
            const warrantyText = getWarrantyText(warrantyPeriod);
            if (warrantyText) {
                warrantySection = `
                    <p>7.1 <strong>Limited Warranty.</strong> Licensor warrants that for a period of <span class="doc-highlight" contenteditable="true" data-field="warrantyPeriod">${warrantyText}</span> from the Effective Date (the "Warranty Period"), the Software will perform substantially in accordance with the Documentation when properly installed and used.</p>
                    <p>7.2 <strong>Remedy.</strong> If the Software fails to conform to the warranty during the Warranty Period, Licensor shall, at its option: (a) repair or replace the non-conforming Software; or (b) refund the license fees paid, and upon such refund, this Agreement shall terminate.</p>
                `;
            } else {
                warrantySection = `<p>7.1 <strong>No Warranty.</strong> THE SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.</p>`;
            }

            // Payment terms text
            let paymentTermsText = 'upon execution of this Agreement';
            if (paymentTerms === 'net30') paymentTermsText = 'within thirty (30) days of invoice';
            if (paymentTerms === 'net15') paymentTermsText = 'within fifteen (15) days of invoice';

            // Delivery method text
            let deliveryText = 'electronic download';
            if (deliveryMethod === 'physical') deliveryText = 'physical media';
            if (deliveryMethod === 'onpremise') deliveryText = 'on-premise installation';

            // Section numbering adjustment
            const supportSectionNum = includeSupport ? 6 : 0;
            const warrantySectionNum = includeSupport ? 7 : 6;
            const liabilitySectionNum = includeSupport ? 8 : 7;
            const indemnSectionNum = includeSupport ? 9 : 8;
            const terminationSectionNum = includeSupport ? 10 : 9;
            const generalSectionNum = includeSupport ? 11 : 10;

            const documentHTML = `
                <h1>SOFTWARE LICENSE AGREEMENT</h1>

                <div class="parties">
                    <p>This Software License Agreement (the "Agreement") is entered into as of <span class="doc-highlight" contenteditable="true" data-field="effectiveDate">${effectiveDate}</span> (the "Effective Date")</p>
                    <p><strong>by and between</strong></p>
                    <p><span class="doc-highlight" contenteditable="true" data-field="licensorName">${licensorName}</span>, a ${licensorState} ${licensorEntity} ("Licensor")<br>
                    <span class="doc-highlight" contenteditable="true" data-field="licensorAddress">${licensorAddress}</span></p>
                    <p><strong>and</strong></p>
                    <p><span class="doc-highlight" contenteditable="true" data-field="licenseeName">${licenseeName}</span> ("Licensee")<br>
                    <span class="doc-highlight" contenteditable="true" data-field="licenseeAddress">${licenseeAddress}</span></p>
                </div>

                <p><strong>RECITALS</strong></p>
                <p>WHEREAS, Licensor has developed and owns certain computer software known as <span class="doc-highlight" contenteditable="true" data-field="softwareName">${softwareName}</span>; and</p>
                <p>WHEREAS, Licensee desires to obtain a license to use such software subject to the terms and conditions set forth herein;</p>
                <p>NOW, THEREFORE, in consideration of the mutual covenants herein, the parties agree as follows:</p>

                <div class="section">
                    <h2><span class="section-number">1.</span> DEFINITIONS</h2>
                    <p>1.1 <strong>"Software"</strong> means <span class="doc-highlight" contenteditable="true" data-field="softwareName">${softwareName}</span> version <span class="doc-highlight" contenteditable="true" data-field="softwareVersion">${softwareVersion}</span>, including <span class="doc-highlight" contenteditable="true" data-field="softwareDescription">${softwareDescription}</span>, together with any updates, patches, or modifications provided by Licensor under this Agreement.</p>
                    <p>1.2 <strong>"Documentation"</strong> means the user manuals, technical specifications, and other materials provided by Licensor describing the installation, operation, and use of the Software.</p>
                    <p>1.3 <strong>"Authorized Users"</strong> means Licensee's employees and contractors who are authorized to use the Software under this Agreement.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">2.</span> LICENSE GRANT</h2>
                    <p>2.1 <strong>Grant.</strong> Subject to the terms of this Agreement and payment of all applicable fees, Licensor grants to Licensee a <span class="doc-highlight" contenteditable="true" data-field="licenseType">${getLicenseTypeText(licenseType)}</span> license to install, copy, and use the Software <span class="doc-highlight" contenteditable="true" data-field="useScope">${getUseScopeText(useScope)}</span>.</p>
                    <p>2.2 <strong>Users.</strong> The license permits use by up to <span class="doc-highlight" contenteditable="true" data-field="userLimit">${userLimit}</span> Authorized Users.</p>
                    <p>2.3 <strong>Devices.</strong> The Software may be installed on up to <span class="doc-highlight" contenteditable="true" data-field="deviceLimit">${deviceLimit}</span> devices owned or controlled by Licensee.</p>
                    ${transferable ? '<p>2.4 <strong>Transfer.</strong> Licensee may transfer this license to a third party, provided that: (a) Licensee provides written notice to Licensor; (b) the transferee agrees in writing to be bound by this Agreement; and (c) Licensee transfers all copies of the Software to the transferee and certifies deletion of any retained copies.</p>' : '<p>2.4 <strong>No Transfer.</strong> This license is non-transferable. Licensee may not assign or transfer this license to any third party without Licensor\'s prior written consent.</p>'}
                    ${sublicensable ? '<p>2.5 <strong>Sublicensing.</strong> Licensee may sublicense use of the Software to its affiliates and subsidiaries, provided that such sublicensees agree to be bound by terms no less restrictive than this Agreement.</p>' : ''}
                </div>

                <div class="section">
                    <h2><span class="section-number">3.</span> TERM</h2>
                    ${termSection}
                </div>

                <div class="section">
                    <h2><span class="section-number">4.</span> LICENSE RESTRICTIONS</h2>
                    <p>4.1 <strong>Restrictions.</strong> Licensee shall not, and shall not permit any third party to:</p>
                    ${restrictions.map((r, i) => `<p class="subsection">(${String.fromCharCode(97 + i)}) ${r};</p>`).join('')}
                    <p>4.2 <strong>Copies.</strong> Licensee may make a reasonable number of backup copies of the Software solely for archival purposes.</p>
                    <p>4.3 <strong>Audit.</strong> Licensor may, upon reasonable notice, audit Licensee's use of the Software to verify compliance with this Agreement. Such audits shall occur no more than once per year during normal business hours.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">5.</span> FEES AND PAYMENT</h2>
                    <p>5.1 <strong>License Fee.</strong> In consideration for the license granted herein, Licensee shall pay Licensor <span class="doc-highlight" contenteditable="true" data-field="licenseFee">${formatCurrency(licenseFee)}</span> ${paymentType === 'onetime' ? '(one-time payment)' : paymentType === 'annual' ? 'per year' : 'per month'}.</p>
                    <p>5.2 <strong>Payment Terms.</strong> All fees are due and payable ${paymentTermsText}.</p>
                    <p>5.3 <strong>Late Payments.</strong> Amounts not paid when due shall bear interest at the rate of 1.5% per month (or the maximum rate permitted by law, if less).</p>
                    <p>5.4 <strong>Taxes.</strong> All fees are exclusive of taxes. Licensee shall pay all applicable sales, use, and other taxes, excluding taxes based on Licensor's income.</p>
                </div>

                ${supportSection}

                <div class="section">
                    <h2><span class="section-number">${warrantySectionNum}.</span> WARRANTIES AND DISCLAIMERS</h2>
                    ${warrantySection}
                    <p>${warrantySectionNum}.${warrantyText ? '3' : '2'} <strong>DISCLAIMER.</strong> EXCEPT AS EXPRESSLY SET FORTH ABOVE, THE SOFTWARE IS PROVIDED "AS IS" AND LICENSOR DISCLAIMS ALL OTHER WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.</p>
                    <p>${warrantySectionNum}.${warrantyText ? '4' : '3'} <strong>Third-Party Components.</strong> The Software may include third-party components subject to separate license terms. Licensor makes no warranty with respect to such third-party components.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">${liabilitySectionNum}.</span> LIMITATION OF LIABILITY</h2>
                    <p>${liabilitySectionNum}.1 <strong>Consequential Damages.</strong> IN NO EVENT SHALL EITHER PARTY BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING LOST PROFITS, LOST DATA, OR BUSINESS INTERRUPTION, ARISING OUT OF THIS AGREEMENT.</p>
                    <p>${liabilitySectionNum}.2 <strong>Liability Cap.</strong> LICENSOR'S TOTAL LIABILITY UNDER THIS AGREEMENT SHALL NOT EXCEED ${liabilityLimit === 'feesPaid' ? 'THE TOTAL FEES PAID BY LICENSEE TO LICENSOR UNDER THIS AGREEMENT' : liabilityLimit === '12months' ? 'THE FEES PAID DURING THE TWELVE (12) MONTHS PRECEDING THE CLAIM' : '[SPECIFIED AMOUNT]'}.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">${indemnSectionNum}.</span> INDEMNIFICATION</h2>
                    <p>${indemnSectionNum}.1 <strong>By Licensor.</strong> Licensor shall indemnify Licensee against any third-party claim that the Software infringes any U.S. patent, copyright, or trademark, provided that Licensee promptly notifies Licensor and allows Licensor to control the defense.</p>
                    <p>${indemnSectionNum}.2 <strong>Exclusions.</strong> Licensor shall have no liability for claims arising from: (a) modification of the Software by anyone other than Licensor; (b) combination of the Software with other products or services; or (c) Licensee's failure to use the most current version of the Software.</p>
                    <p>${indemnSectionNum}.3 <strong>By Licensee.</strong> Licensee shall indemnify Licensor against any claim arising from Licensee's breach of this Agreement or misuse of the Software.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">${terminationSectionNum}.</span> TERMINATION</h2>
                    <p>${terminationSectionNum}.1 <strong>Termination for Cause.</strong> Either party may terminate this Agreement immediately upon written notice if the other party materially breaches this Agreement and fails to cure such breach within thirty (30) days of written notice.</p>
                    <p>${terminationSectionNum}.2 <strong>Termination for Non-Payment.</strong> Licensor may terminate this Agreement immediately if Licensee fails to pay any fees when due and such failure continues for fifteen (15) days after written notice.</p>
                    <p>${terminationSectionNum}.3 <strong>Effect of Termination.</strong> Upon termination: (a) all licenses granted hereunder shall immediately terminate; (b) Licensee shall cease all use of the Software; (c) Licensee shall destroy or return all copies of the Software and Documentation; and (d) Licensee shall certify in writing that it has complied with these obligations.</p>
                    <p>${terminationSectionNum}.4 <strong>Survival.</strong> Sections relating to ownership, confidentiality, limitation of liability, indemnification, and general provisions shall survive termination.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">${generalSectionNum}.</span> GENERAL PROVISIONS</h2>
                    <p>${generalSectionNum}.1 <strong>Intellectual Property.</strong> Licensor retains all right, title, and interest in the Software, including all intellectual property rights. This Agreement grants no ownership rights to Licensee.</p>
                    <p>${generalSectionNum}.2 <strong>Confidentiality.</strong> Each party shall maintain the confidentiality of the other party's confidential information and use such information only for the purposes of this Agreement.</p>
                    <p>${generalSectionNum}.3 <strong>Governing Law.</strong> This Agreement shall be governed by the laws of the State of <span class="doc-highlight" contenteditable="true" data-field="governingLaw">${governingLaw}</span>, without regard to conflict of laws principles.</p>
                    <p>${generalSectionNum}.4 <strong>Dispute Resolution.</strong> Any dispute shall be resolved exclusively in the state or federal courts located in ${governingLaw}.</p>
                    <p>${generalSectionNum}.5 <strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties and supersedes all prior agreements and understandings.</p>
                    <p>${generalSectionNum}.6 <strong>Amendment.</strong> This Agreement may not be amended except by a written instrument signed by both parties.</p>
                    <p>${generalSectionNum}.7 <strong>Waiver.</strong> No waiver of any provision shall be effective unless in writing.</p>
                    <p>${generalSectionNum}.8 <strong>Severability.</strong> If any provision is held invalid, the remaining provisions shall continue in effect.</p>
                    <p>${generalSectionNum}.9 <strong>Counterparts.</strong> This Agreement may be executed in counterparts. Electronic signatures are valid.</p>
                </div>

                <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Software License Agreement as of the Effective Date.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h4>LICENSOR:</h4>
                        <p><strong><span class="doc-highlight" contenteditable="true" data-field="licensorName">${licensorName}</span></strong></p>
                        <div class="signature-line"><span>Signature</span></div>
                        <div class="signature-field"><span>Name: ____________________</span></div>
                        <div class="signature-field"><span>Title: ____________________</span></div>
                        <div class="signature-field"><span>Date: ____________________</span></div>
                    </div>
                    <div class="signature-party">
                        <h4>LICENSEE:</h4>
                        <p><strong><span class="doc-highlight" contenteditable="true" data-field="licenseeName">${licenseeName}</span></strong></p>
                        <div class="signature-line"><span>Signature</span></div>
                        <div class="signature-field"><span>Name: <span class="doc-highlight" contenteditable="true" data-field="licenseeContact">${licenseeContact}</span></span></div>
                        <div class="signature-field"><span>Title: ____________________</span></div>
                        <div class="signature-field"><span>Date: ____________________</span></div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = documentHTML;
            setupInlineEditing();

            if (lastEditedField) {
                setTimeout(() => {
                    const highlight = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (highlight) {
                        highlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        highlight.classList.add('field-highlight-animation');
                        setTimeout(() => highlight.classList.remove('field-highlight-animation'), 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        function setupInlineEditing() {
            document.querySelectorAll('.doc-highlight[data-field]').forEach(field => {
                field.addEventListener('blur', function() {
                    const fieldId = this.dataset.field;
                    const value = this.textContent.trim();
                    const input = document.getElementById(fieldId);
                    if (input) {
                        if (input.type === 'number') {
                            input.value = parseFloat(value.replace(/[^0-9.-]/g, '')) || 0;
                        } else {
                            input.value = value;
                        }
                    }
                    hasCustomEdits = true;
                });
            });
        }

        function printDocument() { window.print(); }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const licensorName = document.getElementById('licensorName').value.trim() || 'Licensor';
            const licenseeName = document.getElementById('licenseeName').value.trim() || 'Licensee';

            const html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>Software License Agreement</title>
                <style>body{font-family:'Times New Roman',serif;font-size:12pt;line-height:1.6;margin:1in;}
                h1{text-align:center;font-size:16pt;}h2{font-size:12pt;margin-top:18pt;}
                p{margin-bottom:6pt;text-align:justify;}.parties{text-align:center;margin-bottom:24pt;}
                .signature-block{margin-top:36pt;}.signature-party{display:inline-block;width:45%;vertical-align:top;}
                .signature-line{border-top:1px solid black;margin-top:48pt;padding-top:6pt;}
                .doc-highlight{background:none;border:none;padding:0;}</style></head>
                <body>${content}</body></html>`;

            const blob = new Blob([html], { type: 'application/msword' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `Software_License_${licensorName.replace(/[^a-z0-9]/gi, '_')}_${licenseeName.replace(/[^a-z0-9]/gi, '_')}.doc`;
            a.click();
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('effectiveDate').value = new Date().toISOString().split('T')[0];
        });
    </script>
</body>
</html>
