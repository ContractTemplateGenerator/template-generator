<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Lien Waiver Generator | Conditional & Unconditional | Terms.Law</title>
    <meta name="description" content="Generate professional lien waivers for construction projects. Create conditional or unconditional, partial or final lien waivers. Free legal template with instant Word export.">
    <meta name="keywords" content="lien waiver, mechanic's lien waiver, construction lien release, conditional lien waiver, unconditional lien waiver, progress payment waiver">
    <link rel="canonical" href="https://terms.law/Templates/lien-waiver-generator.html">
    <meta property="og:title" content="Free Lien Waiver Generator | Terms.Law">
    <meta property="og:description" content="Generate conditional or unconditional lien waivers for construction projects. Free legal template.">
    <meta property="og:type" content="website">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #065f46 0%, #059669 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            padding: 2rem;
            height: fit-content;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #10b981;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="date"],
        input[type="email"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .waiver-type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
        }

        .waiver-type-option {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .waiver-type-option:hover {
            border-color: #10b981;
        }

        .waiver-type-option.selected {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .waiver-type-option input {
            display: none;
        }

        .waiver-type-option .type-title {
            font-weight: 600;
            color: #1f2937;
            font-size: 0.95rem;
        }

        .waiver-type-option .type-desc {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .section-header {
            font-weight: 600;
            color: #065f46;
            font-size: 0.95rem;
            margin: 1.5rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .warning-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.85rem;
            color: #92400e;
        }

        .warning-box strong {
            display: block;
            margin-bottom: 0.25rem;
        }

        .info-box {
            background: #ecfdf5;
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.85rem;
            color: #065f46;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, #065f46 0%, #059669 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .preview-container {
            background: #f9fafb;
            border-radius: 12px;
            padding: 2rem;
            max-height: 800px;
            overflow-y: auto;
        }

        .preview-document {
            background: white;
            padding: 3rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .preview-document h1 {
            color: #1f2937;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .preview-document h2 {
            color: #1f2937;
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 500;
        }

        .preview-document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .preview-document .field {
            color: #059669;
            font-weight: 500;
        }

        .preview-document .label {
            font-weight: 600;
        }

        .preview-document .signature-section {
            margin-top: 3rem;
        }

        .preview-document .signature-block {
            margin-top: 2rem;
            page-break-inside: avoid;
        }

        .preview-document .sig-line {
            border-bottom: 1px solid #1f2937;
            width: 250px;
            margin-bottom: 0.25rem;
            height: 30px;
        }

        .preview-document .sig-label {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .preview-document .amounts-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .preview-document .amounts-table th,
        .preview-document .amounts-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        .preview-document .amounts-table th {
            background: #f9fafb;
            font-weight: 600;
        }

        .preview-document .amounts-table td.amount {
            text-align: right;
            font-weight: 500;
        }

        .preview-document .notary-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid #1f2937;
        }

        .preview-document .center {
            text-align: center;
        }

        .preview-document .bold {
            font-weight: 600;
        }

        footer {
            text-align: center;
            margin-top: 2rem;
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }

        footer a {
            color: white;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #059669;
        }

        .checkbox-group label {
            margin: 0;
            font-weight: 400;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Lien Waiver Generator</h1>
            <p class="subtitle">Generate professional conditional or unconditional lien waivers for construction projects</p>
        </header>

        <div class="main-content">
            <div class="card">
                <h2 class="card-title">Waiver Details</h2>

                <div class="section-header">Waiver Type</div>

                <label>Condition Type</label>
                <div class="waiver-type-selector">
                    <label class="waiver-type-option selected">
                        <input type="radio" name="conditionType" value="conditional" checked onchange="updatePreview()">
                        <div class="type-title">Conditional</div>
                        <div class="type-desc">Waiver effective only upon actual receipt of payment</div>
                    </label>
                    <label class="waiver-type-option">
                        <input type="radio" name="conditionType" value="unconditional" onchange="updatePreview()">
                        <div class="type-title">Unconditional</div>
                        <div class="type-desc">Waiver effective immediately upon signing</div>
                    </label>
                </div>

                <label>Payment Type</label>
                <div class="waiver-type-selector">
                    <label class="waiver-type-option selected">
                        <input type="radio" name="paymentType" value="progress" checked onchange="updatePreview()">
                        <div class="type-title">Progress Payment</div>
                        <div class="type-desc">Partial payment during construction</div>
                    </label>
                    <label class="waiver-type-option">
                        <input type="radio" name="paymentType" value="final" onchange="updatePreview()">
                        <div class="type-title">Final Payment</div>
                        <div class="type-desc">Final payment upon project completion</div>
                    </label>
                </div>

                <div class="warning-box" id="unconditionalWarning" style="display: none;">
                    <strong>⚠️ Unconditional Waiver Warning</strong>
                    An unconditional waiver takes effect immediately upon signing, even if payment has not been received. Only sign after confirming funds have cleared.
                </div>

                <div class="section-header">Claimant Information</div>

                <div class="form-group">
                    <label for="claimantName">Claimant Name (Company/Individual Providing Work)</label>
                    <input type="text" id="claimantName" placeholder="e.g., ABC Electrical Services, LLC" oninput="updatePreview()">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="claimantAddress">Address</label>
                        <input type="text" id="claimantAddress" placeholder="123 Main Street" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="claimantCityStateZip">City, State ZIP</label>
                        <input type="text" id="claimantCityStateZip" placeholder="Austin, TX 78701" oninput="updatePreview()">
                    </div>
                </div>

                <div class="form-group">
                    <label for="claimantRole">Role in Project</label>
                    <select id="claimantRole" onchange="updatePreview()">
                        <option value="General Contractor">General Contractor</option>
                        <option value="Subcontractor">Subcontractor</option>
                        <option value="Material Supplier">Material Supplier</option>
                        <option value="Equipment Rental Company">Equipment Rental Company</option>
                        <option value="Laborer">Laborer</option>
                    </select>
                </div>

                <div class="section-header">Property & Project Information</div>

                <div class="form-group">
                    <label for="projectName">Project Name</label>
                    <input type="text" id="projectName" placeholder="e.g., Johnson Residence Renovation" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="propertyAddress">Property Address (Job Site)</label>
                    <input type="text" id="propertyAddress" placeholder="456 Oak Avenue, Austin, TX 78702" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="propertyOwner">Property Owner</label>
                    <input type="text" id="propertyOwner" placeholder="e.g., Michael and Sarah Johnson" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="generalContractor">General Contractor (if different from claimant)</label>
                    <input type="text" id="generalContractor" placeholder="e.g., Premium Construction Inc." oninput="updatePreview()">
                </div>

                <div class="section-header">Payment Information</div>

                <div class="form-group">
                    <label for="paymentAmount">Payment Amount This Waiver Covers</label>
                    <input type="text" id="paymentAmount" placeholder="e.g., 25,000.00" oninput="updatePreview()">
                </div>

                <div class="form-group" id="throughDateGroup">
                    <label for="throughDate">Work Covered Through Date</label>
                    <input type="date" id="throughDate" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="totalContractAmount">Total Contract Amount</label>
                    <input type="text" id="totalContractAmount" placeholder="e.g., 150,000.00" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="previousPayments">Previous Payments Received</label>
                    <input type="text" id="previousPayments" placeholder="e.g., 75,000.00" oninput="updatePreview()">
                </div>

                <div class="form-group" id="checkNumberGroup">
                    <label for="checkNumber">Check/Payment Reference Number (Optional)</label>
                    <input type="text" id="checkNumber" placeholder="e.g., Check #4521" oninput="updatePreview()">
                </div>

                <div class="form-group">
                    <label for="waiverDate">Waiver Date</label>
                    <input type="date" id="waiverDate" oninput="updatePreview()">
                </div>

                <div class="section-header">Work Description</div>

                <div class="form-group">
                    <label for="workDescription">Description of Labor/Materials/Services Provided</label>
                    <textarea id="workDescription" rows="3" placeholder="e.g., Electrical wiring, panel installation, fixture installation, and related electrical work for residential renovation" oninput="updatePreview()"></textarea>
                </div>

                <div class="section-header">Exceptions (if any)</div>

                <div class="form-group">
                    <label for="exceptions">Disputed or Retained Amounts (leave blank if none)</label>
                    <textarea id="exceptions" rows="2" placeholder="e.g., Retention amount of $5,000 pending final inspection" oninput="updatePreview()"></textarea>
                </div>

                <div class="section-header">Options</div>

                <div class="checkbox-group">
                    <input type="checkbox" id="includeNotary" onchange="updatePreview()">
                    <label for="includeNotary">Include Notary Acknowledgment</label>
                </div>

                <div class="form-group" id="stateGroup" style="margin-top: 1rem;">
                    <label for="state">State</label>
                    <select id="state" onchange="updatePreview()">
                        <option value="Alabama">Alabama</option>
                        <option value="Alaska">Alaska</option>
                        <option value="Arizona">Arizona</option>
                        <option value="Arkansas">Arkansas</option>
                        <option value="California">California</option>
                        <option value="Colorado">Colorado</option>
                        <option value="Connecticut">Connecticut</option>
                        <option value="Delaware">Delaware</option>
                        <option value="Florida">Florida</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Hawaii">Hawaii</option>
                        <option value="Idaho">Idaho</option>
                        <option value="Illinois">Illinois</option>
                        <option value="Indiana">Indiana</option>
                        <option value="Iowa">Iowa</option>
                        <option value="Kansas">Kansas</option>
                        <option value="Kentucky">Kentucky</option>
                        <option value="Louisiana">Louisiana</option>
                        <option value="Maine">Maine</option>
                        <option value="Maryland">Maryland</option>
                        <option value="Massachusetts">Massachusetts</option>
                        <option value="Michigan">Michigan</option>
                        <option value="Minnesota">Minnesota</option>
                        <option value="Mississippi">Mississippi</option>
                        <option value="Missouri">Missouri</option>
                        <option value="Montana">Montana</option>
                        <option value="Nebraska">Nebraska</option>
                        <option value="Nevada">Nevada</option>
                        <option value="New Hampshire">New Hampshire</option>
                        <option value="New Jersey">New Jersey</option>
                        <option value="New Mexico">New Mexico</option>
                        <option value="New York">New York</option>
                        <option value="North Carolina">North Carolina</option>
                        <option value="North Dakota">North Dakota</option>
                        <option value="Ohio">Ohio</option>
                        <option value="Oklahoma">Oklahoma</option>
                        <option value="Oregon">Oregon</option>
                        <option value="Pennsylvania">Pennsylvania</option>
                        <option value="Rhode Island">Rhode Island</option>
                        <option value="South Carolina">South Carolina</option>
                        <option value="South Dakota">South Dakota</option>
                        <option value="Tennessee">Tennessee</option>
                        <option value="Texas" selected>Texas</option>
                        <option value="Utah">Utah</option>
                        <option value="Vermont">Vermont</option>
                        <option value="Virginia">Virginia</option>
                        <option value="Washington">Washington</option>
                        <option value="West Virginia">West Virginia</option>
                        <option value="Wisconsin">Wisconsin</option>
                        <option value="Wyoming">Wyoming</option>
                    </select>
                </div>

                <div class="info-box">
                    <strong>Note:</strong> Many states (including California and Texas) have specific statutory lien waiver forms. This generator creates a general-purpose form. Consult local counsel for state-specific requirements.
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="downloadDocument()">Download Word Document</button>
                    <button class="btn btn-secondary" onclick="resetForm()">Reset Form</button>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Live Preview</h2>
                <div class="preview-container">
                    <div class="preview-document" id="preview">
                        <!-- Preview content generated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>© 2025 <a href="https://terms.law">Terms.Law</a> · Free Legal Document Generators · <a href="/Templates/">All Templates</a></p>
        </footer>
    </div>

    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set default dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('waiverDate').value = today;
            document.getElementById('throughDate').value = today;

            // Set up waiver type selectors
            document.querySelectorAll('.waiver-type-option').forEach(option => {
                option.addEventListener('click', function() {
                    const radioGroup = this.querySelector('input[type="radio"]').name;
                    document.querySelectorAll(`input[name="${radioGroup}"]`).forEach(r => {
                        r.closest('.waiver-type-option').classList.remove('selected');
                    });
                    this.classList.add('selected');
                    this.querySelector('input[type="radio"]').checked = true;
                    updatePreview();
                });
            });

            updatePreview();
        });

        function getWaiverType() {
            const conditionType = document.querySelector('input[name="conditionType"]:checked').value;
            const paymentType = document.querySelector('input[name="paymentType"]:checked').value;
            return { conditionType, paymentType };
        }

        function getWaiverTitle() {
            const { conditionType, paymentType } = getWaiverType();
            const condition = conditionType === 'conditional' ? 'CONDITIONAL' : 'UNCONDITIONAL';
            const payment = paymentType === 'progress' ? 'PROGRESS PAYMENT' : 'FINAL';
            return `${condition} WAIVER AND RELEASE ON ${payment} PAYMENT`;
        }

        function formatCurrency(value) {
            if (!value) return '$0.00';
            const num = parseFloat(value.replace(/,/g, ''));
            if (isNaN(num)) return '$0.00';
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function updatePreview() {
            const { conditionType, paymentType } = getWaiverType();

            // Show/hide warning for unconditional
            document.getElementById('unconditionalWarning').style.display =
                conditionType === 'unconditional' ? 'block' : 'none';

            // Get form values
            const claimantName = document.getElementById('claimantName').value || '[CLAIMANT NAME]';
            const claimantAddress = document.getElementById('claimantAddress').value || '[ADDRESS]';
            const claimantCityStateZip = document.getElementById('claimantCityStateZip').value || '[CITY, STATE ZIP]';
            const claimantRole = document.getElementById('claimantRole').value;
            const projectName = document.getElementById('projectName').value || '[PROJECT NAME]';
            const propertyAddress = document.getElementById('propertyAddress').value || '[PROPERTY ADDRESS]';
            const propertyOwner = document.getElementById('propertyOwner').value || '[PROPERTY OWNER]';
            const generalContractor = document.getElementById('generalContractor').value;
            const paymentAmount = document.getElementById('paymentAmount').value;
            const throughDate = document.getElementById('throughDate').value;
            const totalContractAmount = document.getElementById('totalContractAmount').value;
            const previousPayments = document.getElementById('previousPayments').value;
            const checkNumber = document.getElementById('checkNumber').value;
            const waiverDate = document.getElementById('waiverDate').value;
            const workDescription = document.getElementById('workDescription').value || '[DESCRIPTION OF WORK]';
            const exceptions = document.getElementById('exceptions').value;
            const includeNotary = document.getElementById('includeNotary').checked;
            const state = document.getElementById('state').value;

            // Calculate amounts
            const total = parseFloat((totalContractAmount || '0').replace(/,/g, '')) || 0;
            const previous = parseFloat((previousPayments || '0').replace(/,/g, '')) || 0;
            const current = parseFloat((paymentAmount || '0').replace(/,/g, '')) || 0;
            const balance = total - previous - current;

            let preview = `
                <h1>LIEN WAIVER AND RELEASE</h1>
                <h2>${getWaiverTitle()}</h2>

                <p><span class="label">Property:</span> <span class="field">${propertyAddress}</span></p>
                <p><span class="label">Property Owner:</span> <span class="field">${propertyOwner}</span></p>
                ${generalContractor ? `<p><span class="label">General Contractor:</span> <span class="field">${generalContractor}</span></p>` : ''}
                <p><span class="label">Project Name:</span> <span class="field">${projectName}</span></p>

                <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e5e7eb;">
            `;

            if (conditionType === 'conditional') {
                // Conditional Waiver Language
                if (paymentType === 'progress') {
                    preview += `
                        <p>Upon receipt of a check from <span class="field">${generalContractor || propertyOwner}</span> in the sum of <span class="field">${formatCurrency(paymentAmount)}</span> payable to <span class="field">${claimantName}</span>${checkNumber ? ` (${checkNumber})` : ''} and when the check has been properly endorsed and has been paid by the bank on which it is drawn:</p>

                        <p>The undersigned, <span class="field">${claimantName}</span>, a <span class="field">${claimantRole}</span>, hereby waives and releases any and all mechanic's lien, stop notice, or bond right claims and rights that the undersigned has on the above-referenced job to the following extent:</p>

                        <p>This waiver and release covers a progress payment for labor, services, equipment, or material furnished to the above-referenced job site through <span class="field">${formatDate(throughDate)}</span> only and does not cover any retention, pending modifications, or items furnished after that date.</p>

                        <p>Before any recipient of this document relies on it, said party should verify evidence of payment to the undersigned.</p>
                    `;
                } else {
                    // Conditional Final
                    preview += `
                        <p>Upon receipt of a check from <span class="field">${generalContractor || propertyOwner}</span> in the sum of <span class="field">${formatCurrency(paymentAmount)}</span> payable to <span class="field">${claimantName}</span>${checkNumber ? ` (${checkNumber})` : ''} and when the check has been properly endorsed and has been paid by the bank on which it is drawn:</p>

                        <p>The undersigned, <span class="field">${claimantName}</span>, a <span class="field">${claimantRole}</span>, hereby waives and releases any and all mechanic's lien, stop notice, or bond right claims and rights that the undersigned has on the above-referenced job.</p>

                        <p>This waiver and release covers the final payment for all labor, services, equipment, or material furnished to the above-referenced job site. Upon receipt of payment, the undersigned will have been paid in full for all work performed on this project.</p>

                        <p>Before any recipient of this document relies on it, said party should verify evidence of payment to the undersigned.</p>
                    `;
                }
            } else {
                // Unconditional Waiver Language
                if (paymentType === 'progress') {
                    preview += `
                        <p>The undersigned, <span class="field">${claimantName}</span>, a <span class="field">${claimantRole}</span>, has been paid and has received a progress payment in the sum of <span class="field">${formatCurrency(paymentAmount)}</span> for labor, services, equipment, or material furnished to the above-referenced property.</p>

                        <p>The undersigned hereby unconditionally waives and releases any and all mechanic's lien, stop notice, or bond right claims and rights that the undersigned has on the above-referenced job to the following extent:</p>

                        <p>This waiver and release covers a progress payment for labor, services, equipment, or material furnished through <span class="field">${formatDate(throughDate)}</span> only and does not cover any retention, pending modifications, or items furnished after that date.</p>
                    `;
                } else {
                    // Unconditional Final
                    preview += `
                        <p>The undersigned, <span class="field">${claimantName}</span>, a <span class="field">${claimantRole}</span>, has been paid in full for all labor, services, equipment, or material furnished to the above-referenced property.</p>

                        <p>The undersigned hereby unconditionally waives and releases any and all mechanic's lien, stop notice, or bond right claims and rights that the undersigned has on the above-referenced job.</p>

                        <p>This waiver and release covers the final payment to the undersigned for all labor, services, equipment, or material furnished on this project. The undersigned has been paid in full.</p>
                    `;
                }
            }

            // Payment summary table
            preview += `
                <table class="amounts-table">
                    <tr>
                        <th colspan="2">Payment Summary</th>
                    </tr>
                    <tr>
                        <td>Total Contract Amount:</td>
                        <td class="amount">${formatCurrency(totalContractAmount)}</td>
                    </tr>
                    <tr>
                        <td>Previous Payments Received:</td>
                        <td class="amount">${formatCurrency(previousPayments)}</td>
                    </tr>
                    <tr>
                        <td>Amount of This ${paymentType === 'final' ? 'Final ' : ''}Payment:</td>
                        <td class="amount">${formatCurrency(paymentAmount)}</td>
                    </tr>
                    ${paymentType === 'progress' ? `
                    <tr>
                        <td><strong>Balance Remaining After This Payment:</strong></td>
                        <td class="amount"><strong>${formatCurrency(balance.toString())}</strong></td>
                    </tr>
                    ` : ''}
                </table>
            `;

            // Work description
            preview += `
                <p><span class="label">Description of Work/Materials:</span></p>
                <p><span class="field">${workDescription}</span></p>
            `;

            // Exceptions
            if (exceptions) {
                preview += `
                    <p><span class="label">Exceptions:</span></p>
                    <p><span class="field">${exceptions}</span></p>
                `;
            }

            // Signature section
            preview += `
                <div class="signature-section">
                    <p class="bold">CLAIMANT:</p>
                    <p><span class="field">${claimantName}</span></p>
                    <p>${claimantAddress}</p>
                    <p>${claimantCityStateZip}</p>

                    <div class="signature-block">
                        <div class="sig-line"></div>
                        <p class="sig-label">Signature</p>
                    </div>

                    <div class="signature-block">
                        <div class="sig-line"></div>
                        <p class="sig-label">Printed Name and Title</p>
                    </div>

                    <div class="signature-block">
                        <div class="sig-line"></div>
                        <p class="sig-label">Date: ${formatDate(waiverDate)}</p>
                    </div>
                </div>
            `;

            // Notary section
            if (includeNotary) {
                preview += `
                    <div class="notary-section">
                        <p class="center bold">ACKNOWLEDGMENT</p>
                        <br>
                        <p>STATE OF <span class="field">${state}</span></p>
                        <p>COUNTY OF _______________________</p>
                        <br>
                        <p>On this _______ day of _________________, 20____, before me, the undersigned notary public, personally appeared _________________________________________, proved to me through satisfactory evidence of identification to be the person whose name is signed on the preceding document, and acknowledged to me that they signed it voluntarily for its stated purpose.</p>
                        <br>
                        <div class="signature-block">
                            <div class="sig-line"></div>
                            <p class="sig-label">Notary Public</p>
                        </div>
                        <p>My Commission Expires: _______________________</p>
                    </div>
                `;
            }

            document.getElementById('preview').innerHTML = preview;
        }

        function downloadDocument() {
            const content = document.getElementById('preview').innerHTML;
            const { conditionType, paymentType } = getWaiverType();

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.5; max-width: 8.5in; margin: 1in auto; padding: 0 0.5in; }
                        h1 { font-size: 16pt; text-align: center; margin-bottom: 0.25in; }
                        h2 { font-size: 12pt; text-align: center; margin-bottom: 0.5in; font-weight: normal; }
                        p { margin-bottom: 12pt; text-align: justify; }
                        .field { font-weight: bold; }
                        .label { font-weight: bold; }
                        .signature-section { margin-top: 0.5in; }
                        .signature-block { margin-top: 0.4in; }
                        .sig-line { border-bottom: 1px solid black; width: 3in; margin-bottom: 4pt; height: 20pt; }
                        .sig-label { font-size: 10pt; color: #666; }
                        .amounts-table { width: 100%; border-collapse: collapse; margin: 0.25in 0; }
                        .amounts-table th, .amounts-table td { padding: 8pt; text-align: left; border-bottom: 1px solid #ccc; }
                        .amounts-table th { background: #f5f5f5; font-weight: bold; }
                        .amounts-table td.amount { text-align: right; }
                        .notary-section { margin-top: 0.5in; padding-top: 0.25in; border-top: 2px solid black; }
                        .center { text-align: center; }
                        .bold { font-weight: bold; }
                        hr { border: none; border-top: 1px solid #ccc; margin: 0.25in 0; }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${conditionType}-${paymentType}-lien-waiver.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetForm() {
            document.getElementById('claimantName').value = '';
            document.getElementById('claimantAddress').value = '';
            document.getElementById('claimantCityStateZip').value = '';
            document.getElementById('claimantRole').value = 'General Contractor';
            document.getElementById('projectName').value = '';
            document.getElementById('propertyAddress').value = '';
            document.getElementById('propertyOwner').value = '';
            document.getElementById('generalContractor').value = '';
            document.getElementById('paymentAmount').value = '';
            document.getElementById('totalContractAmount').value = '';
            document.getElementById('previousPayments').value = '';
            document.getElementById('checkNumber').value = '';
            document.getElementById('workDescription').value = '';
            document.getElementById('exceptions').value = '';
            document.getElementById('includeNotary').checked = false;

            // Reset to conditional/progress
            document.querySelector('input[name="conditionType"][value="conditional"]').checked = true;
            document.querySelector('input[name="paymentType"][value="progress"]').checked = true;
            document.querySelectorAll('.waiver-type-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector('input[name="conditionType"][value="conditional"]').closest('.waiver-type-option').classList.add('selected');
            document.querySelector('input[name="paymentType"][value="progress"]').closest('.waiver-type-option').classList.add('selected');

            // Reset dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('waiverDate').value = today;
            document.getElementById('throughDate').value = today;

            updatePreview();
        }
    </script>
</body>
</html>
