<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-901N2Y3CDZ');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Agreement Generator | Free Legal Template</title>
    <meta name="description" content="Generate a comprehensive loan agreement for business or personal loans. Includes interest rates, repayment schedules, collateral, and default provisions.">
    <link rel="canonical" href="https://terms.law/Templates/loan-agreement-generator.html">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 1rem 2rem; position: sticky; top: 0; z-index: 100; }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-links { display: flex; gap: 2rem; }
        .nav-links a { color: #94a3b8; text-decoration: none; }
        .nav-links a:hover { color: #fff; }
        .main-container { display: grid; grid-template-columns: 420px 1fr; gap: 2rem; max-width: 1600px; margin: 0 auto; padding: 2rem; }
        .form-panel { background: #fff; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); position: sticky; top: 100px; max-height: calc(100vh - 120px); overflow-y: auto; }
        .form-header { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
        .form-header h1 { font-size: 1.25rem; font-weight: 700; }
        .form-header p { font-size: 0.85rem; color: #64748b; }
        .form-section { margin-bottom: 1.5rem; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: #374151; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .section-title::before { content: ''; width: 3px; height: 16px; background: linear-gradient(135deg, #059669, #10b981); border-radius: 2px; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 500; color: #475569; margin-bottom: 0.35rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.6rem 0.75rem; border: 1.5px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #059669; box-shadow: 0 0 0 3px rgba(5,150,105,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
        .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.75rem; }
        .help-text { font-size: 0.75rem; color: #94a3b8; margin-top: 0.25rem; }
        .checkbox-label { display: flex; align-items: flex-start; gap: 0.5rem; font-size: 0.8rem; color: #475569; cursor: pointer; margin-bottom: 0.5rem; }
        .checkbox-label input { margin-top: 0.15rem; }
        .preview-panel { background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: flex; flex-direction: column; }
        .preview-toolbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e2e8f0; background: #f8fafc; border-radius: 16px 16px 0 0; }
        .preview-title { font-weight: 600; color: #374151; }
        .preview-actions { display: flex; gap: 0.75rem; }
        .btn { padding: 0.6rem 1.25rem; border-radius: 8px; font-size: 0.85rem; font-weight: 500; cursor: pointer; border: none; }
        .btn-primary { background: linear-gradient(135deg, #059669, #10b981); color: white; }
        .btn-secondary { background: #fff; color: #374151; border: 1.5px solid #e2e8f0; }
        .preview-content { flex: 1; padding: 2rem; overflow-y: auto; }
        .document { background: white; max-width: 8.5in; margin: 0 auto; padding: 1in; box-shadow: 0 2px 20px rgba(0,0,0,0.08); border: 1px solid #e5e7eb; font-family: 'Times New Roman', serif; font-size: 11pt; line-height: 1.5; color: #000; }
        .document h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; border-bottom: 2px solid #000; padding-bottom: 0.5rem; }
        .document h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; }
        .document p { margin-bottom: 0.75rem; text-align: justify; }
        .document ol { margin-left: 1.5rem; margin-bottom: 0.75rem; }
        .document li { margin-bottom: 0.5rem; }
        .document .parties-box { background: #f9f9f9; padding: 1rem; border: 1px solid #ddd; margin: 1rem 0; }
        .document .highlight-box { background: #ecfdf5; border: 1px solid #059669; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
        .document .warning-box { background: #fef2f2; border: 1px solid #dc2626; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
        .document .signature-block { margin-top: 3rem; }
        .document .signature-party { margin-bottom: 2.5rem; }
        .document .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 9pt; width: 60%; }
        .doc-highlight { background: linear-gradient(135deg, #d1fae5, #a7f3d0); padding: 0 3px; border-radius: 3px; }
        .loan-badge { display: inline-block; background: linear-gradient(135deg, #059669, #10b981); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.7rem; font-weight: 600; margin-left: 0.5rem; }
        @media (max-width: 1200px) { .main-container { grid-template-columns: 1fr; } .form-panel { position: relative; top: 0; max-height: none; } }
        @media print { body * { visibility: hidden; } .document, .document * { visibility: visible; } .document { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: none; } }
        .footer { background: #0f172a; color: #94a3b8; padding: 2rem; text-align: center; font-size: 0.85rem; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" style="text-decoration:none"><span class="logo">Terms.Law</span></a>
            <nav class="nav-links">
                <a href="/Templates/contract-library-landing.html">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <aside class="form-panel">
            <div class="form-header">
                <h1>Loan Agreement <span class="loan-badge">Finance</span></h1>
                <p>Create a legally binding loan agreement with payment terms</p>
            </div>

            <!-- Loan Type -->
            <div class="form-section">
                <div class="section-title">Loan Type</div>
                <div class="form-group">
                    <label for="loanType">Type of Loan</label>
                    <select id="loanType" onchange="toggleLoanFields(); updatePreview()">
                        <option value="personal">Personal Loan</option>
                        <option value="business">Business Loan</option>
                        <option value="secured">Secured Loan (with Collateral)</option>
                        <option value="promissory">Simple Promissory Note</option>
                        <option value="line-of-credit">Line of Credit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="loanPurpose">Loan Purpose</label>
                    <input type="text" id="loanPurpose" placeholder="Working capital, equipment purchase, etc." oninput="updatePreview()">
                </div>
            </div>

            <!-- Lender Information -->
            <div class="form-section">
                <div class="section-title">Lender Information</div>
                <div class="form-group">
                    <label for="lenderName">Lender Name</label>
                    <input type="text" id="lenderName" placeholder="First National Bank or John Smith" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="lenderType">Lender Type</label>
                    <select id="lenderType" onchange="updatePreview()">
                        <option value="Individual">Individual</option>
                        <option value="Corporation">Corporation</option>
                        <option value="LLC">LLC</option>
                        <option value="Bank">Bank/Financial Institution</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="lenderAddress">Lender Address</label>
                    <input type="text" id="lenderAddress" placeholder="123 Main Street, City, State ZIP" oninput="updatePreview()">
                </div>
            </div>

            <!-- Borrower Information -->
            <div class="form-section">
                <div class="section-title">Borrower Information</div>
                <div class="form-group">
                    <label for="borrowerName">Borrower Name</label>
                    <input type="text" id="borrowerName" placeholder="Jane Doe or ABC Company LLC" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="borrowerType">Borrower Type</label>
                    <select id="borrowerType" onchange="updatePreview()">
                        <option value="Individual">Individual</option>
                        <option value="Corporation">Corporation</option>
                        <option value="LLC">LLC</option>
                        <option value="Partnership">Partnership</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="borrowerAddress">Borrower Address</label>
                    <input type="text" id="borrowerAddress" placeholder="456 Oak Avenue, City, State ZIP" oninput="updatePreview()">
                </div>
            </div>

            <!-- Loan Terms -->
            <div class="form-section">
                <div class="section-title">Loan Terms</div>
                <div class="form-group">
                    <label for="principalAmount">Principal Amount ($)</label>
                    <input type="text" id="principalAmount" placeholder="50,000" oninput="updatePreview()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="interestRate">Interest Rate (%)</label>
                        <input type="text" id="interestRate" placeholder="8.5" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="interestType">Interest Type</label>
                        <select id="interestType" onchange="updatePreview()">
                            <option value="simple">Simple Interest</option>
                            <option value="compound-monthly">Compound (Monthly)</option>
                            <option value="compound-daily">Compound (Daily)</option>
                            <option value="fixed">Fixed APR</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="loanTerm">Loan Term</label>
                        <input type="text" id="loanTerm" placeholder="36" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="termUnit">Term Unit</label>
                        <select id="termUnit" onchange="updatePreview()">
                            <option value="months">Months</option>
                            <option value="years">Years</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="disbursementDate">Disbursement Date</label>
                    <input type="date" id="disbursementDate" onchange="updatePreview()">
                </div>
            </div>

            <!-- Repayment -->
            <div class="form-section">
                <div class="section-title">Repayment Schedule</div>
                <div class="form-group">
                    <label for="repaymentType">Repayment Type</label>
                    <select id="repaymentType" onchange="toggleRepaymentFields(); updatePreview()">
                        <option value="monthly">Monthly Installments</option>
                        <option value="weekly">Weekly Payments</option>
                        <option value="bi-weekly">Bi-Weekly Payments</option>
                        <option value="quarterly">Quarterly Payments</option>
                        <option value="balloon">Balloon Payment (Interest Only + Lump Sum)</option>
                        <option value="lump-sum">Single Lump Sum at Maturity</option>
                    </select>
                </div>
                <div id="installmentFields">
                    <div class="form-group">
                        <label for="paymentAmount">Payment Amount ($)</label>
                        <input type="text" id="paymentAmount" placeholder="1,500" oninput="updatePreview()">
                        <p class="help-text">Monthly principal + interest payment</p>
                    </div>
                    <div class="form-group">
                        <label for="paymentDueDay">Payment Due Day</label>
                        <select id="paymentDueDay" onchange="updatePreview()">
                            <option value="1">1st of each month</option>
                            <option value="15">15th of each month</option>
                            <option value="last">Last day of each month</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="firstPaymentDate">First Payment Date</label>
                    <input type="date" id="firstPaymentDate" onchange="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="maturityDate">Maturity Date</label>
                    <input type="date" id="maturityDate" onchange="updatePreview()">
                </div>
            </div>

            <!-- Default & Fees -->
            <div class="form-section">
                <div class="section-title">Default & Fees</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lateFee">Late Fee ($)</label>
                        <input type="text" id="lateFee" placeholder="50" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label for="gracePeriod">Grace Period (days)</label>
                        <input type="text" id="gracePeriod" placeholder="10" oninput="updatePreview()">
                    </div>
                </div>
                <div class="form-group">
                    <label for="defaultRate">Default Interest Rate (%)</label>
                    <input type="text" id="defaultRate" placeholder="18" oninput="updatePreview()">
                    <p class="help-text">Higher rate applied after default</p>
                </div>
                <div class="form-group">
                    <label for="prepaymentPenalty">Prepayment Penalty</label>
                    <select id="prepaymentPenalty" onchange="updatePreview()">
                        <option value="none">No Prepayment Penalty</option>
                        <option value="1-year">1% if prepaid within 1 year</option>
                        <option value="2-year">2% if prepaid within 2 years</option>
                        <option value="3-month-interest">3 months interest</option>
                    </select>
                </div>
            </div>

            <!-- Collateral (for secured loans) -->
            <div class="form-section" id="collateralSection" style="display:none;">
                <div class="section-title">Collateral (Security)</div>
                <div class="form-group">
                    <label for="collateralType">Collateral Type</label>
                    <select id="collateralType" onchange="updatePreview()">
                        <option value="real-estate">Real Estate/Property</option>
                        <option value="vehicle">Vehicle</option>
                        <option value="equipment">Equipment/Machinery</option>
                        <option value="inventory">Inventory</option>
                        <option value="accounts">Accounts Receivable</option>
                        <option value="securities">Securities/Investments</option>
                        <option value="other">Other Assets</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="collateralDescription">Collateral Description</label>
                    <textarea id="collateralDescription" rows="3" placeholder="Detailed description of collateral including serial numbers, addresses, or identification..." oninput="updatePreview()"></textarea>
                </div>
                <div class="form-group">
                    <label for="collateralValue">Estimated Collateral Value ($)</label>
                    <input type="text" id="collateralValue" placeholder="75,000" oninput="updatePreview()">
                </div>
            </div>

            <!-- Additional Terms -->
            <div class="form-section">
                <div class="section-title">Additional Terms</div>
                <label class="checkbox-label">
                    <input type="checkbox" id="personalGuarantee" onchange="updatePreview()">
                    Personal Guarantee Required
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="accelerationClause" checked onchange="updatePreview()">
                    Acceleration Clause (full balance due on default)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="crossDefault" onchange="updatePreview()">
                    Cross-Default Provision
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="financialCovenants" onchange="updatePreview()">
                    Financial Reporting Covenants
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="insuranceRequired" onchange="updatePreview()">
                    Insurance Required on Collateral
                </label>
            </div>

            <!-- Guarantor -->
            <div class="form-section" id="guarantorSection" style="display:none;">
                <div class="section-title">Personal Guarantor</div>
                <div class="form-group">
                    <label for="guarantorName">Guarantor Name</label>
                    <input type="text" id="guarantorName" placeholder="Full legal name" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="guarantorAddress">Guarantor Address</label>
                    <input type="text" id="guarantorAddress" placeholder="Address" oninput="updatePreview()">
                </div>
            </div>

            <!-- Governing Law -->
            <div class="form-section">
                <div class="section-title">Governing Law</div>
                <div class="form-group">
                    <label for="governingState">Governing State</label>
                    <select id="governingState" onchange="updatePreview()">
                        <option value="">Select State...</option>
                        <option value="Alabama">Alabama</option><option value="Alaska">Alaska</option><option value="Arizona">Arizona</option><option value="Arkansas">Arkansas</option><option value="California">California</option><option value="Colorado">Colorado</option><option value="Connecticut">Connecticut</option><option value="Delaware">Delaware</option><option value="Florida">Florida</option><option value="Georgia">Georgia</option><option value="Hawaii">Hawaii</option><option value="Idaho">Idaho</option><option value="Illinois">Illinois</option><option value="Indiana">Indiana</option><option value="Iowa">Iowa</option><option value="Kansas">Kansas</option><option value="Kentucky">Kentucky</option><option value="Louisiana">Louisiana</option><option value="Maine">Maine</option><option value="Maryland">Maryland</option><option value="Massachusetts">Massachusetts</option><option value="Michigan">Michigan</option><option value="Minnesota">Minnesota</option><option value="Mississippi">Mississippi</option><option value="Missouri">Missouri</option><option value="Montana">Montana</option><option value="Nebraska">Nebraska</option><option value="Nevada">Nevada</option><option value="New Hampshire">New Hampshire</option><option value="New Jersey">New Jersey</option><option value="New Mexico">New Mexico</option><option value="New York">New York</option><option value="North Carolina">North Carolina</option><option value="North Dakota">North Dakota</option><option value="Ohio">Ohio</option><option value="Oklahoma">Oklahoma</option><option value="Oregon">Oregon</option><option value="Pennsylvania">Pennsylvania</option><option value="Rhode Island">Rhode Island</option><option value="South Carolina">South Carolina</option><option value="South Dakota">South Dakota</option><option value="Tennessee">Tennessee</option><option value="Texas">Texas</option><option value="Utah">Utah</option><option value="Vermont">Vermont</option><option value="Virginia">Virginia</option><option value="Washington">Washington</option><option value="West Virginia">West Virginia</option><option value="Wisconsin">Wisconsin</option><option value="Wyoming">Wyoming</option>
                    </select>
                </div>
            </div>
        </aside>

        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">Live Preview</span>
                <div class="preview-actions">
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                    <button class="btn btn-primary" onclick="downloadWord()">Download Word</button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; Terms.Law. Free legal document templates for everyone.</p>
    </footer>

    <script>
        function toggleLoanFields() {
            const loanType = document.getElementById('loanType').value;
            document.getElementById('collateralSection').style.display =
                (loanType === 'secured') ? 'block' : 'none';
        }

        function toggleRepaymentFields() {
            const repaymentType = document.getElementById('repaymentType').value;
            document.getElementById('installmentFields').style.display =
                (repaymentType === 'lump-sum') ? 'none' : 'block';
        }

        document.getElementById('personalGuarantee').addEventListener('change', function() {
            document.getElementById('guarantorSection').style.display =
                this.checked ? 'block' : 'none';
            updatePreview();
        });

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function formatCurrency(amount) {
            if (!amount) return '$[AMOUNT]';
            const num = parseFloat(amount.replace(/,/g, ''));
            if (isNaN(num)) return '$' + amount;
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function updatePreview() {
            const loanType = document.getElementById('loanType').value;
            const loanPurpose = document.getElementById('loanPurpose').value || '[LOAN PURPOSE]';
            const lenderName = document.getElementById('lenderName').value || '[LENDER NAME]';
            const lenderType = document.getElementById('lenderType').value;
            const lenderAddress = document.getElementById('lenderAddress').value || '[LENDER ADDRESS]';
            const borrowerName = document.getElementById('borrowerName').value || '[BORROWER NAME]';
            const borrowerType = document.getElementById('borrowerType').value;
            const borrowerAddress = document.getElementById('borrowerAddress').value || '[BORROWER ADDRESS]';
            const principalAmount = document.getElementById('principalAmount').value || '0';
            const interestRate = document.getElementById('interestRate').value || '[RATE]';
            const interestType = document.getElementById('interestType').value;
            const loanTerm = document.getElementById('loanTerm').value || '[TERM]';
            const termUnit = document.getElementById('termUnit').value;
            const disbursementDate = formatDate(document.getElementById('disbursementDate').value);
            const repaymentType = document.getElementById('repaymentType').value;
            const paymentAmount = document.getElementById('paymentAmount').value || '0';
            const paymentDueDay = document.getElementById('paymentDueDay').value;
            const firstPaymentDate = formatDate(document.getElementById('firstPaymentDate').value);
            const maturityDate = formatDate(document.getElementById('maturityDate').value);
            const lateFee = document.getElementById('lateFee').value || '50';
            const gracePeriod = document.getElementById('gracePeriod').value || '10';
            const defaultRate = document.getElementById('defaultRate').value || '18';
            const prepaymentPenalty = document.getElementById('prepaymentPenalty').value;
            const governingState = document.getElementById('governingState').value || '[STATE]';

            const hasAcceleration = document.getElementById('accelerationClause').checked;
            const hasCrossDefault = document.getElementById('crossDefault').checked;
            const hasCovenants = document.getElementById('financialCovenants').checked;
            const hasInsurance = document.getElementById('insuranceRequired').checked;
            const hasGuarantee = document.getElementById('personalGuarantee').checked;

            const loanTypeNames = {
                'personal': 'Personal Loan Agreement',
                'business': 'Business Loan Agreement',
                'secured': 'Secured Loan Agreement',
                'promissory': 'Promissory Note',
                'line-of-credit': 'Line of Credit Agreement'
            };

            const interestTypeNames = {
                'simple': 'simple interest',
                'compound-monthly': 'compound interest (compounded monthly)',
                'compound-daily': 'compound interest (compounded daily)',
                'fixed': 'fixed APR'
            };

            const repaymentDescriptions = {
                'monthly': 'equal monthly installments',
                'weekly': 'weekly payments',
                'bi-weekly': 'bi-weekly payments',
                'quarterly': 'quarterly payments',
                'balloon': 'interest-only payments with a balloon payment at maturity',
                'lump-sum': 'a single lump sum payment at maturity'
            };

            const paymentDayText = {
                '1': 'the 1st day of each month',
                '15': 'the 15th day of each month',
                'last': 'the last day of each month'
            };

            let collateralSection = '';
            if (loanType === 'secured') {
                const collateralType = document.getElementById('collateralType').value;
                const collateralDescription = document.getElementById('collateralDescription').value || '[COLLATERAL DESCRIPTION]';
                const collateralValue = document.getElementById('collateralValue').value || '0';
                collateralSection = `
                    <h2>5. COLLATERAL AND SECURITY INTEREST</h2>
                    <p><strong>5.1 Grant of Security Interest.</strong> As security for the payment and performance of all Obligations under this Agreement, Borrower hereby grants to Lender a continuing security interest in and to the following collateral (the "Collateral"):</p>
                    <div class="highlight-box">
                        <strong>Collateral Description:</strong><br>
                        ${collateralDescription}<br><br>
                        <strong>Estimated Value:</strong> ${formatCurrency(collateralValue)}
                    </div>
                    <p><strong>5.2 Perfection.</strong> Borrower authorizes Lender to file all financing statements and other documents necessary to perfect and maintain Lender's security interest in the Collateral. Borrower shall execute all documents and take all actions reasonably requested by Lender to perfect, protect, and maintain such security interest.</p>
                    <p><strong>5.3 Collateral Covenants.</strong> Borrower shall: (a) maintain the Collateral in good condition and repair; (b) not sell, transfer, or encumber the Collateral without Lender's prior written consent; (c) keep the Collateral free from liens; and (d) immediately notify Lender of any damage to or loss of the Collateral.</p>
                    ${hasInsurance ? `<p><strong>5.4 Insurance.</strong> Borrower shall maintain comprehensive insurance coverage on the Collateral in an amount not less than the outstanding principal balance, naming Lender as loss payee. Evidence of such insurance shall be provided to Lender upon request.</p>` : ''}
                `;
            }

            let guaranteeSection = '';
            if (hasGuarantee) {
                const guarantorName = document.getElementById('guarantorName').value || '[GUARANTOR NAME]';
                const guarantorAddress = document.getElementById('guarantorAddress').value || '[GUARANTOR ADDRESS]';
                guaranteeSection = `
                    <h2>${loanType === 'secured' ? '6' : '5'}. PERSONAL GUARANTEE</h2>
                    <p>The undersigned guarantor ("Guarantor") absolutely and unconditionally guarantees to Lender the full and prompt payment and performance of all obligations of Borrower under this Agreement.</p>
                    <div class="parties-box">
                        <strong>GUARANTOR:</strong><br>
                        ${guarantorName}<br>
                        ${guarantorAddress}
                    </div>
                    <p>This guarantee is a continuing guarantee and shall remain in full force and effect until all Obligations are paid in full. Guarantor waives any right to require Lender to proceed against Borrower or the Collateral before enforcing this guarantee.</p>
                `;
            }

            let prepaymentText = '';
            switch(prepaymentPenalty) {
                case 'none':
                    prepaymentText = 'Borrower may prepay the Loan in whole or in part at any time without penalty.';
                    break;
                case '1-year':
                    prepaymentText = 'If Borrower prepays the Loan within twelve (12) months of the Disbursement Date, a prepayment penalty equal to one percent (1%) of the prepaid amount shall be due.';
                    break;
                case '2-year':
                    prepaymentText = 'If Borrower prepays the Loan within twenty-four (24) months of the Disbursement Date, a prepayment penalty equal to two percent (2%) of the prepaid amount shall be due.';
                    break;
                case '3-month-interest':
                    prepaymentText = 'If Borrower prepays the Loan, a prepayment penalty equal to three (3) months of interest on the prepaid amount shall be due.';
                    break;
            }

            const sectionOffset = loanType === 'secured' ? 1 : 0;
            const guaranteeOffset = hasGuarantee ? 1 : 0;

            let html = `
                <h1>${loanTypeNames[loanType]}</h1>

                <p>This ${loanTypeNames[loanType]} (this "Agreement") is entered into as of <span class="doc-highlight">${disbursementDate}</span>, by and between:</p>

                <div class="parties-box">
                    <strong>LENDER:</strong><br>
                    ${lenderName}${lenderType !== 'Individual' ? `, a ${lenderType}` : ''}<br>
                    ${lenderAddress}<br><br>

                    <strong>BORROWER:</strong><br>
                    ${borrowerName}${borrowerType !== 'Individual' ? `, a ${borrowerType}` : ''}<br>
                    ${borrowerAddress}
                </div>

                <p>For good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>

                <h2>1. LOAN AMOUNT AND DISBURSEMENT</h2>
                <p><strong>1.1 Principal Amount.</strong> Subject to the terms and conditions of this Agreement, Lender agrees to lend to Borrower, and Borrower agrees to borrow from Lender, the principal sum of <span class="doc-highlight">${formatCurrency(principalAmount)}</span> (the "Principal" or "Loan").</p>
                <p><strong>1.2 Purpose.</strong> The Loan proceeds shall be used for the following purpose: <span class="doc-highlight">${loanPurpose}</span>.</p>
                <p><strong>1.3 Disbursement.</strong> The Loan shall be disbursed on or before ${disbursementDate} by wire transfer, check, or other method agreed upon by the parties.</p>

                <h2>2. INTEREST</h2>
                <p><strong>2.1 Interest Rate.</strong> The Loan shall bear interest at the rate of <span class="doc-highlight">${interestRate}%</span> per annum, calculated as ${interestTypeNames[interestType]}, on the outstanding principal balance.</p>
                <p><strong>2.2 Default Interest Rate.</strong> Upon the occurrence and during the continuance of an Event of Default, the interest rate shall automatically increase to <span class="doc-highlight">${defaultRate}%</span> per annum (the "Default Rate").</p>
                <p><strong>2.3 Interest Calculation.</strong> Interest shall be calculated on the basis of a 365-day year and actual days elapsed.</p>

                <h2>3. REPAYMENT TERMS</h2>
                <p><strong>3.1 Repayment Schedule.</strong> Borrower shall repay the Loan in ${repaymentDescriptions[repaymentType]}${repaymentType !== 'lump-sum' && repaymentType !== 'balloon' ? ` of <span class="doc-highlight">${formatCurrency(paymentAmount)}</span> each, due on ${paymentDayText[paymentDueDay]}` : ''}.</p>
                <p><strong>3.2 First Payment.</strong> The first payment shall be due on <span class="doc-highlight">${firstPaymentDate}</span>.</p>
                <p><strong>3.3 Maturity Date.</strong> The entire outstanding principal balance, together with all accrued and unpaid interest and any other amounts owing hereunder, shall be due and payable in full on <span class="doc-highlight">${maturityDate}</span> (the "Maturity Date").</p>
                <p><strong>3.4 Application of Payments.</strong> All payments shall be applied first to any fees and costs, then to accrued interest, and finally to principal.</p>
                <p><strong>3.5 Prepayment.</strong> ${prepaymentText}</p>

                <h2>4. LATE PAYMENT AND DEFAULT</h2>
                <p><strong>4.1 Grace Period.</strong> Borrower shall have a grace period of <span class="doc-highlight">${gracePeriod}</span> days after each payment due date before a late fee is assessed.</p>
                <p><strong>4.2 Late Fee.</strong> If any payment is not received within the grace period, Borrower shall pay a late fee of <span class="doc-highlight">${formatCurrency(lateFee)}</span> for each late payment.</p>
                <p><strong>4.3 Events of Default.</strong> The following shall constitute Events of Default under this Agreement:</p>
                <ol type="a">
                    <li>Failure to make any payment when due;</li>
                    <li>Breach of any representation, warranty, or covenant in this Agreement;</li>
                    <li>Bankruptcy, insolvency, or assignment for benefit of creditors by Borrower;</li>
                    ${loanType === 'secured' ? '<li>Loss, theft, damage, or destruction of the Collateral;</li>' : ''}
                    ${hasCrossDefault ? '<li>Default under any other agreement with Lender or any third party;</li>' : ''}
                    <li>Material adverse change in Borrower's financial condition.</li>
                </ol>
                ${hasAcceleration ? `<p><strong>4.4 Acceleration.</strong> Upon the occurrence of any Event of Default, Lender may, at its option, declare all outstanding amounts immediately due and payable without notice or demand.</p>` : ''}

                ${collateralSection}

                ${guaranteeSection}

                <h2>${5 + sectionOffset + guaranteeOffset}. REPRESENTATIONS AND WARRANTIES</h2>
                <p>Borrower represents and warrants to Lender that:</p>
                <ol type="a">
                    <li>Borrower has full power and authority to execute this Agreement and perform its obligations hereunder;</li>
                    <li>This Agreement constitutes a valid and binding obligation of Borrower;</li>
                    <li>The execution of this Agreement does not violate any law or agreement to which Borrower is bound;</li>
                    <li>All financial information provided to Lender is true, complete, and accurate;</li>
                    <li>There is no litigation pending or threatened that could materially affect Borrower's ability to perform.</li>
                </ol>

                ${hasCovenants ? `
                <h2>${6 + sectionOffset + guaranteeOffset}. FINANCIAL COVENANTS</h2>
                <p>During the term of this Loan, Borrower shall:</p>
                <ol type="a">
                    <li>Provide annual financial statements within 90 days of fiscal year end;</li>
                    <li>Notify Lender immediately of any material adverse change in financial condition;</li>
                    <li>Maintain books and records in accordance with generally accepted accounting principles;</li>
                    <li>Permit Lender reasonable access to inspect books, records, and properties.</li>
                </ol>
                ` : ''}

                <h2>${hasCovenants ? 7 : 6 + sectionOffset + guaranteeOffset}. GENERAL PROVISIONS</h2>
                <p><strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight">${governingState}</span>.</p>
                <p><strong>Notices.</strong> All notices shall be in writing and delivered to the addresses set forth above, or such other address as either party may designate in writing.</p>
                <p><strong>Amendments.</strong> This Agreement may not be amended or modified except by a written instrument signed by both parties.</p>
                <p><strong>Waiver.</strong> No waiver of any provision shall be deemed a continuing waiver or a waiver of any other provision.</p>
                <p><strong>Severability.</strong> If any provision is held invalid or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                <p><strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties concerning the subject matter hereof and supersedes all prior agreements and understandings.</p>
                <p><strong>Attorneys' Fees.</strong> In the event of any litigation arising out of this Agreement, the prevailing party shall be entitled to recover reasonable attorneys' fees and costs.</p>

                <div class="signature-block">
                    <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Agreement as of the date first written above.</p>

                    <div class="signature-party">
                        <strong>LENDER:</strong>
                        <div class="signature-line">
                            Signature<br><br>
                            Name: ${lenderName}<br>
                            Title: ___________________________<br>
                            Date: ___________________________
                        </div>
                    </div>

                    <div class="signature-party">
                        <strong>BORROWER:</strong>
                        <div class="signature-line">
                            Signature<br><br>
                            Name: ${borrowerName}<br>
                            Title: ___________________________<br>
                            Date: ___________________________
                        </div>
                    </div>

                    ${hasGuarantee ? `
                    <div class="signature-party">
                        <strong>GUARANTOR:</strong>
                        <div class="signature-line">
                            Signature<br><br>
                            Name: ${document.getElementById('guarantorName').value || '[GUARANTOR NAME]'}<br>
                            Date: ___________________________
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = html;
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const blob = new Blob([`
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset="utf-8"><title>Loan Agreement</title>
                <style>
                    body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; }
                    h1 { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; border-bottom: 2px solid #000; padding-bottom: 0.5rem; }
                    h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; }
                    p { margin-bottom: 0.75rem; text-align: justify; }
                    .parties-box { background: #f9f9f9; padding: 1rem; border: 1px solid #ddd; margin: 1rem 0; }
                    .highlight-box { background: #f0fff4; border: 1px solid #059669; padding: 1rem; margin: 1rem 0; }
                    .doc-highlight { background: #d1fae5; padding: 0 3px; }
                    .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; width: 60%; }
                </style>
                </head><body>${content}</body></html>
            `], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Loan_Agreement.doc';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        updatePreview();
    </script>
</body>
</html>
