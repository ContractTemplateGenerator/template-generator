<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIIA Generator | Proprietary Information & Inventions Agreement</title>
    <meta name="description" content="Generate a Proprietary Information and Inventions Assignment Agreement (PIIA). Protect your company's IP, trade secrets, and ensure employee inventions are assigned.">
    <link rel="canonical" href="https://terms.law/Templates/piia-generator.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 1rem 2rem; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo-link { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; }
        .logo { font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .nav-links { display: flex; gap: 2rem; align-items: center; }
        .nav-links a { color: #94a3b8; text-decoration: none; font-size: 0.95rem; transition: color 0.2s; }
        .nav-links a:hover { color: #ffffff; }
        .main-container { display: grid; grid-template-columns: 420px 1fr; gap: 2rem; max-width: 1600px; margin: 0 auto; padding: 2rem; min-height: calc(100vh - 80px); }
        .form-panel { background: #ffffff; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); height: fit-content; position: sticky; top: 100px; max-height: calc(100vh - 120px); overflow-y: auto; }
        .form-header { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #e2e8f0; }
        .form-header h1 { font-size: 1.25rem; font-weight: 700; color: #0f172a; margin-bottom: 0.25rem; }
        .form-header p { font-size: 0.85rem; color: #64748b; }
        .form-section { margin-bottom: 1.5rem; }
        .section-title { font-size: 0.9rem; font-weight: 600; color: #374151; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .section-title::before { content: ''; width: 3px; height: 16px; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); border-radius: 2px; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 500; color: #475569; margin-bottom: 0.35rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.6rem 0.75rem; border: 1.5px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; transition: all 0.2s; font-family: inherit; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .checkbox-label { display: flex; align-items: center; gap: 0.4rem; font-size: 0.8rem; color: #475569; cursor: pointer; padding: 0.4rem 0.6rem; border: 1px solid #e2e8f0; border-radius: 6px; transition: all 0.2s; }
        .checkbox-label:hover { background: #f1f5f9; }
        .checkbox-label input { width: 14px; height: 14px; cursor: pointer; }
        .checkbox-label input:checked + span { color: #3b82f6; font-weight: 500; }
        .info-box { background: #dbeafe; border: 1px solid #3b82f6; border-radius: 8px; padding: 0.75rem; font-size: 0.8rem; color: #1e40af; margin-bottom: 1rem; }
        .warning-box { background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 0.75rem; font-size: 0.8rem; color: #92400e; margin-bottom: 1rem; }
        .preview-panel { background: #ffffff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: flex; flex-direction: column; }
        .preview-toolbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e2e8f0; background: #f8fafc; border-radius: 16px 16px 0 0; }
        .preview-title { font-weight: 600; color: #374151; display: flex; align-items: center; gap: 0.5rem; }
        .preview-actions { display: flex; gap: 0.75rem; }
        .btn { padding: 0.6rem 1.25rem; border-radius: 8px; font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; display: flex; align-items: center; gap: 0.5rem; }
        .btn-primary { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59,130,246,0.35); }
        .btn-secondary { background: #ffffff; color: #374151; border: 1.5px solid #e2e8f0; }
        .btn-secondary:hover { background: #f1f5f9; border-color: #cbd5e1; }
        .preview-content { padding: 3rem; overflow-y: auto; flex: 1; }
        .document { max-width: 850px; margin: 0 auto; background: #fff; padding: 4rem; min-height: 1100px; box-shadow: 0 2px 20px rgba(0,0,0,0.08); border: 1px solid #e5e7eb; font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; color: #000; }
        .document h1 { text-align: center; font-size: 16pt; font-weight: bold; margin-bottom: 1.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .document h2 { font-size: 12pt; font-weight: bold; margin-top: 1.5rem; margin-bottom: 0.75rem; text-transform: uppercase; }
        .document p { margin-bottom: 1rem; text-align: justify; }
        .document .center { text-align: center; }
        .document .parties { margin: 1.5rem 0; }
        .document .parties p { margin-bottom: 0.5rem; }
        .document .effective-date { text-align: center; margin-bottom: 2rem; font-style: italic; }
        .document .clause { margin-bottom: 1.25rem; }
        .document .sub-clause { margin-left: 2rem; margin-bottom: 0.75rem; }
        .document .signature-block { margin-top: 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; }
        .document .signature-party h3 { font-size: 11pt; font-weight: bold; margin-bottom: 2rem; text-transform: uppercase; }
        .document .signature-line { border-top: 1px solid #000; margin-top: 2.5rem; padding-top: 0.35rem; font-size: 10pt; }
        .document .exhibit { margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #000; }
        .document .exhibit h3 { text-align: center; font-size: 14pt; margin-bottom: 1rem; }
        .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 0 3px; border-radius: 3px; transition: all 0.3s ease; }
        .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
        @media (max-width: 1200px) { .main-container { grid-template-columns: 1fr; } .form-panel { position: relative; top: 0; max-height: none; } }
        @media (max-width: 768px) { .main-container { padding: 1rem; } .document { padding: 2rem; } .preview-content { padding: 1rem; } .nav-links { display: none; } }
        @media print { body * { visibility: hidden; } .document, .document * { visibility: visible; } .document { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: none; padding: 1in; } .header, .form-panel, .preview-toolbar { display: none !important; } }
        .footer { background: #0f172a; color: #94a3b8; padding: 2rem; text-align: center; font-size: 0.85rem; }
        .footer a { color: #60a5fa; text-decoration: none; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo-link">
                <span class="logo">Terms.Law</span>
            </a>
            <nav class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <aside class="form-panel">
            <div class="form-header">
                <h1>PIIA Generator</h1>
                <p>Proprietary Information & Inventions Assignment Agreement</p>
            </div>

            <div class="info-box">
                <strong>Essential for Tech Companies</strong><br>
                A PIIA protects your trade secrets and ensures employees assign all work-related inventions to the company. Required by most investors.
            </div>

            <!-- Company Information -->
            <div class="form-section">
                <div class="section-title">Company Information</div>
                <div class="form-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" id="companyName" placeholder="Acme Technologies, Inc." oninput="updatePreview()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="companyState">State of Incorporation</label>
                        <select id="companyState" onchange="updatePreview()">
                            <option value="">Select State</option>
                            <option value="Delaware">Delaware</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Texas">Texas</option>
                            <option value="Florida">Florida</option>
                            <option value="Washington">Washington</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Nevada">Nevada</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" onchange="updatePreview()">
                    </div>
                </div>
                <div class="form-group">
                    <label for="companyAddress">Company Address</label>
                    <input type="text" id="companyAddress" placeholder="123 Tech Park Drive, San Francisco, CA 94105" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="businessType">Primary Business</label>
                    <select id="businessType" onchange="updatePreview()">
                        <option value="software">Software Development</option>
                        <option value="saas">SaaS / Cloud Services</option>
                        <option value="hardware">Hardware / Electronics</option>
                        <option value="biotech">Biotechnology / Pharma</option>
                        <option value="fintech">Financial Technology</option>
                        <option value="ai">AI / Machine Learning</option>
                        <option value="consulting">Technology Consulting</option>
                        <option value="other">Other Technology</option>
                    </select>
                </div>
            </div>

            <!-- Employee Information -->
            <div class="form-section">
                <div class="section-title">Employee Information</div>
                <div class="form-group">
                    <label for="employeeName">Employee Name</label>
                    <input type="text" id="employeeName" placeholder="Jane Developer" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="employeeAddress">Employee Address</label>
                    <input type="text" id="employeeAddress" placeholder="456 Main Street, Apt 7, San Francisco, CA 94102" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="jobTitle">Position/Title</label>
                    <input type="text" id="jobTitle" placeholder="Senior Software Engineer" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label for="startDate">Employment Start Date</label>
                    <input type="date" id="startDate" onchange="updatePreview()">
                </div>
            </div>

            <!-- Confidentiality Scope -->
            <div class="form-section">
                <div class="section-title">Confidential Information</div>
                <div class="form-group">
                    <label>Types of Confidential Information</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciSourceCode" onchange="updatePreview()" checked>
                            <span>Source Code</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciAlgorithms" onchange="updatePreview()" checked>
                            <span>Algorithms</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciCustomerData" onchange="updatePreview()" checked>
                            <span>Customer Data</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciBusinessPlans" onchange="updatePreview()" checked>
                            <span>Business Plans</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciFinancials" onchange="updatePreview()" checked>
                            <span>Financial Info</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ciMarketing" onchange="updatePreview()">
                            <span>Marketing Strategy</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="confidentialityPeriod">Post-Employment Confidentiality</label>
                    <select id="confidentialityPeriod" onchange="updatePreview()">
                        <option value="indefinite" selected>Indefinite (Trade Secrets)</option>
                        <option value="5 years">5 Years</option>
                        <option value="3 years">3 Years</option>
                        <option value="2 years">2 Years</option>
                    </select>
                </div>
            </div>

            <!-- Invention Assignment -->
            <div class="form-section">
                <div class="section-title">Invention Assignment</div>
                <div class="form-group">
                    <label for="inventionScope">Scope of Assigned Inventions</label>
                    <select id="inventionScope" onchange="updatePreview()">
                        <option value="related" selected>Related to Company Business (Standard)</option>
                        <option value="all-work">All Work During Employment</option>
                        <option value="broad">Broad (Related to Current or Future Business)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Covered IP Types</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="ipPatents" onchange="updatePreview()" checked>
                            <span>Patents</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ipCopyrights" onchange="updatePreview()" checked>
                            <span>Copyrights</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ipTrademarks" onchange="updatePreview()" checked>
                            <span>Trademarks</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ipTradeSecrets" onchange="updatePreview()" checked>
                            <span>Trade Secrets</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label" style="border: none; padding: 0;">
                        <input type="checkbox" id="priorInventions" onchange="togglePriorInventions(); updatePreview()">
                        <span>Employee has prior inventions to exclude</span>
                    </label>
                </div>
                <div class="form-group" id="priorInventionsSection" style="display: none;">
                    <label for="priorInventionsList">List Prior Inventions (Exhibit A)</label>
                    <textarea id="priorInventionsList" rows="3" placeholder="1. [Invention Name] - [Brief Description] - [Date]&#10;2. [Invention Name] - [Brief Description] - [Date]" oninput="updatePreview()"></textarea>
                </div>
            </div>

            <!-- State-Specific Provisions -->
            <div class="form-section">
                <div class="section-title">Additional Provisions</div>
                <div class="warning-box" id="californiaWarning" style="display: none;">
                    <strong>California Notice Required</strong><br>
                    California Labor Code §2870 limits assignment of inventions made on employee's own time without company resources.
                </div>
                <div class="form-group">
                    <label>Include These Sections</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeNonSolicitation" onchange="updatePreview()">
                            <span>Non-Solicitation</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeNonCompete" onchange="updatePreview()">
                            <span>Non-Compete</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeReturnProperty" onchange="updatePreview()" checked>
                            <span>Return of Property</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="includeExitInterview" onchange="updatePreview()" checked>
                            <span>Exit Interview</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="disputeResolution">Dispute Resolution</label>
                    <select id="disputeResolution" onchange="updatePreview()">
                        <option value="litigation" selected>Litigation (Court)</option>
                        <option value="arbitration">Binding Arbitration</option>
                    </select>
                </div>
            </div>
        </aside>

        <section class="preview-panel">
            <div class="preview-toolbar">
                <span class="preview-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Live Preview
                </span>
                <div class="preview-actions">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 9V2h12v7"></path>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadWord()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>
            <div class="preview-content">
                <div class="document" id="documentPreview"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; Terms.Law. For informational purposes only. Not legal advice. <a href="/Terms/terms-of-service.html">Terms</a> | <a href="/Terms/privacy-policy.html">Privacy</a></p>
    </footer>

    <script>
        function togglePriorInventions() {
            const section = document.getElementById('priorInventionsSection');
            const checked = document.getElementById('priorInventions').checked;
            section.style.display = checked ? 'block' : 'none';
        }

        function getValue(id, defaultVal = '') {
            const el = document.getElementById(id);
            if (!el) return defaultVal;
            if (el.type === 'checkbox') return el.checked;
            return el.value || defaultVal;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '[DATE]';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        // Show California warning when California is selected
        document.getElementById('companyState').addEventListener('change', function() {
            const warning = document.getElementById('californiaWarning');
            warning.style.display = this.value === 'California' ? 'block' : 'none';
        });

        function updatePreview() {
            const companyName = getValue('companyName', '[COMPANY NAME]');
            const companyState = getValue('companyState', '[STATE]');
            const companyAddress = getValue('companyAddress', '[COMPANY ADDRESS]');
            const effectiveDate = formatDate(getValue('effectiveDate'));
            const businessType = getValue('businessType', 'software');
            const employeeName = getValue('employeeName', '[EMPLOYEE NAME]');
            const employeeAddress = getValue('employeeAddress', '[EMPLOYEE ADDRESS]');
            const jobTitle = getValue('jobTitle', '[POSITION]');
            const startDate = formatDate(getValue('startDate'));
            const confidentialityPeriod = getValue('confidentialityPeriod', 'indefinite');
            const inventionScope = getValue('inventionScope', 'related');
            const disputeResolution = getValue('disputeResolution', 'litigation');

            // Build confidential information types
            let ciTypes = [];
            if (getValue('ciSourceCode')) ciTypes.push('source code, object code, and software documentation');
            if (getValue('ciAlgorithms')) ciTypes.push('algorithms, data structures, and technical specifications');
            if (getValue('ciCustomerData')) ciTypes.push('customer lists, customer data, and customer preferences');
            if (getValue('ciBusinessPlans')) ciTypes.push('business plans, strategies, and projections');
            if (getValue('ciFinancials')) ciTypes.push('financial information, pricing, and cost structures');
            if (getValue('ciMarketing')) ciTypes.push('marketing strategies, campaigns, and market research');
            const ciTypesText = ciTypes.length > 0 ? ciTypes.join('; ') : 'proprietary business information';

            // Build IP types
            let ipTypes = [];
            if (getValue('ipPatents')) ipTypes.push('patents and patent applications');
            if (getValue('ipCopyrights')) ipTypes.push('copyrights and works of authorship');
            if (getValue('ipTrademarks')) ipTypes.push('trademarks and service marks');
            if (getValue('ipTradeSecrets')) ipTypes.push('trade secrets');
            const ipTypesText = ipTypes.length > 0 ? ipTypes.join(', ') : 'intellectual property';

            // Invention scope text
            let inventionScopeText = '';
            if (inventionScope === 'related') {
                inventionScopeText = 'relate to Company\'s actual or demonstrably anticipated business, research, or development';
            } else if (inventionScope === 'all-work') {
                inventionScopeText = 'are made during the course of Employee\'s employment with Company';
            } else {
                inventionScopeText = 'relate to Company\'s current or reasonably anticipated future business, research, or development';
            }

            // Confidentiality period text
            let confPeriodText = confidentialityPeriod === 'indefinite'
                ? 'indefinitely with respect to trade secrets and for a period of five (5) years with respect to other Confidential Information'
                : `for a period of ${confidentialityPeriod} following termination of employment`;

            // Build sections
            let sectionNum = 1;
            let sections = '';

            // Section 1: Definitions
            sections += `
                <h2>${sectionNum}. DEFINITIONS</h2>
                <p class="clause">${sectionNum}.1 <strong>"Confidential Information"</strong> means any and all information or data that has or could have commercial value or other utility in the business in which Company is engaged, or that, if disclosed without authorization, could be detrimental to Company. Confidential Information includes, without limitation: ${ciTypesText}; vendor and supplier information; personnel information; inventions, processes, techniques, and know-how; and any other information designated as confidential or that reasonably should be understood to be confidential.</p>
                <p class="clause">${sectionNum}.2 <strong>"Inventions"</strong> means any and all inventions, discoveries, developments, concepts, ideas, improvements, innovations, designs, formulas, processes, techniques, know-how, data, software, works of authorship, mask works, and other intellectual property, whether or not patentable or copyrightable.</p>
                <p class="clause">${sectionNum}.3 <strong>"Company Materials"</strong> means all documents, data, equipment, prototypes, and other materials containing or embodying Confidential Information or Inventions.</p>
            `;
            sectionNum++;

            // Section 2: Confidentiality
            sections += `
                <h2>${sectionNum}. CONFIDENTIALITY OBLIGATIONS</h2>
                <p class="clause">${sectionNum}.1 <strong>Non-Disclosure.</strong> Employee agrees to hold all Confidential Information in strict confidence and not to disclose any Confidential Information to any third party, except as required in the performance of Employee's duties for Company and with Company's prior written consent.</p>
                <p class="clause">${sectionNum}.2 <strong>Non-Use.</strong> Employee agrees not to use any Confidential Information for any purpose other than for the benefit of Company in the course of Employee's employment.</p>
                <p class="clause">${sectionNum}.3 <strong>Protection.</strong> Employee agrees to take all reasonable precautions to prevent the unauthorized disclosure or use of Confidential Information, including at minimum those precautions Employee takes to protect Employee's own confidential information.</p>
                <p class="clause">${sectionNum}.4 <strong>Third-Party Information.</strong> Employee agrees not to disclose to Company or use in Company's business any confidential information belonging to any former employer or other third party.</p>
                <p class="clause">${sectionNum}.5 <strong>Duration.</strong> Employee's obligations under this Section shall survive termination of employment ${confPeriodText}.</p>
            `;
            sectionNum++;

            // Section 3: Invention Assignment
            sections += `
                <h2>${sectionNum}. ASSIGNMENT OF INVENTIONS</h2>
                <p class="clause">${sectionNum}.1 <strong>Assignment.</strong> Employee hereby assigns and agrees to assign to Company all right, title, and interest in and to any and all Inventions (and all ${ipTypesText} therein) that Employee may solely or jointly conceive, develop, or reduce to practice during the period of Employee's employment with Company and that: (a) ${inventionScopeText}; (b) result from any work performed by Employee for Company; or (c) are developed using Company's equipment, supplies, facilities, or Confidential Information.</p>
                <p class="clause">${sectionNum}.2 <strong>Works Made for Hire.</strong> Employee acknowledges that all works of authorship created by Employee within the scope of employment are "works made for hire" as defined by the Copyright Act and are owned exclusively by Company. To the extent any such works do not qualify as works made for hire, Employee hereby assigns all rights therein to Company.</p>
                <p class="clause">${sectionNum}.3 <strong>Disclosure.</strong> Employee agrees to promptly and fully disclose in writing to Company all Inventions, whether or not Employee believes they are subject to this Agreement.</p>
                <p class="clause">${sectionNum}.4 <strong>Assistance.</strong> Employee agrees to assist Company, at Company's expense, in obtaining, maintaining, and enforcing ${ipTypesText} relating to Inventions, including executing patent applications, copyright registrations, assignments, and other documents as Company may reasonably request.</p>
                <p class="clause">${sectionNum}.5 <strong>Power of Attorney.</strong> If Company is unable to secure Employee's signature on any document necessary to apply for, prosecute, obtain, or enforce any intellectual property right relating to any Invention, Employee hereby irrevocably designates and appoints Company and its authorized officers as Employee's agent and attorney-in-fact to execute and file such documents.</p>
            `;
            sectionNum++;

            // California-specific notice
            if (companyState === 'California') {
                sections += `
                    <h2>${sectionNum}. CALIFORNIA LABOR CODE NOTICE</h2>
                    <p class="clause">${sectionNum}.1 <strong>Statutory Notice.</strong> Pursuant to California Labor Code Section 2870, the assignment of Inventions in this Agreement does not apply to any Invention that qualifies fully under the provisions of California Labor Code Section 2870, which provides:</p>
                    <p class="sub-clause">"Any provision in an employment agreement which provides that an employee shall assign, or offer to assign, any of his or her rights in an invention to his or her employer shall not apply to an invention that the employee developed entirely on his or her own time without using the employer's equipment, supplies, facilities, or trade secret information except for those inventions that either:</p>
                    <p class="sub-clause">(1) Relate at the time of conception or reduction to practice of the invention to the employer's business, or actual or demonstrably anticipated research or development of the employer; or</p>
                    <p class="sub-clause">(2) Result from any work performed by the employee for the employer."</p>
                    <p class="clause">${sectionNum}.2 Employee acknowledges receipt of written notification of the limitation set forth in California Labor Code Section 2870.</p>
                `;
                sectionNum++;
            }

            // Prior Inventions
            sections += `
                <h2>${sectionNum}. PRIOR INVENTIONS</h2>
                <p class="clause">${sectionNum}.1 Employee has listed on <strong>Exhibit A</strong> attached hereto all Inventions that Employee made prior to employment with Company that Employee wishes to exclude from the scope of this Agreement ("Prior Inventions").</p>
                <p class="clause">${sectionNum}.2 If no Prior Inventions are listed on Exhibit A, Employee represents that there are no Prior Inventions.</p>
                <p class="clause">${sectionNum}.3 If Employee uses any Prior Invention in the course of employment with Company, Employee hereby grants to Company a non-exclusive, royalty-free, irrevocable, perpetual, worldwide license to use, modify, and sublicense such Prior Invention in connection with Company's business.</p>
            `;
            sectionNum++;

            // Return of Materials
            if (getValue('includeReturnProperty')) {
                sections += `
                    <h2>${sectionNum}. RETURN OF COMPANY MATERIALS</h2>
                    <p class="clause">${sectionNum}.1 Upon termination of employment or upon Company's request, Employee agrees to immediately return to Company all Company Materials in Employee's possession or control.</p>
                    <p class="clause">${sectionNum}.2 Employee agrees not to retain any copies, reproductions, or excerpts of Company Materials.</p>
                    <p class="clause">${sectionNum}.3 Employee agrees to permanently delete all Confidential Information from any personal devices, cloud storage, or other personal systems.</p>
                `;
                sectionNum++;
            }

            // Exit Interview
            if (getValue('includeExitInterview')) {
                sections += `
                    <h2>${sectionNum}. EXIT INTERVIEW AND CERTIFICATION</h2>
                    <p class="clause">${sectionNum}.1 Employee agrees to participate in an exit interview upon termination of employment.</p>
                    <p class="clause">${sectionNum}.2 At such interview, Employee agrees to sign a certification confirming compliance with the obligations in this Agreement, including confirmation that Employee has returned all Company Materials and disclosed all Inventions.</p>
                `;
                sectionNum++;
            }

            // Non-Solicitation
            if (getValue('includeNonSolicitation')) {
                sections += `
                    <h2>${sectionNum}. NON-SOLICITATION</h2>
                    <p class="clause">${sectionNum}.1 For a period of one (1) year following termination of employment, Employee agrees not to directly or indirectly solicit, recruit, or hire any employee or contractor of Company, or induce any such person to leave Company.</p>
                    <p class="clause">${sectionNum}.2 For a period of one (1) year following termination of employment, Employee agrees not to solicit any customer or client of Company for the purpose of providing products or services competitive with those of Company.</p>
                `;
                sectionNum++;
            }

            // Non-Compete (with warning)
            if (getValue('includeNonCompete') && companyState !== 'California') {
                sections += `
                    <h2>${sectionNum}. NON-COMPETITION</h2>
                    <p class="clause">${sectionNum}.1 For a period of one (1) year following termination of employment, Employee agrees not to engage in, or be employed by or provide services to, any business that competes with Company within the geographic area where Company conducts business.</p>
                    <p class="clause">${sectionNum}.2 Employee acknowledges that this restriction is reasonable and necessary to protect Company's legitimate business interests.</p>
                `;
                sectionNum++;
            }

            // Remedies
            sections += `
                <h2>${sectionNum}. REMEDIES</h2>
                <p class="clause">${sectionNum}.1 Employee acknowledges that a breach of this Agreement would cause irreparable harm to Company that cannot be adequately compensated by monetary damages.</p>
                <p class="clause">${sectionNum}.2 In the event of any breach or threatened breach, Company shall be entitled to seek injunctive relief, specific performance, and any other remedies available at law or in equity.</p>
                <p class="clause">${sectionNum}.3 Company shall be entitled to recover reasonable attorney's fees and costs incurred in enforcing this Agreement.</p>
            `;
            sectionNum++;

            // General Provisions
            sections += `
                <h2>${sectionNum}. GENERAL PROVISIONS</h2>
                <p class="clause">${sectionNum}.1 <strong>Severability.</strong> If any provision of this Agreement is held invalid or unenforceable, such provision shall be modified to the minimum extent necessary to make it enforceable, and the remaining provisions shall remain in full force and effect.</p>
                <p class="clause">${sectionNum}.2 <strong>Entire Agreement.</strong> This Agreement constitutes the entire agreement between the parties regarding its subject matter and supersedes all prior agreements.</p>
                <p class="clause">${sectionNum}.3 <strong>Amendment.</strong> This Agreement may only be amended by a written instrument signed by both parties.</p>
                <p class="clause">${sectionNum}.4 <strong>Governing Law.</strong> This Agreement shall be governed by the laws of the State of <span class="doc-highlight">${companyState}</span>.</p>
                <p class="clause">${sectionNum}.5 <strong>Survival.</strong> Employee's obligations under this Agreement shall survive termination of employment.</p>
                <p class="clause">${sectionNum}.6 <strong>No Employment Contract.</strong> This Agreement does not constitute a contract of employment or guarantee employment for any period of time.</p>
            `;

            // Build Exhibit A
            let exhibitA = `
                <div class="exhibit">
                    <h3>EXHIBIT A</h3>
                    <h3>PRIOR INVENTIONS</h3>
                    <p>The following is a complete list of all Inventions that Employee made prior to employment with Company and that Employee wishes to exclude from the assignment provisions of this Agreement:</p>
            `;

            if (getValue('priorInventions') && getValue('priorInventionsList')) {
                exhibitA += `<p><span class="doc-highlight">${getValue('priorInventionsList').replace(/\n/g, '<br>')}</span></p>`;
            } else {
                exhibitA += `<p>☐ No Prior Inventions</p><p>☐ See attached list</p>`;
            }

            exhibitA += `
                    <div style="margin-top: 2rem;">
                        <p>Employee Signature: ___________________________ Date: _______________</p>
                    </div>
                </div>
            `;

            // Generate full document
            const html = `
                <h1>Proprietary Information and<br>Inventions Assignment Agreement</h1>
                <p class="effective-date">Effective Date: <span class="doc-highlight">${effectiveDate}</span></p>

                <div class="parties">
                    <p>This Proprietary Information and Inventions Assignment Agreement ("Agreement") is entered into by and between:</p>
                    <p><strong>Company:</strong> <span class="doc-highlight">${companyName}</span>, a <span class="doc-highlight">${companyState}</span> corporation, with its principal place of business at <span class="doc-highlight">${companyAddress}</span> ("Company"); and</p>
                    <p><strong>Employee:</strong> <span class="doc-highlight">${employeeName}</span>, residing at <span class="doc-highlight">${employeeAddress}</span> ("Employee").</p>
                </div>

                <p class="center"><strong>RECITALS</strong></p>
                <p><strong>WHEREAS,</strong> Employee is being employed by Company as <span class="doc-highlight">${jobTitle}</span>, effective <span class="doc-highlight">${startDate}</span>;</p>
                <p><strong>WHEREAS,</strong> in the course of employment, Employee will have access to and become familiar with Company's Confidential Information and will make contributions to Company's intellectual property;</p>
                <p><strong>WHEREAS,</strong> Company requires protection of its Confidential Information and intellectual property as a condition of employment;</p>
                <p><strong>NOW, THEREFORE,</strong> in consideration of Employee's employment with Company and access to Confidential Information, and other good and valuable consideration, the parties agree as follows:</p>

                ${sections}

                <div class="signature-block">
                    <div class="signature-party">
                        <h3>Company</h3>
                        <p><strong><span class="doc-highlight">${companyName}</span></strong></p>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line">Printed Name</div>
                        <div class="signature-line">Title</div>
                        <div class="signature-line">Date</div>
                    </div>
                    <div class="signature-party">
                        <h3>Employee</h3>
                        <div class="signature-line">Signature</div>
                        <div class="signature-line"><span class="doc-highlight">${employeeName}</span></div>
                        <div class="signature-line">Date</div>
                    </div>
                </div>

                ${exhibitA}
            `;

            document.getElementById('documentPreview').innerHTML = html;
        }

        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const html = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'>
                <head><meta charset="utf-8"><title>PIIA Agreement</title>
                <style>
                    body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.6; }
                    h1 { text-align: center; font-size: 16pt; text-transform: uppercase; }
                    h2 { font-size: 12pt; text-transform: uppercase; margin-top: 18pt; }
                    h3 { text-align: center; font-size: 14pt; }
                    p { margin-bottom: 12pt; text-align: justify; }
                    .sub-clause { margin-left: 36pt; }
                    .signature-block { margin-top: 36pt; }
                    .signature-line { border-top: 1px solid black; margin-top: 30pt; padding-top: 4pt; }
                    .exhibit { margin-top: 24pt; padding-top: 12pt; border-top: 2px solid black; page-break-before: always; }
                </style></head>
                <body>${content}</body></html>
            `;
            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'PIIA-Agreement.doc';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;
            document.getElementById('startDate').value = today;
            updatePreview();
        });
    </script>
</body>
</html>
