<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Investor Side Letter Generator | Pro-Rata, MFN, Info Rights | Terms.Law</title>
  <meta name="description" content="Free Investor Side Letter generator. Grant pro-rata rights, MFN clauses, information rights, and board observer seats. Attorney-drafted with real-time preview.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 25px; }
    .doc-section-header { font-size: 12px; font-weight: bold; margin-top: 20px; margin-bottom: 10px; color: var(--doc-clause-title); border-bottom: 1px solid var(--color-border); padding-bottom: 4px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-signature-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px; }
    .doc-signature-party-title { font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 15px; color: var(--color-text-muted); }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; }
    .doc-signature-line .sig-label { width: 60px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .doc-signature-row { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/" class="nav-link">Demands</a>
        <a href="/Templates/" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">Investor Relations</div>
      <h1>Investor <span class="highlight">Side Letter</span> Generator</h1>
      <p class="hero-subtitle">Generate side letters granting special investor rights. Include pro-rata rights, MFN clauses, information rights, and board observer seats.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">Company Information</h3>
        <div class="form-group">
          <label class="form-label">Company Name</label>
          <input type="text" id="companyName" class="form-input" placeholder="Acme Inc." oninput="trackFieldEdit('companyName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select id="incState" class="form-select" onchange="trackFieldEdit('incState')">
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Financing Round</label>
          <input type="text" id="financingRound" class="form-input" placeholder="Series A" oninput="trackFieldEdit('financingRound')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Investor Information</h3>
        <div class="form-group">
          <label class="form-label">Investor Name</label>
          <input type="text" id="investorName" class="form-input" placeholder="Sequoia Capital" oninput="trackFieldEdit('investorName')">
        </div>
        <div class="form-group">
          <label class="form-label">Investment Amount ($)</label>
          <input type="number" id="investmentAmount" class="form-input" placeholder="5000000" oninput="trackFieldEdit('investmentAmount')">
        </div>
        <div class="form-group">
          <label class="form-label">Effective Date</label>
          <input type="date" id="effectiveDate" class="form-input" oninput="trackFieldEdit('effectiveDate')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Rights Granted</h3>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="proRata" checked onchange="trackFieldEdit('proRata')">
            <span class="form-label" style="margin:0;">Pro-Rata Rights</span>
          </label>
          <div class="form-hint">Right to participate in future rounds</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="mfn" onchange="trackFieldEdit('mfn')">
            <span class="form-label" style="margin:0;">Most Favored Nation (MFN)</span>
          </label>
          <div class="form-hint">Get same terms as better deals</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="infoRights" checked onchange="trackFieldEdit('infoRights')">
            <span class="form-label" style="margin:0;">Information Rights</span>
          </label>
          <div class="form-hint">Receive financial statements</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="boardObserver" onchange="trackFieldEdit('boardObserver')">
            <span class="form-label" style="margin:0;">Board Observer Seat</span>
          </label>
          <div class="form-hint">Attend board meetings (non-voting)</div>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="coInvest" onchange="trackFieldEdit('coInvest')">
            <span class="form-label" style="margin:0;">Co-Investment Rights</span>
          </label>
          <div class="form-hint">Invite other funds to invest</div>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Pro-Rata Details</h3>
        <div class="form-group">
          <label class="form-label">Ownership Threshold</label>
          <select id="proRataThreshold" class="form-select" onchange="trackFieldEdit('proRataThreshold')">
            <option value="none">No minimum threshold</option>
            <option value="1">Must hold 1%+ ownership</option>
            <option value="2">Must hold 2%+ ownership</option>
            <option value="5">Must hold 5%+ ownership</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Pro-Rata Calculation</label>
          <select id="proRataCalc" class="form-select" onchange="trackFieldEdit('proRataCalc')">
            <option value="fully-diluted">Fully diluted basis</option>
            <option value="outstanding">Outstanding shares only</option>
          </select>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Information Rights Details</h3>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="annualFinancials" checked onchange="trackFieldEdit('annualFinancials')">
            <span class="form-label" style="margin:0;">Annual financial statements</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="quarterlyFinancials" checked onchange="trackFieldEdit('quarterlyFinancials')">
            <span class="form-label" style="margin:0;">Quarterly financial statements</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="monthlyFinancials" onchange="trackFieldEdit('monthlyFinancials')">
            <span class="form-label" style="margin:0;">Monthly financial statements</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="budgetAccess" onchange="trackFieldEdit('budgetAccess')">
            <span class="form-label" style="margin:0;">Annual budget/business plan</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <input type="checkbox" id="capTableAccess" onchange="trackFieldEdit('capTableAccess')">
            <span class="form-label" style="margin:0;">Cap table access</span>
          </label>
        </div>
      </div>
    </aside>
    <div class="preview-panel">
      <div class="preview-toolbar">
        <div class="preview-title">Live Preview - Click highlighted text to edit</div>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title">Investor Side Letter</span>
          <span class="document-status">Live</span>
        </div>
        <div class="document-body" id="documentPreview"></div>
      </div>
    </div>
  </main>
  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>2024 Terms.Law - Sergei Tokmakov, Esq.</p>
  </footer>
  <div class="toast" id="toast"></div>
  <script>
    let lastEditedField = null;

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('effectiveDate').value = new Date().toISOString().split('T')[0];
      updatePreview();
    });

    function trackFieldEdit(fieldId) { lastEditedField = fieldId; updatePreview(); }

    function formatCurrency(num) {
      if (!num) return '';
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(num);
    }

    function updatePreview() {
      const h = (v, p, f) => `<span class="doc-highlight${!v?' empty':''}" data-field="${f}" contenteditable="true">${v||'['+p+']'}</span>`;

      const companyName = document.getElementById('companyName').value;
      const incState = document.getElementById('incState').value;
      const financingRound = document.getElementById('financingRound').value;
      const investorName = document.getElementById('investorName').value;
      const investmentAmount = document.getElementById('investmentAmount').value;
      const effectiveDate = document.getElementById('effectiveDate').value;
      const proRata = document.getElementById('proRata').checked;
      const mfn = document.getElementById('mfn').checked;
      const infoRights = document.getElementById('infoRights').checked;
      const boardObserver = document.getElementById('boardObserver').checked;
      const coInvest = document.getElementById('coInvest').checked;
      const proRataThreshold = document.getElementById('proRataThreshold').value;
      const proRataCalc = document.getElementById('proRataCalc').value;
      const annualFinancials = document.getElementById('annualFinancials').checked;
      const quarterlyFinancials = document.getElementById('quarterlyFinancials').checked;
      const monthlyFinancials = document.getElementById('monthlyFinancials').checked;
      const budgetAccess = document.getElementById('budgetAccess').checked;
      const capTableAccess = document.getElementById('capTableAccess').checked;

      const formattedDate = effectiveDate ? new Date(effectiveDate+'T00:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '';
      const formattedAmount = formatCurrency(investmentAmount);

      let sectionNum = 1;

      let proRataSection = '';
      if (proRata) {
        const thresholdText = proRataThreshold === 'none' ? '' : `, provided that the Investor maintains at least ${proRataThreshold}% of the Company's outstanding capital stock on a fully diluted basis`;
        const calcText = proRataCalc === 'fully-diluted' ? 'on a fully diluted basis' : 'based on outstanding shares';
        proRataSection = `
          <div class="doc-section-header">${sectionNum}. Pro-Rata Rights</div>
          <p class="doc-paragraph">The Company hereby grants to the Investor the right to participate in any future equity financing of the Company on a pro-rata basis, calculated ${calcText}${thresholdText}.</p>
          <p class="doc-paragraph">The Investor's pro-rata share shall be calculated as the ratio of (a) the number of shares of the Company's capital stock held by the Investor immediately prior to such financing, to (b) the total number of shares of the Company's capital stock outstanding immediately prior to such financing${proRataCalc === 'fully-diluted' ? ', on an as-converted, fully diluted basis' : ''}.</p>
          <p class="doc-paragraph">The Company shall provide the Investor with at least fifteen (15) business days' notice prior to the closing of any such financing, together with the material terms thereof, to allow the Investor to exercise its pro-rata rights.</p>
        `;
        sectionNum++;
      }

      let mfnSection = '';
      if (mfn) {
        mfnSection = `
          <div class="doc-section-header">${sectionNum}. Most Favored Nation</div>
          <p class="doc-paragraph">If the Company issues equity securities to any other investor in connection with the ${h(financingRound || 'this financing','Series A','financingRound')} financing on terms more favorable than those provided to the Investor, the Company shall promptly notify the Investor and offer the Investor the opportunity to amend its investment documents to incorporate such more favorable terms.</p>
          <p class="doc-paragraph">This Most Favored Nation provision shall apply to: (a) valuation and pricing terms; (b) liquidation preferences; (c) anti-dilution provisions; (d) registration rights; and (e) any other material economic or governance terms.</p>
        `;
        sectionNum++;
      }

      let infoSection = '';
      if (infoRights) {
        let infoList = [];
        if (annualFinancials) infoList.push('Annual audited financial statements within 120 days after the end of each fiscal year');
        if (quarterlyFinancials) infoList.push('Quarterly unaudited financial statements within 45 days after the end of each fiscal quarter');
        if (monthlyFinancials) infoList.push('Monthly unaudited financial statements within 30 days after the end of each month');
        if (budgetAccess) infoList.push('Annual budget and business plan within 30 days after the start of each fiscal year');
        if (capTableAccess) infoList.push('Current capitalization table upon reasonable request');

        infoSection = `
          <div class="doc-section-header">${sectionNum}. Information Rights</div>
          <p class="doc-paragraph">The Company shall provide the Investor with the following information:</p>
          <ul class="doc-list">
            ${infoList.map(i => `<li>${i}</li>`).join('')}
          </ul>
          <p class="doc-paragraph">All financial statements shall be prepared in accordance with generally accepted accounting principles (GAAP), applied on a consistent basis.</p>
          <p class="doc-paragraph">These information rights shall terminate upon: (a) the closing of a firm commitment underwritten public offering; or (b) a merger or acquisition where the Investor receives publicly traded securities.</p>
        `;
        sectionNum++;
      }

      let boardSection = '';
      if (boardObserver) {
        boardSection = `
          <div class="doc-section-header">${sectionNum}. Board Observer Rights</div>
          <p class="doc-paragraph">The Company grants the Investor the right to designate one (1) representative to attend all meetings of the Company's Board of Directors in a non-voting, observer capacity.</p>
          <p class="doc-paragraph">The board observer shall: (a) receive copies of all materials distributed to the Board at the same time as Board members; (b) be entitled to participate in discussions at Board meetings; but (c) shall have no voting rights.</p>
          <p class="doc-paragraph">The Company may exclude the board observer from any portion of a meeting or withhold materials if the Board determines in good faith that: (a) such exclusion is necessary to preserve attorney-client privilege; or (b) the matter involves a conflict of interest with the Investor.</p>
          <p class="doc-paragraph">The Company shall provide the board observer with reasonable advance notice of all Board meetings and shall use reasonable efforts to schedule meetings at times convenient for the observer.</p>
        `;
        sectionNum++;
      }

      let coInvestSection = '';
      if (coInvest) {
        coInvestSection = `
          <div class="doc-section-header">${sectionNum}. Co-Investment Rights</div>
          <p class="doc-paragraph">The Investor shall have the right, but not the obligation, to invite other investors (including affiliated funds, limited partners, and co-investment vehicles) to participate in the ${h(financingRound || 'this financing','Series A','financingRound')} financing, subject to the Company's prior written approval, which shall not be unreasonably withheld.</p>
          <p class="doc-paragraph">Any co-investors shall be subject to the same terms and conditions as the Investor and shall execute all applicable transaction documents.</p>
        `;
        sectionNum++;
      }

      document.getElementById('documentPreview').innerHTML = `
        <div class="doc-title">SIDE LETTER</div>

        <p class="doc-paragraph">${h(formattedDate,'Date','effectiveDate')}</p>

        <p class="doc-paragraph">
          ${h(investorName,'Investor Name','investorName')}<br>
          [Address]
        </p>

        <p class="doc-paragraph">Re: ${h(financingRound,'Series A','financingRound')} Financing - Side Letter</p>

        <p class="doc-paragraph">Dear ${h(investorName,'Investor','investorName')}:</p>

        <p class="doc-paragraph">Reference is made to that certain ${h(financingRound,'Series A','financingRound')} Preferred Stock Purchase Agreement dated as of ${h(formattedDate,'[Date]','effectiveDate')} (the "<strong>Purchase Agreement</strong>") by and among ${h(companyName,'Company Name','companyName')}, a ${h(incState,'Delaware','incState')} corporation (the "<strong>Company</strong>"), and the investors party thereto, pursuant to which you are investing ${h(formattedAmount,'$5,000,000','investmentAmount')} in the Company.</p>

        <p class="doc-paragraph">In consideration of your investment and the mutual covenants contained herein, and intending to be legally bound, the Company hereby agrees as follows:</p>

        ${proRataSection}
        ${mfnSection}
        ${infoSection}
        ${boardSection}
        ${coInvestSection}

        <div class="doc-section-header">${sectionNum}. Confidentiality</div>
        <p class="doc-paragraph">The existence and terms of this Side Letter shall be treated as confidential by both parties and shall not be disclosed to any third party except: (a) to each party's legal and financial advisors; (b) as required by law; or (c) with the prior written consent of the other party.</p>

        <div class="doc-section-header">${sectionNum + 1}. General Provisions</div>
        <p class="doc-paragraph"><strong>Amendment.</strong> This Side Letter may only be amended by a written instrument signed by both the Company and the Investor.</p>
        <p class="doc-paragraph"><strong>Governing Law.</strong> This Side Letter shall be governed by the laws of the State of ${h(incState,'Delaware','incState')}, without regard to conflicts of law principles.</p>
        <p class="doc-paragraph"><strong>Entire Agreement.</strong> This Side Letter, together with the Purchase Agreement and related transaction documents, constitutes the entire agreement between the parties with respect to the subject matter hereof.</p>
        <p class="doc-paragraph"><strong>Counterparts.</strong> This Side Letter may be executed in counterparts, each of which shall be deemed an original.</p>

        <p class="doc-paragraph" style="margin-top:30px;">If the foregoing accurately reflects our agreement, please sign and return one copy of this Side Letter.</p>

        <p class="doc-paragraph" style="margin-top:20px;">Sincerely,</p>

        <div class="doc-signature-row">
          <div>
            <div class="doc-signature-party-title">${companyName || 'Company'}</div>
            <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Title:</span><span class="sig-value"></span></div>
          </div>
          <div>
            <div class="doc-signature-party-title">Acknowledged and Agreed:</div>
            <p style="font-weight:bold;margin-bottom:10px;">${investorName || '[Investor]'}</p>
            <div class="doc-signature-line"><span class="sig-label">Sign:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Name:</span><span class="sig-value"></span></div>
            <div class="doc-signature-line"><span class="sig-label">Title:</span><span class="sig-value"></span></div>
          </div>
        </div>
      `;

      if(lastEditedField){
        setTimeout(()=>{
          const el = document.querySelector(`[data-field="${lastEditedField}"]`);
          if(el){
            el.scrollIntoView({behavior:'smooth',block:'center'});
            el.classList.add('field-highlight-animation');
            setTimeout(()=>el.classList.remove('field-highlight-animation'),600);
          }
        },50);
      }
    }

    function showToast(msg,type=''){
      const t=document.getElementById('toast');
      t.textContent=msg;
      t.className='toast show'+(type?' '+type:'');
      setTimeout(()=>t.classList.remove('show'),3000);
    }

    function copyToClipboard(){
      const r=document.createRange();
      r.selectNode(document.getElementById('documentPreview'));
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(r);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      showToast('Copied!','success');
    }

    function downloadDocument(){
      const c=document.getElementById('documentPreview').innerHTML;
      const investorName = document.getElementById('investorName').value || 'Investor';
      const h=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Side Letter - ${investorName}</title><style>body{font-family:Georgia,serif;max-width:8.5in;margin:1in auto;line-height:1.8;font-size:12pt}.doc-title{text-align:center;font-size:14pt;font-weight:bold;text-transform:uppercase;letter-spacing:2px;margin-bottom:25px}.doc-section-header{font-weight:bold;margin-top:20px;border-bottom:1px solid #ccc;padding-bottom:4px;font-size:11pt}.doc-paragraph{margin:12px 0;text-align:justify}.doc-list{margin:12px 0 12px 20px}.doc-list li{margin-bottom:8px}.doc-highlight{background:#fef3c7}.doc-signature-row{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:40px}.doc-signature-party-title{font-weight:bold;text-transform:uppercase;margin-bottom:15px;font-size:10pt}.doc-signature-line{display:flex;margin-bottom:8px;min-height:30px}.doc-signature-line .sig-label{width:60px;font-size:9pt;color:#666}.doc-signature-line .sig-value{flex:1;border-bottom:1px solid #333}</style></head><body>${c}</body></html>`;
      const b=new Blob([h],{type:'text/html'});
      const u=URL.createObjectURL(b);
      const a=document.createElement('a');
      a.href=u;
      a.download='Side-Letter.html';
      a.click();
      URL.revokeObjectURL(u);
      showToast('Downloaded!','success');
    }
  </script>
</body>
</html>
