<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Purchase Agreement Generator | Share Purchase | Terms.Law</title>
  <meta name="description" content="Free Stock Purchase Agreement generator. Create legally binding agreements for buying and selling company shares with representations, warranties, and closing conditions.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #1e40af;
      --color-primary-dark: #1e3a8a;
      --color-primary-light: #3b82f6;
      --color-accent: #7c3aed;
      --color-accent-light: #8b5cf6;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-danger: #dc2626;
      --color-bg: #f8fafc;
      --color-surface: #ffffff;
      --color-border: #e2e8f0;
      --color-border-light: #f1f5f9;
      --color-text: #0f172a;
      --color-text-secondary: #334155;
      --color-text-muted: #64748b;
      --color-text-light: #94a3b8;
      --color-dark: #0f172a;
      --color-dark-surface: #1e293b;
      --doc-bg: #fefefe;
      --doc-text: #1f2937;
      --doc-clause-title: #1e40af;
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-full: 9999px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-serif: Georgia, 'Times New Roman', serif;
      --transition-fast: 150ms ease;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); font-size: 16px; line-height: 1.6; color: var(--color-text); background: var(--color-bg); }
    .site-header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 0; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); }
    .header-content { display: flex; align-items: center; justify-content: center; height: 52px; }
    .header-nav { display: flex; align-items: center; gap: 0; height: 100%; }
    .nav-link { color: #94a3b8; font-size: 0.85rem; font-weight: 600; padding: 16px 24px; transition: all 150ms ease; text-decoration: none; height: 100%; display: flex; align-items: center; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid transparent; }
    .nav-link:hover { color: #ffffff; background: rgba(255, 255, 255, 0.05); }
    .nav-link.active { color: #ffffff; background: rgba(255, 255, 255, 0.08); border-bottom-color: #3b82f6; }
    .nav-link.home-logo { padding: 12px 20px; font-size: 1.1rem; font-weight: 800; letter-spacing: -0.02em; text-transform: none; }
    .nav-link.home-logo .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); padding: 2rem 2rem; position: relative; }
    .hero-content { max-width: 800px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px; background: rgba(124, 58, 237, 0.15); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: var(--radius-full); font-size: 0.8rem; color: #c4b5fd; margin-bottom: 1rem; }
    .hero h1 { font-size: 2rem; font-weight: 800; color: #fff; line-height: 1.2; margin-bottom: 0.75rem; }
    .hero h1 .highlight { background: linear-gradient(135deg, #a78bfa, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size: 1rem; color: #94a3b8; line-height: 1.6; }
    .builder-layout { display: grid; grid-template-columns: 380px 1fr; gap: 0; min-height: calc(100vh - 200px); }
    @media (max-width: 1024px) { .builder-layout { grid-template-columns: 1fr; } }
    .builder-sidebar { background: var(--color-surface); border-right: 1px solid var(--color-border); padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 150px); position: sticky; top: 52px; }
    .builder-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-border-light); }
    .builder-section:last-child { border-bottom: none; margin-bottom: 0; }
    .builder-section-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--color-text-muted); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
    .form-group { margin-bottom: 1rem; }
    .form-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--color-text); margin-bottom: 0.35rem; }
    .form-input, .form-textarea, .form-select { width: 100%; padding: 10px 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); font-size: 0.9rem; font-family: inherit; transition: all var(--transition-fast); background: var(--color-surface); }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1); }
    .form-textarea { min-height: 80px; resize: vertical; }
    .form-hint { font-size: 0.75rem; color: var(--color-text-muted); margin-top: 4px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .preview-panel { background: var(--color-bg); padding: 1.5rem; overflow-y: auto; }
    .preview-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .preview-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); }
    .preview-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all var(--transition-fast); border: none; }
    .btn-primary { background: var(--color-primary); color: #fff; }
    .btn-primary:hover { background: var(--color-primary-dark); }
    .btn-secondary { background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); }
    .btn-secondary:hover { border-color: var(--color-primary); color: var(--color-primary); }
    .document-container { background: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .document-header { background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-dark-surface) 100%); padding: 0.75rem 1.5rem; display: flex; align-items: center; justify-content: space-between; }
    .document-title { color: #fff; font-size: 0.85rem; font-weight: 600; }
    .document-status { font-size: 0.7rem; color: var(--color-accent-light); }
    .document-body { padding: 40px 50px; background: var(--doc-bg); font-family: var(--font-serif); font-size: 13px; line-height: 1.8; color: var(--doc-text); }
    .document-body.full-edit-mode { outline: 3px solid var(--color-primary); background: #fffef8; }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 25px; }
    .doc-section-header { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; color: var(--doc-clause-title); border-bottom: 1px solid var(--color-border); padding-bottom: 4px; }
    .doc-subsection { font-size: 11px; font-weight: bold; margin-top: 12px; margin-bottom: 6px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; text-align: justify; }
    .doc-highlight { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 1px 5px; border-radius: 3px; border-bottom: 2px solid #f59e0b; font-weight: 600; cursor: text; }
    .doc-highlight:hover { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); }
    .doc-highlight:focus { outline: none; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); }
    .doc-highlight.empty { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-bottom-color: #ef4444; color: #dc2626; }
    @keyframes highlightPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } 50% { box-shadow: 0 0 0 6px rgba(245, 158, 11, 0.3); } }
    .field-highlight-animation { animation: highlightPulse 0.6s ease-out; }
    .doc-signature-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px; }
    .doc-signature-party-title { font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 15px; color: var(--color-text-muted); }
    .doc-signature-line { display: flex; align-items: flex-end; margin-bottom: 8px; min-height: 35px; }
    .doc-signature-line .sig-label { width: 80px; font-size: 10px; color: var(--color-text-muted); }
    .doc-signature-line .sig-value { flex: 1; border-bottom: 1px solid #333; min-height: 30px; display: flex; align-items: flex-end; padding-bottom: 3px; }
    .type-card { background: var(--color-bg); border: 2px solid var(--color-border); border-radius: var(--radius-md); padding: 0.75rem; margin-bottom: 0.5rem; cursor: pointer; transition: all var(--transition-fast); }
    .type-card:hover { border-color: var(--color-primary-light); }
    .type-card.selected { border-color: var(--color-primary); background: rgba(30, 64, 175, 0.05); }
    .type-card input { display: none; }
    .type-name { font-weight: 600; font-size: 0.85rem; margin-bottom: 2px; }
    .type-desc { font-size: 0.75rem; color: var(--color-text-muted); }
    .checkbox-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .checkbox-item { display: flex; align-items: center; gap: 0.5rem; }
    .checkbox-item input { width: 16px; height: 16px; }
    .checkbox-item label { font-size: 0.85rem; cursor: pointer; }
    .toast { position: fixed; bottom: 20px; right: 20px; background: var(--color-dark); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 0.85rem; box-shadow: var(--shadow-xl); transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast.success { background: var(--color-success); }
    .site-footer { background: var(--color-dark); color: #94a3b8; padding: 2rem; text-align: center; }
    .footer-brand { font-size: 1.1rem; font-weight: 800; margin-bottom: 0.5rem; }
    .footer-brand .logo-text { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @media (max-width: 768px) { .document-body { padding: 25px 20px; } .doc-signature-row { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } }
    @media print { .site-header, .hero, .builder-sidebar, .preview-toolbar, .document-header, .site-footer, .toast { display: none !important; } .builder-layout { display: block; } .preview-panel { padding: 0; } .document-container { box-shadow: none; } .document-body { padding: 0.5in; } .doc-highlight { background: none !important; border: none !important; padding: 0 !important; } }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <nav class="header-nav">
        <a href="/" class="nav-link home-logo"><span class="logo-text">Terms.Law</span></a>
        <a href="/Demand-Letters/demand-letters-landing.html" class="nav-link">Demands</a>
        <a href="contract-library-landing.html" class="nav-link active">Contracts</a>
        <a href="/INC/formation-landing.html" class="nav-link">Incorporation</a>
        <a href="/Blog/" class="nav-link">Blog</a>
      </nav>
    </div>
  </header>
  <section class="hero">
    <div class="hero-content">
      <div class="hero-badge">Equity Transaction</div>
      <h1><span class="highlight">Stock Purchase</span> Agreement Generator</h1>
      <p class="hero-subtitle">Create a comprehensive Stock Purchase Agreement with representations, warranties, closing conditions, and indemnification provisions.</p>
    </div>
  </section>
  <main class="builder-layout">
    <aside class="builder-sidebar">
      <div class="builder-section">
        <h3 class="builder-section-title">Transaction Type</h3>
        <label class="type-card selected" id="typePrimaryCard">
          <input type="radio" name="transType" value="primary" checked onchange="updateTransType()">
          <div class="type-name">Primary Issuance</div>
          <div class="type-desc">Company issues new shares directly to buyer</div>
        </label>
        <label class="type-card" id="typeSecondaryCard">
          <input type="radio" name="transType" value="secondary" onchange="updateTransType()">
          <div class="type-name">Secondary Sale</div>
          <div class="type-desc">Existing shareholder sells shares to buyer</div>
        </label>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Company Information</h3>
        <div class="form-group">
          <label class="form-label">Company Name</label>
          <input type="text" id="companyName" class="form-input" placeholder="Acme Corporation" oninput="trackFieldEdit('companyName')">
        </div>
        <div class="form-group">
          <label class="form-label">State of Incorporation</label>
          <select id="incState" class="form-select" onchange="trackFieldEdit('incState')">
            <option value="Delaware">Delaware</option>
            <option value="California">California</option>
            <option value="New York">New York</option>
            <option value="Texas">Texas</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Company Address</label>
          <input type="text" id="companyAddress" class="form-input" placeholder="123 Business Ave, Suite 100" oninput="trackFieldEdit('companyAddress')">
        </div>
      </div>
      <div class="builder-section" id="sellerSection" style="display: none;">
        <h3 class="builder-section-title">Seller Information</h3>
        <div class="form-group">
          <label class="form-label">Seller Name</label>
          <input type="text" id="sellerName" class="form-input" placeholder="John Smith" oninput="trackFieldEdit('sellerName')">
        </div>
        <div class="form-group">
          <label class="form-label">Seller Address</label>
          <input type="text" id="sellerAddress" class="form-input" placeholder="456 Seller St, City, State ZIP" oninput="trackFieldEdit('sellerAddress')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Buyer Information</h3>
        <div class="form-group">
          <label class="form-label">Buyer Name</label>
          <input type="text" id="buyerName" class="form-input" placeholder="Jane Investor" oninput="trackFieldEdit('buyerName')">
        </div>
        <div class="form-group">
          <label class="form-label">Buyer Type</label>
          <select id="buyerType" class="form-select" onchange="trackFieldEdit('buyerType')">
            <option value="individual">Individual</option>
            <option value="entity">Entity (LLC, Corp, etc.)</option>
            <option value="trust">Trust</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Buyer Address</label>
          <input type="text" id="buyerAddress" class="form-input" placeholder="789 Buyer Blvd, City, State ZIP" oninput="trackFieldEdit('buyerAddress')">
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Stock Details</h3>
        <div class="form-group">
          <label class="form-label">Stock Class</label>
          <select id="stockClass" class="form-select" onchange="trackFieldEdit('stockClass')">
            <option value="Common">Common Stock</option>
            <option value="Series A Preferred">Series A Preferred Stock</option>
            <option value="Series B Preferred">Series B Preferred Stock</option>
            <option value="Series Seed Preferred">Series Seed Preferred Stock</option>
          </select>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Number of Shares</label>
            <input type="number" id="numShares" class="form-input" placeholder="100000" oninput="trackFieldEdit('numShares')">
          </div>
          <div class="form-group">
            <label class="form-label">Price Per Share ($)</label>
            <input type="number" step="0.0001" id="pricePerShare" class="form-input" placeholder="1.00" oninput="trackFieldEdit('pricePerShare')">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Total Purchase Price</label>
          <input type="text" id="totalPrice" class="form-input" readonly>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Closing</h3>
        <div class="form-group">
          <label class="form-label">Closing Date</label>
          <input type="date" id="closingDate" class="form-input" oninput="trackFieldEdit('closingDate')">
        </div>
        <div class="form-group">
          <label class="form-label">Payment Method</label>
          <select id="paymentMethod" class="form-select" onchange="trackFieldEdit('paymentMethod')">
            <option value="wire">Wire Transfer</option>
            <option value="check">Check</option>
            <option value="escrow">Escrow</option>
          </select>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Representations & Warranties</h3>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="repOrg" checked onchange="updatePreview()">
            <label for="repOrg">Organization & Good Standing</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repAuth" checked onchange="updatePreview()">
            <label for="repAuth">Authorization</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repCap" checked onchange="updatePreview()">
            <label for="repCap">Capitalization</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repLit" checked onchange="updatePreview()">
            <label for="repLit">No Litigation</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repIP" onchange="updatePreview()">
            <label for="repIP">Intellectual Property</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repTax" onchange="updatePreview()">
            <label for="repTax">Tax Matters</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="repCompliance" onchange="updatePreview()">
            <label for="repCompliance">Compliance with Laws</label>
          </div>
        </div>
      </div>
      <div class="builder-section">
        <h3 class="builder-section-title">Additional Provisions</h3>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="provROFR" onchange="updatePreview()">
            <label for="provROFR">Right of First Refusal</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provCoSale" onchange="updatePreview()">
            <label for="provCoSale">Co-Sale Rights</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provLockup" onchange="updatePreview()">
            <label for="provLockup">Lock-up Period</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="provLegend" checked onchange="updatePreview()">
            <label for="provLegend">Stock Certificate Legend</label>
          </div>
        </div>
        <div class="form-group" id="lockupPeriodGroup" style="display: none; margin-top: 0.75rem;">
          <label class="form-label">Lock-up Period (months)</label>
          <input type="number" id="lockupPeriod" class="form-input" value="12" oninput="updatePreview()">
        </div>
      </div>
    </aside>
    <section class="preview-panel">
      <div class="preview-toolbar">
        <span class="preview-title">LIVE PREVIEW</span>
        <div class="preview-actions">
          <button class="btn btn-secondary" onclick="toggleFullEdit()">Full Edit Mode</button>
          <button class="btn btn-secondary" onclick="copyToClipboard()">Copy</button>
          <button class="btn btn-secondary" onclick="window.print()">Print</button>
          <button class="btn btn-primary" onclick="downloadDocument()">Download</button>
        </div>
      </div>
      <div class="document-container">
        <div class="document-header">
          <span class="document-title">Stock Purchase Agreement</span>
          <span class="document-status">Auto-saved</span>
        </div>
        <div class="document-body" id="documentBody">
          <!-- Generated by JS -->
        </div>
      </div>
    </section>
  </main>
  <footer class="site-footer">
    <div class="footer-brand"><span class="logo-text">Terms.Law</span></div>
    <p>Free legal document tools for startups and businesses</p>
  </footer>
  <div class="toast" id="toast"></div>

  <script>
    let fullEditMode = false;

    const fieldMap = {
      companyName: 'field-companyName',
      incState: 'field-incState',
      companyAddress: 'field-companyAddress',
      sellerName: 'field-sellerName',
      sellerAddress: 'field-sellerAddress',
      buyerName: 'field-buyerName',
      buyerType: 'field-buyerType',
      buyerAddress: 'field-buyerAddress',
      stockClass: 'field-stockClass',
      numShares: 'field-numShares',
      pricePerShare: 'field-pricePerShare',
      closingDate: 'field-closingDate',
      paymentMethod: 'field-paymentMethod'
    };

    function trackFieldEdit(fieldId) {
      updatePreview();
      const targetId = fieldMap[fieldId];
      if (targetId) {
        setTimeout(() => {
          const el = document.getElementById(targetId);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            el.classList.remove('field-highlight-animation');
            void el.offsetWidth;
            el.classList.add('field-highlight-animation');
          }
        }, 100);
      }
    }

    function updateTransType() {
      const type = document.querySelector('input[name="transType"]:checked').value;
      document.querySelectorAll('.type-card').forEach(card => card.classList.remove('selected'));
      document.getElementById(`type${type.charAt(0).toUpperCase() + type.slice(1)}Card`).classList.add('selected');
      document.getElementById('sellerSection').style.display = type === 'secondary' ? 'block' : 'none';
      updatePreview();
    }

    function getVal(id, def = '') {
      const el = document.getElementById(id);
      return el ? (el.value || def) : def;
    }

    function getChecked(id) {
      const el = document.getElementById(id);
      return el ? el.checked : false;
    }

    function formatDate(dateStr) {
      if (!dateStr) return '[Closing Date]';
      const d = new Date(dateStr);
      return d.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    function formatCurrency(num) {
      if (!num) return '$0.00';
      return '$' + parseFloat(num).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function formatNumber(num) {
      if (!num) return '0';
      return parseInt(num).toLocaleString();
    }

    function span(id, val) {
      const isEmpty = !val || val.startsWith('[');
      return `<span class="doc-highlight${isEmpty ? ' empty' : ''}" id="${id}" contenteditable="true">${val || '[Not Specified]'}</span>`;
    }

    function updatePreview() {
      const transType = document.querySelector('input[name="transType"]:checked').value;
      const companyName = getVal('companyName', '[Company Name]');
      const state = getVal('incState', 'Delaware');
      const companyAddress = getVal('companyAddress', '[Company Address]');
      const sellerName = getVal('sellerName', '[Seller Name]');
      const sellerAddress = getVal('sellerAddress', '[Seller Address]');
      const buyerName = getVal('buyerName', '[Buyer Name]');
      const buyerType = getVal('buyerType', 'individual');
      const buyerAddress = getVal('buyerAddress', '[Buyer Address]');
      const stockClass = getVal('stockClass', 'Common');
      const numShares = getVal('numShares', '0');
      const pricePerShare = getVal('pricePerShare', '0');
      const closingDate = formatDate(getVal('closingDate'));
      const paymentMethod = getVal('paymentMethod', 'wire');

      // Calculate total
      const total = parseFloat(numShares || 0) * parseFloat(pricePerShare || 0);
      document.getElementById('totalPrice').value = formatCurrency(total);

      // Show/hide lockup period input
      document.getElementById('lockupPeriodGroup').style.display = getChecked('provLockup') ? 'block' : 'none';
      const lockupPeriod = getVal('lockupPeriod', '12');

      const paymentText = paymentMethod === 'wire' ? 'wire transfer of immediately available funds' :
                          paymentMethod === 'check' ? 'certified or cashier\'s check' :
                          'deposit into an escrow account';

      const isPrimary = transType === 'primary';
      const sellerParty = isPrimary ? companyName : sellerName;

      // Representations
      let repsSection = '';
      let repNum = 1;

      if (getChecked('repOrg')) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Organization and Good Standing</div>
          <p class="doc-paragraph">${isPrimary ? 'The Company' : 'Seller'} represents and warrants that ${isPrimary ? companyName : 'they are'} ${isPrimary ? 'is' : ''} a corporation duly organized, validly existing, and in good standing under the laws of the State of ${state}, with full corporate power and authority to own its properties and conduct its business as presently conducted.</p>
        `;
        repNum++;
      }

      if (getChecked('repAuth')) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Authorization</div>
          <p class="doc-paragraph">${isPrimary ? 'The Company' : 'Seller'} has full power and authority to execute, deliver, and perform this Agreement. The execution and delivery of this Agreement and the consummation of the transactions contemplated hereby have been duly authorized by all necessary ${isPrimary ? 'corporate' : ''} action.</p>
        `;
        repNum++;
      }

      if (getChecked('repCap') && isPrimary) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Capitalization</div>
          <p class="doc-paragraph">The authorized capital stock of the Company and the number of shares of each class outstanding are as set forth in Schedule A attached hereto. All outstanding shares have been duly authorized, validly issued, fully paid, and are non-assessable. The Shares, when issued and paid for in accordance with this Agreement, will be duly authorized, validly issued, fully paid, and non-assessable.</p>
        `;
        repNum++;
      }

      if (getChecked('repLit')) {
        repsSection += `
          <div class="doc-subsection">${repNum}. No Litigation</div>
          <p class="doc-paragraph">There is no action, suit, proceeding, or investigation pending or, to the knowledge of ${isPrimary ? 'the Company' : 'Seller'}, threatened against ${isPrimary ? 'the Company' : 'Seller or the Shares'} that would adversely affect the ability to consummate the transactions contemplated by this Agreement.</p>
        `;
        repNum++;
      }

      if (getChecked('repIP') && isPrimary) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Intellectual Property</div>
          <p class="doc-paragraph">The Company owns or has the right to use all intellectual property necessary for the conduct of its business as currently conducted. To the Company's knowledge, the Company's business does not infringe upon the intellectual property rights of any third party.</p>
        `;
        repNum++;
      }

      if (getChecked('repTax') && isPrimary) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Tax Matters</div>
          <p class="doc-paragraph">The Company has timely filed all tax returns required to be filed by it and has paid all taxes shown to be due and payable on such returns. There are no pending tax audits or assessments against the Company.</p>
        `;
        repNum++;
      }

      if (getChecked('repCompliance') && isPrimary) {
        repsSection += `
          <div class="doc-subsection">${repNum}. Compliance with Laws</div>
          <p class="doc-paragraph">The Company is in compliance with all applicable laws, rules, and regulations, except where failure to comply would not have a material adverse effect on the Company's business or financial condition.</p>
        `;
        repNum++;
      }

      // Additional provisions
      let additionalProvisions = '';
      let provNum = 1;

      if (getChecked('provROFR')) {
        additionalProvisions += `
          <div class="doc-subsection">${provNum}. Right of First Refusal</div>
          <p class="doc-paragraph">Before any transfer of the Shares, Buyer shall first offer the Shares to the Company (or its designees) at the same price and on the same terms as the proposed transfer. The Company shall have thirty (30) days to exercise this right of first refusal.</p>
        `;
        provNum++;
      }

      if (getChecked('provCoSale')) {
        additionalProvisions += `
          <div class="doc-subsection">${provNum}. Co-Sale Rights</div>
          <p class="doc-paragraph">If any shareholder holding more than 5% of the Company's outstanding shares proposes to transfer shares to a third party, Buyer shall have the right to participate in such sale on a pro rata basis on the same terms and conditions.</p>
        `;
        provNum++;
      }

      if (getChecked('provLockup')) {
        additionalProvisions += `
          <div class="doc-subsection">${provNum}. Lock-up Period</div>
          <p class="doc-paragraph">Buyer agrees not to sell, transfer, or otherwise dispose of any of the Shares for a period of ${lockupPeriod} months following the Closing Date, except with the prior written consent of the Company or pursuant to an underwritten public offering.</p>
        `;
        provNum++;
      }

      if (getChecked('provLegend')) {
        additionalProvisions += `
          <div class="doc-subsection">${provNum}. Stock Certificate Legend</div>
          <p class="doc-paragraph">Each certificate representing Shares shall bear the following legend:</p>
          <p class="doc-paragraph" style="font-style: italic; padding: 10px; background: #f8fafc; border-left: 3px solid var(--color-primary);">"THE SHARES REPRESENTED BY THIS CERTIFICATE HAVE NOT BEEN REGISTERED UNDER THE SECURITIES ACT OF 1933, AS AMENDED, OR ANY STATE SECURITIES LAWS, AND MAY NOT BE SOLD, TRANSFERRED, OR OTHERWISE DISPOSED OF EXCEPT PURSUANT TO AN EFFECTIVE REGISTRATION STATEMENT OR AN EXEMPTION FROM REGISTRATION UNDER SUCH ACT AND APPLICABLE STATE SECURITIES LAWS."</p>
        `;
        provNum++;
      }

      const html = `
        <div class="doc-title">STOCK PURCHASE AGREEMENT</div>

        <p class="doc-paragraph">This Stock Purchase Agreement (this "Agreement") is entered into as of ${span('field-closingDate', closingDate)}, by and between:</p>

        ${isPrimary ? `
          <p class="doc-paragraph"><strong>${span('field-companyName', companyName)}</strong>, a ${span('field-incState', state)} corporation, with its principal place of business at ${span('field-companyAddress', companyAddress)} (the "Company"),</p>
        ` : `
          <p class="doc-paragraph"><strong>${span('field-sellerName', sellerName)}</strong>, an individual residing at ${span('field-sellerAddress', sellerAddress)} (the "Seller"),</p>
        `}

        <p class="doc-paragraph">and</p>

        <p class="doc-paragraph"><strong>${span('field-buyerName', buyerName)}</strong>, ${buyerType === 'individual' ? 'an individual residing at' : buyerType === 'entity' ? 'a [State] [entity type], with its principal place of business at' : 'a trust located at'} ${span('field-buyerAddress', buyerAddress)} (the "Buyer").</p>

        ${!isPrimary ? `
          <p class="doc-paragraph">The Company referenced herein is ${span('field-companyName', companyName)}, a ${span('field-incState', state)} corporation (the "Company").</p>
        ` : ''}

        <div class="doc-section-header">RECITALS</div>

        <p class="doc-paragraph">A. ${isPrimary ? 'The Company desires to issue and sell, and the' : 'The Seller is the owner of, and desires to sell to the'} Buyer ${isPrimary ? 'desires to purchase from the Company,' : ', and Buyer desires to purchase from Seller,'} ${span('field-numShares', formatNumber(numShares))} shares of ${span('field-stockClass', stockClass)} (the "Shares") of ${companyName}.</p>

        <p class="doc-paragraph">B. The parties desire to set forth the terms and conditions upon which such purchase and sale shall be effected.</p>

        <p class="doc-paragraph"><strong>NOW, THEREFORE</strong>, in consideration of the mutual covenants and agreements set forth herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>

        <div class="doc-section-header">ARTICLE 1 - PURCHASE AND SALE</div>

        <div class="doc-subsection">1.1 Sale of Shares</div>
        <p class="doc-paragraph">Subject to the terms and conditions of this Agreement, ${isPrimary ? 'the Company agrees to issue and sell to Buyer' : 'Seller agrees to sell to Buyer'}, and Buyer agrees to purchase from ${isPrimary ? 'the Company' : 'Seller'}, the Shares.</p>

        <div class="doc-subsection">1.2 Purchase Price</div>
        <p class="doc-paragraph">The purchase price for the Shares shall be ${span('field-pricePerShare', formatCurrency(pricePerShare))} per share, for an aggregate purchase price of <strong>${formatCurrency(total)}</strong> (the "Purchase Price").</p>

        <div class="doc-subsection">1.3 Payment</div>
        <p class="doc-paragraph">At the Closing, Buyer shall pay the Purchase Price to ${isPrimary ? 'the Company' : 'Seller'} by ${paymentText}.</p>

        <div class="doc-section-header">ARTICLE 2 - CLOSING</div>

        <div class="doc-subsection">2.1 Closing Date</div>
        <p class="doc-paragraph">The closing of the purchase and sale of the Shares (the "Closing") shall take place on ${span('field-closingDate', closingDate)}, or at such other time and place as the parties may mutually agree (the "Closing Date").</p>

        <div class="doc-subsection">2.2 Deliveries at Closing</div>
        <p class="doc-paragraph">At the Closing:</p>
        <ul class="doc-list">
          <li>Buyer shall deliver the Purchase Price to ${isPrimary ? 'the Company' : 'Seller'};</li>
          <li>${isPrimary ? 'The Company' : 'Seller'} shall deliver to Buyer a stock certificate representing the Shares, registered in the name of Buyer;</li>
          ${isPrimary ? '<li>The Company shall update its stock ledger to reflect Buyer as a shareholder;</li>' : '<li>Seller shall deliver all stock powers and other documents necessary to transfer the Shares;</li>'}
          <li>Each party shall deliver any other documents reasonably requested by the other party to consummate the transactions contemplated by this Agreement.</li>
        </ul>

        <div class="doc-section-header">ARTICLE 3 - REPRESENTATIONS AND WARRANTIES OF ${isPrimary ? 'THE COMPANY' : 'SELLER'}</div>

        <p class="doc-paragraph">${isPrimary ? 'The Company' : 'Seller'} represents and warrants to Buyer as follows:</p>

        ${repsSection}

        ${!isPrimary ? `
          <div class="doc-subsection">${repNum}. Title to Shares</div>
          <p class="doc-paragraph">Seller is the sole record and beneficial owner of the Shares, free and clear of all liens, encumbrances, security interests, and claims of any kind. Seller has full power and authority to sell, transfer, and deliver the Shares to Buyer.</p>
        ` : ''}

        <div class="doc-section-header">ARTICLE 4 - REPRESENTATIONS AND WARRANTIES OF BUYER</div>

        <p class="doc-paragraph">Buyer represents and warrants to ${isPrimary ? 'the Company' : 'Seller'} as follows:</p>

        <div class="doc-subsection">1. Authorization</div>
        <p class="doc-paragraph">Buyer has full power and authority to execute, deliver, and perform this Agreement. ${buyerType === 'entity' ? 'The execution and delivery of this Agreement have been duly authorized by all necessary corporate or other action.' : ''}</p>

        <div class="doc-subsection">2. Investment Intent</div>
        <p class="doc-paragraph">Buyer is acquiring the Shares for investment for Buyer's own account and not with a view to, or for sale in connection with, any distribution thereof in violation of federal or state securities laws.</p>

        <div class="doc-subsection">3. Accredited Investor</div>
        <p class="doc-paragraph">Buyer is an "accredited investor" as defined in Rule 501 of Regulation D promulgated under the Securities Act of 1933, as amended.</p>

        <div class="doc-subsection">4. Access to Information</div>
        <p class="doc-paragraph">Buyer has had the opportunity to ask questions of and receive answers from ${isPrimary ? 'the Company' : 'Seller'} concerning the Company and the Shares, and has had access to such information as Buyer considers necessary to make an informed investment decision.</p>

        <div class="doc-subsection">5. Risk Acknowledgment</div>
        <p class="doc-paragraph">Buyer understands that the purchase of the Shares involves a high degree of risk and that there can be no assurance that the objectives of the Company will be achieved or that the Shares will appreciate in value or be able to be sold.</p>

        ${additionalProvisions ? `
          <div class="doc-section-header">ARTICLE 5 - ADDITIONAL PROVISIONS</div>
          ${additionalProvisions}
        ` : ''}

        <div class="doc-section-header">ARTICLE ${additionalProvisions ? '6' : '5'} - INDEMNIFICATION</div>

        <div class="doc-subsection">1. Indemnification by ${isPrimary ? 'the Company' : 'Seller'}</div>
        <p class="doc-paragraph">${isPrimary ? 'The Company' : 'Seller'} shall indemnify and hold harmless Buyer from and against any and all losses, damages, liabilities, costs, and expenses (including reasonable attorneys' fees) arising out of or resulting from any breach of any representation, warranty, or covenant of ${isPrimary ? 'the Company' : 'Seller'} contained in this Agreement.</p>

        <div class="doc-subsection">2. Indemnification by Buyer</div>
        <p class="doc-paragraph">Buyer shall indemnify and hold harmless ${isPrimary ? 'the Company' : 'Seller'} from and against any and all losses, damages, liabilities, costs, and expenses (including reasonable attorneys' fees) arising out of or resulting from any breach of any representation, warranty, or covenant of Buyer contained in this Agreement.</p>

        <div class="doc-section-header">ARTICLE ${additionalProvisions ? '7' : '6'} - MISCELLANEOUS</div>

        <div class="doc-subsection">1. Entire Agreement</div>
        <p class="doc-paragraph">This Agreement constitutes the entire agreement between the parties with respect to the subject matter hereof and supersedes all prior agreements and understandings, both written and oral.</p>

        <div class="doc-subsection">2. Amendments</div>
        <p class="doc-paragraph">This Agreement may be amended only by a written instrument signed by both parties.</p>

        <div class="doc-subsection">3. Governing Law</div>
        <p class="doc-paragraph">This Agreement shall be governed by and construed in accordance with the laws of the State of ${state}, without regard to its conflict of laws principles.</p>

        <div class="doc-subsection">4. Notices</div>
        <p class="doc-paragraph">All notices and other communications hereunder shall be in writing and shall be deemed given when delivered personally, sent by overnight courier, or mailed by certified mail, return receipt requested, to the parties at their addresses set forth above.</p>

        <div class="doc-subsection">5. Counterparts</div>
        <p class="doc-paragraph">This Agreement may be executed in counterparts, each of which shall be deemed an original, but all of which together shall constitute one and the same instrument.</p>

        <div class="doc-subsection">6. Successors and Assigns</div>
        <p class="doc-paragraph">This Agreement shall be binding upon and inure to the benefit of the parties and their respective heirs, executors, administrators, successors, and assigns.</p>

        <p class="doc-paragraph" style="margin-top: 30px;"><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Stock Purchase Agreement as of the date first written above.</p>

        <div class="doc-signature-row">
          ${isPrimary ? `
            <div>
              <div class="doc-signature-party-title">${companyName}</div>
              <div class="doc-signature-line">
                <span class="sig-label">Signature:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Print Name:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Title:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Date:</span>
                <span class="sig-value"></span>
              </div>
            </div>
          ` : `
            <div>
              <div class="doc-signature-party-title">Seller</div>
              <div class="doc-signature-line">
                <span class="sig-label">Signature:</span>
                <span class="sig-value"></span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Print Name:</span>
                <span class="sig-value">${sellerName}</span>
              </div>
              <div class="doc-signature-line">
                <span class="sig-label">Date:</span>
                <span class="sig-value"></span>
              </div>
            </div>
          `}
          <div>
            <div class="doc-signature-party-title">Buyer</div>
            <div class="doc-signature-line">
              <span class="sig-label">Signature:</span>
              <span class="sig-value"></span>
            </div>
            <div class="doc-signature-line">
              <span class="sig-label">Print Name:</span>
              <span class="sig-value">${buyerName}</span>
            </div>
            ${buyerType === 'entity' ? `
              <div class="doc-signature-line">
                <span class="sig-label">Title:</span>
                <span class="sig-value"></span>
              </div>
            ` : ''}
            <div class="doc-signature-line">
              <span class="sig-label">Date:</span>
              <span class="sig-value"></span>
            </div>
          </div>
        </div>
      `;

      document.getElementById('documentBody').innerHTML = html;
    }

    function toggleFullEdit() {
      fullEditMode = !fullEditMode;
      document.getElementById('documentBody').classList.toggle('full-edit-mode', fullEditMode);
      showToast(fullEditMode ? 'Full edit mode enabled - edit any text directly' : 'Full edit mode disabled');
    }

    function copyToClipboard() {
      const content = document.getElementById('documentBody').innerText;
      navigator.clipboard.writeText(content).then(() => {
        showToast('Copied to clipboard!', 'success');
      });
    }

    function downloadDocument() {
      const content = document.getElementById('documentBody').innerHTML;
      const companyName = getVal('companyName', 'Company');
      const buyerName = getVal('buyerName', 'Buyer');

      const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Stock Purchase Agreement - ${companyName}</title>
  <style>
    body { font-family: Georgia, 'Times New Roman', serif; font-size: 13px; line-height: 1.8; max-width: 8.5in; margin: 0 auto; padding: 1in; }
    .doc-title { text-align: center; font-size: 16px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 25px; }
    .doc-section-header { font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 4px; }
    .doc-subsection { font-size: 11px; font-weight: bold; margin-top: 12px; margin-bottom: 6px; }
    .doc-paragraph { margin-bottom: 12px; text-align: justify; }
    .doc-list { margin: 12px 0 12px 20px; padding-left: 15px; }
    .doc-list li { margin-bottom: 8px; }
    .doc-highlight { background: none; border: none; padding: 0; font-weight: normal; }
    .doc-signature-row { display: flex; flex-wrap: wrap; gap: 30px; margin-top: 40px; }
    .doc-signature-party-title { font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 15px; color: #666; }
    .doc-signature-line { margin-bottom: 8px; min-height: 30px; }
    .sig-label { display: inline-block; width: 80px; font-size: 10px; color: #666; }
    .sig-value { display: inline-block; border-bottom: 1px solid #333; min-width: 200px; }
  </style>
</head>
<body>${content}</body>
</html>`;

      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `Stock-Purchase-Agreement-${companyName.replace(/[^a-zA-Z0-9]/g, '-')}-${buyerName.replace(/[^a-zA-Z0-9]/g, '-')}.html`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Document downloaded!', 'success');
    }

    function showToast(message, type = '') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'toast' + (type ? ' ' + type : '');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updatePreview();
    });
  </script>
</body>
</html>
