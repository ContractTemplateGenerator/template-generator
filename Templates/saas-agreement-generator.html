<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-901N2Y3CDZ');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaaS Subscription Agreement Generator | Terms.Law</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e40af;
            --primary-dark: #1e3a8a;
            --secondary: #475569;
            --accent: #f59e0b;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            text-decoration: none;
        }

        .nav-divider {
            color: rgba(255, 255, 255, 0.5);
        }

        .nav-title {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: white;
        }

        /* Main Layout */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 2rem;
            align-items: start;
        }

        /* Form Panel */
        .form-panel {
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 80px;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .form-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px 12px 0 0;
        }

        .form-header h2 {
            font-size: 1.25rem;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .form-header p {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .form-content {
            padding: 1.5rem;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 0.375rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.75rem;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
        }

        .help-text {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }

        /* Action Buttons */
        .form-actions {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--background);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* Document Preview */
        .preview-panel {
            background: var(--surface);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .preview-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .preview-header h3 {
            font-size: 1rem;
            color: var(--text);
        }

        .preview-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .preview-actions .btn {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .edit-mode-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #fef3c7;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #92400e;
        }

        .edit-mode-toggle input {
            accent-color: var(--warning);
        }

        .document-container {
            padding: 2rem;
            max-width: 850px;
            margin: 0 auto;
        }

        .document {
            background: white;
            padding: 3rem;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            line-height: 1.8;
            font-size: 14px;
        }

        .document h1 {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .document h2 {
            font-size: 1.1rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text);
        }

        .document p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .document .parties {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .document .section {
            margin-bottom: 1.5rem;
        }

        .document .section-number {
            font-weight: 600;
        }

        .document .subsection {
            margin-left: 1.5rem;
            margin-bottom: 0.5rem;
        }

        /* Signature Block */
        .signature-block {
            margin-top: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .signature-party h4 {
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .signature-line {
            border-top: 1px solid var(--text);
            margin-top: 3rem;
            padding-top: 0.5rem;
        }

        .signature-field {
            margin-top: 1rem;
        }

        .signature-field span {
            display: block;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Highlight Styles */
        .doc-highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 1px 4px;
            border-radius: 3px;
            border-bottom: 2px solid var(--accent);
            transition: all 0.2s;
        }

        .doc-highlight:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
        }

        .doc-highlight:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3);
        }

        /* Scroll-to-view highlight animation */
        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); }
        }

        @keyframes flashContainer {
            0% { background-color: transparent; }
            30% { background-color: rgba(245, 158, 11, 0.2); }
            100% { background-color: transparent; }
        }

        .field-highlight-animation {
            animation: highlightPulse 0.6s ease-out;
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%) !important;
        }

        .section-highlight-animation {
            animation: flashContainer 1s ease-out;
        }

        /* Full Edit Mode Styles */
        .full-edit-mode .document {
            border: 2px dashed var(--warning);
        }

        .full-edit-warning {
            display: none;
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.85rem;
            color: #92400e;
        }

        .full-edit-mode .full-edit-warning {
            display: block;
        }

        /* Print Styles */
        @media print {
            .navbar, .form-panel, .preview-header, .full-edit-warning {
                display: none !important;
            }

            .main-container {
                display: block;
                padding: 0;
            }

            .preview-panel {
                box-shadow: none;
            }

            .document-container {
                padding: 0;
            }

            .document {
                border: none;
                box-shadow: none;
                padding: 0;
            }

            .doc-highlight {
                background: none !important;
                border: none !important;
                padding: 0 !important;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .form-panel {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 640px) {
            .navbar {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }

            .main-container {
                padding: 1rem;
            }

            .document {
                padding: 1.5rem;
            }

            .signature-block {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="https://terms.law" class="nav-logo">Terms.Law</a>
                <span class="nav-divider">|</span>
                <span class="nav-title">SaaS Subscription Agreement Generator</span>
            </div>
            <div class="nav-links">
                <a href="/Templates/">Contract Library</a>
                <a href="/Blog/">Blog</a>
                <a href="https://terms.law">Home</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Form Panel -->
        <div class="form-panel">
            <div class="form-header">
                <h2>☁️ Agreement Details</h2>
                <p>Generate a SaaS subscription agreement for your software service</p>
            </div>

            <div class="form-content">
                <!-- Provider Information -->
                <div class="form-section">
                    <div class="section-title">Provider Information</div>
                    <div class="form-group">
                        <label for="providerName">Company Name</label>
                        <input type="text" id="providerName" placeholder="Acme Software, Inc." oninput="trackFieldEdit('providerName')">
                    </div>
                    <div class="form-group">
                        <label for="providerAddress">Business Address</label>
                        <input type="text" id="providerAddress" placeholder="123 Tech Lane, San Francisco, CA 94102" oninput="trackFieldEdit('providerAddress')">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="providerState">State of Incorporation</label>
                            <select id="providerState" onchange="trackFieldEdit('providerState')">
                                <option value="">Select State</option>
                                <option value="Delaware">Delaware</option>
                                <option value="California">California</option>
                                <option value="New York">New York</option>
                                <option value="Texas">Texas</option>
                                <option value="Florida">Florida</option>
                                <option value="Washington">Washington</option>
                                <option value="Nevada">Nevada</option>
                                <option value="Wyoming">Wyoming</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="providerEntity">Entity Type</label>
                            <select id="providerEntity" onchange="trackFieldEdit('providerEntity')">
                                <option value="Corporation">Corporation</option>
                                <option value="LLC">LLC</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="providerEmail">Support Email</label>
                        <input type="email" id="providerEmail" placeholder="support@company.com" oninput="trackFieldEdit('providerEmail')">
                    </div>
                </div>

                <!-- Customer Information -->
                <div class="form-section">
                    <div class="section-title">Customer Information</div>
                    <div class="form-group">
                        <label for="customerName">Customer Name</label>
                        <input type="text" id="customerName" placeholder="Customer Corp" oninput="trackFieldEdit('customerName')">
                    </div>
                    <div class="form-group">
                        <label for="customerAddress">Business Address</label>
                        <input type="text" id="customerAddress" placeholder="456 Business Ave, New York, NY 10001" oninput="trackFieldEdit('customerAddress')">
                    </div>
                    <div class="form-group">
                        <label for="customerContact">Contact Person</label>
                        <input type="text" id="customerContact" placeholder="John Smith" oninput="trackFieldEdit('customerContact')">
                    </div>
                    <div class="form-group">
                        <label for="customerEmail">Contact Email</label>
                        <input type="email" id="customerEmail" placeholder="john@customer.com" oninput="trackFieldEdit('customerEmail')">
                    </div>
                </div>

                <!-- Service Details -->
                <div class="form-section">
                    <div class="section-title">Service Details</div>
                    <div class="form-group">
                        <label for="serviceName">Service/Product Name</label>
                        <input type="text" id="serviceName" placeholder="CloudApp Pro" oninput="trackFieldEdit('serviceName')">
                    </div>
                    <div class="form-group">
                        <label for="serviceDescription">Service Description</label>
                        <textarea id="serviceDescription" placeholder="A cloud-based project management and collaboration platform..." oninput="trackFieldEdit('serviceDescription')"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="serviceUrl">Service URL</label>
                        <input type="text" id="serviceUrl" placeholder="https://app.cloudapp.com" oninput="trackFieldEdit('serviceUrl')">
                    </div>
                </div>

                <!-- Subscription Terms -->
                <div class="form-section">
                    <div class="section-title">Subscription Terms</div>
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date</label>
                        <input type="date" id="effectiveDate" oninput="trackFieldEdit('effectiveDate')">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="subscriptionTerm">Initial Term</label>
                            <select id="subscriptionTerm" onchange="trackFieldEdit('subscriptionTerm')">
                                <option value="monthly">Monthly</option>
                                <option value="annual" selected>Annual (12 months)</option>
                                <option value="2-year">2 Years</option>
                                <option value="3-year">3 Years</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="autoRenewal">Auto-Renewal</label>
                            <select id="autoRenewal" onchange="trackFieldEdit('autoRenewal')">
                                <option value="yes" selected>Yes, auto-renew</option>
                                <option value="no">No auto-renewal</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="renewalNotice">Cancellation Notice Period (days)</label>
                        <input type="number" id="renewalNotice" placeholder="30" value="30" oninput="trackFieldEdit('renewalNotice')">
                    </div>
                </div>

                <!-- Pricing -->
                <div class="form-section">
                    <div class="section-title">Pricing & Payment</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="subscriptionFee">Subscription Fee ($)</label>
                            <input type="number" id="subscriptionFee" placeholder="499.00" step="0.01" oninput="trackFieldEdit('subscriptionFee')">
                        </div>
                        <div class="form-group">
                            <label for="billingCycle">Billing Cycle</label>
                            <select id="billingCycle" onchange="trackFieldEdit('billingCycle')">
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="annually" selected>Annually</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="paymentTerms">Payment Due</label>
                        <select id="paymentTerms" onchange="trackFieldEdit('paymentTerms')">
                            <option value="advance">In Advance</option>
                            <option value="net30">Net 30</option>
                            <option value="net15">Net 15</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="userSeats">Number of User Seats</label>
                        <input type="number" id="userSeats" placeholder="10" value="10" oninput="trackFieldEdit('userSeats')">
                    </div>
                    <div class="form-group">
                        <label for="additionalSeatFee">Additional Seat Fee ($)</label>
                        <input type="number" id="additionalSeatFee" placeholder="49.00" step="0.01" value="49.00" oninput="trackFieldEdit('additionalSeatFee')">
                    </div>
                </div>

                <!-- Service Level -->
                <div class="form-section">
                    <div class="section-title">Service Level Agreement</div>
                    <div class="form-group">
                        <label for="uptimeGuarantee">Uptime Guarantee (%)</label>
                        <select id="uptimeGuarantee" onchange="trackFieldEdit('uptimeGuarantee')">
                            <option value="99.0">99.0%</option>
                            <option value="99.5">99.5%</option>
                            <option value="99.9" selected>99.9%</option>
                            <option value="99.99">99.99%</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="supportLevel">Support Level</label>
                        <select id="supportLevel" onchange="trackFieldEdit('supportLevel')">
                            <option value="standard">Standard (Business Hours)</option>
                            <option value="priority">Priority (Extended Hours)</option>
                            <option value="premium">Premium (24/7)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="responseTime">Initial Response Time</label>
                        <select id="responseTime" onchange="trackFieldEdit('responseTime')">
                            <option value="24hours">24 hours</option>
                            <option value="8hours" selected>8 business hours</option>
                            <option value="4hours">4 hours</option>
                            <option value="1hour">1 hour</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeSLA" checked onchange="trackFieldEdit('includeSLA')">
                        <label for="includeSLA">Include SLA credits for downtime</label>
                    </div>
                </div>

                <!-- Data & Security -->
                <div class="form-section">
                    <div class="section-title">Data & Security</div>
                    <div class="form-group">
                        <label for="dataLocation">Data Storage Location</label>
                        <select id="dataLocation" onchange="trackFieldEdit('dataLocation')">
                            <option value="United States" selected>United States</option>
                            <option value="European Union">European Union</option>
                            <option value="Customer Choice">Customer Choice</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeBAA" onchange="trackFieldEdit('includeBAA')">
                        <label for="includeBAA">HIPAA Business Associate Agreement (BAA)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeDPA" onchange="trackFieldEdit('includeDPA')">
                        <label for="includeDPA">GDPR Data Processing Addendum (DPA)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="dataExport" checked onchange="trackFieldEdit('dataExport')">
                        <label for="dataExport">Data export available upon request</label>
                    </div>
                    <div class="form-group">
                        <label for="dataRetention">Data Retention After Termination (days)</label>
                        <input type="number" id="dataRetention" placeholder="30" value="30" oninput="trackFieldEdit('dataRetention')">
                    </div>
                </div>

                <!-- Legal Terms -->
                <div class="form-section">
                    <div class="section-title">Legal Terms</div>
                    <div class="form-group">
                        <label for="governingLaw">Governing Law</label>
                        <select id="governingLaw" onchange="trackFieldEdit('governingLaw')">
                            <option value="">Same as Provider State</option>
                            <option value="Delaware">Delaware</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Texas">Texas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="disputeResolution">Dispute Resolution</label>
                        <select id="disputeResolution" onchange="trackFieldEdit('disputeResolution')">
                            <option value="litigation">Litigation</option>
                            <option value="arbitration" selected>Binding Arbitration</option>
                            <option value="mediation">Mediation then Arbitration</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="liabilityLimit">Liability Limit</label>
                        <select id="liabilityLimit" onchange="trackFieldEdit('liabilityLimit')">
                            <option value="12months" selected>12 months of fees paid</option>
                            <option value="6months">6 months of fees paid</option>
                            <option value="totalfees">Total fees paid under agreement</option>
                            <option value="custom">Custom amount</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="updatePreview()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Generate Agreement
                </button>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="preview-panel" id="previewPanel">
            <div class="preview-header">
                <h3>Document Preview</h3>
                <div class="preview-actions">
                    <div class="edit-mode-toggle">
                        <input type="checkbox" id="fullEditMode" onchange="toggleFullEditMode()">
                        <label for="fullEditMode">Full Edit Mode</label>
                    </div>
                    <button class="btn btn-secondary" onclick="printDocument()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 6 2 18 2 18 9"></polyline>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                    <button class="btn btn-success" onclick="downloadWord()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Word
                    </button>
                </div>
            </div>

            <div class="document-container">
                <div class="full-edit-warning">
                    ⚠️ <strong>Full Edit Mode Active:</strong> You can now directly edit any text in the document below.
                    Changes made in this mode will NOT sync back to the form fields. Generating a new preview will overwrite your edits.
                </div>
                <div class="document" id="documentPreview">
                    <p style="text-align: center; color: var(--text-light); padding: 3rem;">
                        Fill in the form fields and click "Generate Agreement" to preview your document.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let lastEditedField = null;
        let hasCustomEdits = false;

        // Track field edits for scroll-to-view
        function trackFieldEdit(fieldId) {
            if (hasCustomEdits) {
                const proceed = confirm('You have made custom edits to the document. Generating a new preview will overwrite those changes. Continue?');
                if (!proceed) return;
                hasCustomEdits = false;
            }
            lastEditedField = fieldId;
            updatePreview();
        }

        // Full edit mode
        function toggleFullEditMode() {
            const isEnabled = document.getElementById('fullEditMode').checked;
            const previewPanel = document.getElementById('previewPanel');
            const documentEl = document.getElementById('documentPreview');

            if (isEnabled) {
                previewPanel.classList.add('full-edit-mode');
                documentEl.contentEditable = true;
                documentEl.addEventListener('input', markCustomEdits);
            } else {
                previewPanel.classList.remove('full-edit-mode');
                documentEl.contentEditable = false;
                documentEl.removeEventListener('input', markCustomEdits);
            }
        }

        function markCustomEdits() {
            hasCustomEdits = true;
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2
            }).format(amount);
        }

        // Format date
        function formatDate(dateString) {
            if (!dateString) return '[DATE]';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        // Get subscription term text
        function getTermText(term) {
            switch(term) {
                case 'monthly': return 'one (1) month';
                case 'annual': return 'twelve (12) months';
                case '2-year': return 'twenty-four (24) months';
                case '3-year': return 'thirty-six (36) months';
                default: return 'twelve (12) months';
            }
        }

        // Get billing cycle text
        function getBillingText(cycle) {
            switch(cycle) {
                case 'monthly': return 'monthly';
                case 'quarterly': return 'quarterly';
                case 'annually': return 'annually';
                default: return 'annually';
            }
        }

        // Get support level text
        function getSupportText(level) {
            switch(level) {
                case 'standard': return 'Standard support during Provider\'s regular business hours (9:00 AM to 5:00 PM Pacific Time, Monday through Friday, excluding holidays)';
                case 'priority': return 'Priority support during extended hours (7:00 AM to 9:00 PM Pacific Time, Monday through Friday)';
                case 'premium': return 'Premium 24/7 support, including weekends and holidays';
                default: return 'Standard support during Provider\'s regular business hours';
            }
        }

        // Get response time text
        function getResponseText(time) {
            switch(time) {
                case '24hours': return 'twenty-four (24) hours';
                case '8hours': return 'eight (8) business hours';
                case '4hours': return 'four (4) hours';
                case '1hour': return 'one (1) hour';
                default: return 'eight (8) business hours';
            }
        }

        // Get liability text
        function getLiabilityText(limit) {
            switch(limit) {
                case '12months': return 'the total fees paid by Customer to Provider during the twelve (12) month period immediately preceding the claim';
                case '6months': return 'the total fees paid by Customer to Provider during the six (6) month period immediately preceding the claim';
                case 'totalfees': return 'the total fees paid by Customer to Provider under this Agreement';
                case 'custom': return '[CUSTOM AMOUNT]';
                default: return 'the total fees paid by Customer to Provider during the twelve (12) month period immediately preceding the claim';
            }
        }

        // Generate document preview
        function updatePreview() {
            const providerName = document.getElementById('providerName').value.trim() || '[PROVIDER NAME]';
            const providerAddress = document.getElementById('providerAddress').value.trim() || '[PROVIDER ADDRESS]';
            const providerState = document.getElementById('providerState').value || '[STATE]';
            const providerEntity = document.getElementById('providerEntity').value;
            const providerEmail = document.getElementById('providerEmail').value.trim() || '[SUPPORT EMAIL]';

            const customerName = document.getElementById('customerName').value.trim() || '[CUSTOMER NAME]';
            const customerAddress = document.getElementById('customerAddress').value.trim() || '[CUSTOMER ADDRESS]';
            const customerContact = document.getElementById('customerContact').value.trim() || '[CONTACT NAME]';
            const customerEmail = document.getElementById('customerEmail').value.trim() || '[CUSTOMER EMAIL]';

            const serviceName = document.getElementById('serviceName').value.trim() || '[SERVICE NAME]';
            const serviceDescription = document.getElementById('serviceDescription').value.trim() || '[Service description to be specified]';
            const serviceUrl = document.getElementById('serviceUrl').value.trim() || '[SERVICE URL]';

            const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
            const subscriptionTerm = document.getElementById('subscriptionTerm').value;
            const autoRenewal = document.getElementById('autoRenewal').value === 'yes';
            const renewalNotice = document.getElementById('renewalNotice').value || '30';

            const subscriptionFee = parseFloat(document.getElementById('subscriptionFee').value) || 0;
            const billingCycle = document.getElementById('billingCycle').value;
            const paymentTerms = document.getElementById('paymentTerms').value;
            const userSeats = document.getElementById('userSeats').value || '10';
            const additionalSeatFee = parseFloat(document.getElementById('additionalSeatFee').value) || 0;

            const uptimeGuarantee = document.getElementById('uptimeGuarantee').value;
            const supportLevel = document.getElementById('supportLevel').value;
            const responseTime = document.getElementById('responseTime').value;
            const includeSLA = document.getElementById('includeSLA').checked;

            const dataLocation = document.getElementById('dataLocation').value;
            const includeBAA = document.getElementById('includeBAA').checked;
            const includeDPA = document.getElementById('includeDPA').checked;
            const dataExport = document.getElementById('dataExport').checked;
            const dataRetention = document.getElementById('dataRetention').value || '30';

            const governingLaw = document.getElementById('governingLaw').value || providerState;
            const disputeResolution = document.getElementById('disputeResolution').value;
            const liabilityLimit = document.getElementById('liabilityLimit').value;

            // Build SLA credits section
            let slaCreditsSection = '';
            if (includeSLA) {
                slaCreditsSection = `
                    <p>4.4 <strong>Service Credits.</strong> If Provider fails to meet the Uptime Commitment in any calendar month, Customer shall be entitled to a credit as follows:</p>
                    <p class="subsection">(a) Uptime between 99.0% and ${uptimeGuarantee}%: Credit equal to 10% of that month's fees;</p>
                    <p class="subsection">(b) Uptime between 95.0% and 98.99%: Credit equal to 25% of that month's fees;</p>
                    <p class="subsection">(c) Uptime below 95.0%: Credit equal to 50% of that month's fees.</p>
                    <p>4.5 <strong>Credit Request.</strong> Customer must request service credits in writing within thirty (30) days of the end of the affected month. Credits will be applied to the next billing cycle and are Customer's sole remedy for Provider's failure to meet the Uptime Commitment.</p>
                `;
            }

            // Build BAA section
            let baaSection = '';
            if (includeBAA) {
                baaSection = `
                    <p class="subsection">(d) To the extent Customer's use of the Service involves Protected Health Information (PHI) as defined under HIPAA, the parties shall execute a Business Associate Agreement in the form attached as Exhibit B.</p>
                `;
            }

            // Build DPA section
            let dpaSection = '';
            if (includeDPA) {
                dpaSection = `
                    <p class="subsection">(e) To the extent the GDPR applies to Customer's use of the Service, the parties agree to the Data Processing Addendum attached as Exhibit C, which is incorporated by reference.</p>
                `;
            }

            // Build data export section
            let dataExportSection = '';
            if (dataExport) {
                dataExportSection = `<p>7.3 <strong>Data Export.</strong> Upon Customer's written request, Provider shall make Customer Data available for export in a commonly used, machine-readable format within ten (10) business days of such request.</p>`;
            }

            // Payment terms text
            let paymentTermsText = '';
            if (paymentTerms === 'advance') {
                paymentTermsText = 'in advance';
            } else if (paymentTerms === 'net30') {
                paymentTermsText = 'within thirty (30) days of invoice date';
            } else {
                paymentTermsText = 'within fifteen (15) days of invoice date';
            }

            // Dispute resolution section
            let disputeSection = '';
            if (disputeResolution === 'arbitration') {
                disputeSection = `<p>12.2 <strong>Arbitration.</strong> Any dispute arising out of or relating to this Agreement shall be resolved by binding arbitration administered by the American Arbitration Association in accordance with its Commercial Arbitration Rules. The arbitration shall be conducted in ${governingLaw}, and judgment on the award may be entered in any court having jurisdiction. Each party shall bear its own costs and attorneys' fees.</p>`;
            } else if (disputeResolution === 'mediation') {
                disputeSection = `<p>12.2 <strong>Mediation and Arbitration.</strong> Any dispute arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful, the dispute shall be resolved by binding arbitration administered by the American Arbitration Association in ${governingLaw}.</p>`;
            } else {
                disputeSection = `<p>12.2 <strong>Jurisdiction.</strong> Any legal action arising out of this Agreement shall be brought exclusively in the state or federal courts located in ${governingLaw}, and each party consents to the jurisdiction of such courts.</p>`;
            }

            const documentHTML = `
                <h1>SAAS SUBSCRIPTION AGREEMENT</h1>

                <div class="parties">
                    <p>This SaaS Subscription Agreement (the "Agreement") is entered into as of <span class="doc-highlight" contenteditable="true" data-field="effectiveDate">${effectiveDate}</span> (the "Effective Date")</p>
                    <p><strong>by and between</strong></p>
                    <p><span class="doc-highlight" contenteditable="true" data-field="providerName">${providerName}</span>, a ${providerState} ${providerEntity} ("Provider")<br>
                    <span class="doc-highlight" contenteditable="true" data-field="providerAddress">${providerAddress}</span></p>
                    <p><strong>and</strong></p>
                    <p><span class="doc-highlight" contenteditable="true" data-field="customerName">${customerName}</span> ("Customer")<br>
                    <span class="doc-highlight" contenteditable="true" data-field="customerAddress">${customerAddress}</span></p>
                </div>

                <p><strong>RECITALS</strong></p>
                <p>WHEREAS, Provider operates a software-as-a-service platform known as <span class="doc-highlight" contenteditable="true" data-field="serviceName">${serviceName}</span> (the "Service"); and</p>
                <p>WHEREAS, Customer desires to subscribe to and use the Service subject to the terms and conditions set forth herein;</p>
                <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements hereinafter set forth, the parties agree as follows:</p>

                <div class="section">
                    <h2><span class="section-number">1.</span> DEFINITIONS</h2>
                    <p>1.1 <strong>"Customer Data"</strong> means all data, information, and content that Customer or its Authorized Users upload, submit, store, or transmit through the Service.</p>
                    <p>1.2 <strong>"Authorized Users"</strong> means Customer's employees, contractors, and agents who are authorized by Customer to access and use the Service under the rights granted pursuant to this Agreement.</p>
                    <p>1.3 <strong>"Documentation"</strong> means Provider's standard user guides, online help, and other documentation made available by Provider for use of the Service.</p>
                    <p>1.4 <strong>"Service"</strong> means <span class="doc-highlight" contenteditable="true" data-field="serviceDescription">${serviceDescription}</span>, accessible at <span class="doc-highlight" contenteditable="true" data-field="serviceUrl">${serviceUrl}</span>.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">2.</span> LICENSE GRANT AND RESTRICTIONS</h2>
                    <p>2.1 <strong>License Grant.</strong> Subject to the terms of this Agreement, Provider grants Customer a non-exclusive, non-transferable right to access and use the Service during the Subscription Term for Customer's internal business purposes, up to the number of Authorized Users specified herein.</p>
                    <p>2.2 <strong>Authorized Users.</strong> Customer is authorized to permit up to <span class="doc-highlight" contenteditable="true" data-field="userSeats">${userSeats}</span> Authorized Users to access and use the Service. Additional users may be added at <span class="doc-highlight" contenteditable="true" data-field="additionalSeatFee">${formatCurrency(additionalSeatFee)}</span> per user per month.</p>
                    <p>2.3 <strong>Use Restrictions.</strong> Customer shall not:</p>
                    <p class="subsection">(a) License, sublicense, sell, resell, transfer, assign, or otherwise dispose of or make available the Service to any third party;</p>
                    <p class="subsection">(b) Modify or make derivative works based upon the Service;</p>
                    <p class="subsection">(c) Reverse engineer, disassemble, or decompile the Service or attempt to access its source code;</p>
                    <p class="subsection">(d) Access the Service to build a competitive product or service;</p>
                    <p class="subsection">(e) Use the Service to store or transmit malicious code, or to engage in any unlawful activity;</p>
                    <p class="subsection">(f) Interfere with or disrupt the integrity or performance of the Service;</p>
                    <p class="subsection">(g) Attempt to gain unauthorized access to the Service or its related systems.</p>
                    <p>2.4 <strong>Responsibility for Users.</strong> Customer is responsible for all activities that occur under its account and for its Authorized Users' compliance with this Agreement.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">3.</span> SUBSCRIPTION TERM AND RENEWAL</h2>
                    <p>3.1 <strong>Subscription Term.</strong> The initial subscription term shall be <span class="doc-highlight" contenteditable="true" data-field="subscriptionTerm">${getTermText(subscriptionTerm)}</span>, commencing on the Effective Date (the "Initial Term").</p>
                    ${autoRenewal ? `<p>3.2 <strong>Renewal.</strong> Following the Initial Term, this Agreement shall automatically renew for successive periods equal to the Initial Term (each a "Renewal Term"), unless either party provides written notice of non-renewal at least <span class="doc-highlight" contenteditable="true" data-field="renewalNotice">${renewalNotice}</span> days prior to the end of the then-current term.</p>` : `<p>3.2 <strong>Expiration.</strong> This Agreement shall expire at the end of the Initial Term unless the parties mutually agree in writing to renew.</p>`}
                    <p>3.3 <strong>Termination for Convenience.</strong> Either party may terminate this Agreement at any time by providing <span class="doc-highlight" contenteditable="true" data-field="renewalNotice">${renewalNotice}</span> days' prior written notice. If Customer terminates for convenience prior to the end of the then-current term, Customer shall not be entitled to any refund of prepaid fees.</p>
                    <p>3.4 <strong>Termination for Cause.</strong> Either party may terminate this Agreement immediately upon written notice if the other party materially breaches this Agreement and fails to cure such breach within thirty (30) days of receiving written notice thereof.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">4.</span> SERVICE LEVEL AGREEMENT</h2>
                    <p>4.1 <strong>Uptime Commitment.</strong> Provider shall use commercially reasonable efforts to make the Service available <span class="doc-highlight" contenteditable="true" data-field="uptimeGuarantee">${uptimeGuarantee}%</span> of the time during each calendar month (the "Uptime Commitment"), excluding scheduled maintenance and circumstances beyond Provider's reasonable control.</p>
                    <p>4.2 <strong>Scheduled Maintenance.</strong> Provider shall use reasonable efforts to perform scheduled maintenance during off-peak hours and provide at least 24 hours' advance notice for planned downtime.</p>
                    <p>4.3 <strong>Support.</strong> Provider shall provide <span class="doc-highlight" contenteditable="true" data-field="supportLevel">${getSupportText(supportLevel)}</span>. Provider shall respond to support requests within <span class="doc-highlight" contenteditable="true" data-field="responseTime">${getResponseText(responseTime)}</span> of receipt.</p>
                    ${slaCreditsSection}
                </div>

                <div class="section">
                    <h2><span class="section-number">5.</span> FEES AND PAYMENT</h2>
                    <p>5.1 <strong>Subscription Fees.</strong> Customer shall pay Provider <span class="doc-highlight" contenteditable="true" data-field="subscriptionFee">${formatCurrency(subscriptionFee)}</span> <span class="doc-highlight" contenteditable="true" data-field="billingCycle">${getBillingText(billingCycle)}</span> for access to the Service (the "Subscription Fee").</p>
                    <p>5.2 <strong>Payment Terms.</strong> All fees are due and payable ${paymentTermsText}. Provider shall invoice Customer in accordance with the billing cycle selected above.</p>
                    <p>5.3 <strong>Late Payments.</strong> Any amounts not paid when due shall bear interest at the rate of 1.5% per month (or the maximum rate permitted by law, if less) from the due date until paid.</p>
                    <p>5.4 <strong>Taxes.</strong> All fees are exclusive of taxes. Customer shall be responsible for all sales, use, and excise taxes, and any other similar taxes, duties, and charges imposed by any governmental authority, excluding taxes based on Provider's income.</p>
                    <p>5.5 <strong>Price Increases.</strong> Provider may increase fees upon renewal by providing at least sixty (60) days' prior written notice before the start of any Renewal Term.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">6.</span> INTELLECTUAL PROPERTY</h2>
                    <p>6.1 <strong>Provider IP.</strong> Provider retains all right, title, and interest in and to the Service, including all software, technology, documentation, and any modifications or improvements thereto. Nothing in this Agreement transfers any ownership rights in the Service to Customer.</p>
                    <p>6.2 <strong>Customer Data.</strong> Customer retains all right, title, and interest in and to Customer Data. Customer grants Provider a limited license to use Customer Data solely to provide the Service to Customer.</p>
                    <p>6.3 <strong>Feedback.</strong> If Customer provides any suggestions, ideas, or feedback regarding the Service, Provider may freely use and incorporate such feedback without any obligation to Customer.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">7.</span> DATA SECURITY AND PRIVACY</h2>
                    <p>7.1 <strong>Security.</strong> Provider shall implement and maintain reasonable administrative, technical, and physical security measures designed to protect Customer Data against unauthorized access, disclosure, or destruction.</p>
                    <p>7.2 <strong>Data Location.</strong> Customer Data shall be stored in <span class="doc-highlight" contenteditable="true" data-field="dataLocation">${dataLocation}</span>.</p>
                    ${dataExportSection}
                    <p>7.4 <strong>Data Retention.</strong> Upon termination or expiration of this Agreement, Provider shall retain Customer Data for <span class="doc-highlight" contenteditable="true" data-field="dataRetention">${dataRetention}</span> days, during which time Customer may request an export. Thereafter, Provider shall delete Customer Data in accordance with its standard data retention policies.</p>
                    ${baaSection}
                    ${dpaSection}
                </div>

                <div class="section">
                    <h2><span class="section-number">8.</span> CONFIDENTIALITY</h2>
                    <p>8.1 <strong>Definition.</strong> "Confidential Information" means any non-public information disclosed by one party to the other that is designated as confidential or that reasonably should be understood to be confidential given the nature of the information.</p>
                    <p>8.2 <strong>Obligations.</strong> Each party agrees to: (a) maintain the confidentiality of the other party's Confidential Information using at least the same degree of care it uses to protect its own confidential information; (b) not disclose Confidential Information to any third party except as permitted herein; and (c) use Confidential Information solely for the purposes of this Agreement.</p>
                    <p>8.3 <strong>Exceptions.</strong> Confidential Information does not include information that: (a) is or becomes publicly available through no fault of the receiving party; (b) was rightfully known prior to disclosure; (c) is independently developed without use of Confidential Information; or (d) is rightfully obtained from a third party.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">9.</span> WARRANTIES AND DISCLAIMERS</h2>
                    <p>9.1 <strong>Provider Warranties.</strong> Provider warrants that: (a) the Service will perform materially in accordance with the Documentation; (b) Provider has the right to grant the licenses granted herein; and (c) Provider will provide the Service in compliance with applicable laws.</p>
                    <p>9.2 <strong>Customer Warranties.</strong> Customer warrants that: (a) it has the right to use and transmit Customer Data through the Service; and (b) Customer's use of the Service will comply with applicable laws and the terms of this Agreement.</p>
                    <p>9.3 <strong>DISCLAIMER.</strong> EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, THE SERVICE IS PROVIDED "AS IS" AND PROVIDER DISCLAIMS ALL OTHER WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT. PROVIDER DOES NOT WARRANT THAT THE SERVICE WILL BE UNINTERRUPTED OR ERROR-FREE.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">10.</span> LIMITATION OF LIABILITY</h2>
                    <p>10.1 <strong>Exclusion of Damages.</strong> IN NO EVENT SHALL EITHER PARTY BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING LOST PROFITS, LOST DATA, OR BUSINESS INTERRUPTION, ARISING OUT OF OR RELATING TO THIS AGREEMENT, REGARDLESS OF WHETHER SUCH DAMAGES WERE FORESEEABLE OR WHETHER EITHER PARTY WAS ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
                    <p>10.2 <strong>Liability Cap.</strong> EXCEPT FOR A PARTY'S INDEMNIFICATION OBLIGATIONS OR A PARTY'S BREACH OF SECTION 2 (LICENSE RESTRICTIONS) OR SECTION 8 (CONFIDENTIALITY), NEITHER PARTY'S TOTAL LIABILITY UNDER THIS AGREEMENT SHALL EXCEED <span class="doc-highlight" contenteditable="true" data-field="liabilityLimit">${getLiabilityText(liabilityLimit)}</span>.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">11.</span> INDEMNIFICATION</h2>
                    <p>11.1 <strong>By Provider.</strong> Provider shall indemnify, defend, and hold harmless Customer from any third-party claim alleging that the Service infringes any patent, copyright, or trademark, or misappropriates any trade secret, and shall pay any resulting damages, costs, and attorneys' fees.</p>
                    <p>11.2 <strong>By Customer.</strong> Customer shall indemnify, defend, and hold harmless Provider from any third-party claim arising from: (a) Customer Data; (b) Customer's breach of this Agreement; or (c) Customer's violation of applicable law.</p>
                </div>

                <div class="section">
                    <h2><span class="section-number">12.</span> GENERAL PROVISIONS</h2>
                    <p>12.1 <strong>Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span class="doc-highlight" contenteditable="true" data-field="governingLaw">${governingLaw}</span>, without regard to its conflict of laws principles.</p>
                    ${disputeSection}
                    <p>12.3 <strong>Assignment.</strong> Neither party may assign this Agreement without the prior written consent of the other party, except that either party may assign this Agreement to an affiliate or in connection with a merger, acquisition, or sale of all or substantially all of its assets.</p>
                    <p>12.4 <strong>Force Majeure.</strong> Neither party shall be liable for any failure or delay in performance due to causes beyond its reasonable control, including acts of God, war, terrorism, natural disasters, or government actions.</p>
                    <p>12.5 <strong>Notices.</strong> All notices under this Agreement shall be in writing and sent to the addresses set forth above, or to such other address as either party may designate in writing. Notices shall be deemed delivered when received if delivered personally or by confirmed email, three (3) business days after being sent by certified mail, or one (1) business day after being sent by overnight courier.</p>
                    <p>12.6 <strong>Entire Agreement.</strong> This Agreement, together with any exhibits and schedules, constitutes the entire agreement between the parties concerning its subject matter and supersedes all prior and contemporaneous agreements, proposals, and representations.</p>
                    <p>12.7 <strong>Amendments.</strong> This Agreement may not be amended or modified except by a written instrument signed by both parties.</p>
                    <p>12.8 <strong>Waiver.</strong> No waiver of any provision of this Agreement shall be effective unless in writing and signed by the waiving party.</p>
                    <p>12.9 <strong>Severability.</strong> If any provision of this Agreement is held invalid or unenforceable, the remaining provisions shall continue in full force and effect.</p>
                    <p>12.10 <strong>Counterparts.</strong> This Agreement may be executed in counterparts, each of which shall be deemed an original. Electronic signatures shall be deemed valid and binding.</p>
                </div>

                <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this SaaS Subscription Agreement as of the Effective Date.</p>

                <div class="signature-block">
                    <div class="signature-party">
                        <h4>PROVIDER:</h4>
                        <p><strong><span class="doc-highlight" contenteditable="true" data-field="providerName">${providerName}</span></strong></p>
                        <div class="signature-line">
                            <span>Signature</span>
                        </div>
                        <div class="signature-field">
                            <span>Name: ____________________</span>
                        </div>
                        <div class="signature-field">
                            <span>Title: ____________________</span>
                        </div>
                        <div class="signature-field">
                            <span>Date: ____________________</span>
                        </div>
                    </div>
                    <div class="signature-party">
                        <h4>CUSTOMER:</h4>
                        <p><strong><span class="doc-highlight" contenteditable="true" data-field="customerName">${customerName}</span></strong></p>
                        <div class="signature-line">
                            <span>Signature</span>
                        </div>
                        <div class="signature-field">
                            <span>Name: <span class="doc-highlight" contenteditable="true" data-field="customerContact">${customerContact}</span></span>
                        </div>
                        <div class="signature-field">
                            <span>Title: ____________________</span>
                        </div>
                        <div class="signature-field">
                            <span>Date: ____________________</span>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('documentPreview').innerHTML = documentHTML;

            // Set up inline editing sync
            setupInlineEditing();

            // Scroll to edited field
            if (lastEditedField) {
                setTimeout(() => {
                    const highlight = document.querySelector(`[data-field="${lastEditedField}"]`);
                    if (highlight) {
                        highlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        highlight.classList.add('field-highlight-animation');
                        setTimeout(() => highlight.classList.remove('field-highlight-animation'), 1500);
                    }
                    lastEditedField = null;
                }, 50);
            }
        }

        // Setup inline editing sync
        function setupInlineEditing() {
            const editableFields = document.querySelectorAll('.doc-highlight[data-field]');
            editableFields.forEach(field => {
                field.addEventListener('blur', function() {
                    const fieldId = this.dataset.field;
                    const value = this.textContent.trim();
                    const input = document.getElementById(fieldId);
                    if (input) {
                        if (input.type === 'date') {
                            const parsed = new Date(value);
                            if (!isNaN(parsed)) {
                                input.value = parsed.toISOString().split('T')[0];
                            }
                        } else if (input.type === 'number') {
                            const num = parseFloat(value.replace(/[^0-9.-]/g, ''));
                            if (!isNaN(num)) {
                                input.value = num;
                            }
                        } else {
                            input.value = value;
                        }
                    }
                    hasCustomEdits = true;
                });
            });
        }

        // Print document
        function printDocument() {
            window.print();
        }

        // Download as Word
        function downloadWord() {
            const content = document.getElementById('documentPreview').innerHTML;
            const providerName = document.getElementById('providerName').value.trim() || 'Provider';
            const customerName = document.getElementById('customerName').value.trim() || 'Customer';

            const styles = `
                <style>
                    body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; line-height: 1.6; margin: 1in; }
                    h1 { text-align: center; font-size: 16pt; margin-bottom: 12pt; }
                    h2 { font-size: 12pt; margin-top: 18pt; margin-bottom: 6pt; }
                    p { margin-bottom: 6pt; text-align: justify; }
                    .parties { text-align: center; margin-bottom: 24pt; }
                    .signature-block { margin-top: 36pt; }
                    .signature-party { display: inline-block; width: 45%; vertical-align: top; }
                    .signature-line { border-top: 1px solid black; margin-top: 48pt; padding-top: 6pt; }
                    .doc-highlight { background: none; border: none; padding: 0; }
                </style>
            `;

            const html = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>SaaS Subscription Agreement - ${providerName} and ${customerName}</title>
                    ${styles}
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `;

            const blob = new Blob([html], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `SaaS_Agreement_${providerName.replace(/[^a-z0-9]/gi, '_')}_${customerName.replace(/[^a-z0-9]/gi, '_')}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('effectiveDate').value = today;
        });
    </script>
</body>
</html>
