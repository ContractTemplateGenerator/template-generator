<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAFT (Simple Agreement for Future Tokens) Generator</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            color: #333;
            line-height: 1.6;
            background-color: #f9f9f9;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            background-color: #fff;
        }
        
        .form-section {
            flex: 1;
            padding: 20px;
            background-color: #f8f9fa;
            overflow-y: auto;
            max-height: 100vh;
            border-right: 1px solid #ddd;
        }
        
        .preview-section {
            flex: 1;
            padding: 20px;
            background-color: white;
            overflow-y: auto;
            max-height: 100vh;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        h2 {
            color: #3498db;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-top: 30px;
            font-size: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-top: 10px;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .download-btn {
            background-color: #27ae60;
            font-weight: bold;
        }
        
        .download-btn:hover {
            background-color: #219652;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            margin-right: 5px;
            border-radius: 4px 4px 0 0;
            background-color: #f1f1f1;
            margin-bottom: -1px;
        }
        
        .tab.active {
            background-color: white;
            border-color: #ddd;
            border-bottom-color: white;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .preview-document {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            font-size: 14px;
        }
        
        .highlight {
            background-color: #ffff80;
            transition: background-color 0.5s;
        }
        
        .preview-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .preview-section h3 {
            position: sticky;
            top: 0;
            background-color: white;
            padding: 10px 0;
            margin-top: 0;
            border-bottom: 1px solid #ddd;
            z-index: 10;
        }
        
        .calendly-button {
            text-align: center;
            margin-top: 20px;
        }
        
        .calendly-button a {
            display: inline-block;
            background-color: #0069ff;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
        }
        
        .info-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .form-section, .preview-section {
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Form Section -->
        <div class="form-section">
            <h1>Comprehensive SAFT (Simple Agreement for Future Tokens) Generator</h1>
            
            <div class="tabs">
                <div class="tab active" data-tab="company">Company</div>
                <div class="tab" data-tab="investor">Investor</div>
                <div class="tab" data-tab="investment">Investment</div>
                <div class="tab" data-tab="token">Token Terms</div>
                <div class="tab" data-tab="additional">Additional Terms</div>
            </div>
            
            <form id="saftForm">
                <!-- Company Information Tab -->
                <div class="tab-content active" id="company-tab">
                    <h2>Company Information</h2>
                    
                    <div class="form-group">
                        <label for="companyName">Company Name:</label>
                        <input type="text" id="companyName" name="companyName" placeholder="e.g., Blockchain Tech Inc.">
                    </div>
                    
                    <div class="form-group">
                        <label for="companyAddress">Company Address:</label>
                        <textarea id="companyAddress" name="companyAddress" rows="3" placeholder="Full company address"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="stateOfIncorporation">State of Incorporation:</label>
                        <select id="stateOfIncorporation" name="stateOfIncorporation">
                            <option value="">Select State</option>
                            <option value="Delaware">Delaware</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Wyoming">Wyoming</option>
                            <option value="Nevada">Nevada</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Florida">Florida</option>
                            <option value="Texas">Texas</option>
                            <option value="Washington">Washington</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="companyEmail">Company Email:</label>
                        <input type="email" id="companyEmail" name="companyEmail" placeholder="contact@company.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="signatoryName">Authorized Signatory Name:</label>
                        <input type="text" id="signatoryName" name="signatoryName" placeholder="e.g., John Smith">
                    </div>
                    
                    <div class="form-group">
                        <label for="signatoryTitle">Authorized Signatory Title:</label>
                        <input type="text" id="signatoryTitle" name="signatoryTitle" placeholder="e.g., CEO">
                    </div>
                </div>
                
                <!-- Investor Information Tab -->
                <div class="tab-content" id="investor-tab">
                    <h2>Investor Information</h2>
                    
                    <div class="form-group">
                        <label for="investorType">Investor Type:</label>
                        <select id="investorType" name="investorType">
                            <option value="individual">Individual</option>
                            <option value="entity">Entity (Company, LLC, etc.)</option>
                            <option value="trust">Trust</option>
                            <option value="partnership">Partnership</option>
                            <option value="investment_fund">Investment Fund</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="investorName">Investor Name:</label>
                        <input type="text" id="investorName" name="investorName" placeholder="Full legal name">
                    </div>
                    
                    <div class="form-group">
                        <label for="investorAddress">Investor Address:</label>
                        <textarea id="investorAddress" name="investorAddress" rows="3" placeholder="Full legal address"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="investorEmail">Investor Email:</label>
                        <input type="email" id="investorEmail" name="investorEmail" placeholder="investor@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="investorPhone">Investor Phone:</label>
                        <input type="tel" id="investorPhone" name="investorPhone" placeholder="e.g., +1 (555) 123-4567">
                    </div>
                    
                    <div class="form-group entity-only" style="display: none;">
                        <label for="investorSignatoryName">Authorized Signatory Name:</label>
                        <input type="text" id="investorSignatoryName" name="investorSignatoryName" placeholder="e.g., Jane Doe">
                    </div>
                    
                    <div class="form-group entity-only" style="display: none;">
                        <label for="investorSignatoryTitle">Authorized Signatory Title:</label>
                        <input type="text" id="investorSignatoryTitle" name="investorSignatoryTitle" placeholder="e.g., Managing Partner">
                    </div>
                    
                    <div class="form-group">
                        <label for="accreditedInvestor">Accredited Investor:</label>
                        <select id="accreditedInvestor" name="accreditedInvestor">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                        <p class="info-text">Note: SAFTs are generally limited to accredited investors under U.S. securities laws.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="accreditationBasis">Basis for Accreditation:</label>
                        <select id="accreditationBasis" name="accreditationBasis">
                            <option value="">Select Basis</option>
                            <option value="income">Income (Individual with $200K+ or Joint with $300K+)</option>
                            <option value="net_worth">Net Worth (Individual or Joint $1M+)</option>
                            <option value="professional">Financial Professional</option>
                            <option value="entity_assets">Entity with $5M+ in Assets</option>
                            <option value="insiders">Company Insider</option>
                            <option value="other">Other Qualified Basis</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="investorCountry">Investor Country of Residence/Incorporation:</label>
                        <input type="text" id="investorCountry" name="investorCountry" placeholder="e.g., United States">
                    </div>
                    
                    <div class="form-group">
                        <label for="kyc_aml_completed">KYC/AML Verification Completed:</label>
                        <select id="kyc_aml_completed" name="kyc_aml_completed">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                            <option value="pending">Pending</option>
                        </select>
                    </div>
                </div>
                
                <!-- Investment Terms Tab -->
                <div class="tab-content" id="investment-tab">
                    <h2>Investment Terms</h2>
                    
                    <div class="form-group">
                        <label for="purchaseAmount">Purchase Amount (USD):</label>
                        <input type="number" id="purchaseAmount" name="purchaseAmount" min="0" step="0.01" placeholder="e.g., 50000">
                    </div>
                    
                    <div class="form-group">
                        <label for="paymentMethod">Payment Method:</label>
                        <select id="paymentMethod" name="paymentMethod">
                            <option value="wire">Wire Transfer</option>
                            <option value="crypto">Cryptocurrency</option>
                            <option value="check">Check</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group crypto-only" style="display: none;">
                        <label for="cryptoCurrency">Cryptocurrency:</label>
                        <select id="cryptoCurrency" name="cryptoCurrency">
                            <option value="BTC">Bitcoin (BTC)</option>
                            <option value="ETH">Ethereum (ETH)</option>
                            <option value="USDC">USD Coin (USDC)</option>
                            <option value="USDT">Tether (USDT)</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group crypto-only" style="display: none;">
                        <label for="cryptoAddress">Company's Crypto Wallet Address:</label>
                        <input type="text" id="cryptoAddress" name="cryptoAddress" placeholder="e.g., 0x71C7656EC7ab88b098defB751B7401B5f6d8976F">
                    </div>
                    
                    <div class="form-group">
                        <label for="valuationCap">Valuation Cap (USD):</label>
                        <input type="number" id="valuationCap" name="valuationCap" min="0" step="1" placeholder="e.g., 5000000">
                    </div>
                    
                    <div class="form-group">
                        <label for="discount">Discount Rate (%):</label>
                        <input type="number" id="discount" name="discount" min="0" max="100" step="0.1" placeholder="e.g., 20">
                    </div>
                    
                    <div class="form-group">
                        <label for="minimumRaise">Minimum Fundraising Target (USD):</label>
                        <input type="number" id="minimumRaise" name="minimumRaise" min="0" step="1" placeholder="e.g., 1000000">
                    </div>
                    
                    <div class="form-group">
                        <label for="maximumRaise">Maximum Fundraising Cap (USD):</label>
                        <input type="number" id="maximumRaise" name="maximumRaise" min="0" step="1" placeholder="e.g., 5000000">
                    </div>
                    
                    <div class="form-group">
                        <label for="closingDate">Closing Date:</label>
                        <input type="date" id="closingDate" name="closingDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="terminationDate">Termination Date:</label>
                        <input type="date" id="terminationDate" name="terminationDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="dissolutionPayout">Dissolution Event Payout:</label>
                        <select id="dissolutionPayout" name="dissolutionPayout">
                            <option value="principal">Principal Only</option>
                            <option value="interest">Principal Plus Interest</option>
                            <option value="premium">Principal Plus Premium</option>
                        </select>
                    </div>
                    
                    <div class="form-group interest-premium-only" style="display: none;">
                        <label for="interestRate">Interest/Premium Rate (% per annum):</label>
                        <input type="number" id="interestRate" name="interestRate" min="0" max="100" step="0.1" placeholder="e.g., 5">
                    </div>
                </div>
                
                <!-- Token Terms Tab -->
                <div class="tab-content" id="token-tab">
                    <h2>Token Terms</h2>
                    
                    <div class="form-group">
                        <label for="tokenName">Token Name:</label>
                        <input type="text" id="tokenName" name="tokenName" placeholder="e.g., ExampleCoin">
                    </div>
                    
                    <div class="form-group">
                        <label for="tokenSymbol">Token Symbol:</label>
                        <input type="text" id="tokenSymbol" name="tokenSymbol" placeholder="e.g., EXC">
                    </div>
                    
                    <div class="form-group">
                        <label for="tokenStandard">Token Standard:</label>
                        <select id="tokenStandard" name="tokenStandard">
                            <option value="erc20">ERC-20 (Ethereum)</option>
                            <option value="bep20">BEP-20 (Binance Smart Chain)</option>
                            <option value="spl">SPL (Solana)</option>
                            <option value="other">Other Standard</option>
                            <option value="custom">Custom Blockchain</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="networkLaunchDeadline">Network Launch Deadline:</label>
                        <input type="date" id="networkLaunchDeadline" name="networkLaunchDeadline">
                    </div>
                    
                    <div class="form-group">
                        <label for="totalSupply">Total Token Supply:</label>
                        <input type="number" id="totalSupply" name="totalSupply" min="0" step="1" placeholder="e.g., 100000000">
                    </div>
                    
                    <div class="form-group">
                        <label for="tokenUseCase">Token Use Case Description:</label>
                        <textarea id="tokenUseCase" name="tokenUseCase" rows="3" placeholder="Brief description of the token's utility and use case"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="tokenRights">Token Rights:</label>
                        <select id="tokenRights" name="tokenRights" multiple>
                            <option value="utility">Utility/Platform Access</option>
                            <option value="governance">Governance Rights</option>
                            <option value="staking">Staking Rewards</option>
                            <option value="discount">Platform Fee Discounts</option>
                            <option value="dividend">Profit Sharing/Dividends</option>
                            <option value="none">No Special Rights (Pure Utility)</option>
                        </select>
                        <p class="info-text">Hold Ctrl/Cmd to select multiple options</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="vestingPeriod">Vesting Period (months):</label>
                        <input type="number" id="vestingPeriod" name="vestingPeriod" min="0" step="1" placeholder="e.g., 12">
                    </div>
                    
                    <div class="form-group">
                        <label for="initialReleasePercentage">Initial Release Percentage (%):</label>
                        <input type="number" id="initialReleasePercentage" name="initialReleasePercentage" min="0" max="100" step="1" placeholder="e.g., 25">
                    </div>
                    
                    <div class="form-group">
                        <label for="vestingSchedule">Vesting Schedule:</label>
                        <select id="vestingSchedule" name="vestingSchedule">
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="annually">Annually</option>
                            <option value="cliff">Cliff Vesting</option>
                            <option value="milestone">Milestone-Based</option>
                        </select>
                    </div>
                    
                    <div class="form-group milestone-only" style="display: none;">
                        <label for="milestones">Milestone Description:</label>
                        <textarea id="milestones" name="milestones" rows="3" placeholder="Description of milestones that trigger token releases"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="lockupPeriod">Post-Network Launch Lockup Period (days):</label>
                        <input type="number" id="lockupPeriod" name="lockupPeriod" min="0" step="1" placeholder="e.g., 90">
                    </div>
                </div>
                
                <!-- Additional Terms Tab -->
                <div class="tab-content" id="additional-tab">
                    <h2>Additional Terms</h2>
                    
                    <div class="form-group">
                        <label for="governingLaw">Governing Law:</label>
                        <select id="governingLaw" name="governingLaw">
                            <option value="">Select State</option>
                            <option value="Delaware">Delaware</option>
                            <option value="California">California</option>
                            <option value="New York">New York</option>
                            <option value="Wyoming">Wyoming</option>
                            <option value="Nevada">Nevada</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Florida">Florida</option>
                            <option value="Texas">Texas</option>
                            <option value="Washington">Washington</option>
                            <option value="other_us">Other US State</option>
                            <option value="non_us">Non-US Jurisdiction</option>
                        </select>
                    </div>
                    
                    <div class="form-group other-jurisdiction" style="display: none;">
                        <label for="otherJurisdiction">Specify Jurisdiction:</label>
                        <input type="text" id="otherJurisdiction" name="otherJurisdiction" placeholder="e.g., Singapore, United Kingdom, etc.">
                    </div>
                    
                    <div class="form-group">
                        <label for="disputeResolution">Dispute Resolution:</label>
                        <select id="disputeResolution" name="disputeResolution">
                            <option value="courts">Courts</option>
                            <option value="arbitration">Binding Arbitration</option>
                            <option value="mediation">Mediation First, Then Courts</option>
                            <option value="hybrid">Mediation, Then Arbitration</option>
                        </select>
                    </div>
                    
                    <div class="form-group arbitration-only" style="display: none;">
                        <label for="arbitrationVenue">Arbitration Venue:</label>
                        <input type="text" id="arbitrationVenue" name="arbitrationVenue" placeholder="e.g., San Francisco, CA">
                    </div>
                    
                    <div class="form-group arbitration-only" style="display: none;">
                        <label for="arbitrationRules">Arbitration Rules:</label>
                        <select id="arbitrationRules" name="arbitrationRules">
                            <option value="aaa">American Arbitration Association (AAA)</option>
                            <option value="jams">JAMS</option>
                            <option value="icc">International Chamber of Commerce (ICC)</option>
                            <option value="uncitral">UNCITRAL</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="confidentiality">Confidentiality Clause:</label>
                        <select id="confidentiality" name="confidentiality">
                            <option value="yes">Include</option>
                            <option value="no">Exclude</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="transferRestrictions">Transfer Restrictions:</label>
                        <select id="transferRestrictions" name="transferRestrictions">
                            <option value="yes">Include</option>
                            <option value="no">Exclude</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="mostFavoredNation">Most Favored Nation Clause:</label>
                        <select id="mostFavoredNation" name="mostFavoredNation">
                            <option value="yes">Include</option>
                            <option value="no">Exclude</option>
                        </select>
                        <p class="info-text">Ensures investor receives best terms offered to future SAFT purchasers</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="proRataRights">Pro-Rata Rights for Future Rounds:</label>
                        <select id="proRataRights" name="proRataRights">
                            <option value="yes">Include</option>
                            <option value="no">Exclude</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="informationRights">Information Rights:</label>
                        <select id="informationRights" name="informationRights">
                            <option value="none">None</option>
                            <option value="basic">Basic (Quarterly Updates)</option>
                            <option value="standard">Standard (Financial Reports)</option>
                            <option value="comprehensive">Comprehensive (Financial + Development Reports)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="regulatoryCompliance">Regulatory Compliance Provisions:</label>
                        <select id="regulatoryCompliance" name="regulatoryCompliance" multiple>
                            <option value="aml">Anti-Money Laundering (AML)</option>
                            <option value="kyc">Know Your Customer (KYC)</option>
                            <option value="sanctions">Sanctions Compliance</option>
                            <option value="securities">Securities Law Compliance</option>
                            <option value="tax">Tax Reporting</option>
                        </select>
                        <p class="info-text">Hold Ctrl/Cmd to select multiple options</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="additionalTerms">Additional Custom Terms:</label>
                        <textarea id="additionalTerms" name="additionalTerms" rows="5" placeholder="Enter any additional terms you want to include in the agreement"></textarea>
                    </div>
                    
                    <div class="calendly-button">
                        <p>Need legal advice on your SAFT?</p>
                        <a href="" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">Schedule a consultation</a>
                    </div>
                </div>
                
                <div class="nav-buttons">
                    <button type="button" id="prevBtn">Previous</button>
                    <button type="button" id="nextBtn">Next</button>
                    <button type="button" id="downloadBtn" class="download-btn">Download as Word Document</button>
                </div>
            </form>
        </div>
        
        <!-- Preview Section -->
        <div class="preview-section">
            <h3>Live Preview</h3>
            <div class="preview-document" id="previewDocument">
                <div class="preview-title">SIMPLE AGREEMENT FOR FUTURE TOKENS (SAFT)</div>
                <p>This Simple Agreement for Future Tokens (the "Agreement") is dated as of <span id="preview-closingDate">[CLOSING DATE]</span> by and between <span id="preview-companyName">[COMPANY NAME]</span>, a <span id="preview-stateOfIncorporation">[STATE]</span> corporation (the "Company"), and <span id="preview-investorName">[INVESTOR NAME]</span> (the "Purchaser").</p>
                
                <p><strong>WHEREAS</strong>, the Purchaser desires to purchase a right to certain units of <span id="preview-tokenName">[TOKEN NAME]</span> (the "<span id="preview-tokenSymbol">[TOKEN SYMBOL]</span>" or "Tokens") to be developed, produced and issued by the Company at a future point in time, and the Company desires to issue and sell such right to the Purchaser;</p>
                
                <p><strong>WHEREAS</strong>, the Company intends to develop, produce and issue the Tokens as part of a decentralized blockchain-based network (the "Network") that it is creating;</p>
                
                <p><strong>NOW, THEREFORE</strong>, in consideration of the mutual covenants and agreements herein contained, the parties hereto agree as follows:</p>
                
                <p><strong>1. Events</strong></p>
                
                <p><strong>1.1 Network Launch.</strong> The Company will use reasonable best efforts to launch the Network on or before <span id="preview-networkLaunchDeadline">[NETWORK LAUNCH DEADLINE]</span>. Upon launch of the Network, the Company will issue the Tokens to the Purchaser pursuant to the terms set forth herein.</p>
                
                <p><strong>1.2 Dissolution Event.</strong> If there is a Dissolution Event before this instrument terminates, the Company will pay an amount equal to the Purchase Amount, to the Purchaser immediately prior to or concurrent with the consummation of the Dissolution Event.</p>
                
                <p><strong>1.3 Termination.</strong> This Agreement will terminate upon the earlier of (i) the issuance of Tokens to the Purchaser pursuant to Section 1.1; (ii) the payment of amounts due to the Purchaser pursuant to Section 1.2; and (iii) <span id="preview-terminationDate">[TERMINATION DATE]</span> (the "Termination Date"), if the Network Launch has not occurred as of such date.</p>
                
                <p><strong>2. Purchase and Sale</strong></p>
                
                <p><strong>2.1 Purchase Amount.</strong> The Purchaser hereby purchases from the Company, and the Company hereby sells to the Purchaser, the right to certain units of Tokens in exchange for <span id="preview-purchaseAmount">[PURCHASE AMOUNT]</span> USD (the "Purchase Amount").</p>
                
                <p><strong>2.2 Payment Method.</strong> The Purchaser will deliver the Purchase Amount to the Company via <span id="preview-paymentMethod">[PAYMENT METHOD]</span><span id="preview-cryptoCurrency-section" style="display: none;"> using <span id="preview-cryptoCurrency">[CRYPTOCURRENCY]</span> sent to the Company's wallet address: <span id="preview-cryptoAddress">[CRYPTO ADDRESS]</span></span>.</p>
                
                <p><strong>2.3 Delivery of Purchase Amount.</strong> The Purchaser will deliver the Purchase Amount to the Company on or about the date of this Agreement.</p>
                
                <p><strong>2.4 Fundraising Targets.</strong> This Agreement is part of a fundraising round with a minimum target of <span id="preview-minimumRaise">[MINIMUM RAISE]</span> USD and a maximum cap of <span id="preview-maximumRaise">[MAXIMUM RAISE]</span> USD.</p>
                
                <p><strong>2.5 Dissolution Event Payout.</strong> In the event of a Dissolution Event before this instrument terminates, the Company will pay an amount equal to the Purchase Amount <span id="preview-dissolutionPayout">[DISSOLUTION PAYOUT]</span><span id="preview-interestRate-section" style="display: none;"> plus interest at an annual rate of <span id="preview-interestRate">[INTEREST RATE]</span>%</span> to the Purchaser immediately prior to or concurrent with the consummation of the Dissolution Event.</p>
                
                <p><strong>3. Token Issuance</strong></p>
                
                <p><strong>3.1 Token Calculation.</strong> The number of Tokens to be issued to the Purchaser shall be determined as follows:</p>
                
                <p>The Purchaser will receive the number of Tokens equal to the Purchase Amount divided by the lesser of (i) a price per Token equal to the valuation cap of <span id="preview-valuationCap">[VALUATION CAP]</span> USD divided by the Network's aggregate token supply of <span id="preview-totalSupply">[TOTAL SUPPLY]</span> at Network Launch, or (ii) the lowest price per Token sold by the Company to any third party during the Token Sale, less a <span id="preview-discount">[DISCOUNT]</span>% discount.</p>
                
                <p><strong>3.2 Token Use Case.</strong> The Tokens are intended to be used for <span id="preview-tokenUseCase">[TOKEN USE CASE]</span>. The Tokens will provide holders with the following rights: <span id="preview-tokenRights">[TOKEN RIGHTS]</span>.</p>
                
                <p><strong>3.3 Token Vesting.</strong> The Tokens will be delivered to the Purchaser according to the following vesting schedule:</p>
                
                <p><span id="preview-initialReleasePercentage">[INITIAL RELEASE PERCENTAGE]</span>% of the Tokens will be released to the Purchaser immediately upon Network Launch, and the remaining Tokens will vest over a period of <span id="preview-vestingPeriod">[VESTING PERIOD]</span> months on a <span id="preview-vestingSchedule">[VESTING SCHEDULE]</span> basis.</p>
                
                <div id="preview-milestone-section" style="display: none;">
                    <p><strong>3.4 Milestone-Based Vesting.</strong> Token releases will be triggered by the following milestones: <span id="preview-milestones">[MILESTONES]</span>.</p>
                </div>
                
                <p><strong>3.5 Lock-up Period.</strong> Following the Network Launch, the Tokens will be subject to a lock-up period of <span id="preview-lockupPeriod">[LOCKUP PERIOD]</span> days, during which the Purchaser may not sell, transfer, or otherwise dispose of the Tokens.</p>
                
                <p><strong>4. Representations and Warranties</strong></p>
                
                <p><strong>4.1 Purchaser Representations.</strong> The Purchaser represents and warrants to the Company that:</p>
                
                <p>(a) The Purchaser has full legal capacity, power and authority to execute and deliver this Agreement and to perform its obligations hereunder.</p>
                
                <p>(b) This Agreement constitutes a valid and binding obligation of the Purchaser, enforceable in accordance with its terms.</p>
                
                <p>(c) The Purchaser is <span id="preview-accreditedInvestor">an accredited investor</span> as defined in Rule 501(a) of Regulation D under the Securities Act. The Purchaser has been advised that this Agreement is a security and that the offer and sale of this Agreement have not been registered under the Securities Act, or any state securities laws.</p>
                
                <p><strong>4.2 Company Representations.</strong> The Company hereby represents and warrants to the Purchaser that:</p>
                
                <p>(a) The Company is duly organized, validly existing and in good standing under the laws of its state of incorporation, and has the power and authority to own, lease and operate its properties and carry on its business as now conducted.</p>
                
                <p>(b) The execution, delivery and performance by the Company of this Agreement is, to the Company's knowledge, within the power of the Company and has been duly authorized by all necessary actions on the part of the Company.</p>
                
                <p><strong>5. Miscellaneous</strong></p>
                
                <p><strong>5.1 Notice.</strong> Any notice required or permitted by this Agreement will be deemed sufficient when delivered personally or by overnight courier or sent by email to the relevant address listed on the signature page.</p>
                
                <p><strong>5.2 Assignment.</strong> Neither this Agreement nor the rights contained herein may be assigned, by operation of law or otherwise, by either party without the prior written consent of the other.</p>
                
                <div id="preview-transferRestrictions-section" style="display: none;">
                    <p><strong>5.3 Transfer Restrictions.</strong> The Purchaser agrees not to transfer any Tokens received under this Agreement until the expiration of the vesting period stated in Section 3.2. Any attempted transfer in violation of this Section will be null and void.</p>
                </div>
                
                <div id="preview-confidentiality-section" style="display: none;">
                    <p><strong>5.4 Confidentiality.</strong> The Purchaser agrees to keep confidential all information provided by the Company relating to its business, technology, and the Network, except for information that is publicly available or that the Purchaser is required to disclose by law.</p>
                </div>
                
                <p><strong>5.5 Governing Law.</strong> This Agreement shall be governed by and construed in accordance with the laws of the State of <span id="preview-governingLaw">[GOVERNING LAW]</span>, without regard to conflicts of laws principles.</p>
                
                <div id="preview-disputeResolution-courts" style="display: none;">
                    <p><strong>5.6 Dispute Resolution.</strong> Any dispute arising out of or relating to this Agreement shall be resolved in the courts located in the State of <span id="preview-governingLaw-courts">[GOVERNING LAW]</span>.</p>
                </div>
                
                <div id="preview-disputeResolution-arbitration" style="display: none;">
                    <p><strong>5.6 Dispute Resolution.</strong> Any dispute arising out of or relating to this Agreement shall be resolved by binding arbitration in <span id="preview-arbitrationVenue">[ARBITRATION VENUE]</span> in accordance with the rules of <span id="preview-arbitrationRules">[ARBITRATION RULES]</span>.</p>
                </div>
                
                <div id="preview-disputeResolution-mediation" style="display: none;">
                    <p><strong>5.6 Dispute Resolution.</strong> Any dispute arising out of or relating to this Agreement shall first be submitted to mediation, and if mediation is unsuccessful, then to the courts located in the State of <span id="preview-governingLaw-mediation">[GOVERNING LAW]</span>.</p>
                </div>
                
                <div id="preview-mostFavoredNation-section" style="display: none;">
                    <p><strong>5.7 Most Favored Nation.</strong> If, at any time prior to the Network Launch, the Company issues any SAFTs or other instruments convertible into Tokens with rights, preferences or privileges that are more favorable to the holder thereof than those granted to the Purchaser herein, the Company shall promptly provide the Purchaser with written notice thereof, together with a copy of all documentation relating to such SAFT or other instrument. The Company agrees that the Purchaser shall have the right to amend this Agreement to include such more favorable terms.</p>
                </div>
                
                <div id="preview-proRataRights-section" style="display: none;">
                    <p><strong>5.8 Pro-Rata Rights.</strong> If the Company proposes to sell any equity securities or securities convertible into equity securities in a financing with the principal purpose of raising capital, the Purchaser shall have the right to purchase up to its pro rata share (calculated based on the ratio of Tokens received to total Tokens outstanding) of such securities.</p>
                </div>
                
                <div id="preview-informationRights-section" style="display: none;">
                    <p><strong>5.9 Information Rights.</strong> The Company agrees to provide the Purchaser with <span id="preview-informationRights">[INFORMATION RIGHTS]</span> concerning the financial and business condition of the Company and the development progress of the Network.</p>
                </div>
                
                <div id="preview-regulatoryCompliance-section" style="display: none;">
                    <p><strong>5.10 Regulatory Compliance.</strong> The parties agree to comply with all applicable regulations, including but not limited to <span id="preview-regulatoryCompliance">[REGULATORY COMPLIANCE]</span>.</p>
                </div>
                
                <div id="preview-additionalTerms-section" style="display: none;">
                    <p><strong>5.11 Additional Terms.</strong> <span id="preview-additionalTerms">[ADDITIONAL TERMS]</span></p>
                </div>
                
                <p><strong>IN WITNESS WHEREOF</strong>, the undersigned have caused this Agreement to be duly executed and delivered as of the date first written above.</p>
                
                <div style="margin-top: 40px;">
                    <div style="float: left; width: 45%;">
                        <p><strong>COMPANY:</strong></p>
                        <p><span id="preview-companyName2">[COMPANY NAME]</span><br>
                        <span id="preview-companyAddress">[COMPANY ADDRESS]</span><br>
                        Email: <span id="preview-companyEmail">[COMPANY EMAIL]</span></p>
                        
                        <p>By: ____________________________<br>
                        Name: <span id="preview-signatoryName">[SIGNATORY NAME]</span><br>
                        Title: <span id="preview-signatoryTitle">[SIGNATORY TITLE]</span></p>
                    </div>
                    
                    <div style="float: right; width: 45%;">
                        <p><strong>PURCHASER:</strong></p>
                        <p><span id="preview-investorName2">[INVESTOR NAME]</span><br>
                        <span id="preview-investorAddress">[INVESTOR ADDRESS]</span><br>
                        Email: <span id="preview-investorEmail">[INVESTOR EMAIL]</span></p>
                        
                        <div id="preview-individual-signature">
                            <p>By: ____________________________<br>
                            Name: <span id="preview-investorName3">[INVESTOR NAME]</span></p>
                        </div>
                        
                        <div id="preview-entity-signature" style="display: none;">
                            <p>By: ____________________________<br>
                            Name: <span id="preview-investorSignatoryName">[INVESTOR SIGNATORY NAME]</span><br>
                            Title: <span id="preview-investorSignatoryTitle">[INVESTOR SIGNATORY TITLE]</span></p>
                        </div>
                    </div>
                    <div style="clear: both;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Calendly widget code -->
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    
    <script>
        // Track last changed elements
        let lastChangedElements = [];
        
        // Function to highlight changes
        function highlightChanges(elements) {
            // Remove previous highlights
            document.querySelectorAll('.highlight').forEach(el => {
                el.classList.remove('highlight');
            });
            
            // Add highlight to new elements
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.add('highlight');
                    
                    // Check if element is in view
                    const rect = element.getBoundingClientRect();
                    const previewSection = document.querySelector('.preview-section');
                    const previewRect = previewSection.getBoundingClientRect();
                    
                    if (rect.top < previewRect.top || rect.bottom > previewRect.bottom) {
                        // Scroll element into view
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            });
            
            // Store current changes
            lastChangedElements = elements;
        }
        
        // Function to update preview based on form values
        function updatePreview() {
            const changedElements = [];
            
            // Company Information
            const companyName = document.getElementById('companyName').value || '[COMPANY NAME]';
            if (document.getElementById('preview-companyName').textContent !== companyName) {
                document.getElementById('preview-companyName').textContent = companyName;
                document.getElementById('preview-companyName2').textContent = companyName;
                changedElements.push('preview-companyName', 'preview-companyName2');
            }
            
            const companyAddress = document.getElementById('companyAddress').value || '[COMPANY ADDRESS]';
            if (document.getElementById('preview-companyAddress').textContent !== companyAddress) {
                document.getElementById('preview-companyAddress').textContent = companyAddress;
                changedElements.push('preview-companyAddress');
            }
            
            const stateOfIncorporation = document.getElementById('stateOfIncorporation').value || '[STATE]';
            if (document.getElementById('preview-stateOfIncorporation').textContent !== stateOfIncorporation) {
                document.getElementById('preview-stateOfIncorporation').textContent = stateOfIncorporation;
                changedElements.push('preview-stateOfIncorporation');
            }
            
            const companyEmail = document.getElementById('companyEmail').value || '[COMPANY EMAIL]';
            if (document.getElementById('preview-companyEmail').textContent !== companyEmail) {
                document.getElementById('preview-companyEmail').textContent = companyEmail;
                changedElements.push('preview-companyEmail');
            }
            
            const signatoryName = document.getElementById('signatoryName').value || '[SIGNATORY NAME]';
            if (document.getElementById('preview-signatoryName').textContent !== signatoryName) {
                document.getElementById('preview-signatoryName').textContent = signatoryName;
                changedElements.push('preview-signatoryName');
            }
            
            const signatoryTitle = document.getElementById('signatoryTitle').value || '[SIGNATORY TITLE]';
            if (document.getElementById('preview-signatoryTitle').textContent !== signatoryTitle) {
                document.getElementById('preview-signatoryTitle').textContent = signatoryTitle;
                changedElements.push('preview-signatoryTitle');
            }
            
            // Investor Information
            const investorType = document.getElementById('investorType').value;
            document.getElementById('preview-individual-signature').style.display = investorType === 'individual' ? 'block' : 'none';
            document.getElementById('preview-entity-signature').style.display = investorType === 'entity' ? 'block' : 'none';
            
            const investorName = document.getElementById('investorName').value || '[INVESTOR NAME]';
            if (document.getElementById('preview-investorName').textContent !== investorName) {
                document.getElementById('preview-investorName').textContent = investorName;
                document.getElementById('preview-investorName2').textContent = investorName;
                document.getElementById('preview-investorName3').textContent = investorName;
                changedElements.push('preview-investorName', 'preview-investorName2', 'preview-investorName3');
            }
            
            const investorAddress = document.getElementById('investorAddress').value || '[INVESTOR ADDRESS]';
            if (document.getElementById('preview-investorAddress').textContent !== investorAddress) {
                document.getElementById('preview-investorAddress').textContent = investorAddress;
                changedElements.push('preview-investorAddress');
            }
            
            const investorEmail = document.getElementById('investorEmail').value || '[INVESTOR EMAIL]';
            if (document.getElementById('preview-investorEmail').textContent !== investorEmail) {
                document.getElementById('preview-investorEmail').textContent = investorEmail;
                changedElements.push('preview-investorEmail');
            }
            
            if (investorType === 'entity') {
                const investorSignatoryName = document.getElementById('investorSignatoryName').value || '[INVESTOR SIGNATORY NAME]';
                if (document.getElementById('preview-investorSignatoryName').textContent !== investorSignatoryName) {
                    document.getElementById('preview-investorSignatoryName').textContent = investorSignatoryName;
                    changedElements.push('preview-investorSignatoryName');
                }
                
                const investorSignatoryTitle = document.getElementById('investorSignatoryTitle').value || '[INVESTOR SIGNATORY TITLE]';
                if (document.getElementById('preview-investorSignatoryTitle').textContent !== investorSignatoryTitle) {
                    document.getElementById('preview-investorSignatoryTitle').textContent = investorSignatoryTitle;
                    changedElements.push('preview-investorSignatoryTitle');
                }
            }
            
            const accredited = document.getElementById('accreditedInvestor').value;
            const accreditedText = accredited === 'yes' ? 'an accredited investor' : 'not an accredited investor';
            if (document.getElementById('preview-accreditedInvestor').textContent !== accreditedText) {
                document.getElementById('preview-accreditedInvestor').textContent = accreditedText;
                changedElements.push('preview-accreditedInvestor');
            }
            
            // Investment Terms
            const purchaseAmount = document.getElementById('purchaseAmount').value || '[PURCHASE AMOUNT]';
            if (document.getElementById('preview-purchaseAmount').textContent !== purchaseAmount) {
                document.getElementById('preview-purchaseAmount').textContent = purchaseAmount;
                changedElements.push('preview-purchaseAmount');
            }
            
            // Payment Method
            const paymentMethod = document.getElementById('paymentMethod').value;
            let paymentMethodText = '[PAYMENT METHOD]';
            if (paymentMethod === 'wire') paymentMethodText = 'wire transfer';
            else if (paymentMethod === 'crypto') paymentMethodText = 'cryptocurrency';
            else if (paymentMethod === 'check') paymentMethodText = 'check';
            else if (paymentMethod === 'other') paymentMethodText = 'other approved payment method';
            
            if (document.getElementById('preview-paymentMethod').textContent !== paymentMethodText) {
                document.getElementById('preview-paymentMethod').textContent = paymentMethodText;
                changedElements.push('preview-paymentMethod');
            }
            
            // Show/hide crypto section
            document.getElementById('preview-cryptoCurrency-section').style.display = paymentMethod === 'crypto' ? 'inline' : 'none';
            
            if (paymentMethod === 'crypto') {
                const cryptoCurrency = document.getElementById('cryptoCurrency').value;
                let cryptoCurrencyText = '[CRYPTOCURRENCY]';
                if (cryptoCurrency === 'BTC') cryptoCurrencyText = 'Bitcoin (BTC)';
                else if (cryptoCurrency === 'ETH') cryptoCurrencyText = 'Ethereum (ETH)';
                else if (cryptoCurrency === 'USDC') cryptoCurrencyText = 'USD Coin (USDC)';
                else if (cryptoCurrency === 'USDT') cryptoCurrencyText = 'Tether (USDT)';
                else if (cryptoCurrency === 'other') cryptoCurrencyText = 'the specified cryptocurrency';
                
                if (document.getElementById('preview-cryptoCurrency').textContent !== cryptoCurrencyText) {
                    document.getElementById('preview-cryptoCurrency').textContent = cryptoCurrencyText;
                    changedElements.push('preview-cryptoCurrency');
                }
                
                const cryptoAddress = document.getElementById('cryptoAddress').value || '[CRYPTO ADDRESS]';
                if (document.getElementById('preview-cryptoAddress').textContent !== cryptoAddress) {
                    document.getElementById('preview-cryptoAddress').textContent = cryptoAddress;
                    changedElements.push('preview-cryptoAddress');
                }
            }
            
            const valuationCap = document.getElementById('valuationCap').value || '[VALUATION CAP]';
            if (document.getElementById('preview-valuationCap').textContent !== valuationCap) {
                document.getElementById('preview-valuationCap').textContent = valuationCap;
                changedElements.push('preview-valuationCap');
            }
            
            const discount = document.getElementById('discount').value || '[DISCOUNT]';
            if (document.getElementById('preview-discount').textContent !== discount) {
                document.getElementById('preview-discount').textContent = discount;
                changedElements.push('preview-discount');
            }
            
            // Fundraising targets
            const minimumRaise = document.getElementById('minimumRaise').value || '[MINIMUM RAISE]';
            if (document.getElementById('preview-minimumRaise').textContent !== minimumRaise) {
                document.getElementById('preview-minimumRaise').textContent = minimumRaise;
                changedElements.push('preview-minimumRaise');
            }
            
            const maximumRaise = document.getElementById('maximumRaise').value || '[MAXIMUM RAISE]';
            if (document.getElementById('preview-maximumRaise').textContent !== maximumRaise) {
                document.getElementById('preview-maximumRaise').textContent = maximumRaise;
                changedElements.push('preview-maximumRaise');
            }
            
            const closingDate = document.getElementById('closingDate').value ? new Date(document.getElementById('closingDate').value).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'}) : '[CLOSING DATE]';
            if (document.getElementById('preview-closingDate').textContent !== closingDate) {
                document.getElementById('preview-closingDate').textContent = closingDate;
                changedElements.push('preview-closingDate');
            }
            
            const terminationDate = document.getElementById('terminationDate').value ? new Date(document.getElementById('terminationDate').value).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'}) : '[TERMINATION DATE]';
            if (document.getElementById('preview-terminationDate').textContent !== terminationDate) {
                document.getElementById('preview-terminationDate').textContent = terminationDate;
                changedElements.push('preview-terminationDate');
            }
            
            // Dissolution payout
            const dissolutionPayout = document.getElementById('dissolutionPayout').value;
            let dissolutionPayoutText = '[DISSOLUTION PAYOUT]';
            if (dissolutionPayout === 'principal') dissolutionPayoutText = 'only';
            else if (dissolutionPayout === 'interest') dissolutionPayoutText = 'plus accrued interest';
            else if (dissolutionPayout === 'premium') dissolutionPayoutText = 'plus a premium';
            
            if (document.getElementById('preview-dissolutionPayout').textContent !== dissolutionPayoutText) {
                document.getElementById('preview-dissolutionPayout').textContent = dissolutionPayoutText;
                changedElements.push('preview-dissolutionPayout');
            }
            
            // Show/hide interest rate section
            document.getElementById('preview-interestRate-section').style.display = (dissolutionPayout === 'interest' || dissolutionPayout === 'premium') ? 'inline' : 'none';
            
            if (dissolutionPayout === 'interest' || dissolutionPayout === 'premium') {
                const interestRate = document.getElementById('interestRate').value || '[INTEREST RATE]';
                if (document.getElementById('preview-interestRate').textContent !== interestRate) {
                    document.getElementById('preview-interestRate').textContent = interestRate;
                    changedElements.push('preview-interestRate');
                }
            }
            
            // Token Terms
            const tokenName = document.getElementById('tokenName').value || '[TOKEN NAME]';
            if (document.getElementById('preview-tokenName').textContent !== tokenName) {
                document.getElementById('preview-tokenName').textContent = tokenName;
                changedElements.push('preview-tokenName');
            }
            
            const tokenSymbol = document.getElementById('tokenSymbol').value || '[TOKEN SYMBOL]';
            if (document.getElementById('preview-tokenSymbol').textContent !== tokenSymbol) {
                document.getElementById('preview-tokenSymbol').textContent = tokenSymbol;
                changedElements.push('preview-tokenSymbol');
            }
            
            const totalSupply = document.getElementById('totalSupply').value || '[TOTAL SUPPLY]';
            if (document.getElementById('preview-totalSupply').textContent !== totalSupply) {
                document.getElementById('preview-totalSupply').textContent = totalSupply;
                changedElements.push('preview-totalSupply');
            }
            
            const tokenUseCase = document.getElementById('tokenUseCase').value || '[TOKEN USE CASE]';
            if (document.getElementById('preview-tokenUseCase').textContent !== tokenUseCase) {
                document.getElementById('preview-tokenUseCase').textContent = tokenUseCase;
                changedElements.push('preview-tokenUseCase');
            }
            
            // Token Rights
            const tokenRightsSelect = document.getElementById('tokenRights');
            let tokenRightsText = '[TOKEN RIGHTS]';
            if (tokenRightsSelect.selectedOptions.length > 0) {
                const selectedRights = Array.from(tokenRightsSelect.selectedOptions).map(option => {
                    if (option.value === 'utility') return 'utility and platform access';
                    if (option.value === 'governance') return 'governance voting rights';
                    if (option.value === 'staking') return 'staking rewards';
                    if (option.value === 'discount') return 'platform fee discounts';
                    if (option.value === 'dividend') return 'profit sharing/dividends';
                    if (option.value === 'none') return 'no special rights (pure utility)';
                    return option.value;
                });
                tokenRightsText = selectedRights.join(', ');
            }
            if (document.getElementById('preview-tokenRights').textContent !== tokenRightsText) {
                document.getElementById('preview-tokenRights').textContent = tokenRightsText;
                changedElements.push('preview-tokenRights');
            }
            
            const networkLaunchDeadline = document.getElementById('networkLaunchDeadline').value ? new Date(document.getElementById('networkLaunchDeadline').value).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'}) : '[NETWORK LAUNCH DEADLINE]';
            if (document.getElementById('preview-networkLaunchDeadline').textContent !== networkLaunchDeadline) {
                document.getElementById('preview-networkLaunchDeadline').textContent = networkLaunchDeadline;
                changedElements.push('preview-networkLaunchDeadline');
            }
            
            const vestingPeriod = document.getElementById('vestingPeriod').value || '[VESTING PERIOD]';
            if (document.getElementById('preview-vestingPeriod').textContent !== vestingPeriod) {
                document.getElementById('preview-vestingPeriod').textContent = vestingPeriod;
                changedElements.push('preview-vestingPeriod');
            }
            
            const initialReleasePercentage = document.getElementById('initialReleasePercentage').value || '[INITIAL RELEASE PERCENTAGE]';
            if (document.getElementById('preview-initialReleasePercentage').textContent !== initialReleasePercentage) {
                document.getElementById('preview-initialReleasePercentage').textContent = initialReleasePercentage;
                changedElements.push('preview-initialReleasePercentage');
            }
            
            let vestingScheduleText = '[VESTING SCHEDULE]';
            const vestingSchedule = document.getElementById('vestingSchedule').value;
            if (vestingSchedule === 'monthly') vestingScheduleText = 'monthly';
            else if (vestingSchedule === 'quarterly') vestingScheduleText = 'quarterly';
            else if (vestingSchedule === 'annually') vestingScheduleText = 'annual';
            else if (vestingSchedule === 'cliff') vestingScheduleText = 'cliff';
            else if (vestingSchedule === 'milestone') vestingScheduleText = 'milestone-based';
            
            if (document.getElementById('preview-vestingSchedule').textContent !== vestingScheduleText) {
                document.getElementById('preview-vestingSchedule').textContent = vestingScheduleText;
                changedElements.push('preview-vestingSchedule');
            }
            
            // Show/hide milestone section
            document.getElementById('preview-milestone-section').style.display = vestingSchedule === 'milestone' ? 'block' : 'none';
            
            if (vestingSchedule === 'milestone') {
                const milestones = document.getElementById('milestones').value || '[MILESTONES]';
                if (document.getElementById('preview-milestones').textContent !== milestones) {
                    document.getElementById('preview-milestones').textContent = milestones;
                    changedElements.push('preview-milestones');
                }
            }
            
            const lockupPeriod = document.getElementById('lockupPeriod').value || '[LOCKUP PERIOD]';
            if (document.getElementById('preview-lockupPeriod').textContent !== lockupPeriod) {
                document.getElementById('preview-lockupPeriod').textContent = lockupPeriod;
                changedElements.push('preview-lockupPeriod');
            }
            
            // Additional Terms
            const governingLaw = document.getElementById('governingLaw').value || '[GOVERNING LAW]';
            const otherJurisdiction = document.getElementById('otherJurisdiction');
            let finalGoverningLaw = governingLaw;
            
            if ((governingLaw === 'other_us' || governingLaw === 'non_us') && otherJurisdiction) {
                finalGoverningLaw = otherJurisdiction.value || '[OTHER JURISDICTION]';
            }
            
            if (document.getElementById('preview-governingLaw').textContent !== finalGoverningLaw) {
                document.getElementById('preview-governingLaw').textContent = finalGoverningLaw;
                
                const courtsEl = document.getElementById('preview-governingLaw-courts');
                if (courtsEl) {
                    courtsEl.textContent = finalGoverningLaw;
                }
                
                const mediationEl = document.getElementById('preview-governingLaw-mediation');
                if (mediationEl) {
                    mediationEl.textContent = finalGoverningLaw;
                }
                
                changedElements.push('preview-governingLaw');
                
                if (document.getElementById('disputeResolution').value === 'courts') {
                    changedElements.push('preview-governingLaw-courts');
                } else if (document.getElementById('disputeResolution').value === 'mediation') {
                    changedElements.push('preview-governingLaw-mediation');
                }
            }
            
            const disputeResolution = document.getElementById('disputeResolution').value;
            document.getElementById('preview-disputeResolution-courts').style.display = disputeResolution === 'courts' ? 'block' : 'none';
            document.getElementById('preview-disputeResolution-arbitration').style.display = (disputeResolution === 'arbitration' || disputeResolution === 'hybrid') ? 'block' : 'none';
            document.getElementById('preview-disputeResolution-mediation').style.display = disputeResolution === 'mediation' ? 'block' : 'none';
            
            if (disputeResolution === 'arbitration' || disputeResolution === 'hybrid') {
                const arbitrationVenue = document.getElementById('arbitrationVenue').value || '[ARBITRATION VENUE]';
                if (document.getElementById('preview-arbitrationVenue').textContent !== arbitrationVenue) {
                    document.getElementById('preview-arbitrationVenue').textContent = arbitrationVenue;
                    changedElements.push('preview-arbitrationVenue');
                }
                
                const arbitrationRules = document.getElementById('arbitrationRules').value;
                let arbitrationRulesText = '[ARBITRATION RULES]';
                if (arbitrationRules === 'aaa') arbitrationRulesText = 'the American Arbitration Association (AAA)';
                else if (arbitrationRules === 'jams') arbitrationRulesText = 'JAMS';
                else if (arbitrationRules === 'icc') arbitrationRulesText = 'the International Chamber of Commerce (ICC)';
                else if (arbitrationRules === 'uncitral') arbitrationRulesText = 'UNCITRAL';
                else if (arbitrationRules === 'other') arbitrationRulesText = 'the agreed upon rules';
                
                if (document.getElementById('preview-arbitrationRules').textContent !== arbitrationRulesText) {
                    document.getElementById('preview-arbitrationRules').textContent = arbitrationRulesText;
                    changedElements.push('preview-arbitrationRules');
                }
            }
            
            const confidentiality = document.getElementById('confidentiality').value;
            document.getElementById('preview-confidentiality-section').style.display = confidentiality === 'yes' ? 'block' : 'none';
            
            const transferRestrictions = document.getElementById('transferRestrictions').value;
            document.getElementById('preview-transferRestrictions-section').style.display = transferRestrictions === 'yes' ? 'block' : 'none';
            
            // Most Favored Nation
            const mostFavoredNation = document.getElementById('mostFavoredNation').value;
            document.getElementById('preview-mostFavoredNation-section').style.display = mostFavoredNation === 'yes' ? 'block' : 'none';
            
            // Pro-Rata Rights
            const proRataRights = document.getElementById('proRataRights').value;
            document.getElementById('preview-proRataRights-section').style.display = proRataRights === 'yes' ? 'block' : 'none';
            
            // Information Rights
            const informationRights = document.getElementById('informationRights').value;
            let informationRightsText = '[INFORMATION RIGHTS]';
            if (informationRights === 'basic') informationRightsText = 'quarterly updates on project development';
            else if (informationRights === 'standard') informationRightsText = 'quarterly financial reports and development updates';
            else if (informationRights === 'comprehensive') informationRightsText = 'monthly financial reports, development milestones, and strategic planning information';
            
            document.getElementById('preview-informationRights-section').style.display = informationRights !== 'none' ? 'block' : 'none';
            
            if (document.getElementById('preview-informationRights').textContent !== informationRightsText) {
                document.getElementById('preview-informationRights').textContent = informationRightsText;
                changedElements.push('preview-informationRights');
            }
            
            // Regulatory Compliance
            const regulatoryComplianceSelect = document.getElementById('regulatoryCompliance');
            let regulatoryComplianceText = '[REGULATORY COMPLIANCE]';
            if (regulatoryComplianceSelect.selectedOptions.length > 0) {
                const selectedCompliance = Array.from(regulatoryComplianceSelect.selectedOptions).map(option => {
                    if (option.value === 'aml') return 'Anti-Money Laundering (AML) regulations';
                    if (option.value === 'kyc') return 'Know Your Customer (KYC) requirements';
                    if (option.value === 'sanctions') return 'sanctions compliance laws';
                    if (option.value === 'securities') return 'applicable securities laws';
                    if (option.value === 'tax') return 'tax reporting obligations';
                    return option.value;
                });
                regulatoryComplianceText = selectedCompliance.join(', ');
                document.getElementById('preview-regulatoryCompliance-section').style.display = 'block';
            } else {
                document.getElementById('preview-regulatoryCompliance-section').style.display = 'none';
            }
            
            if (document.getElementById('preview-regulatoryCompliance').textContent !== regulatoryComplianceText) {
                document.getElementById('preview-regulatoryCompliance').textContent = regulatoryComplianceText;
                changedElements.push('preview-regulatoryCompliance');
            }
            
            const additionalTerms = document.getElementById('additionalTerms').value;
            document.getElementById('preview-additionalTerms-section').style.display = additionalTerms ? 'block' : 'none';
            if (additionalTerms && document.getElementById('preview-additionalTerms').textContent !== additionalTerms) {
                document.getElementById('preview-additionalTerms').textContent = additionalTerms;
                changedElements.push('preview-additionalTerms');
            }
            
            // Highlight changes if there are any
            if (changedElements.length > 0) {
                highlightChanges(changedElements);
            }
        }
        
        // Tab navigation
        let currentTab = 0;
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
                    function showTab(n) {
            tabs.forEach(tab => tab.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            tabs[n].classList.add('active');
            tabContents[n].classList.add('active');
            
            // Update navigation buttons
            if (n === 0) {
                document.getElementById('prevBtn').style.display = 'none';
            } else {
                document.getElementById('prevBtn').style.display = 'inline';
            }
            
            // Remove the Next button on the last tab
            if (n === (tabs.length - 1)) {
                document.getElementById('nextBtn').style.display = 'none';
            } else {
                document.getElementById('nextBtn').style.display = 'inline';
                document.getElementById('nextBtn').textContent = 'Next';
            }
        }
        
        // Initialize with first tab active
        showTab(currentTab);
        
        // Tab click event
        tabs.forEach((tab, index) => {
            tab.addEventListener('click', () => {
                currentTab = index;
                showTab(currentTab);
            });
        });
        
        // Next/Previous button event
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentTab < tabs.length - 1) {
                currentTab++;
                showTab(currentTab);
            }
        });
        
        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentTab > 0) {
                currentTab--;
                showTab(currentTab);
            }
        });
        
        // Add event listener for the download button
        document.getElementById('downloadBtn').addEventListener('click', generateWordDocument);
        
        // Conditional form fields
        document.getElementById('investorType').addEventListener('change', function() {
            const entityFields = document.querySelectorAll('.entity-only');
            entityFields.forEach(field => {
                field.style.display = this.value === 'entity' ? 'block' : 'none';
            });
            updatePreview();
        });
        
        document.getElementById('disputeResolution').addEventListener('change', function() {
            const arbitrationFields = document.querySelectorAll('.arbitration-only');
            arbitrationFields.forEach(field => {
                field.style.display = this.value === 'arbitration' ? 'block' : 'none';
            });
            updatePreview();
        });
        
        // Attach event listeners to all form fields
        const formFields = document.querySelectorAll('input, select, textarea');
        formFields.forEach(field => {
            field.addEventListener('change', updatePreview);
            field.addEventListener('input', updatePreview);
        });
        
        // Add more conditional form display logic
        document.getElementById('paymentMethod').addEventListener('change', function() {
            const cryptoFields = document.querySelectorAll('.crypto-only');
            cryptoFields.forEach(field => {
                field.style.display = this.value === 'crypto' ? 'block' : 'none';
            });
            updatePreview();
        });
        
        document.getElementById('dissolutionPayout').addEventListener('change', function() {
            const interestFields = document.querySelectorAll('.interest-premium-only');
            interestFields.forEach(field => {
                field.style.display = (this.value === 'interest' || this.value === 'premium') ? 'block' : 'none';
            });
            updatePreview();
        });
        
        document.getElementById('vestingSchedule').addEventListener('change', function() {
            const milestoneFields = document.querySelectorAll('.milestone-only');
            milestoneFields.forEach(field => {
                field.style.display = this.value === 'milestone' ? 'block' : 'none';
            });
            updatePreview();
        });
        
        document.getElementById('governingLaw').addEventListener('change', function() {
            const otherJurisdictionFields = document.querySelectorAll('.other-jurisdiction');
            otherJurisdictionFields.forEach(field => {
                field.style.display = (this.value === 'other_us' || this.value === 'non_us') ? 'block' : 'none';
            });
            updatePreview();
        });
        
        // Function to generate Word document
        function generateWordDocument() {
            // Create a properly formatted document
            const companyName = document.getElementById('companyName').value || 'Company';
            const investorName = document.getElementById('investorName').value || 'Investor';
            const currentDate = new Date().toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'});
            
            // Get all visible content from the preview
            const previewDocument = document.getElementById('previewDocument');
            
            // Clone the preview to work with
            const contentClone = previewDocument.cloneNode(true);
            
            // Create a downloadable Word document
            const header = `
SIMPLE AGREEMENT FOR FUTURE TOKENS (SAFT)
`;
            
            // Create the content as a string
            let previewText = header + '\n\n';
            
            // Process the HTML into plain text
            const processNode = (node) => {
                if (node.nodeType === Node.TEXT_NODE) {
                    return node.textContent;
                }
                
                if (node.nodeType !== Node.ELEMENT_NODE) {
                    return '';
                }
                
                // Skip elements with display: none
                const computedStyle = window.getComputedStyle(node);
                if (computedStyle && computedStyle.display === 'none') {
                    return '';
                }
                
                // Handle different tag types
                let text = '';
                
                if (node.tagName === 'DIV' || node.tagName === 'P') {
                    const childText = Array.from(node.childNodes).map(processNode).join('');
                    text = childText + '\n\n';
                } else if (node.tagName === 'STRONG') {
                    text = node.textContent;
                } else if (node.tagName === 'SPAN') {
                    text = node.textContent;
                } else {
                    // Recursively process children for other elements
                    text = Array.from(node.childNodes).map(processNode).join('');
                }
                
                return text;
            };
            
            // Process the content
            previewText += Array.from(contentClone.childNodes)
                .map(processNode)
                .join('')
                .replace(/\n\n\n+/g, '\n\n') // Remove excessive line breaks
                .replace(/\[.*?\]/g, '_______'); // Replace placeholders with underscores
            
            // Create a blob for download
            const blob = new Blob([previewText], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
            
            // Generate filename
            let filename = 'SAFT_Agreement';
            if (companyName && investorName) {
                filename = `SAFT_${companyName}_${investorName}`.replace(/\s+/g, '_');
            } else if (companyName) {
                filename = `SAFT_${companyName}`.replace(/\s+/g, '_');
            } else if (investorName) {
                filename = `SAFT_for_${investorName}`.replace(/\s+/g, '_');
            }
            
            // Create download link
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${filename}.docx`;
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
            
            alert('Your SAFT agreement has been downloaded as a Word document.\n\nNote: This is a template only and should be reviewed by a qualified attorney before signing.');
        }
        
        // Initialize preview
        updatePreview();
    </script>
</body>
</html>
