<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Purchase Agreement Generator | Terms.Law</title>
  <link rel="canonical" href="https://terms.law/2024/10/15/stock-purchase-agreement-generator/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css">
</head>
<body>
  <div id="site-header"></div>
  <script src="/shared/header-loader.js"></script>
  <main>
    <article>
      <h1>Stock Purchase Agreement Generator</h1>
      <div class="meta">Published: October 15, 2024 â€¢ Document Generators, Free Templates, Incorporation, M&amp;A</div>
      <div class="content">
<div id="stock-purchase-agreement-generator" class="terms-law-tool">
  <div class="tool-container">
    <div class="tool-header">
      <h2>Stock Purchase Agreement Generator</h2>
      <p class="tool-intro">Create a customized Stock Purchase Agreement for the sale and transfer of shares between a seller and purchaser. This agreement establishes the terms and conditions for the stock transaction.</p>
    </div>
    
    <!-- Progress Bar -->
    <div class="tool-progress-container">
      <div class="tool-progress-bar">
        <div id="progress-bar"></div>
      </div>
      <div class="tool-progress-text"><span id="current-step">1</span>/<span id="total-steps">5</span></div>
    </div>
    
    <!-- Split View Container -->
    <div class="split-view-container">
      <!-- Left Side: Question Container -->
      <div id="question-container" class="question-panel">
        <!-- Questions will be inserted here by JavaScript -->
      </div>
      
      <!-- Right Side: Preview Container -->
      <div id="preview-container" class="preview-panel">
        <div class="preview-header">
          <h3>Agreement Preview</h3>
          <p class="preview-note">This preview updates as you make selections</p>
        </div>
        <div class="preview-content">
          <div id="preview-text"></div>
        </div>
      </div>
    </div>
    
    <!-- Results Container -->
    <div id="results-container" style="display: none;">
      <div class="results-header">
        <h3>Your Stock Purchase Agreement</h3>
        <p>Below is your completed agreement based on the information provided.</p>
      </div>
      
      <div class="agreement-text-container">
        <div id="agreement-text"></div>
      </div>
      
      <div class="copy-action">
        <button id="copy-btn" class="tool-btn copy-btn">Copy Agreement Text</button>
        <button id="download-btn" class="tool-btn download-btn">Download as DOCX</button>
        <span id="copy-message" class="copy-message"></span>
      </div>
      
      <div class="agreement-notes">
        <h4>Important Notes</h4>
        <p>This agreement template is provided as a starting point and may need further customization for your specific situation:</p>
        <ul>
          <li>Review the document thoroughly before using it officially</li>
          <li>Ensure compliance with state-specific securities laws</li>
          <li>Consider having it reviewed by qualified legal counsel</li>
          <li>Make sure all parties understand the terms before signing</li>
        </ul>
      </div>
      
      <!-- CTA Buttons -->
      <div class="results-cta">
        <button id="recalculate-btn" class="tool-btn tool-btn-secondary">Start Over</button>
        <a href="#" class="tool-btn tool-btn-cta" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">Schedule Legal Consultation</a>
      </div>
    </div>
  </div>
</div>

<style>
/* Tool Styles */
.terms-law-tool {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  max-width: 1200px;
  margin: 0 auto;
  color: #333;
}

.tool-container {
  background-color: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  padding: 20px;
  margin-bottom: 30px;
  position: relative;
  z-index: 1;
}

.tool-header {
  text-align: center;
  margin-bottom: 20px;
}

.tool-header h2 {
  color: #2c3e50;
  font-size: 24px;
  margin-bottom: 8px;
}

.tool-intro {
  color: #555;
  font-size: 15px;
  line-height: 1.5;
  max-width: 800px;
  margin: 0 auto;
}

/* Split View Layout */
.split-view-container {
  display: flex;
  gap: 20px;
  margin-bottom: 20px;
}

.question-panel {
  flex: 1;
  max-width: 50%;
}

.preview-panel {
  flex: 1;
  border-left: 1px solid #eee;
  padding-left: 20px;
}

.preview-header {
  margin-bottom: 15px;
}

.preview-header h3 {
  font-size: 18px;
  color: #2c3e50;
  margin: 0 0 5px 0;
}

.preview-note {
  font-size: 13px;
  color: #777;
  font-style: italic;
  margin: 0;
}

.preview-content {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 15px;
  max-height: 500px;
  overflow-y: auto;
  transition: background-color 0.5s ease;
  position: relative;
  z-index: 2;
}

#preview-text {
  font-size: 13px;
  line-height: 1.5;
  color: #333;
  white-space: pre-wrap;
}

.highlight {
  background-color: #ffffd0;
  transition: background-color 0.3s ease;
}

/* Progress Bar */
.tool-progress-container {
  margin: 20px 0;
  position: relative;
}

.tool-progress-bar {
  height: 6px;
  background-color: #e0e0e0;
  border-radius: 3px;
  overflow: hidden;
}

#progress-bar {
  height: 100%;
  background-color: #3498db;
  width: 20%;
  transition: width 0.3s ease;
}

.tool-progress-text {
  text-align: right;
  font-size: 12px;
  color: #777;
  margin-top: 5px;
}

/* Question Styles */
.question-step {
  margin-bottom: 20px;
}

.question-step h3 {
  font-size: 18px;
  margin-bottom: 12px;
  color: #2c3e50;
}

.question-description {
  color: #555;
  font-size: 14px;
  margin-bottom: 15px;
  line-height: 1.5;
}

/* Input Styles */
.input-group {
  margin-bottom: 15px;
}

.input-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  font-size: 14px;
}

.text-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.number-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.date-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

.select-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  background-color: white;
}

.textarea-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  min-height: 80px;
  resize: vertical;
}

.input-helper {
  font-size: 12px;
  color: #666;
  margin-top: 4px;
}

/* Radio Options */
.radio-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 8px;
}

.radio-option {
  display: flex;
  align-items: flex-start;
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.radio-option:hover {
  background-color: #f1f3f5;
  border-color: #d0d0d0;
}

.radio-option.selected {
  background-color: #e3f2fd;
  border-color: #90caf9;
}

.radio-option input[type="radio"] {
  margin-right: 10px;
  margin-top: 2px;
}

.radio-label {
  flex: 1;
}

.radio-label-title {
  font-weight: 600;
  display: block;
  margin-bottom: 3px;
  font-size: 14px;
}

.radio-label-desc {
  font-size: 12px;
  color: #666;
  line-height: 1.4;
}

/* Checkbox Styles */
.checkbox-group {
  margin-bottom: 15px;
}

.checkbox-option {
  display: flex;
  align-items: flex-start;
  margin-bottom: 10px;
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.checkbox-option:hover {
  background-color: #f1f3f5;
  border-color: #d0d0d0;
}

.checkbox-option.selected {
  background-color: #e3f2fd;
  border-color: #90caf9;
}

.checkbox-option input[type="checkbox"] {
  margin-right: 10px;
  margin-top: 2px;
}

.checkbox-label {
  font-size: 14px;
  flex: 1;
}

.checkbox-label-title {
  font-weight: 600;
  display: block;
  margin-bottom: 3px;
  font-size: 14px;
}

.checkbox-label-desc {
  font-size: 12px;
  color: #666;
  line-height: 1.4;
}

/* Navigation Buttons */
.tool-navigation {
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
}

.tool-btn {
  padding: 10px 18px;
  border-radius: 4px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  font-size: 14px;
  text-decoration: none;
}

.tool-btn-primary {
  background-color: #3498db;
  color: white;
}

.tool-btn-primary:hover {
  background-color: #2980b9;
}

.tool-btn-secondary {
  background-color: #ecf0f1;
  color: #34495e;
}

.tool-btn-secondary:hover {
  background-color: #dde4e6;
}

.tool-btn-secondary:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.tool-btn-cta {
  background-color: #2c3e50;
  color: white !important;
  display: inline-block;
  text-align: center;
}

.tool-btn-cta:hover {
  background-color: #1a252f;
}

/* Results Styles */
#results-container {
  opacity: 0;
  transition: opacity 0.5s ease;
}

#results-container.visible {
  opacity: 1;
}

.results-header {
  text-align: center;
  margin-bottom: 20px;
}

.results-header h3 {
  color: #2c3e50;
  font-size: 24px;
  margin-bottom: 8px;
}

.agreement-text-container {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  max-height: 500px;
  overflow-y: auto;
}

#agreement-text {
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  white-space: pre-wrap;
}

.copy-action {
  text-align: center;
  margin-bottom: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 15px;
}

.copy-btn {
  background-color: #3498db;
  color: white;
  flex: 0 1 auto;
}

.copy-btn:hover {
  background-color: #2980b9;
}

.download-btn {
  background-color: #27ae60;
  color: white;
  flex: 0 1 auto;
}

.download-btn:hover {
  background-color: #219653;
}

.copy-message {
  font-size: 14px;
  color: #27ae60;
  flex: 0 1 100%;
  margin-top: 5px;
}

.agreement-notes {
  background-color: #fff8e1;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 25px;
}

.agreement-notes h4 {
  color: #856404;
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 18px;
}

.agreement-notes ul {
  padding-left: 20px;
  margin-bottom: 0;
}

.agreement-notes li {
  margin-bottom: 8px;
  font-size: 14px;
}

/* Call to Action */
.results-cta {
  margin-top: 30px;
  display: flex;
  justify-content: center;
  gap: 15px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .tool-container {
    padding: 15px;
  }
  
  .split-view-container {
    flex-direction: column;
  }
  
  .question-panel, 
  .preview-panel {
    max-width: 100%;
  }
  
  .preview-panel {
    border-left: none;
    border-top: 1px solid #eee;
    padding-left: 0;
    padding-top: 15px;
    margin-top: 15px;
  }
  
  .results-cta {
    flex-direction: column;
  }
  
  .tool-btn {
    width: 100%;
  }
  
  .copy-action {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }
  
  .copy-btn, .download-btn {
    margin: 0;
    width: 100%;
  }
  
  .copy-message {
    margin-left: 0;
    margin-bottom: 10px;
  }
}
</style>

<!-- Load Calendly Widget -->
<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

<!-- Add docx download capability -->
<script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Set current date for default values
  const today = new Date();
  const formattedDate = today.toISOString().split('T')[0];
  
  // Format dates for display
  const formatDateForDisplay = (dateString) => {
    const date = new Date(dateString);
    const options = { year: 'numeric', month: 'long', day: 'numeric' };
    return date.toLocaleDateString('en-US', options);
  };
  
  // Format currency values for display
  const formatCurrency = (amount) => {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD',
      minimumFractionDigits: 2
    }).format(amount);
  };
  
  // Questions Data
  const questions = [
    {
      id: 'parties-info',
      title: 'Parties Information',
      description: 'Enter details about the parties involved in this stock purchase',
      fields: [
        {
          id: 'company-name',
          label: 'Company Name',
          type: 'text',
          value: 'ABC Corporation',
          helper: 'The full legal name of the company whose stock is being purchased'
        },
        {
          id: 'state-of-incorporation',
          label: 'State of Incorporation',
          type: 'select',
          options: [
            { value: 'Alabama', label: 'Alabama' },
            { value: 'Alaska', label: 'Alaska' },
            { value: 'Arizona', label: 'Arizona' },
            { value: 'Arkansas', label: 'Arkansas' },
            { value: 'California', label: 'California', selected: true },
            { value: 'Colorado', label: 'Colorado' },
            { value: 'Connecticut', label: 'Connecticut' },
            { value: 'Delaware', label: 'Delaware' },
            { value: 'Florida', label: 'Florida' },
            { value: 'Georgia', label: 'Georgia' },
            { value: 'Hawaii', label: 'Hawaii' },
            { value: 'Idaho', label: 'Idaho' },
            { value: 'Illinois', label: 'Illinois' },
            { value: 'Indiana', label: 'Indiana' },
            { value: 'Iowa', label: 'Iowa' },
            { value: 'Kansas', label: 'Kansas' },
            { value: 'Kentucky', label: 'Kentucky' },
            { value: 'Louisiana', label: 'Louisiana' },
            { value: 'Maine', label: 'Maine' },
            { value: 'Maryland', label: 'Maryland' },
            { value: 'Massachusetts', label: 'Massachusetts' },
            { value: 'Michigan', label: 'Michigan' },
            { value: 'Minnesota', label: 'Minnesota' },
            { value: 'Mississippi', label: 'Mississippi' },
            { value: 'Missouri', label: 'Missouri' },
            { value: 'Montana', label: 'Montana' },
            { value: 'Nebraska', label: 'Nebraska' },
            { value: 'Nevada', label: 'Nevada' },
            { value: 'New Hampshire', label: 'New Hampshire' },
            { value: 'New Jersey', label: 'New Jersey' },
            { value: 'New Mexico', label: 'New Mexico' },
            { value: 'New York', label: 'New York' },
            { value: 'North Carolina', label: 'North Carolina' },
            { value: 'North Dakota', label: 'North Dakota' },
            { value: 'Ohio', label: 'Ohio' },
            { value: 'Oklahoma', label: 'Oklahoma' },
            { value: 'Oregon', label: 'Oregon' },
            { value: 'Pennsylvania', label: 'Pennsylvania' },
            { value: 'Rhode Island', label: 'Rhode Island' },
            { value: 'South Carolina', label: 'South Carolina' },
            { value: 'South Dakota', label: 'South Dakota' },
            { value: 'Tennessee', label: 'Tennessee' },
            { value: 'Texas', label: 'Texas' },
            { value: 'Utah', label: 'Utah' },
            { value: 'Vermont', label: 'Vermont' },
            { value: 'Virginia', label: 'Virginia' },
            { value: 'Washington', label: 'Washington' },
            { value: 'West Virginia', label: 'West Virginia' },
            { value: 'Wisconsin', label: 'Wisconsin' },
            { value: 'Wyoming', label: 'Wyoming' }
          ],
          helper: 'The state where the company is incorporated'
        },
        {
          id: 'seller-name',
          label: 'Seller\'s Full Name',
          type: 'text',
          value: 'John Smith',
          helper: 'The full legal name of the person selling the shares'
        },
        {
          id: 'seller-address',
          label: 'Seller\'s Address',
          type: 'text',
          value: '123 Seller Street, San Francisco, CA 94101',
          helper: 'The complete address of the seller'
        },
        {
          id: 'purchaser-name',
          label: 'Purchaser\'s Full Name',
          type: 'text',
          value: 'Jane Doe',
          helper: 'The full legal name of the person purchasing the shares'
        },
        {
          id: 'purchaser-address',
          label: 'Purchaser\'s Address',
          type: 'text',
          value: '456 Buyer Avenue, San Francisco, CA 94102',
          helper: 'The complete address of the purchaser'
        }
      ]
    },
    {
      id: 'stock-details',
      title: 'Stock Details',
      description: 'Provide information about the stock being purchased',
      fields: [
        {
          id: 'agreement-date',
          label: 'Agreement Date',
          type: 'date',
          value: formattedDate,
          helper: 'The date when this agreement will be executed'
        },
        {
          id: 'stock-type',
          label: 'Type of Stock',
          type: 'select',
          options: [
            { value: 'common', label: 'Common Stock', selected: true },
            { value: 'preferred', label: 'Preferred Stock' },
            { value: 'restricted', label: 'Restricted Stock' },
            { value: 'other', label: 'Other (specify below)' }
          ],
          helper: 'The class or type of stock being purchased'
        },
        {
          id: 'stock-type-other',
          label: 'Other Stock Type Description',
          type: 'text',
          value: '',
          helper: 'If you selected "Other" above, please specify the type of stock',
          depends: 'stock-type:other'
        },
        {
          id: 'shares-number',
          label: 'Number of Shares',
          type: 'number',
          value: '1000',
          helper: 'The quantity of shares being purchased'
        },
        {
          id: 'price-per-share',
          label: 'Price Per Share ($)',
          type: 'number',
          value: '10.00',
          helper: 'The price for each individual share'
        }
      ]
    },
    {
      id: 'payment-terms',
      title: 'Payment Terms',
      description: 'Define how payment will be made for this stock purchase',
      fields: [
        {
          id: 'payment-method',
          label: 'Payment Method',
          type: 'radio',
          options: [
            {
              value: 'lump-sum',
              title: 'Lump Sum Payment',
              description: 'The entire purchase amount paid at closing',
              selected: true
            },
            {
              value: 'installments',
              title: 'Installment Payments',
              description: 'The purchase amount paid in multiple installments'
            },
            {
              value: 'other-consideration',
              title: 'Other Consideration',
              description: 'Payment made through non-cash means or combination of methods'
            }
          ],
          helper: 'How the purchase price will be paid to the seller'
        },
        {
          id: 'payment-timing',
          label: 'Payment Timing',
          type: 'select',
          options: [
            { value: 'closing', label: 'At Closing', selected: true },
            { value: 'days-after', label: 'Days After Closing' },
            { value: 'custom', label: 'Custom Schedule' }
          ],
          helper: 'When the payment will be made',
          depends: 'payment-method:lump-sum'
        },
        {
          id: 'days-after-closing',
          label: 'Days After Closing',
          type: 'number',
          value: '30',
          helper: 'Number of days after closing when payment is due',
          depends: 'payment-timing:days-after'
        },
        {
          id: 'installment-terms',
          label: 'Installment Payment Terms',
          type: 'textarea',
          value: 'Purchase price to be paid in 12 equal monthly installments of equal amount, with the first payment due at closing and subsequent payments due on the same day of each following month until fully paid.',
          helper: 'Describe the installment payment schedule and terms',
          depends: 'payment-method:installments'
        },
        {
          id: 'other-consideration-details',
          label: 'Other Consideration Details',
          type: 'textarea',
          value: '',
          helper: 'Describe the alternative form of payment or consideration',
          depends: 'payment-method:other-consideration'
        }
      ]
    },
    {
      id: 'representations',
      title: 'Representations & Warranties',
      description: 'Select the representations and warranties to include in the agreement',
      fields: [
        {
          id: 'seller-representations',
          label: 'Seller\'s Representations',
          type: 'checkbox',
          options: [
            { 
              id: 'rep-ownership', 
              label: 'Ownership of shares',
              desc: 'Seller owns the shares free and clear of any liens or encumbrances',
              checked: true
            },
            { 
              id: 'rep-authority', 
              label: 'Authority to sell',
              desc: 'Seller has the authority to execute this agreement and sell the shares',
              checked: true
            },
            { 
              id: 'rep-restrictions', 
              label: 'No transfer restrictions',
              desc: 'No restrictions on transfer except as stated in this agreement',
              checked: true
            },
            { 
              id: 'rep-litigation', 
              label: 'No pending litigation',
              desc: 'No litigation pending that would affect the shares or transaction',
              checked: true
            }
          ],
          helper: 'Select the representations and warranties the Seller will make'
        },
        {
          id: 'purchaser-representations',
          label: 'Purchaser\'s Representations',
          type: 'checkbox',
          options: [
            { 
              id: 'rep-purchaser-authority', 
              label: 'Authority to purchase',
              desc: 'Purchaser has the authority to execute this agreement and purchase the shares',
              checked: true
            },
            { 
              id: 'rep-investment', 
              label: 'Investment purpose',
              desc: 'Purchaser is acquiring shares for investment purposes and not for resale',
              checked: true
            },
            { 
              id: 'rep-accredited', 
              label: 'Accredited investor',
              desc: 'Purchaser qualifies as an accredited investor under securities laws',
              checked: false
            },
            { 
              id: 'rep-securities-laws', 
              label: 'Securities law compliance',
              desc: 'Purchaser understands the shares have not been registered under securities laws',
              checked: true
            }
          ],
          helper: 'Select the representations and warranties the Purchaser will make'
        },
        {
          id: 'additional-representations',
          label: 'Additional Representations (Optional)',
          type: 'textarea',
          value: '',
          helper: 'Include any additional representations and warranties not listed above'
        }
      ]
    },
    {
      id: 'additional-terms',
      title: 'Additional Terms',
      description: 'Add closing conditions and other terms to the agreement',
      fields: [
        {
          id: 'closing-date',
          label: 'Closing Date',
          type: 'radio',
          options: [
            {
              value: 'upon-execution',
              title: 'Upon Execution',
              description: 'The agreement will close immediately upon signing',
              selected: true
            },
            {
              value: 'specific-date',
              title: 'Specific Date',
              description: 'The agreement will close on a specified future date'
            },
            {
              value: 'conditions',
              title: 'Upon Satisfaction of Conditions',
              description: 'The agreement will close when specific conditions are met'
            }
          ],
          helper: 'When will the stock purchase transaction be completed (closed)?'
        },
        {
          id: 'specific-closing-date',
          label: 'Specific Closing Date',
          type: 'date',
          value: '',
          helper: 'The specific date when the closing will occur',
          depends: 'closing-date:specific-date'
        },
        {
          id: 'closing-conditions',
          label: 'Closing Conditions',
          type: 'textarea',
          value: '',
          helper: 'List any conditions that must be satisfied before closing',
          depends: 'closing-date:conditions'
        },
        {
          id: 'governing-law',
          label: 'Governing Law (State)',
          type: 'select',
          options: [
            { value: 'Alabama', label: 'Alabama' },
            { value: 'Alaska', label: 'Alaska' },
            { value: 'Arizona', label: 'Arizona' },
            { value: 'Arkansas', label: 'Arkansas' },
            { value: 'California', label: 'California', selected: true },
            { value: 'Colorado', label: 'Colorado' },
            { value: 'Connecticut', label: 'Connecticut' },
            { value: 'Delaware', label: 'Delaware' },
            { value: 'Florida', label: 'Florida' },
            { value: 'Georgia', label: 'Georgia' },
            { value: 'Hawaii', label: 'Hawaii' },
            { value: 'Idaho', label: 'Idaho' },
            { value: 'Illinois', label: 'Illinois' },
            { value: 'Indiana', label: 'Indiana' },
            { value: 'Iowa', label: 'Iowa' },
            { value: 'Kansas', label: 'Kansas' },
            { value: 'Kentucky', label: 'Kentucky' },
            { value: 'Louisiana', label: 'Louisiana' },
            { value: 'Maine', label: 'Maine' },
            { value: 'Maryland', label: 'Maryland' },
            { value: 'Massachusetts', label: 'Massachusetts' },
            { value: 'Michigan', label: 'Michigan' },
            { value: 'Minnesota', label: 'Minnesota' },
            { value: 'Mississippi', label: 'Mississippi' },
            { value: 'Missouri', label: 'Missouri' },
            { value: 'Montana', label: 'Montana' },
            { value: 'Nebraska', label: 'Nebraska' },
            { value: 'Nevada', label: 'Nevada' },
            { value: 'New Hampshire', label: 'New Hampshire' },
            { value: 'New Jersey', label: 'New Jersey' },
            { value: 'New Mexico', label: 'New Mexico' },
            { value: 'New York', label: 'New York' },
            { value: 'North Carolina', label: 'North Carolina' },
            { value: 'North Dakota', label: 'North Dakota' },
            { value: 'Ohio', label: 'Ohio' },
            { value: 'Oklahoma', label: 'Oklahoma' },
            { value: 'Oregon', label: 'Oregon' },
            { value: 'Pennsylvania', label: 'Pennsylvania' },
            { value: 'Rhode Island', label: 'Rhode Island' },
            { value: 'South Carolina', label: 'South Carolina' },
            { value: 'South Dakota', label: 'South Dakota' },
            { value: 'Tennessee', label: 'Tennessee' },
            { value: 'Texas', label: 'Texas' },
            { value: 'Utah', label: 'Utah' },
            { value: 'Vermont', label: 'Vermont' },
            { value: 'Virginia', label: 'Virginia' },
            { value: 'Washington', label: 'Washington' },
            { value: 'West Virginia', label: 'West Virginia' },
            { value: 'Wisconsin', label: 'Wisconsin' },
            { value: 'Wyoming', label: 'Wyoming' }
          ],
          helper: 'The state whose laws will govern this agreement'
        },
        {
          id: 'additional-provisions',
          label: 'Additional Provisions (Optional)',
          type: 'textarea',
          value: '',
          helper: 'Enter any additional terms or provisions to include in the agreement'
        }
      ]
    }
  ];
  
  // DOM Elements
  const questionContainer = document.getElementById('question-container');
  const previewContainer = document.getElementById('preview-container');
  const previewText = document.getElementById('preview-text');
  const resultsContainer = document.getElementById('results-container');
  const progressBar = document.getElementById('progress-bar');
  const currentStepEl = document.getElementById('current-step');
  const totalStepsEl = document.getElementById('total-steps');
  const recalculateBtn = document.getElementById('recalculate-btn');
  const copyBtn = document.getElementById('copy-btn');
  const copyMessage = document.getElementById('copy-message');
  const downloadBtn = document.getElementById('download-btn');
  
  // Set up variables
  let currentStep = 0;
  const userAnswers = {};
  const totalSteps = questions.length;
  let highlightTimeoutId;
  
  // Initialize the tool
  function initTool() {
    // Set total steps
    totalStepsEl.textContent = totalSteps;
    
    // Initialize with default values
    questions.forEach(question => {
      question.fields.forEach(field => {
        if (field.type === 'select') {
          const selectedOption = field.options.find(option => option.selected);
          if (selectedOption) {
            userAnswers[field.id] = selectedOption.value;
          } else if (field.options.length > 0) {
            userAnswers[field.id] = field.options[0].value;
          }
        } else if (field.type === 'radio') {
          const selectedOption = field.options.find(option => option.selected);
          if (selectedOption) {
            userAnswers[field.id] = selectedOption.value;
          } else if (field.options.length > 0) {
            userAnswers[field.id] = field.options[0].value;
          }
        } else if (field.type === 'checkbox') {
          field.options.forEach(option => {
            userAnswers[option.id] = option.checked || false;
          });
        } else {
          userAnswers[field.id] = field.value || '';
        }
      });
    });
    
    // Generate initial preview
    updatePreview();
    
    // Show first question
    showQuestion(0);
    
    // Add event listener to recalculate button
    recalculateBtn.addEventListener('click', function() {
      resultsContainer.style.display = 'none';
      resultsContainer.classList.remove('visible');
      previewContainer.style.display = 'block';
      questionContainer.style.display = 'block';
      showQuestion(0);
      
      // Scroll to the top of the tool
      document.getElementById('stock-purchase-agreement-generator').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start'
      });
    });
    
    // Add event listener to copy button
    copyBtn.addEventListener('click', function() {
      const agreementText = document.getElementById('agreement-text').innerText;
      
      try {
        navigator.clipboard.writeText(agreementText).then(function() {
          copyMessage.textContent = 'Agreement copied!';
          setTimeout(function() {
            copyMessage.textContent = '';
          }, 3000);
        }, function() {
          copyMessage.textContent = 'Unable to copy. Please select and copy manually.';
          setTimeout(function() {
            copyMessage.textContent = '';
          }, 3000);
        });
      } catch (e) {
        // Fallback for older browsers
        const textArea = document.createElement("textarea");
        textArea.value = agreementText;
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyMessage.textContent = 'Agreement copied!';
        } catch (err) {
          copyMessage.textContent = 'Unable to copy. Please select and copy manually.';
        }
        
        document.body.removeChild(textArea);
        setTimeout(function() {
          copyMessage.textContent = '';
        }, 3000);
      }
    });
    
    // Add event listener to download button
    downloadBtn.addEventListener('click', function() {
      generateDocx();
    });
  }
  
  // Generate DOCX file with better formatting
  function generateDocx() {
    try {
      // Access docx library
      const docx = window.docx;
      if (!docx) {
        throw new Error("DOCX library not loaded");
      }
      
      const companyName = userAnswers['company-name'] || 'ABC Corporation';
      
      // Get agreement text
      const agreementText = document.getElementById('agreement-text').innerText;
      
      // Remove the title section from the text content - we'll add our own formatted title
      let processedText = agreementText;
      processedText = processedText.replace(/STOCK PURCHASE AGREEMENT\s+\n/, '');
      
      // Parse sections for better formatting
      const lines = processedText.split('\n');
      const paragraphs = [];
      
      // Title - centered and bold
      paragraphs.push(
        new docx.Paragraph({
          alignment: docx.AlignmentType.CENTER,
          spacing: {
            before: 0,
            after: 0
          },
          children: [
            new docx.TextRun({
              text: "STOCK PURCHASE AGREEMENT",
              bold: true,
              size: 11 * 2 // docx uses half-points, so 11pt = 22 half-points
            })
          ]
        })
      );
      
      // Process each line
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        
        if (!line) {
          continue; // Skip empty lines
        }
        
        // Create paragraphs
        if (line.startsWith("ARTICLE") || line === "WITNESSETH:" || line === "NOW, THEREFORE:" || line === "RECITALS:") {
          // Add space before article heading
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              }
            })
          );
          
          // Article heading - bold and centered
          paragraphs.push(
            new docx.Paragraph({
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  bold: true,
                  size: 11 * 2
                })
              ]
            })
          );
          
          // Add space after article heading
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              }
            })
          );
        } else if (/^[A-Z0-9\.\s]{5,}:$/.test(line) || /^[0-9]+\.\s+[A-Z]/.test(line)) {
          // Add space before section heading
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              }
            })
          );
          
          // Section headings or numbered sections
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  bold: true,
                  size: 11 * 2
                })
              ]
            })
          );
          
          // Add space after section heading
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              }
            })
          );
        } else {
          // Regular paragraph
          paragraphs.push(
            new docx.Paragraph({
              spacing: {
                before: 0,
                after: 0
              },
              children: [
                new docx.TextRun({
                  text: line,
                  size: 11 * 2 // 11pt font size
                })
              ]
            })
          );
        }
      }
      
      // Create document with enhanced formatting
      const doc = new docx.Document({
        styles: {
          default: {
            document: {
              run: {
                size: 11 * 2, // 11pt font size (in half-points)
                font: "Calibri"
              },
              paragraph: {
                spacing: {
                  line: 240, // 1.0x line spacing
                  before: 0,
                  after: 0,
                  afterAutoSpacing: false,
                  beforeAutoSpacing: false
                }
              }
            }
          }
        },
        sections: [{
          properties: {
            page: {
              margin: {
                top: 1440, // 1 inch in twips
                right: 1440,
                bottom: 1440,
                left: 1440
              }
            }
          },
          children: paragraphs
        }]
      });
      
      // Generate and save document
      docx.Packer.toBlob(doc)
        .then(blob => {
          const fileName = `stock_purchase_agreement.docx`;
          window.saveAs(blob, fileName);
        })
        .catch(error => {
          console.error("Error saving DOCX:", error);
          alert("Unable to download. Please use the copy button instead.");
        });
    } catch (error) {
      console.error("DOCX generation error:", error);
      alert("Unable to download. Please use the copy button instead.");
    }
  }
  
  // Show a specific question
  function showQuestion(index) {
    currentStep = index;
    currentStepEl.textContent = index + 1;
    
    // Update progress bar
    progressBar.style.width = `${((index + 1) / totalSteps) * 100}%`;
    
    // Get the current question
    const question = questions[index];
    
    // Create the question HTML
    let html = `
      <div class="question-step" id="step-${question.id}">
        <h3>${question.title}</h3>
        <p class="question-description">${question.description}</p>
    `;
    
    // Add fields
    question.fields.forEach(field => {
      // Check if the field should be shown based on dependencies
      if (field.depends) {
        const dependParts = field.depends.split(':');
        const dependsOn = dependParts[0];
        const dependValues = dependParts[1].split(',');
        
        if (!userAnswers[dependsOn] || !dependValues.includes(userAnswers[dependsOn])) {
          return; // Skip this field if its dependency isn't met
        }
      }
      
      if (field.type === 'text') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="text" id="${field.id}" class="text-input" value="${userAnswers[field.id] || ''}">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'number') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="number" id="${field.id}" class="number-input" value="${userAnswers[field.id] || ''}" step="0.01">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'date') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <input type="date" id="${field.id}" class="date-input" value="${userAnswers[field.id] || ''}">
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'select') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <select id="${field.id}" class="select-input">
        `;
        field.options.forEach(option => {
          const isSelected = userAnswers[field.id] === option.value;
          html += `<option value="${option.value}" ${isSelected ? 'selected' : ''}>${option.label}</option>`;
        });
        html += `
            </select>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'textarea') {
        html += `
          <div class="input-group">
            <label for="${field.id}">${field.label}</label>
            <textarea id="${field.id}" class="textarea-input" rows="4">${userAnswers[field.id] || ''}</textarea>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
          </div>
        `;
      } else if (field.type === 'radio') {
        html += `
          <div class="input-group">
            <label>${field.label}</label>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
            <div class="radio-options">
        `;
        field.options.forEach(option => {
          const isSelected = userAnswers[field.id] === option.value;
          html += `
            <div class="radio-option ${isSelected ? 'selected' : ''}" data-value="${option.value}" data-field="${field.id}">
              <input type="radio" name="${field.id}" id="${field.id}-${option.value}" value="${option.value}" ${isSelected ? 'checked' : ''}>
              <div class="radio-label">
                <span class="radio-label-title">${option.title}</span>
                <span class="radio-label-desc">${option.description}</span>
              </div>
            </div>
          `;
        });
        html += `
            </div>
          </div>
        `;
      } else if (field.type === 'checkbox') {
        html += `
          <div class="checkbox-group">
            <label>${field.label}</label>
            ${field.helper ? `<div class="input-helper">${field.helper}</div>` : ''}
        `;
        
        field.options.forEach(option => {
          const isChecked = userAnswers[option.id];
          html += `
            <div class="checkbox-option ${isChecked ? 'selected' : ''}" data-id="${option.id}">
              <input type="checkbox" id="${option.id}" ${isChecked ? 'checked' : ''}>
              <div class="checkbox-label">
                <span class="checkbox-label-title">${option.label}</span>
                <span class="checkbox-label-desc">${option.desc || ''}</span>
              </div>
            </div>
          `;
        });
        
        html += `</div>`;
      }
    });
    
    html += `</div>`;
    
    // Add navigation buttons
    html += `
      <div class="tool-navigation">
        <button id="back-btn" class="tool-btn tool-btn-secondary" ${index === 0 ? 'disabled' : ''}>Back</button>
        <button id="continue-btn" class="tool-btn tool-btn-primary">${index === totalSteps - 1 ? 'Generate Agreement' : 'Continue'}</button>
      </div>
    `;
    
    // Set the HTML
    questionContainer.innerHTML = html;
    
    // Add event listeners to input fields for real-time preview updates
    const inputs = document.querySelectorAll('.text-input, .number-input, .date-input, .select-input, .textarea-input');
    inputs.forEach(input => {
      input.addEventListener('input', function() {
        // Store the answer
        userAnswers[this.id] = this.value;
        
        // Update the preview with the section that changed
        updatePreview(this.id);
      });
      
      // For select inputs, we need to use 'change' event instead of 'input'
      if (input.tagName.toLowerCase() === 'select') {
        input.addEventListener('change', function() {
          // Store the answer
          userAnswers[this.id] = this.value;
          
          // Update the preview with the section that changed
          updatePreview(this.id);
        });
      }
    });
    
    // Add event listeners to radio options
    const radioOptions = document.querySelectorAll('.radio-option');
    radioOptions.forEach(option => {
      option.addEventListener('click', function() {
        const fieldId = this.getAttribute('data-field');
        const value = this.getAttribute('data-value');
        
        // Update selection visually
        radioOptions.forEach(opt => {
          if (opt.getAttribute('data-field') === fieldId) {
            opt.classList.remove('selected');
          }
        });
        this.classList.add('selected');
        
        // Update the radio button
        this.querySelector('input').checked = true;
        
        // Store the answer
        userAnswers[fieldId] = value;
        
        // Check for dependent fields
        const dependentFields = questions[currentStep].fields.filter(field => 
          field.depends && field.depends.startsWith(fieldId + ':')
        );
        
        if (dependentFields.length > 0) {
          // Re-render the step to update visibility of dependent fields
          saveCurrentAnswers();
          showQuestion(currentStep);
        }
        
        // Update the preview with section that changed
        updatePreview(fieldId);
      });
    });
    
    // Add event listeners to checkbox options
    const checkboxOptions = document.querySelectorAll('.checkbox-option');
    checkboxOptions.forEach(option => {
      option.addEventListener('click', function() {
        const optionId = this.getAttribute('data-id');
        const checkbox = this.querySelector('input[type="checkbox"]');
        
        // Toggle selection
        this.classList.toggle('selected');
        checkbox.checked = !checkbox.checked;
        
        // Store the answer
        userAnswers[optionId] = checkbox.checked;
        
        // Update the preview with the section that changed
        updatePreview(optionId);
      });
    });
    
    // Add event listeners to the Back and Continue buttons
    document.getElementById('back-btn').addEventListener('click', function() {
      if (currentStep > 0) {
        // Save current answers
        saveCurrentAnswers();
        // Go to previous question
        showQuestion(currentStep - 1);
      }
    });
    
    document.getElementById('continue-btn').addEventListener('click', function() {
      // Save current answers
      saveCurrentAnswers();
      
      if (currentStep < totalSteps - 1) {
        // Go to next question
        showQuestion(currentStep + 1);
      } else {
        // Generate agreement
        generateAgreement();
      }
    });
  }
  
  // Save the current answers from the form
  function saveCurrentAnswers() {
    const question = questions[currentStep];
    
    question.fields.forEach(field => {
      if (['text', 'number', 'date', 'select', 'textarea'].includes(field.type)) {
        const inputEl = document.getElementById(field.id);
        if (inputEl) {
          userAnswers[field.id] = inputEl.value;
        }
      } else if (field.type === 'radio') {
        const selectedRadio = document.querySelector(`input[name="${field.id}"]:checked`);
        if (selectedRadio) {
          userAnswers[field.id] = selectedRadio.value;
        }
      } else if (field.type === 'checkbox') {
        field.options.forEach(option => {
          const checkboxEl = document.getElementById(option.id);
          if (checkboxEl) {
            userAnswers[option.id] = checkboxEl.checked;
          }
        });
      }
    });
  }
  
  // Get specific object sections for preview
  function getHeaderSection() {
    const companyName = userAnswers['company-name'] || 'ABC Corporation';
    const stateOfIncorporation = userAnswers['state-of-incorporation'] || 'California';
    const agreementDate = userAnswers['agreement-date'] ? formatDateForDisplay(userAnswers['agreement-date']) : formatDateForDisplay(formattedDate);
    const sellerName = userAnswers['seller-name'] || 'John Smith';
    const purchaserName = userAnswers['purchaser-name'] || 'Jane Doe';
    
    return `<div id="preview-header">STOCK PURCHASE AGREEMENT

THIS STOCK PURCHASE AGREEMENT (the "Agreement") is made and entered into as of ${agreementDate} (the "Effective Date"), by and between ${sellerName} (the "Seller"), and ${purchaserName} (the "Purchaser").

RECITALS:

WHEREAS, Seller is the record owner and holder of certain issued and outstanding shares of capital stock of ${companyName}, a ${stateOfIncorporation} corporation (the "Company"); and

WHEREAS, Purchaser desires to purchase from Seller, and Seller desires to sell to Purchaser, shares of the capital stock of the Company pursuant to the terms and conditions set forth herein.</div>`;
  }
  
  function getStockDetailsSection() {
    const stockType = userAnswers['stock-type'] || 'common';
    const stockTypeOther = userAnswers['stock-type-other'] || '';
    const sharesNumber = userAnswers['shares-number'] || '1000';
    const pricePerShare = userAnswers['price-per-share'] || '10.00';
    const totalPurchasePrice = (parseFloat(sharesNumber) * parseFloat(pricePerShare)).toFixed(2);
    
    // Determine stock type display text
    let stockTypeText = 'Common Stock';
    if (stockType === 'preferred') {
      stockTypeText = 'Preferred Stock';
    } else if (stockType === 'restricted') {
      stockTypeText = 'Restricted Stock';
    } else if (stockType === 'other' && stockTypeOther) {
      stockTypeText = stockTypeOther;
    }
    
    return `<div id="preview-stock-details">NOW, THEREFORE, in consideration of the foregoing recitals and the mutual promises, representations, warranties, and covenants hereinafter set forth and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties hereto agree as follows:

1. AGREEMENT TO PURCHASE AND SELL STOCK.

1.1 Subject to the terms and conditions of this Agreement, Seller hereby agrees to sell, assign, transfer, convey, and deliver to Purchaser, and Purchaser hereby agrees to purchase from Seller, ${sharesNumber} shares of ${stockTypeText} of the Company (the "Shares").

1.2 The purchase price for the Shares shall be ${formatCurrency(pricePerShare)} per share, for a total purchase price of ${formatCurrency(totalPurchasePrice)} (the "Purchase Price").</div>`;
  }
  
  function getPaymentTermsSection() {
    const paymentMethod = userAnswers['payment-method'] || 'lump-sum';
    const paymentTiming = userAnswers['payment-timing'] || 'closing';
    const daysAfterClosing = userAnswers['days-after-closing'] || '30';
    const installmentTerms = userAnswers['installment-terms'] || '';
    const otherConsiderationDetails = userAnswers['other-consideration-details'] || '';
    
    let paymentTermsText = '';
    
    if (paymentMethod === 'lump-sum') {
      if (paymentTiming === 'closing') {
        paymentTermsText = 'Purchaser shall pay the Purchase Price to Seller in full at the Closing (as defined below) in cash, by certified check, or by wire transfer of immediately available funds to an account designated by Seller.';
      } else if (paymentTiming === 'days-after') {
        paymentTermsText = `Purchaser shall pay the Purchase Price to Seller in full within ${daysAfterClosing} days after the Closing (as defined below) in cash, by certified check, or by wire transfer of immediately available funds to an account designated by Seller.`;
      } else if (paymentTiming === 'custom') {
        paymentTermsText = 'Purchaser shall pay the Purchase Price to Seller according to the payment schedule set forth in Exhibit A attached hereto.';
      }
    } else if (paymentMethod === 'installments') {
      paymentTermsText = installmentTerms || 'Purchaser shall pay the Purchase Price to Seller in installments according to the payment schedule set forth in Exhibit A attached hereto.';
    } else if (paymentMethod === 'other-consideration') {
      paymentTermsText = otherConsiderationDetails || 'The Purchase Price shall be paid in the form of consideration set forth in Exhibit A attached hereto.';
    }
    
    return `<div id="preview-payment-terms">2. PAYMENT OF PURCHASE PRICE.

${paymentTermsText}</div>`;
  }
  
  function getRepresentationsSection() {
    const repOwnership = userAnswers['rep-ownership'] || false;
    const repAuthority = userAnswers['rep-authority'] || false;
    const repRestrictions = userAnswers['rep-restrictions'] || false;
    const repLitigation = userAnswers['rep-litigation'] || false;
    
    const repPurchaserAuthority = userAnswers['rep-purchaser-authority'] || false;
    const repInvestment = userAnswers['rep-investment'] || false;
    const repAccredited = userAnswers['rep-accredited'] || false;
    const repSecuritiesLaws = userAnswers['rep-securities-laws'] || false;
    
    const additionalRepresentations = userAnswers['additional-representations'] || '';
    
    let representationsText = `3. REPRESENTATIONS AND WARRANTIES.

3.1 Representations and Warranties of Seller. Seller hereby represents and warrants to Purchaser as follows:
`;
    
    let sellerRepIndex = 1;
    if (repOwnership) {
      representationsText += `
3.1.${sellerRepIndex} Seller is the record and beneficial owner of the Shares and has good and marketable title to the Shares, free and clear of all liens, pledges, security interests, encumbrances, claims, or equities of any kind.`;
      sellerRepIndex++;
    }
    
    if (repAuthority) {
      representationsText += `
3.1.${sellerRepIndex} Seller has the full right, power, and authority to enter into this Agreement and to sell, assign, transfer, and convey the Shares to Purchaser pursuant to this Agreement.`;
      sellerRepIndex++;
    }
    
    if (repRestrictions) {
      representationsText += `
3.1.${sellerRepIndex} There are no restrictions on the transfer of the Shares imposed by any shareholder agreement, voting agreement, right of first refusal, or any other restriction, except as explicitly stated in this Agreement.`;
      sellerRepIndex++;
    }
    
    if (repLitigation) {
      representationsText += `
3.1.${sellerRepIndex} There is no action, suit, proceeding, or investigation pending or, to Seller's knowledge, threatened that could affect Seller's right to transfer the Shares to Purchaser.`;
      sellerRepIndex++;
    }
    
    representationsText += `

3.2 Representations and Warranties of Purchaser. Purchaser hereby represents and warrants to Seller as follows:
`;
    
    let purchaserRepIndex = 1;
    if (repPurchaserAuthority) {
      representationsText += `
3.2.${purchaserRepIndex} Purchaser has the full right, power, and authority to enter into this Agreement and to purchase the Shares from Seller pursuant to this Agreement.`;
      purchaserRepIndex++;
    }
    
    if (repInvestment) {
      representationsText += `
3.2.${purchaserRepIndex} Purchaser is acquiring the Shares for investment purposes and not with a view to resale or distribution in violation of applicable securities laws.`;
      purchaserRepIndex++;
    }
    
    if (repAccredited) {
      representationsText += `
3.2.${purchaserRepIndex} Purchaser is an "accredited investor" as defined in Rule 501(a) of Regulation D promulgated under the Securities Act of 1933, as amended.`;
      purchaserRepIndex++;
    }
    
    if (repSecuritiesLaws) {
      representationsText += `
3.2.${purchaserRepIndex} Purchaser understands that the Shares have not been registered under the Securities Act of 1933, as amended, or any state securities laws, and may not be sold, transferred, or otherwise disposed of without registration under such laws or pursuant to an exemption therefrom.`;
      purchaserRepIndex++;
    }
    
    if (additionalRepresentations) {
      representationsText += `

3.3 Additional Representations and Warranties.

${additionalRepresentations}`;
    }
    
    return `<div id="preview-representations">${representationsText}</div>`;
  }
  
  function getClosingSection() {
    const closingDate = userAnswers['closing-date'] || 'upon-execution';
    const specificClosingDate = userAnswers['specific-closing-date'] ? formatDateForDisplay(userAnswers['specific-closing-date']) : '';
    const closingConditions = userAnswers['closing-conditions'] || '';
    
    let closingText = `4. CLOSING.

`;
    
    if (closingDate === 'upon-execution') {
      closingText += `4.1 The closing of the transactions contemplated by this Agreement (the "Closing") shall take place simultaneously with the execution of this Agreement by the parties hereto.`;
    } else if (closingDate === 'specific-date' && specificClosingDate) {
      closingText += `4.1 The closing of the transactions contemplated by this Agreement (the "Closing") shall take place on ${specificClosingDate}, or at such other time and place as the parties may mutually agree.`;
    } else if (closingDate === 'conditions' && closingConditions) {
      closingText += `4.1 The closing of the transactions contemplated by this Agreement (the "Closing") shall take place upon satisfaction of the following conditions:

${closingConditions}`;
    } else {
      closingText += `4.1 The closing of the transactions contemplated by this Agreement (the "Closing") shall take place at such time and place as the parties may mutually agree.`;
    }
    
    closingText += `

4.2 At the Closing:

4.2.1 Seller shall deliver to Purchaser (i) a stock certificate or certificates representing the Shares, duly endorsed for transfer or accompanied by a duly executed stock power, and (ii) any other documents reasonably requested by Purchaser to effectuate the transfer of the Shares.

4.2.2 Purchaser shall deliver to Seller the Purchase Price in accordance with Section 2 of this Agreement.`;
    
    return `<div id="preview-closing">${closingText}</div>`;
  }
  
  function getMiscellaneousSection() {
    const governingLaw = userAnswers['governing-law'] || 'California';
    const additionalProvisions = userAnswers['additional-provisions'] || '';
    
    let miscText = `5. MISCELLANEOUS.

5.1 Governing Law. This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw}, without giving effect to any choice of law or conflict of law provisions.

5.2 Successors and Assigns. This Agreement shall be binding upon and inure to the benefit of the parties hereto and their respective successors and permitted assigns.

5.3 Entire Agreement. This Agreement constitutes the entire agreement between the parties with respect to the subject matter hereof and supersedes all prior agreements and understandings, both written and oral, between the parties with respect to the subject matter hereof.

5.4 Amendments and Waivers. This Agreement may not be amended or modified except by an instrument in writing signed by both parties. Waiver of any term or condition of this Agreement shall only be effective if in writing and shall not be construed as a waiver of any subsequent breach or failure of the same term or condition.

5.5 Counterparts. This Agreement may be executed in counterparts, each of which shall be deemed an original, but all of which together shall constitute one and the same instrument.`;
    
    if (additionalProvisions) {
      miscText += `

5.6 Additional Provisions.

${additionalProvisions}`;
    }
    
    return `<div id="preview-miscellaneous">${miscText}</div>`;
  }
  
  function getSignatureSection() {
    const sellerName = userAnswers['seller-name'] || 'John Smith';
    const sellerAddress = userAnswers['seller-address'] || '123 Seller Street, San Francisco, CA 94101';
    const purchaserName = userAnswers['purchaser-name'] || 'Jane Doe';
    const purchaserAddress = userAnswers['purchaser-address'] || '456 Buyer Avenue, San Francisco, CA 94102';
    
    return `<div id="preview-signature">IN WITNESS WHEREOF, the parties hereto have executed this Stock Purchase Agreement as of the date first written above.

SELLER:

__________________________
${sellerName}
${sellerAddress}


PURCHASER:

__________________________
${purchaserName}
${purchaserAddress}</div>`;
  }
  
  // Update the agreement preview based on current selections
  function updatePreview(changedSection = null) {
    // Remove any existing highlights
    if (highlightTimeoutId) {
      clearTimeout(highlightTimeoutId);
    }
    
    // Define the sections and their content
    const sections = {
      header: getHeaderSection(),
      stockDetails: getStockDetailsSection(),
      paymentTerms: getPaymentTermsSection(),
      representations: getRepresentationsSection(),
      closing: getClosingSection(),
      miscellaneous: getMiscellaneousSection(),
      signature: getSignatureSection()
    };
    
    // Combine all sections
    const previewHTML = 
        sections.header + '\n\n' + 
        sections.stockDetails + '\n\n' + 
        sections.paymentTerms + '\n\n' + 
        sections.representations + '\n\n' + 
        sections.closing + '\n\n' + 
        sections.miscellaneous + '\n\n' + 
        sections.signature;
    
    // Set the preview HTML
    previewText.innerHTML = previewHTML;
    
    // If a section has changed, highlight it
    if (changedSection) {
      highlightChangedText(changedSection);
    }
  }
  
  // Highlight changed text in the preview
  function highlightChangedText(changedSection) {
    // Clear any existing highlights
    const existingHighlights = document.querySelectorAll('.highlight');
    existingHighlights.forEach(el => {
      el.classList.remove('highlight');
    });
    
    // Determine which section and text to highlight
    let sectionId = '';
    let textToFind = '';
    
    // Parties Info fields
    if (['company-name', 'state-of-incorporation', 'seller-name', 'seller-address', 'purchaser-name', 'purchaser-address'].includes(changedSection)) {
      sectionId = 'preview-header';
      
      if (changedSection === 'company-name') {
        textToFind = userAnswers['company-name'] || 'ABC Corporation';
      } else if (changedSection === 'state-of-incorporation') {
        textToFind = userAnswers['state-of-incorporation'] || 'California';
      } else if (changedSection === 'seller-name') {
        textToFind = userAnswers['seller-name'] || 'John Smith';
      } else if (changedSection === 'purchaser-name') {
        textToFind = userAnswers['purchaser-name'] || 'Jane Doe';
      }
    } 
    // Stock Details fields
    else if (['agreement-date', 'stock-type', 'stock-type-other', 'shares-number', 'price-per-share'].includes(changedSection)) {
      if (changedSection === 'agreement-date') {
        sectionId = 'preview-header';
        const formattedDate = userAnswers['agreement-date'] ? formatDateForDisplay(userAnswers['agreement-date']) : formatDateForDisplay(formattedDate);
        textToFind = formattedDate;
      } else {
        sectionId = 'preview-stock-details';
        
        if (changedSection === 'stock-type' || changedSection === 'stock-type-other') {
          const stockType = userAnswers['stock-type'] || 'common';
          const stockTypeOther = userAnswers['stock-type-other'] || '';
          
          let stockTypeText = 'Common Stock';
          if (stockType === 'preferred') {
            stockTypeText = 'Preferred Stock';
          } else if (stockType === 'restricted') {
            stockTypeText = 'Restricted Stock';
          } else if (stockType === 'other' && stockTypeOther) {
            stockTypeText = stockTypeOther;
          }
          
          textToFind = stockTypeText;
        } else if (changedSection === 'shares-number') {
          textToFind = userAnswers['shares-number'] || '1000';
        } else if (changedSection === 'price-per-share') {
          const pricePerShare = userAnswers['price-per-share'] || '10.00';
          textToFind = formatCurrency(pricePerShare);
        }
      }
    }
    // Payment Terms fields
    else if (['payment-method', 'payment-timing', 'days-after-closing', 'installment-terms', 'other-consideration-details'].includes(changedSection)) {
      sectionId = 'preview-payment-terms';
      
      const paymentMethod = userAnswers['payment-method'] || 'lump-sum';
      
      if (paymentMethod === 'lump-sum') {
        textToFind = 'Purchaser shall pay the Purchase Price to Seller in full';
      } else if (paymentMethod === 'installments') {
        textToFind = userAnswers['installment-terms'] || 'installments';
      } else if (paymentMethod === 'other-consideration') {
        textToFind = userAnswers['other-consideration-details'] || 'consideration';
      }
    }
    // Representations fields
    else if (['rep-ownership', 'rep-authority', 'rep-restrictions', 'rep-litigation', 
              'rep-purchaser-authority', 'rep-investment', 'rep-accredited', 'rep-securities-laws',
              'additional-representations'].includes(changedSection)) {
      sectionId = 'preview-representations';
      
      if (changedSection === 'rep-ownership') {
        textToFind = 'good and marketable title to the Shares';
      } else if (changedSection === 'rep-authority') {
        textToFind = 'full right, power, and authority to enter into this Agreement';
      } else if (changedSection === 'rep-restrictions') {
        textToFind = 'no restrictions on the transfer of the Shares';
      } else if (changedSection === 'rep-litigation') {
        textToFind = 'no action, suit, proceeding, or investigation pending';
      } else if (changedSection === 'rep-purchaser-authority') {
        textToFind = 'Purchaser has the full right, power, and authority';
      } else if (changedSection === 'rep-investment') {
        textToFind = 'investment purposes';
      } else if (changedSection === 'rep-accredited') {
        textToFind = 'accredited investor';
      } else if (changedSection === 'rep-securities-laws') {
        textToFind = 'not been registered under the Securities Act';
      } else if (changedSection === 'additional-representations') {
        textToFind = userAnswers['additional-representations'] || '';
      }
    }
    // Closing & Additional Terms fields
    else if (['closing-date', 'specific-closing-date', 'closing-conditions'].includes(changedSection)) {
      sectionId = 'preview-closing';
      
      const closingDate = userAnswers['closing-date'] || 'upon-execution';
      
      if (closingDate === 'upon-execution') {
        textToFind = 'simultaneously with the execution of this Agreement';
      } else if (closingDate === 'specific-date') {
        const specificClosingDate = userAnswers['specific-closing-date'] ? formatDateForDisplay(userAnswers['specific-closing-date']) : '';
        textToFind = specificClosingDate;
      } else if (closingDate === 'conditions') {
        textToFind = userAnswers['closing-conditions'] || '';
      }
    }
    // Miscellaneous fields
    else if (['governing-law', 'additional-provisions'].includes(changedSection)) {
      sectionId = 'preview-miscellaneous';
      
      if (changedSection === 'governing-law') {
        textToFind = 'State of ' + (userAnswers['governing-law'] || 'California');
      } else if (changedSection === 'additional-provisions') {
        textToFind = userAnswers['additional-provisions'] || '';
      }
    }
    
    // Find and highlight the text
    if (sectionId && textToFind) {
      const sectionElement = document.getElementById(sectionId);
      if (sectionElement) {
        // First, we need to escape special characters for use in regex
        const escapedText = textToFind.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        
        // Create a simple regex to find the text
        const regex = new RegExp(`(${escapedText})`, 'g');
        
        // Create a temporary div, set its HTML to the section's innerHTML,
        // and then use replace to wrap the text with a span
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = sectionElement.innerHTML;
        
        // Replace the text with highlighted version
        tempDiv.innerHTML = tempDiv.innerHTML.replace(regex, '<span class="highlight">$1</span>');
        
        // Set the section's innerHTML to the new HTML
        sectionElement.innerHTML = tempDiv.innerHTML;
        
        // Make sure the highlighted text is visible
        const highlightedElement = sectionElement.querySelector('.highlight');
        if (highlightedElement) {
          // Ensure that the scrollContainer is visible
          const previewContent = document.querySelector('.preview-content');
          
          // Calculate positions to determine if scrolling is needed
          const containerRect = previewContent.getBoundingClientRect();
          const highlightRect = highlightedElement.getBoundingClientRect();
          
          // Only scroll if the highlighted element is not fully visible
          if (highlightRect.top < containerRect.top || highlightRect.bottom > containerRect.bottom) {
            highlightedElement.scrollIntoView({
              behavior: 'smooth',
              block: 'center'
            });
          }
        }
      }
    }
  }
  
  // Generate the agreement based on user selections
  function generateAgreement() {
    // Get all the sections and combine them
    const headerSection = getHeaderSection().replace('<div id="preview-header">', '').replace('</div>', '');
    const stockDetailsSection = getStockDetailsSection().replace('<div id="preview-stock-details">', '').replace('</div>', '');
    const paymentTermsSection = getPaymentTermsSection().replace('<div id="preview-payment-terms">', '').replace('</div>', '');
    const representationsSection = getRepresentationsSection().replace('<div id="preview-representations">', '').replace('</div>', '');
    const closingSection = getClosingSection().replace('<div id="preview-closing">', '').replace('</div>', '');
    const miscellaneousSection = getMiscellaneousSection().replace('<div id="preview-miscellaneous">', '').replace('</div>', '');
    const signatureSection = getSignatureSection().replace('<div id="preview-signature">', '').replace('</div>', '');
    
    const agreementText = 
        headerSection + '\n\n' + 
        stockDetailsSection + '\n\n' + 
        paymentTermsSection + '\n\n' + 
        representationsSection + '\n\n' + 
        closingSection + '\n\n' + 
        miscellaneousSection + '\n\n' + 
        signatureSection;
    
    // Display the agreement text
    const agreementTextElement = document.getElementById('agreement-text');
    agreementTextElement.textContent = agreementText;
    
    // Hide question container and preview container, and show results
    questionContainer.style.display = 'none';
    previewContainer.style.display = 'none';
    resultsContainer.style.display = 'block';
    
    // Add visible class after a slight delay for animation
    setTimeout(() => {
      resultsContainer.classList.add('visible');
    }, 50);
    
    // Scroll to the top of the results
    document.querySelector('.results-header').scrollIntoView({ behavior: 'smooth' });
  }
  
  // Initialize the tool
  initTool();
});
</script>



<h1 class="wp-block-heading"></h1>



<p>Creating a legally sound stock purchase agreement is crucial when transferring ownership of shares. Whether you&#8217;re a startup founder selling equity, an investor acquiring stock, or a business owner restructuring ownership, a well-drafted stock purchase agreement protects all parties and clearly defines the terms of the transaction.</p>



<h2 class="wp-block-heading">What Is a Stock Purchase Agreement?</h2>



<p>A Stock Purchase Agreement (SPA) is a legally binding contract that documents the sale and transfer of shares between a seller and purchaser. This document formalizes the terms of the stock transaction, including the number of shares being sold, purchase price, payment terms, and various representations and warranties made by both parties.</p>



<p>Unlike handshake deals or informal agreements, a properly drafted SPA provides legal protection and clarity by establishing precisely what&#8217;s being purchased, for how much, and under what conditions. It creates a paper trail that can prove invaluable if disagreements arise later.</p>



<h3 class="wp-block-heading">When You Need a Stock Purchase Agreement</h3>



<p>You should use a stock purchase agreement in several scenarios:</p>



<ul class="wp-block-list">
<li>When selling or purchasing shares in a privately-held company</li>



<li>For transactions between existing shareholders</li>



<li>When bringing on new investors</li>



<li>For employee stock ownership transfers</li>



<li>In mergers and acquisitions involving stock transfers</li>



<li>For family business succession planning</li>
</ul>



<p>The complexity of the agreement should match the complexity of the transaction. A simple transfer between family members might require only basic terms, while a sophisticated investment from a venture capital firm would demand more comprehensive provisions.</p>



<h2 class="wp-block-heading">Key Components of a Stock Purchase Agreement</h2>



<h3 class="wp-block-heading">1. Identification of Parties and Company</h3>



<p>The agreement begins by identifying all parties involved and the company whose shares are being transferred. This section includes:</p>



<ul class="wp-block-list">
<li>Full legal names of seller(s) and purchaser(s)</li>



<li>Contact information and addresses</li>



<li>Company name and state of incorporation</li>



<li>Effective date of the agreement</li>
</ul>



<p>Accuracy is crucial hereâ€”using proper legal names prevents confusion and enforceability issues later.</p>



<h3 class="wp-block-heading">2. Stock Details and Purchase Price</h3>



<p>This section defines exactly what&#8217;s being sold and for how much:</p>



<ul class="wp-block-list">
<li>Number and class of shares (common, preferred, restricted, etc.)</li>



<li>Price per share and total purchase price</li>



<li>Any stock certificate numbers being transferred</li>



<li>Percentage of ownership represented by the shares</li>
</ul>



<p>When dealing with different classes of stock, be specific about voting rights, dividend preferences, and other special rights attached to the shares.</p>



<h3 class="wp-block-heading">3. Payment Terms</h3>



<p>The payment section outlines how and when the purchaser will pay for the shares:</p>



<ul class="wp-block-list">
<li>Payment method (cash, wire transfer, check)</li>



<li>Whether payment is in lump sum or installments</li>



<li>Payment timing (at closing, deferred, or according to a schedule)</li>



<li>Any escrow arrangements for portions of the payment</li>



<li>Treatment of deposits or earnest money</li>
</ul>



<p>Clear payment terms help prevent misunderstandings and provide remedies if payment obligations aren&#8217;t met.</p>



<h3 class="wp-block-heading">4. Representations and Warranties</h3>



<p>These provisions are promises that each party makes to the other:</p>



<p><strong>Seller representations commonly include:</strong></p>



<ul class="wp-block-list">
<li>They own the shares free of any liens or encumbrances</li>



<li>They have authority to sell the shares</li>



<li>There are no restrictions on transfer except as stated</li>



<li>No pending litigation affecting the shares</li>
</ul>



<p><strong>Purchaser representations commonly include:</strong></p>



<ul class="wp-block-list">
<li>They have authority to make the purchase</li>



<li>They&#8217;re buying for investment purposes, not resale</li>



<li>They understand any securities law implications</li>



<li>They have sufficient funds to complete the transaction</li>
</ul>



<p>These statements provide important legal protectionâ€”if they turn out to be false, the injured party can seek remedies for misrepresentation.</p>



<h3 class="wp-block-heading">5. Closing Conditions and Process</h3>



<p>This section details when and how the transaction will be completed:</p>



<ul class="wp-block-list">
<li>Closing date and location</li>



<li>Documents to be exchanged at closing</li>



<li>Actions to be taken by each party</li>



<li>Conditions that must be satisfied before closing</li>



<li>Process for transferring stock certificates</li>
</ul>



<p>For simple transactions, closing might happen simultaneously with signing. For complex deals, there may be a period between signing and closing while conditions are satisfied.</p>



<h3 class="wp-block-heading">6. Additional Provisions</h3>



<p>Depending on the transaction, you might need additional sections:</p>



<ul class="wp-block-list">
<li><strong>Confidentiality clauses</strong> regarding company information</li>



<li><strong>Non-compete provisions</strong> for selling shareholders</li>



<li><strong>Right of first refusal</strong> on future stock sales</li>



<li><strong>Dispute resolution</strong> procedures</li>



<li><strong>Governing law</strong> and jurisdiction</li>



<li><strong>Indemnification</strong> provisions for future claims</li>
</ul>



<h2 class="wp-block-heading">Using the Stock Purchase Agreement Generator</h2>



<p>The Stock Purchase Agreement Generator simplifies the creation of this important document by guiding you through a step-by-step process:</p>



<h3 class="wp-block-heading">Step 1: Parties Information</h3>



<p>Enter basic details about who&#8217;s involved in the transaction:</p>



<ul class="wp-block-list">
<li>Company name and state of incorporation</li>



<li>Seller&#8217;s full name and address</li>



<li>Purchaser&#8217;s full name and address</li>
</ul>



<p>These details ensure the agreement correctly identifies all parties with legal standing.</p>



<h3 class="wp-block-heading">Step 2: Stock Details</h3>



<p>Specify the particulars of the stock being sold:</p>



<ul class="wp-block-list">
<li>Date of the agreement</li>



<li>Type of stock (common, preferred, restricted)</li>



<li>Number of shares being transferred</li>



<li>Price per share</li>
</ul>



<p>The generator calculates the total purchase price automatically based on your inputs.</p>



<h3 class="wp-block-heading">Step 3: Payment Terms</h3>



<p>Define how payment will be handled:</p>



<ul class="wp-block-list">
<li>Payment method (lump sum, installments, other consideration)</li>



<li>Payment timing (at closing, days after closing, custom schedule)</li>



<li>Specific payment details for installments or alternative arrangements</li>
</ul>



<p>Clear payment terms prevent confusion and provide a basis for enforcement if needed.</p>



<h3 class="wp-block-heading">Step 4: Representations &amp; Warranties</h3>



<p>Select the statements each party will make:</p>



<ul class="wp-block-list">
<li>Seller representations about ownership, authority, and restrictions</li>



<li>Purchaser representations about investment intent and securities laws</li>



<li>Any additional custom representations specific to your transaction</li>
</ul>



<p>These provisions create important legal protections for both parties.</p>



<h3 class="wp-block-heading">Step 5: Additional Terms</h3>



<p>Complete the agreement with closing details and final provisions:</p>



<ul class="wp-block-list">
<li>Closing date arrangements</li>



<li>State law governing the agreement</li>



<li>Any additional custom provisions for your specific needs</li>
</ul>



<h2 class="wp-block-heading">Legal Considerations for Stock Purchase Agreements</h2>



<h3 class="wp-block-heading">Securities Law Compliance</h3>



<p>When transferring stock, you must consider whether the transaction needs to comply with federal and state securities laws:</p>



<p>The Securities Act of 1933 generally requires that securities offerings be registered with the SEC unless an exemption applies. Common exemptions for private company stock transfers include:</p>



<ul class="wp-block-list">
<li><strong>Rule 506 of Regulation D</strong> for private placements to accredited investors</li>



<li><strong>Section 4(a)(2)</strong> for transactions not involving a public offering</li>



<li><strong>Rule 701</strong> for compensatory arrangements with employees</li>
</ul>



<p>Your stock purchase agreement should include appropriate representations that the transaction qualifies for an exemption from registration.</p>



<h3 class="wp-block-heading">Transfer Restrictions</h3>



<p>Many private companies have existing transfer restrictions in their:</p>



<ul class="wp-block-list">
<li>Bylaws</li>



<li>Shareholder agreements</li>



<li>Stock option plans</li>



<li>Investor rights agreements</li>
</ul>



<p>Before drafting a stock purchase agreement, verify whether the shares are subject to:</p>



<ul class="wp-block-list">
<li>Rights of first refusal</li>



<li>Co-sale rights</li>



<li>Board approval requirements</li>



<li>Transfer limitations</li>
</ul>



<p>These existing restrictions must be addressed in your agreement either through compliance or obtaining appropriate waivers.</p>



<h3 class="wp-block-heading">Tax Implications</h3>



<p>Stock transfers can trigger significant tax consequences for both parties:</p>



<p><strong>For sellers:</strong></p>



<ul class="wp-block-list">
<li>Capital gains tax on appreciated shares</li>



<li>Ordinary income treatment for certain compensatory equity</li>
</ul>



<p><strong>For purchasers:</strong></p>



<ul class="wp-block-list">
<li>Potential future tax basis issues</li>



<li>Implications for company tax attributes</li>
</ul>



<p>While your stock purchase agreement isn&#8217;t a tax document, it should acknowledge the parties&#8217; responsibility for their own tax consequences and may include cooperation provisions for consistent tax reporting.</p>



<h2 class="wp-block-heading">Best Practices for Stock Transactions</h2>



<h3 class="wp-block-heading">Due Diligence</h3>



<p>Before finalizing a stock purchase agreement, purchasers should conduct appropriate due diligence, which might include:</p>



<ul class="wp-block-list">
<li>Reviewing company financial statements</li>



<li>Examining corporate records and minute books</li>



<li>Verifying outstanding debt and obligations</li>



<li>Confirming there are no undisclosed liabilities</li>



<li>Checking for pending litigation or claims</li>
</ul>



<p>The agreement&#8217;s representations and warranties provide protection, but they&#8217;re no substitute for proper investigation.</p>



<h3 class="wp-block-heading">Documentation and Record Keeping</h3>



<p>Maintain complete records of the stock transaction:</p>



<ul class="wp-block-list">
<li>Original signed agreement</li>



<li>Stock certificates (canceled and newly issued)</li>



<li>Corporate approvals (board resolutions, shareholder consents)</li>



<li>Payment confirmations</li>



<li>Related agreements (voting agreements, rights agreements)</li>
</ul>



<p>Good record-keeping helps prevent disputes and facilitates future transactions or company sales.</p>



<h3 class="wp-block-heading">Implementing Transfer Mechanics</h3>



<p>After signing the agreement, ensure proper implementation:</p>



<ul class="wp-block-list">
<li>Return old certificates and issue new ones</li>



<li>Update the company&#8217;s stock ledger</li>



<li>File any required corporate or securities filings</li>



<li>Make appropriate entries in accounting records</li>



<li>Provide required notices to other shareholders or the board</li>
</ul>



<p>Incomplete implementation can create questions about whether the transfer was actually completed.</p>



<h2 class="wp-block-heading">Common Pitfalls to Avoid</h2>



<p>When creating a stock purchase agreement, be careful to avoid these common mistakes:</p>



<ul class="wp-block-list">
<li><strong>Inconsistency with existing agreements</strong>: Ensure your stock purchase agreement doesn&#8217;t conflict with shareholder agreements, company bylaws, or other contracts.</li>



<li><strong>Inadequate due diligence</strong>: Failing to verify key facts about the company or the shares being transferred can lead to costly surprises.</li>



<li><strong>Vague payment terms</strong>: Ambiguous language about when and how payment will be made creates enforcement challenges.</li>



<li><strong>Overlooking securities laws</strong>: Ignoring registration requirements or exemption conditions can invalidate the transaction and create liability.</li>
</ul>



<p>My generator helps avoid these issues by providing clear sections for each critical component and guiding you through the process systematically.</p>



<h2 class="wp-block-heading">Special Considerations for Startups</h2>



<p>Startups have unique considerations when transferring equity:</p>



<h3 class="wp-block-heading">Valuation Challenges</h3>



<p>Early-stage companies often struggle with determining appropriate share valuation. Consider:</p>



<ul class="wp-block-list">
<li>Recent financing rounds as benchmarks</li>



<li>Independent valuation reports for significant transactions</li>



<li>409A valuations if available</li>



<li>Consistent valuation approaches for similar transactions</li>
</ul>



<p>The stock purchase agreement should document the agreed valuation and acknowledge that both parties are satisfied with it.</p>



<h3 class="wp-block-heading">Intellectual Property Protection</h3>



<p>For technology startups, protecting intellectual property during ownership changes is crucial:</p>



<ul class="wp-block-list">
<li>Confidentiality provisions for sensitive information disclosed during the transaction</li>



<li>Limitations on use of proprietary information</li>



<li>Clear assignment of any IP rights involved in the transaction</li>
</ul>



<h3 class="wp-block-heading">Future Financing Impacts</h3>



<p>Consider how the stock sale might affect:</p>



<ul class="wp-block-list">
<li>Company capitalization tables</li>



<li>Future financing rounds</li>



<li>Investor rights and preferences</li>



<li>Voting control thresholds</li>
</ul>



<h2 class="wp-block-heading">FAQ: Stock Purchase Agreements</h2>



<h3 class="wp-block-heading">How is a stock purchase agreement different from an asset purchase agreement?</h3>



<p>A stock purchase agreement transfers ownership of shares in a corporation, while an asset purchase agreement transfers specific business assets but not ownership of the company itself. This distinction has significant implications. With a stock purchase, the buyer effectively steps into the shoes of the seller as a shareholder, acquiring an ownership interest in the entire corporate entityâ€”including all assets, liabilities, contracts, employees, and potential legal issues, whether disclosed or not.</p>



<p>Asset purchases, by contrast, allow buyers to cherry-pick specific assets while leaving liabilities behind with the selling entity. This creates different tax consequences, successor liability issues, and contract assignment requirements. Stock purchases generally require fewer third-party consents but expose purchasers to greater unknown liability risks. The appropriate structure depends on your specific business goals, tax situation, and risk tolerance, which is why consulting with both legal and tax advisors before choosing between these transaction types is essential.</p>



<h3 class="wp-block-heading">What happens if the representations and warranties in a stock purchase agreement turn out to be false?</h3>



<p>When representations and warranties prove false, the injured party typically has several potential remedies depending on the severity and impact of the misrepresentation. The most common remedy is an indemnification claim, where the party who made the false statement must compensate the other party for any losses resulting from the inaccuracy. For material misrepresentations discovered before closing, the transaction can often be terminated without penalty.</p>



<p>In more serious cases involving intentional misrepresentation or fraud, the injured party might seek rescission of the entire agreement (unwinding the transaction), damages beyond mere indemnification, or even pursue civil fraud claims. Some agreements include escrow provisions where a portion of the purchase price is held back specifically to satisfy potential indemnification claims. The agreement should specify the claim process, notification requirements, survival periods for representations, and limitations on liability to provide a clear roadmap when issues arise.</p>



<h3 class="wp-block-heading">For international stock transactions, what additional considerations should I keep in mind?</h3>



<p>International stock transactions introduce several layers of complexity beyond domestic deals. First, you must navigate multiple legal jurisdictions, each with its own securities laws, corporate governance requirements, and transfer restrictions. This often requires obtaining specialized legal advice in each relevant country.</p>



<p>Currency exchange issues also become significantâ€”your agreement should specify which currency applies, who bears exchange rate risk, and whether any special conversion timing applies. Tax considerations multiply with international transactions, potentially involving foreign investment taxes, withholding requirements, and international tax treaties that might provide relief from double taxation.</p>



<p>For cross-border enforcement, consider including clear dispute resolution provisions that specify governing law, forum selection, and whether international arbitration would be preferable to court proceedings. Finally, be aware of potential foreign investment restrictions that might require governmental approvals before the transaction can proceed. Given these complexities, international stock transactions nearly always require specialized legal counsel in all relevant jurisdictions.</p>



<h3 class="wp-block-heading">How should a stock purchase agreement address earnouts or contingent payments?</h3>



<p>Earnouts and contingent payments require particularly detailed treatment in stock purchase agreements to prevent future disputes. The agreement must precisely define the performance metrics triggering additional paymentsâ€”whether revenue targets, profit thresholds, customer retention rates, or other business milestones. Each metric needs clear calculation methodologies, measurement periods, and verification procedures.</p>



<p>The agreement should address operational control during the earnout period, as the seller often has legitimate concerns about the buyer&#8217;s management decisions affecting earnout achievements. Consider including provisions regarding minimum resource commitments, retention of key personnel, and limitations on extraordinary transactions that might artificially impact earnout calculations.</p>



<p>Dispute resolution mechanisms specific to earnout calculations are advisable, potentially including expedited procedures and specialized arbitrators with relevant industry or accounting expertise. Finally, tax treatment of earnout payments should be addressed, as these payments may be characterized differently depending on structure and timing. A well-drafted earnout provision anticipates potential areas of disagreement and establishes clear procedures for resolving them before disputes arise.</p>
</div>
    </article>
  </main>
  <footer><p>Â© 2025 Terms.Law. All rights reserved.</p></footer>
</body>
</html>