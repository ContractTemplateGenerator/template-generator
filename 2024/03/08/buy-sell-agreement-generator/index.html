<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buy-Sell Agreement Generator | Terms.Law</title>
  <link rel="canonical" href="https://terms.law/2024/03/08/buy-sell-agreement-generator/">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css">
</head>
<body>
  <div id="site-header"></div>
  <script src="/shared/header-loader.js"></script>
  <main>
    <article>
      <h1>Buy-Sell Agreement Generator</h1>
      <div class="meta">Published: March 8, 2024 • Document Generators, Free Templates</div>
      <div class="content">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buy-Sell Agreement Generator</title>
  <style>
    /* Base Styles */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #27ae60;
      --bg-color: #f9fafb;
      --card-bg: #ffffff;
      --text-primary: #333333;
      --text-secondary: #666666;
      --border-color: #e0e0e0;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    body {
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
    }
    
    /* Container Styles */
    .generator-container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    
    /* Header Styles */
    .generator-header {
      background-color: var(--primary-color);
      color: white;
      padding: 25px;
      text-align: center;
    }
    
    .generator-header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .generator-header p {
      font-size: 16px;
      opacity: 0.9;
    }
    
    /* Content Layout */
    .generator-content {
      display: flex;
      min-height: 700px;
    }
    
    /* Form Styles */
    .form-container {
      flex: 1;
      padding: 20px;
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      max-height: 800px;
    }
    
    /* Tabs */
    .tabs {
      display: flex;
      background-color: #f5f7fa;
      border-bottom: 1px solid var(--border-color);
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
    }
    
    .tabs::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Edge */
    }
    
    .tab {
      padding: 10px 15px;
      font-size: 14px;
      color: var(--text-secondary);
      white-space: nowrap;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .tab.active {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
      font-weight: 500;
    }
    
    /* Tab Content */
    .tab-content {
      display: none;
      padding: 20px 0;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .form-section {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .form-section:last-child {
      border-bottom: none;
    }
    
    .form-section-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .form-row {
      display: flex;
      flex-wrap: wrap;
      margin: 0 -10px;
    }
    
    .form-group {
      flex: 1;
      min-width: 200px;
      padding: 0 10px;
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 5px;
      color: var(--text-primary);
      font-size: 14px;
    }
    
    .form-input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      transition: var(--transition);
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }
    
    .form-select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      background-color: white;
      transition: var(--transition);
    }
    
    .form-select:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }
    
    textarea.form-input {
      min-height: 80px;
      resize: vertical;
    }
    
    .form-helper {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    /* Owner rows with add/remove buttons */
    .owner-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px dashed #eee;
    }
    
    .owner-row:last-child {
      border-bottom: none;
    }
    
    .owner-inputs {
      flex: 1;
      display: flex;
      gap: 10px;
    }
    
    .owner-name {
      flex: 2;
    }
    
    .owner-percentage {
      flex: 1;
    }
    
    .owner-row-actions {
      margin-left: 10px;
    }
    
    .btn-icon {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: none;
      background-color: #f1f1f1;
      color: var(--text-secondary);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }
    
    .btn-icon:hover {
      background-color: #e4e4e4;
    }
    
    .btn-icon.add {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-icon.add:hover {
      background-color: #219653;
    }
    
    .btn-icon.remove {
      background-color: #e74c3c;
      color: white;
    }
    
    .btn-icon.remove:hover {
      background-color: #c0392b;
    }
    
    /* Options Styles */
    .options-group {
      margin-bottom: 15px;
    }
    
    .option-item {
      display: flex;
      align-items: flex-start;
      padding: 8px 10px;
      margin-bottom: 8px;
      background-color: #f5f7fa;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .option-item:hover {
      background-color: #eef2f7;
    }
    
    .option-item.selected {
      background-color: #e8f6f3;
      border-color: var(--accent-color);
    }
    
    .option-item input[type="radio"],
    .option-item input[type="checkbox"] {
      margin-right: 10px;
      margin-top: 3px;
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-label {
      font-weight: 500;
      display: block;
      margin-bottom: 2px;
    }
    
    .option-description {
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    /* Tab Navigation */
    .tab-navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    
    /* Preview Styles */
    .preview-container {
      flex: 1;
      padding: 20px;
      position: relative;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .preview-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .preview-note {
      font-size: 12px;
      color: var(--text-secondary);
      font-style: italic;
    }
    
    .preview-box {
      height: 700px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      padding: 20px;
      background-color: white;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-primary);
    }
    
    /* Document Styles */
    .document-template {
      font-family: Arial, sans-serif;
    }
    
    .document-title {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    
    .document-section {
      margin-bottom: 20px;
    }
    
    .section-title {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 10px;
      color: var(--primary-color);
    }
    
    .section-content {
      margin-bottom: 15px;
    }
    
    .field-label {
      font-weight: bold;
      display: inline-block;
      margin-right: 5px;
    }
    
    /* Highlight Effect */
    .highlight {
      background-color: #ffff8d;
      transition: background-color 0.5s ease;
    }
    
    /* Form Actions */
    .form-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 25px;
      flex-wrap: wrap;
      gap: 10px;
      padding-top: 15px;
      border-top: 1px solid var(--border-color);
    }
    
    .btn {
      padding: 10px 16px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }
    
    .btn-reset {
      background-color: #f1f1f1;
      color: var(--text-primary);
    }
    
    .btn-reset:hover {
      background-color: #e4e4e4;
    }
    
    .btn-navigate {
      background-color: var(--primary-color);
      color: white;
    }
    
    .btn-navigate:hover {
      background-color: #1a2a3a;
    }
    
    .btn-copy {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .btn-copy:hover {
      background-color: #2980b9;
    }
    
    .btn-download {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-download:hover {
      background-color: #219653;
    }
    
    .copy-message {
      display: none;
      font-size: 14px;
      color: #27ae60;
      margin-left: 10px;
    }
    
    .btn-consult {
      display: block;
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background-color: var(--primary-color);
      color: white;
      text-decoration: none;
      text-align: center;
      border-radius: 4px;
      font-weight: 500;
      transition: var(--transition);
    }
    
    .btn-consult:hover {
      background-color: #1e2a37;
    }
    
    /* Responsive Styles */
    @media (max-width: 1024px) {
      .generator-content {
        flex-direction: column;
      }
      
      .form-container {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        max-height: none;
      }
      
      .preview-box {
        height: 500px;
      }
    }
    
    @media (max-width: 768px) {
      .generator-container {
        margin: 0;
        border-radius: 0;
      }
      
      .generator-header {
        padding: 20px;
      }
      
      .form-row {
        flex-direction: column;
        margin: 0;
      }
      
      .form-group {
        padding: 0;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .copy-message {
        margin-left: 0;
        margin-top: 5px;
        text-align: center;
      }
      
      .owner-inputs {
        flex-direction: column;
        gap: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="generator-container">
    <div class="generator-header">
      <h1>Buy-Sell Agreement Generator</h1>
      <p>Create a customized agreement to protect your business and co-owners in case of ownership changes</p>
    </div>
    
    <div class="generator-content">
      <!-- Form Container -->
      <div class="form-container">
        <!-- Tabs -->
        <div class="tabs" id="formTabs">
          <div class="tab active" data-tab="business">Business</div>
          <div class="tab" data-tab="owners">Owners</div>
          <div class="tab" data-tab="events">Triggering Events</div>
          <div class="tab" data-tab="valuation">Valuation</div>
          <div class="tab" data-tab="terms">Purchase Terms</div>
          <div class="tab" data-tab="insurance">Insurance</div>
          <div class="tab" data-tab="restrictions">Restrictions</div>
          <div class="tab" data-tab="legal">Legal</div>
        </div>
        
        <form id="buyHellForm">
          <!-- Business Information Tab -->
          <div class="tab-content active" id="tab-business">
            <div class="form-section">
              <h2 class="form-section-title">Business Information</h2>
              <div class="form-row">
                <div class="form-group">
                  <label for="companyName">Company Name</label>
                  <input type="text" id="companyName" class="form-input" placeholder="Enter company name" value="ABC Corporation">
                </div>
                <div class="form-group">
                  <label for="companyType">Company Type</label>
                  <select id="companyType" class="form-select">
                    <option value="corporation" selected>Corporation</option>
                    <option value="llc">Limited Liability Company (LLC)</option>
                    <option value="partnership">Partnership</option>
                    <option value="soleProprietorship">Sole Proprietorship</option>
                  </select>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="stateOfFormation">State of Formation</label>
                  <select id="stateOfFormation" class="form-select">
                    <option value="Alabama">Alabama</option>
                    <option value="Alaska">Alaska</option>
                    <option value="Arizona">Arizona</option>
                    <option value="Arkansas">Arkansas</option>
                    <option value="California" selected>California</option>
                    <option value="Colorado">Colorado</option>
                    <option value="Connecticut">Connecticut</option>
                    <option value="Delaware">Delaware</option>
                    <option value="Florida">Florida</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Hawaii">Hawaii</option>
                    <option value="Idaho">Idaho</option>
                    <option value="Illinois">Illinois</option>
                    <option value="Indiana">Indiana</option>
                    <option value="Iowa">Iowa</option>
                    <option value="Kansas">Kansas</option>
                    <option value="Kentucky">Kentucky</option>
                    <option value="Louisiana">Louisiana</option>
                    <option value="Maine">Maine</option>
                    <option value="Maryland">Maryland</option>
                    <option value="Massachusetts">Massachusetts</option>
                    <option value="Michigan">Michigan</option>
                    <option value="Minnesota">Minnesota</option>
                    <option value="Mississippi">Mississippi</option>
                    <option value="Missouri">Missouri</option>
                    <option value="Montana">Montana</option>
                    <option value="Nebraska">Nebraska</option>
                    <option value="Nevada">Nevada</option>
                    <option value="New Hampshire">New Hampshire</option>
                    <option value="New Jersey">New Jersey</option>
                    <option value="New Mexico">New Mexico</option>
                    <option value="New York">New York</option>
                    <option value="North Carolina">North Carolina</option>
                    <option value="North Dakota">North Dakota</option>
                    <option value="Ohio">Ohio</option>
                    <option value="Oklahoma">Oklahoma</option>
                    <option value="Oregon">Oregon</option>
                    <option value="Pennsylvania">Pennsylvania</option>
                    <option value="Rhode Island">Rhode Island</option>
                    <option value="South Carolina">South Carolina</option>
                    <option value="South Dakota">South Dakota</option>
                    <option value="Tennessee">Tennessee</option>
                    <option value="Texas">Texas</option>
                    <option value="Utah">Utah</option>
                    <option value="Vermont">Vermont</option>
                    <option value="Virginia">Virginia</option>
                    <option value="Washington">Washington</option>
                    <option value="West Virginia">West Virginia</option>
                    <option value="Wisconsin">Wisconsin</option>
                    <option value="Wyoming">Wyoming</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="principalAddress">Principal Business Address</label>
                  <input type="text" id="principalAddress" class="form-input" placeholder="Enter business address" value="123 Business Street, San Diego, CA 92101">
                </div>
              </div>
              
              <div class="form-group">
                <label for="businessDescription">Description of Business</label>
                <textarea id="businessDescription" class="form-input" placeholder="Briefly describe the nature of the business">Software development and technology consulting services focused on enterprise solutions.</textarea>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="effectiveDate">Effective Date</label>
                  <input type="date" id="effectiveDate" class="form-input" value="2025-04-01">
                </div>
                <div class="form-group">
                  <label for="governingLaw">Governing Law (State)</label>
                  <select id="governingLaw" class="form-select">
                    <option value="Alabama">Alabama</option>
                    <option value="Alaska">Alaska</option>
                    <option value="Arizona">Arizona</option>
                    <option value="Arkansas">Arkansas</option>
                    <option value="California" selected>California</option>
                    <option value="Colorado">Colorado</option>
                    <option value="Connecticut">Connecticut</option>
                    <option value="Delaware">Delaware</option>
                    <option value="Florida">Florida</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Hawaii">Hawaii</option>
                    <option value="Idaho">Idaho</option>
                    <option value="Illinois">Illinois</option>
                    <option value="Indiana">Indiana</option>
                    <option value="Iowa">Iowa</option>
                    <option value="Kansas">Kansas</option>
                    <option value="Kentucky">Kentucky</option>
                    <option value="Louisiana">Louisiana</option>
                    <option value="Maine">Maine</option>
                    <option value="Maryland">Maryland</option>
                    <option value="Massachusetts">Massachusetts</option>
                    <option value="Michigan">Michigan</option>
                    <option value="Minnesota">Minnesota</option>
                    <option value="Mississippi">Mississippi</option>
                    <option value="Missouri">Missouri</option>
                    <option value="Montana">Montana</option>
                    <option value="Nebraska">Nebraska</option>
                    <option value="Nevada">Nevada</option>
                    <option value="New Hampshire">New Hampshire</option>
                    <option value="New Jersey">New Jersey</option>
                    <option value="New Mexico">New Mexico</option>
                    <option value="New York">New York</option>
                    <option value="North Carolina">North Carolina</option>
                    <option value="North Dakota">North Dakota</option>
                    <option value="Ohio">Ohio</option>
                    <option value="Oklahoma">Oklahoma</option>
                    <option value="Oregon">Oregon</option>
                    <option value="Pennsylvania">Pennsylvania</option>
                    <option value="Rhode Island">Rhode Island</option>
                    <option value="South Carolina">South Carolina</option>
                    <option value="South Dakota">South Dakota</option>
                    <option value="Tennessee">Tennessee</option>
                    <option value="Texas">Texas</option>
                    <option value="Utah">Utah</option>
                    <option value="Vermont">Vermont</option>
                    <option value="Virginia">Virginia</option>
                    <option value="Washington">Washington</option>
                    <option value="West Virginia">West Virginia</option>
                    <option value="Wisconsin">Wisconsin</option>
                    <option value="Wyoming">Wyoming</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="tab-navigation">
              <div></div> <!-- Empty div for spacing -->
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-business').style.display='none'; document.getElementById('tab-owners').style.display='block'; updateActiveTab('owners');">Next: Owners →</button>
            </div>
          </div>
          
          <!-- Owners Tab -->
          <div class="tab-content" id="tab-owners">
            <div class="form-section">
              <h2 class="form-section-title">Owner Information</h2>
              <p class="form-helper">Enter information about all current owners of the business.</p>
              
              <div id="ownersContainer">
                <!-- Owner rows will be dynamically added here -->
                <div class="owner-row" id="owner-row-1">
                  <div class="owner-inputs">
                    <div class="owner-name">
                      <input type="text" class="form-input owner-name-input" placeholder="Owner name" value="John Smith">
                    </div>
                    <div class="owner-percentage">
                      <input type="number" class="form-input owner-percentage-input" placeholder="Ownership %" value="50" min="1" max="100">
                    </div>
                  </div>
                  <div class="owner-row-actions">
                    <button type="button" class="btn-icon remove" onclick="document.getElementById('owner-row-1').remove(); updateOwnersPreview();">×</button>
                  </div>
                </div>
                
                <div class="owner-row" id="owner-row-2">
                  <div class="owner-inputs">
                    <div class="owner-name">
                      <input type="text" class="form-input owner-name-input" placeholder="Owner name" value="Jane Doe">
                    </div>
                    <div class="owner-percentage">
                      <input type="number" class="form-input owner-percentage-input" placeholder="Ownership %" value="50" min="1" max="100">
                    </div>
                  </div>
                  <div class="owner-row-actions">
                    <button type="button" class="btn-icon remove" onclick="document.getElementById('owner-row-2').remove(); updateOwnersPreview();">×</button>
                  </div>
                </div>
              </div>
              
              <div style="margin-top: 15px;">
                <button type="button" class="btn-icon add" onclick="addOwnerRow()">+</button>
                <span style="margin-left: 10px; font-size: 14px;">Add another owner</span>
              </div>
              
              <div class="form-group" style="margin-top: 20px;">
                <label for="votingRequirements">Voting Requirements for Agreement Modifications</label>
                <select id="votingRequirements" class="form-select">
                  <option value="unanimous" selected>Unanimous Consent</option>
                  <option value="majority">Majority Vote</option>
                  <option value="supermajority">Super Majority (2/3)</option>
                  <option value="supermajority75">Super Majority (3/4)</option>
                </select>
                <p class="form-helper">This determines how many owners must approve any future modifications to this Buy-Sell Agreement.</p>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-owners').style.display='none'; document.getElementById('tab-business').style.display='block'; updateActiveTab('business');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-owners').style.display='none'; document.getElementById('tab-events').style.display='block'; updateActiveTab('events');">Next: Triggering Events →</button>
            </div>
          </div>
          
          <!-- Triggering Events Tab -->
          <div class="tab-content" id="tab-events">
            <div class="form-section">
              <h2 class="form-section-title">Triggering Events</h2>
              <p class="form-helper">Select which events will trigger the buy-sell provisions of this agreement.</p>
              
              <div class="options-group">
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="death" checked>
                  <div class="option-content">
                    <span class="option-label">Death of an Owner</span>
                    <span class="option-description">Allows remaining owners to purchase the deceased owner&#8217;s interest in the business</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="disability" checked>
                  <div class="option-content">
                    <span class="option-label">Disability of an Owner</span>
                    <span class="option-description">Allows purchase of a disabled owner&#8217;s interest after a specified period of disability</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="retirement" checked>
                  <div class="option-content">
                    <span class="option-label">Retirement of an Owner</span>
                    <span class="option-description">Applies when an owner retires and wishes to sell their interest</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="termination" checked>
                  <div class="option-content">
                    <span class="option-label">Termination of Employment</span>
                    <span class="option-description">Applies when an owner&#8217;s employment with the business is terminated</span>
                  </div>
                </label>
                
                <label class="option-item" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="bankruptcy">
                  <div class="option-content">
                    <span class="option-label">Bankruptcy of an Owner</span>
                    <span class="option-description">Applies if an owner files for bankruptcy protection</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="divorce" checked>
                  <div class="option-content">
                    <span class="option-label">Divorce of an Owner</span>
                    <span class="option-description">Prevents ownership transfer to a former spouse in divorce proceedings</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('triggeringEvents');">
                  <input type="checkbox" name="triggeringEvents" value="thirdPartyOffer" checked>
                  <div class="option-content">
                    <span class="option-label">Third-Party Offer</span>
                    <span class="option-description">Applies when an owner receives an offer from an outside party to purchase their interest</span>
                  </div>
                </label>
              </div>
              
              <div class="form-group" style="margin-top: 20px;">
                <label for="disabilityPeriod">Disability Period Definition</label>
                <select id="disabilityPeriod" class="form-select">
                  <option value="90days">90 consecutive days</option>
                  <option value="180days" selected>180 consecutive days</option>
                  <option value="270days">270 consecutive days</option>
                  <option value="365days">365 consecutive days</option>
                </select>
                <p class="form-helper">Period after which a disability is considered permanent for the purposes of this agreement.</p>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-events').style.display='none'; document.getElementById('tab-owners').style.display='block'; updateActiveTab('owners');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-events').style.display='none'; document.getElementById('tab-valuation').style.display='block'; updateActiveTab('valuation');">Next: Valuation →</button>
            </div>
          </div>
          
          <!-- Valuation Tab -->
          <div class="tab-content" id="tab-valuation">
            <div class="form-section">
              <h2 class="form-section-title">Business Valuation Method</h2>
              <p class="form-helper">Choose how the business will be valued when a triggering event occurs.</p>
              
              <div class="options-group">
                <label class="option-item" onclick="selectValuationMethod(this, 'fixedPrice')">
                  <input type="radio" name="valuationMethod" value="fixedPrice">
                  <div class="option-content">
                    <span class="option-label">Fixed Price</span>
                    <span class="option-description">A specific dollar amount agreed upon by all owners</span>
                  </div>
                </label>
                
                <label class="option-item" onclick="selectValuationMethod(this, 'bookValue')">
                  <input type="radio" name="valuationMethod" value="bookValue">
                  <div class="option-content">
                    <span class="option-label">Book Value</span>
                    <span class="option-description">Based on the company&#8217;s balance sheet (assets minus liabilities)</span>
                  </div>
                </label>
                
                <label class="option-item selected" onclick="selectValuationMethod(this, 'formulaMultiple')">
                  <input type="radio" name="valuationMethod" value="formulaMultiple" checked>
                  <div class="option-content">
                    <span class="option-label">Formula (Multiple of Earnings)</span>
                    <span class="option-description">Calculated as a multiple of the company&#8217;s earnings</span>
                  </div>
                </label>
                
                <label class="option-item" onclick="selectValuationMethod(this, 'appraisal')">
                  <input type="radio" name="valuationMethod" value="appraisal">
                  <div class="option-content">
                    <span class="option-label">Independent Appraisal</span>
                    <span class="option-description">Determined by one or more professional business appraisers</span>
                  </div>
                </label>
                
                <label class="option-item" onclick="selectValuationMethod(this, 'agreeValue')">
                  <input type="radio" name="valuationMethod" value="agreeValue">
                  <div class="option-content">
                    <span class="option-label">Agreed Value (Periodic)</span>
                    <span class="option-description">Value is periodically determined by agreement of all owners</span>
                  </div>
                </label>
              </div>
              
              <!-- Conditional fields based on valuation method -->
              <div id="fixedPriceFields" class="valuation-details" style="display: none; margin-top: 15px;">
                <div class="form-group">
                  <label for="fixedPriceAmount">Fixed Price Amount</label>
                  <input type="text" id="fixedPriceAmount" class="form-input" placeholder="Enter dollar amount" value="1,000,000">
                </div>
                <div class="form-group">
                  <label for="fixedPriceReview">Review Period</label>
                  <select id="fixedPriceReview" class="form-select">
                    <option value="6months">Every 6 months</option>
                    <option value="annually" selected>Annually</option>
                    <option value="2years">Every 2 years</option>
                    <option value="3years">Every 3 years</option>
                  </select>
                </div>
              </div>
              
              <div id="bookValueFields" class="valuation-details" style="display: none; margin-top: 15px;">
                <div class="form-group">
                  <label for="bookValueMethod">Book Value Calculation Method</label>
                  <select id="bookValueMethod" class="form-select">
                    <option value="standard" selected>Standard Accounting Principles</option>
                    <option value="adjusted">Adjusted Book Value (includes adjustments to fair market value)</option>
                    <option value="tangible">Tangible Book Value (excludes goodwill and intangible assets)</option>
                  </select>
                </div>
              </div>
              
              <div id="formulaMultipleFields" class="valuation-details" style="margin-top: 15px;">
                <div class="form-row">
                  <div class="form-group">
                    <label for="earningsType">Earnings Definition</label>
                    <select id="earningsType" class="form-select">
                      <option value="netIncome">Net Income</option>
                      <option value="ebitda" selected>EBITDA</option>
                      <option value="ebit">EBIT</option>
                      <option value="grossRevenue">Gross Revenue</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="earningsPeriod">Earnings Period</label>
                    <select id="earningsPeriod" class="form-select">
                      <option value="trailing12">Trailing 12 Months</option>
                      <option value="lastFiscal" selected>Last Fiscal Year</option>
                      <option value="average3">Average of Last 3 Years</option>
                      <option value="average5">Average of Last 5 Years</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="earningsMultiple">Multiple of Earnings</label>
                  <input type="number" id="earningsMultiple" class="form-input" placeholder="Enter multiple" value="3.5" step="0.1" min="0.1">
                  <p class="form-helper">The business value will be calculated as this multiple times the earnings.</p>
                </div>
              </div>
              
              <div id="appraisalFields" class="valuation-details" style="display: none; margin-top: 15px;">
                <div class="form-group">
                  <label for="appraiserSelection">Appraiser Selection Method</label>
                  <select id="appraiserSelection" class="form-select">
                    <option value="single" selected>Single Mutually Agreed Appraiser</option>
                    <option value="multiple">Multiple Appraisers (Average of Values)</option>
                    <option value="twoPlus">Two Appraisers Plus Tiebreaker If Needed</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="appraisalCosts">Appraisal Costs</label>
                  <select id="appraisalCosts" class="form-select">
                    <option value="company" selected>Paid by Company</option>
                    <option value="selling">Paid by Selling Owner</option>
                    <option value="buying">Paid by Buying Owner(s)</option>
                    <option value="split">Split Equally Between All Parties</option>
                  </select>
                </div>
              </div>
              
              <div id="agreeValueFields" class="valuation-details" style="display: none; margin-top: 15px;">
                <div class="form-group">
                  <label for="agreeValueInitial">Initial Agreed Value</label>
                  <input type="text" id="agreeValueInitial" class="form-input" placeholder="Enter initial value" value="1,000,000">
                </div>
                <div class="form-group">
                  <label for="agreeValueReview">Value Review Period</label>
                  <select id="agreeValueReview" class="form-select">
                    <option value="quarterly">Quarterly</option>
                    <option value="semiannually">Semi-Annually</option>
                    <option value="annually" selected>Annually</option>
                    <option value="biennially">Every 2 Years</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="agreeValueDefault">Default Valuation Method</label>
                  <select id="agreeValueDefault" class="form-select">
                    <option value="lastAgreed" selected>Last Agreed Value</option>
                    <option value="appraisal">Independent Appraisal</option>
                    <option value="formula">Formula Calculation</option>
                    <option value="bookValue">Book Value</option>
                  </select>
                  <p class="form-helper">Method to use if owners fail to agree on a new value during a scheduled review.</p>
                </div>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-valuation').style.display='none'; document.getElementById('tab-events').style.display='block'; updateActiveTab('events');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-valuation').style.display='none'; document.getElementById('tab-terms').style.display='block'; updateActiveTab('terms');">Next: Purchase Terms →</button>
            </div>
          </div>
          
          <!-- Purchase Terms Tab -->
          <div class="tab-content" id="tab-terms">
            <div class="form-section">
              <h2 class="form-section-title">Purchase Terms</h2>
              <p class="form-helper">Specify how the purchase of an owner&#8217;s interest will be structured.</p>
              
              <div class="form-group">
                <label for="rightOfFirstRefusal">Right of First Refusal</label>
                <select id="rightOfFirstRefusal" class="form-select">
                  <option value="company">Company First, Then Remaining Owners</option>
                  <option value="owners" selected>Remaining Owners First, Then Company</option>
                  <option value="proportional">Proportional to Ownership Percentage</option>
                  <option value="equal">Equal Opportunity for All Owners</option>
                </select>
                <p class="form-helper">Determines the order in which the company and/or remaining owners can purchase interests.</p>
              </div>
              
              <div class="form-group">
                <label for="paymentMethod">Payment Method</label>
                <select id="paymentMethod" class="form-select">
                  <option value="cash">Cash Payment in Full</option>
                  <option value="installment" selected>Installment Payments</option>
                  <option value="mixed">Mixed (Down Payment + Installments)</option>
                  <option value="insurance">Insurance Proceeds (if applicable) + Installments</option>
                </select>
              </div>
              
              <div id="installmentTermsFields">
                <div class="form-row">
                  <div class="form-group">
                    <label for="downPaymentPercentage">Down Payment</label>
                    <input type="number" id="downPaymentPercentage" class="form-input" placeholder="Enter %" value="20" min="0" max="100">
                    <p class="form-helper">Percentage of purchase price to be paid upfront</p>
                  </div>
                  <div class="form-group">
                    <label for="installmentPeriod">Installment Period</label>
                    <select id="installmentPeriod" class="form-select">
                      <option value="1year">1 Year</option>
                      <option value="2years">2 Years</option>
                      <option value="3years">3 Years</option>
                      <option value="5years" selected>5 Years</option>
                      <option value="7years">7 Years</option>
                      <option value="10years">10 Years</option>
                    </select>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="interestRate">Interest Rate</label>
                    <input type="number" id="interestRate" class="form-input" placeholder="Enter %" value="5.0" step="0.1" min="0">
                    <p class="form-helper">Annual interest rate on the installment payments</p>
                  </div>
                  <div class="form-group">
                    <label for="paymentFrequency">Payment Frequency</label>
                    <select id="paymentFrequency" class="form-select">
                      <option value="monthly" selected>Monthly</option>
                      <option value="quarterly">Quarterly</option>
                      <option value="semiannually">Semi-Annually</option>
                      <option value="annually">Annually</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label for="closingPeriod">Closing Period</label>
                <select id="closingPeriod" class="form-select">
                  <option value="30days">30 Days</option>
                  <option value="60days" selected>60 Days</option>
                  <option value="90days">90 Days</option>
                  <option value="180days">180 Days</option>
                </select>
                <p class="form-helper">Period of time within which the purchase transaction must close after a triggering event</p>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-terms').style.display='none'; document.getElementById('tab-valuation').style.display='block'; updateActiveTab('valuation');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-terms').style.display='none'; document.getElementById('tab-insurance').style.display='block'; updateActiveTab('insurance');">Next: Insurance →</button>
            </div>
          </div>
          
          <!-- Insurance Tab -->
          <div class="tab-content" id="tab-insurance">
            <div class="form-section">
              <h2 class="form-section-title">Insurance Provisions</h2>
              <p class="form-helper">Specify details about life and disability insurance policies to fund the buy-sell agreement.</p>
              
              <div class="form-group">
                <label>Life Insurance Requirements</label>
                <select id="lifeInsurance" class="form-select">
                  <option value="required" selected>Required for All Owners</option>
                  <option value="optional">Optional</option>
                  <option value="none">No Insurance Provisions</option>
                </select>
              </div>
              
              <div id="lifeInsuranceFields">
                <div class="form-group">
                  <label for="lifeInsuranceOwner">Life Insurance Policy Owner</label>
                  <select id="lifeInsuranceOwner" class="form-select">
                    <option value="company" selected>Company-Owned Policies</option>
                    <option value="crossPurchase">Cross-Purchase (Owners Own Policies on Each Other)</option>
                    <option value="trust">Insurance Trust</option>
                  </select>
                  <p class="form-helper">Determines who will own the life insurance policies</p>
                </div>
                
                <div class="form-group">
                  <label for="lifeInsuranceAmount">Life Insurance Coverage Amount</label>
                  <select id="lifeInsuranceAmount" class="form-select">
                    <option value="fullValue" selected>Full Purchase Price</option>
                    <option value="percentage">Percentage of Purchase Price</option>
                    <option value="fixedAmount">Fixed Dollar Amount</option>
                  </select>
                </div>
                
                <div class="form-group" id="lifeInsurancePercentageField" style="display: none;">
                  <label for="lifeInsurancePercentage">Coverage Percentage</label>
                  <input type="number" id="lifeInsurancePercentage" class="form-input" placeholder="Enter %" value="75" min="1" max="100">
                  <p class="form-helper">Percentage of purchase price to be covered by insurance</p>
                </div>
                
                <div class="form-group" id="lifeInsuranceFixedField" style="display: none;">
                  <label for="lifeInsuranceFixed">Fixed Coverage Amount</label>
                  <input type="text" id="lifeInsuranceFixed" class="form-input" placeholder="Enter dollar amount" value="500,000">
                </div>
              </div>
              
              <div class="form-group">
                <label>Disability Insurance Requirements</label>
                <select id="disabilityInsurance" class="form-select">
                  <option value="required">Required for All Owners</option>
                  <option value="optional" selected>Optional</option>
                  <option value="none">No Disability Insurance Provisions</option>
                </select>
              </div>
              
              <div id="disabilityInsuranceFields">
                <div class="form-group">
                  <label for="disabilityInsuranceOwner">Disability Insurance Policy Owner</label>
                  <select id="disabilityInsuranceOwner" class="form-select">
                    <option value="company" selected>Company-Owned Policies</option>
                    <option value="individual">Individually-Owned Policies</option>
                    <option value="crossPurchase">Cross-Purchase Arrangement</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label for="disabilityInsuranceAmount">Disability Insurance Coverage Amount</label>
                  <select id="disabilityInsuranceAmount" class="form-select">
                    <option value="fullValue">Full Purchase Price</option>
                    <option value="percentage" selected>Percentage of Purchase Price</option>
                    <option value="fixedAmount">Fixed Dollar Amount</option>
                  </select>
                </div>
                
                <div class="form-group" id="disabilityInsurancePercentageField">
                  <label for="disabilityInsurancePercentage">Coverage Percentage</label>
                  <input type="number" id="disabilityInsurancePercentage" class="form-input" placeholder="Enter %" value="50" min="1" max="100">
                  <p class="form-helper">Percentage of purchase price to be covered by insurance</p>
                </div>
                
                <div class="form-group" id="disabilityInsuranceFixedField" style="display: none;">
                  <label for="disabilityInsuranceFixed">Fixed Coverage Amount</label>
                  <input type="text" id="disabilityInsuranceFixed" class="form-input" placeholder="Enter dollar amount" value="250,000">
                </div>
              </div>
              
              <div class="form-group">
                <label for="insuranceMaintenance">Policy Maintenance Requirements</label>
                <select id="insuranceMaintenance" class="form-select">
                  <option value="annual" selected>Annual Review of Coverage</option>
                  <option value="biennial">Biennial Review of Coverage</option>
                  <option value="valuation">Review With Each Valuation Update</option>
                  <option value="none">No Specific Review Requirements</option>
                </select>
                <p class="form-helper">How often insurance coverage should be reviewed to ensure adequate funding</p>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-insurance').style.display='none'; document.getElementById('tab-terms').style.display='block'; updateActiveTab('terms');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-insurance').style.display='none'; document.getElementById('tab-restrictions').style.display='block'; updateActiveTab('restrictions');">Next: Restrictions →</button>
            </div>
          </div>
          
          <!-- Restrictions Tab -->
          <div class="tab-content" id="tab-restrictions">
            <div class="form-section">
              <h2 class="form-section-title">Transfer Restrictions</h2>
              <p class="form-helper">Specify restrictions on the transfer of ownership interests.</p>
              
              <div class="form-group">
                <label>Permitted Transfers (Transfer Without Triggering Buy-Sell)</label>
                <div class="options-group">
                  <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('permittedTransfers');">
                    <input type="checkbox" name="permittedTransfers" value="familyMembers" checked>
                    <div class="option-content">
                      <span class="option-label">Transfers to Family Members</span>
                      <span class="option-description">Allows transfers to immediate family (spouse, children, etc.)</span>
                    </div>
                  </label>
                  
                  <label class="option-item" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('permittedTransfers');">
                    <input type="checkbox" name="permittedTransfers" value="trusts">
                    <div class="option-content">
                      <span class="option-label">Transfers to Trusts</span>
                      <span class="option-description">Allows transfers to trusts for estate planning purposes</span>
                    </div>
                  </label>
                  
                  <label class="option-item selected" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('permittedTransfers');">
                    <input type="checkbox" name="permittedTransfers" value="otherOwners" checked>
                    <div class="option-content">
                      <span class="option-label">Transfers to Other Owners</span>
                      <span class="option-description">Allows transfers between existing owners</span>
                    </div>
                  </label>
                  
                  <label class="option-item" onclick="this.classList.toggle('selected'); this.querySelector('input').checked = !this.querySelector('input').checked; updatePreview('permittedTransfers');">
                    <input type="checkbox" name="permittedTransfers" value="affiliates">
                    <div class="option-content">
                      <span class="option-label">Transfers to Affiliates</span>
                      <span class="option-description">Allows transfers to affiliated entities of an owner</span>
                    </div>
                  </label>
                </div>
              </div>
              
              <div class="form-group">
                <label for="spousalConsent">Spousal Consent Requirements</label>
                <select id="spousalConsent" class="form-select">
                  <option value="required" selected>Required</option>
                  <option value="optional">Optional</option>
                  <option value="none">Not Required</option>
                </select>
                <p class="form-helper">Whether spouses of owners must consent to the terms of the agreement</p>
              </div>
              
              <div class="form-group">
                <label for="noncompeteRestrictions">Non-Compete Restrictions</label>
                <select id="noncompeteRestrictions" class="form-select">
                  <option value="none">No Restrictions</option>
                  <option value="limited" selected>Limited Restrictions (1-2 years)</option>
                  <option value="standard">Standard Restrictions (3-5 years)</option>
                  <option value="extensive">Extensive Restrictions (5+ years)</option>
                </select>
              </div>
              
              <div class="form-group" id="noncompeteDetailsField">
                <label for="noncompeteDetails">Non-Compete Details</label>
                <textarea id="noncompeteDetails" class="form-input">For a period of two (2) years following the sale of an Owner&#8217;s interest pursuant to this Agreement, the selling Owner shall not, directly or indirectly, engage in or have any ownership interest in any business that competes with the Company within a 50-mile radius of the Company&#8217;s principal place of business.</textarea>
              </div>
              
              <div class="form-group">
                <label for="tagsAlong">Tag-Along Rights</label>
                <select id="tagsAlong" class="form-select">
                  <option value="none">None</option>
                  <option value="limited">Limited (Majority Transactions Only)</option>
                  <option value="standard" selected>Standard</option>
                  <option value="comprehensive">Comprehensive</option>
                </select>
                <p class="form-helper">Allows minority owners to participate in a sale if a majority owner sells</p>
              </div>
              
              <div class="form-group">
                <label for="dragAlong">Drag-Along Rights</label>
                <select id="dragAlong" class="form-select">
                  <option value="none">None</option>
                  <option value="majorityOwners" selected>Majority Owners</option>
                  <option value="supermajority">Super Majority (2/3 or 3/4)</option>
                  <option value="unanimity">Unanimity Required</option>
                </select>
                <p class="form-helper">Allows majority owners to force minority owners to participate in a sale</p>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-restrictions').style.display='none'; document.getElementById('tab-insurance').style.display='block'; updateActiveTab('insurance');">← Back</button>
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-restrictions').style.display='none'; document.getElementById('tab-legal').style.display='block'; updateActiveTab('legal');">Next: Legal →</button>
            </div>
          </div>
          
          <!-- Legal Provisions Tab -->
          <div class="tab-content" id="tab-legal">
            <div class="form-section">
              <h2 class="form-section-title">Legal Provisions</h2>
              <p class="form-helper">Specify dispute resolution methods and other legal details.</p>
              
              <div class="form-group">
                <label for="disputeResolution">Dispute Resolution Method</label>
                <select id="disputeResolution" class="form-select">
                  <option value="litigation">Litigation</option>
                  <option value="arbitration" selected>Binding Arbitration</option>
                  <option value="mediation">Mediation Before Arbitration</option>
                  <option value="mediationOnly">Mediation Only (Non-Binding)</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="attorneyFeesProvision">Attorney Fees Provision</label>
                <select id="attorneyFeesProvision" class="form-select">
                  <option value="prevailingParty" selected>Prevailing Party Recovers Fees</option>
                  <option value="eachBear">Each Party Bears Own Fees</option>
                  <option value="courtDiscretion">Court/Arbitrator Discretion</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="transferRestrictionTime">Duration of Agreement</label>
                <select id="transferRestrictionTime" class="form-select">
                  <option value="indefinite" selected>Indefinite (Until Terminated by Agreement)</option>
                  <option value="fixedYears">Fixed Term (Years)</option>
                  <option value="terminatingEvent">Until Specific Terminating Event</option>
                </select>
              </div>
              
              <div class="form-group" id="fixedYearsField" style="display: none;">
                <label for="fixedYearsNumber">Number of Years</label>
                <input type="number" id="fixedYearsNumber" class="form-input" value="10" min="1">
              </div>
              
              <div class="form-group" id="terminatingEventField" style="display: none;">
                <label for="terminatingEventDescription">Terminating Event Description</label>
                <input type="text" id="terminatingEventDescription" class="form-input" placeholder="Describe terminating event" value="Sale of the company or initial public offering">
              </div>
              
              <div class="form-group">
                <label for="confidentiality">Confidentiality Provisions</label>
                <select id="confidentiality" class="form-select">
                  <option value="none">None</option>
                  <option value="limited">Limited</option>
                  <option value="standard" selected>Standard</option>
                  <option value="comprehensive">Comprehensive</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="amendmentProvisions">Amendment Provisions</label>
                <select id="amendmentProvisions" class="form-select">
                  <option value="unanimous" selected>Unanimous Consent Required</option>
                  <option value="majority">Majority Consent</option>
                  <option value="supermajority">Super Majority (2/3 or 3/4)</option>
                  <option value="written">Written Amendment Only</option>
                </select>
                <p class="form-helper">Requirements for amending the agreement in the future</p>
              </div>
              
              <div class="form-group">
                <label for="additionalProvisions">Additional Legal Provisions</label>
                <textarea id="additionalProvisions" class="form-input" placeholder="Enter any additional provisions you'd like to include"></textarea>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-navigate" onclick="document.getElementById('tab-legal').style.display='none'; document.getElementById('tab-restrictions').style.display='block'; updateActiveTab('restrictions');">← Back</button>
              <button type="button" class="btn btn-primary" onclick="showPreview(true)">Preview Agreement</button>
            </div>
          </div>
        </form>
        
        <div class="form-actions">
          <button type="button" id="resetBtn" class="btn btn-reset" onclick="if(confirm('Are you sure you want to reset the form? This will clear all your entries.')) { document.getElementById('buyHellForm').reset(); updatePreview(); }">Reset Form</button>
          <button type="button" id="copyBtn" class="btn btn-copy" onclick="copyAgreement()">Copy Agreement</button>
          <button type="button" id="downloadBtn" class="btn btn-download" onclick="downloadAgreement()">Download as DOCX</button>
          <span id="copyMessage" class="copy-message">Agreement copied!</span>
        </div>
        
        <a href="#" class="btn-consult" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">
          Schedule Legal Consultation
        </a>
      </div>
      
      <!-- Preview Container -->
      <div class="preview-container">
        <div class="preview-header">
          <div class="preview-title">Agreement Preview</div>
          <div class="preview-note">Updates as you complete the form</div>
        </div>
        
        <div class="preview-box">
          <div class="document-template" id="agreementPreview">
            <!-- Document content will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Libraries for DOCX download -->
  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- Calendly Integration -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initial update of the preview
      updatePreview();
      
      // Set up event listeners for all form inputs
      document.querySelectorAll('input, textarea, select').forEach(input => {
        input.addEventListener('input', function() {
          updatePreview(this.id);
        });
        
        input.addEventListener('change', function() {
          updatePreview(this.id);
        });
      });
      
      // Listen for changes to the valuation method
      document.getElementsByName('valuationMethod').forEach(radio => {
        radio.addEventListener('change', function() {
          showValuationFields(this.value);
          updatePreview('valuationMethod');
        });
      });
      
      // Listen for changes to life insurance amount
      document.getElementById('lifeInsuranceAmount').addEventListener('change', function() {
        document.getElementById('lifeInsurancePercentageField').style.display = this.value === 'percentage' ? 'block' : 'none';
        document.getElementById('lifeInsuranceFixedField').style.display = this.value === 'fixedAmount' ? 'block' : 'none';
      });
      
      // Listen for changes to disability insurance amount
      document.getElementById('disabilityInsuranceAmount').addEventListener('change', function() {
        document.getElementById('disabilityInsurancePercentageField').style.display = this.value === 'percentage' ? 'block' : 'none';
        document.getElementById('disabilityInsuranceFixedField').style.display = this.value === 'fixedAmount' ? 'block' : 'none';
      });
      
      // Listen for changes to payment method
      document.getElementById('paymentMethod').addEventListener('change', function() {
        document.getElementById('installmentTermsFields').style.display = 
          (this.value === 'installment' || this.value === 'mixed' || this.value === 'insurance') ? 'block' : 'none';
      });
      
      // Listen for changes to transfer restriction time
      document.getElementById('transferRestrictionTime').addEventListener('change', function() {
        document.getElementById('fixedYearsField').style.display = this.value === 'fixedYears' ? 'block' : 'none';
        document.getElementById('terminatingEventField').style.display = this.value === 'terminatingEvent' ? 'block' : 'none';
      });
      
      // Listen for changes to noncompete restrictions
      document.getElementById('noncompeteRestrictions').addEventListener('change', function() {
        document.getElementById('noncompeteDetailsField').style.display = this.value === 'none' ? 'none' : 'block';
        
        let noncompeteText = '';
        if (this.value === 'limited') {
          noncompeteText = 'For a period of two (2) years following the sale of an Owner\'s interest pursuant to this Agreement, the selling Owner shall not, directly or indirectly, engage in or have any ownership interest in any business that competes with the Company within a 50-mile radius of the Company\'s principal place of business.';
        } else if (this.value === 'standard') {
          noncompeteText = 'For a period of four (4) years following the sale of an Owner\'s interest pursuant to this Agreement, the selling Owner shall not, directly or indirectly, engage in, have any ownership interest in, or participate in the financing, operation, management, or control of, any business that competes with the Company within a 100-mile radius of the Company\'s principal place of business.';
        } else if (this.value === 'extensive') {
          noncompeteText = 'For a period of seven (7) years following the sale of an Owner\'s interest pursuant to this Agreement, the selling Owner shall not, directly or indirectly, engage in, have any ownership interest in, participate in the financing, operation, management, or control of, or be employed by or contracted with, any business that competes with the Company anywhere in the United States. The selling Owner further agrees not to solicit any employees, customers, or suppliers of the Company during this period.';
        }
        
        if (noncompeteText) {
          document.getElementById('noncompeteDetails').value = noncompeteText;
        }
      });
    });
    
    // Function to get all the selected triggering events
    function getSelectedTriggeringEvents() {
      const selectedEvents = [];
      document.querySelectorAll('input[name="triggeringEvents"]:checked').forEach(checkbox => {
        selectedEvents.push(checkbox.value);
      });
      return selectedEvents;
    }
    
    // Function to get all the selected permitted transfers
    function getSelectedPermittedTransfers() {
      const selectedTransfers = [];
      document.querySelectorAll('input[name="permittedTransfers"]:checked').forEach(checkbox => {
        selectedTransfers.push(checkbox.value);
      });
      return selectedTransfers;
    }
    
    // Function to get all owners
    function getAllOwners() {
      const owners = [];
      document.querySelectorAll('.owner-row').forEach(row => {
        const nameInput = row.querySelector('.owner-name-input');
        const percentageInput = row.querySelector('.owner-percentage-input');
        
        if (nameInput && percentageInput) {
          owners.push({
            name: nameInput.value.trim(),
            percentage: parseFloat(percentageInput.value) || 0
          });
        }
      });
      return owners;
    }
    
    // Function to add a new owner row
    function addOwnerRow() {
      const ownersContainer = document.getElementById('ownersContainer');
      const rowCount = ownersContainer.querySelectorAll('.owner-row').length + 1;
      
      const ownerRow = document.createElement('div');
      ownerRow.className = 'owner-row';
      ownerRow.id = `owner-row-${rowCount}`;
      
      ownerRow.innerHTML = `
        <div class="owner-inputs">
          <div class="owner-name">
            <input type="text" class="form-input owner-name-input" placeholder="Owner name" value="New Owner">
          </div>
          <div class="owner-percentage">
            <input type="number" class="form-input owner-percentage-input" placeholder="Ownership %" value="0" min="1" max="100">
          </div>
        </div>
        <div class="owner-row-actions">
          <button type="button" class="btn-icon remove" onclick="document.getElementById('owner-row-${rowCount}').remove(); updateOwnersPreview();">×</button>
        </div>
      `;
      
      ownersContainer.appendChild(ownerRow);
      
      // Add event listeners to new inputs
      const nameInput = ownerRow.querySelector('.owner-name-input');
      const percentageInput = ownerRow.querySelector('.owner-percentage-input');
      
      nameInput.addEventListener('input', updateOwnersPreview);
      percentageInput.addEventListener('input', updateOwnersPreview);
      
      updateOwnersPreview();
    }
    
    // Function to update the owner section in the preview
    function updateOwnersPreview() {
      updatePreview('owners');
    }
    
    // Function to select valuation method and update UI
    function selectValuationMethod(element, method) {
      // First, deselect all options
      document.querySelectorAll('.option-item').forEach(item => {
        if (item.querySelector('input[name="valuationMethod"]')) {
          item.classList.remove('selected');
          item.querySelector('input[name="valuationMethod"]').checked = false;
        }
      });
      
      // Select the clicked option
      element.classList.add('selected');
      element.querySelector('input[name="valuationMethod"]').checked = true;
      
      // Show the appropriate valuation fields
      showValuationFields(method);
      
      // Update the preview
      updatePreview('valuationMethod');
    }
    
    // Function to show the appropriate valuation fields based on method
    function showValuationFields(method) {
      document.querySelectorAll('.valuation-details').forEach(field => {
        field.style.display = 'none';
      });
      
      if (method === 'fixedPrice') {
        document.getElementById('fixedPriceFields').style.display = 'block';
      } else if (method === 'bookValue') {
        document.getElementById('bookValueFields').style.display = 'block';
      } else if (method === 'formulaMultiple') {
        document.getElementById('formulaMultipleFields').style.display = 'block';
      } else if (method === 'appraisal') {
        document.getElementById('appraisalFields').style.display = 'block';
      } else if (method === 'agreeValue') {
        document.getElementById('agreeValueFields').style.display = 'block';
      }
    }
    
    // Format date from YYYY-MM-DD to readable format
    function formatDate(dateString) {
      if (!dateString) return '';
      
      try {
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
      } catch (e) {
        return dateString;
      }
    }
    
    // Track currently highlighted elements
    let highlightedElements = [];
    let highlightTimeout;
    
    // Function to update active tab
    function updateActiveTab(tabId) {
      // Update active tab class
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabId) {
          tab.classList.add('active');
        }
      });
    }
    
    // Function to clear highlights
    function clearHighlights() {
      if (highlightTimeout) {
        clearTimeout(highlightTimeout);
      }
      
      highlightedElements.forEach(element => {
        element.classList.remove('highlight');
      });
      highlightedElements = [];
    }
    
    // Function to show preview with scrolling to top
    function showPreview(scrollToTop = false) {
      if (scrollToTop) {
        const previewBox = document.querySelector('.preview-box');
        previewBox.scrollTop = 0;
      }
    }
    
    // Function to update the agreement preview
    function updatePreview(changedField = null) {
      clearHighlights();
      
      // Get all form values
      const companyName = document.getElementById('companyName').value;
      const companyTypeEl = document.getElementById('companyType');
      const companyType = companyTypeEl.options[companyTypeEl.selectedIndex].text;
      const stateOfFormationEl = document.getElementById('stateOfFormation');
      const stateOfFormation = stateOfFormationEl.options[stateOfFormationEl.selectedIndex].text;
      const principalAddress = document.getElementById('principalAddress').value;
      const businessDescription = document.getElementById('businessDescription').value;
      const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
      const governingLawEl = document.getElementById('governingLaw');
      const governingLaw = governingLawEl.options[governingLawEl.selectedIndex].text;
      
      // Get owners
      const owners = getAllOwners();
      
      // Get voting requirements
      const votingRequirementsEl = document.getElementById('votingRequirements');
      const votingRequirements = votingRequirementsEl.options[votingRequirementsEl.selectedIndex].text;
      
      // Get triggering events
      const triggeringEvents = getSelectedTriggeringEvents();
      const disabilityPeriodEl = document.getElementById('disabilityPeriod');
      const disabilityPeriod = disabilityPeriodEl.options[disabilityPeriodEl.selectedIndex].text;
      
      // Get valuation method
      let valuationMethod = '';
      document.getElementsByName('valuationMethod').forEach(radio => {
        if (radio.checked) {
          valuationMethod = radio.value;
        }
      });
      
      // Get valuation details based on method
      let valuationDetails = '';
      if (valuationMethod === 'fixedPrice') {
        const fixedPriceAmount = document.getElementById('fixedPriceAmount').value;
        const fixedPriceReviewEl = document.getElementById('fixedPriceReview');
        const fixedPriceReview = fixedPriceReviewEl.options[fixedPriceReviewEl.selectedIndex].text;
        valuationDetails = `Fixed price of ${fixedPriceAmount} to be reviewed ${fixedPriceReview.toLowerCase()}`;
      } else if (valuationMethod === 'bookValue') {
        const bookValueMethodEl = document.getElementById('bookValueMethod');
        const bookValueMethodText = bookValueMethodEl.options[bookValueMethodEl.selectedIndex].text;
        valuationDetails = `Book value based on ${bookValueMethodText.toLowerCase()}`;
      } else if (valuationMethod === 'formulaMultiple') {
        const earningsTypeEl = document.getElementById('earningsType');
        const earningsType = earningsTypeEl.options[earningsTypeEl.selectedIndex].text;
        const earningsPeriodEl = document.getElementById('earningsPeriod');
        const earningsPeriod = earningsPeriodEl.options[earningsPeriodEl.selectedIndex].text;
        const earningsMultiple = document.getElementById('earningsMultiple').value;
        valuationDetails = `${earningsMultiple}x multiple of ${earningsType} based on ${earningsPeriod.toLowerCase()}`;
      } else if (valuationMethod === 'appraisal') {
        const appraiserSelectionEl = document.getElementById('appraiserSelection');
        const appraiserSelection = appraiserSelectionEl.options[appraiserSelectionEl.selectedIndex].text;
        const appraisalCostsEl = document.getElementById('appraisalCosts');
        const appraisalCosts = appraisalCostsEl.options[appraisalCostsEl.selectedIndex].text;
        valuationDetails = `Independent appraisal using ${appraiserSelection.toLowerCase()} with costs ${appraisalCosts.toLowerCase()}`;
      } else if (valuationMethod === 'agreeValue') {
        const agreeValueInitial = document.getElementById('agreeValueInitial').value;
        const agreeValueReviewEl = document.getElementById('agreeValueReview');
        const agreeValueReview = agreeValueReviewEl.options[agreeValueReviewEl.selectedIndex].text;
        const agreeValueDefaultEl = document.getElementById('agreeValueDefault');
        const agreeValueDefault = agreeValueDefaultEl.options[agreeValueDefaultEl.selectedIndex].text;
        valuationDetails = `Initially agreed value of ${agreeValueInitial} to be reviewed ${agreeValueReview.toLowerCase()} with ${agreeValueDefault.toLowerCase()} as default if no agreement`;
      }
      
      // Get purchase terms
      const rightOfFirstRefusalEl = document.getElementById('rightOfFirstRefusal');
      const rightOfFirstRefusal = rightOfFirstRefusalEl.options[rightOfFirstRefusalEl.selectedIndex].text;
      const paymentMethodEl = document.getElementById('paymentMethod');
      const paymentMethod = paymentMethodEl.options[paymentMethodEl.selectedIndex].text;
      
      // Get installment terms
      let installmentTerms = '';
      if (paymentMethod.includes('Installment')) {
        const downPaymentPercentage = document.getElementById('downPaymentPercentage').value;
        const installmentPeriodEl = document.getElementById('installmentPeriod');
        const installmentPeriod = installmentPeriodEl.options[installmentPeriodEl.selectedIndex].text;
        const interestRate = document.getElementById('interestRate').value;
        const paymentFrequencyEl = document.getElementById('paymentFrequency');
        const paymentFrequency = paymentFrequencyEl.options[paymentFrequencyEl.selectedIndex].text;
        
        installmentTerms = `Down payment of ${downPaymentPercentage}% with remainder paid over ${installmentPeriod} at ${interestRate}% interest with ${paymentFrequency.toLowerCase()} payments`;
      }
      
      const closingPeriodEl = document.getElementById('closingPeriod');
      const closingPeriod = closingPeriodEl.options[closingPeriodEl.selectedIndex].text;
      
      // Get insurance provisions
      const lifeInsuranceEl = document.getElementById('lifeInsurance');
      const lifeInsurance = lifeInsuranceEl.options[lifeInsuranceEl.selectedIndex].text;
      
      let lifeInsuranceDetails = '';
      if (lifeInsurance !== 'No Insurance Provisions') {
        const lifeInsuranceOwnerEl = document.getElementById('lifeInsuranceOwner');
        const lifeInsuranceOwner = lifeInsuranceOwnerEl.options[lifeInsuranceOwnerEl.selectedIndex].text;
        const lifeInsuranceAmountEl = document.getElementById('lifeInsuranceAmount');
        const lifeInsuranceAmount = lifeInsuranceAmountEl.options[lifeInsuranceAmountEl.selectedIndex].text;
        
        let coverageDetail = '';
        if (lifeInsuranceAmount === 'Percentage of Purchase Price') {
          coverageDetail = `${document.getElementById('lifeInsurancePercentage').value}% of the purchase price`;
        } else if (lifeInsuranceAmount === 'Fixed Dollar Amount') {
          coverageDetail = document.getElementById('lifeInsuranceFixed').value;
        } else {
          coverageDetail = 'full purchase price';
        }
        
        lifeInsuranceDetails = `${lifeInsuranceOwner} with coverage of ${coverageDetail}`;
      }
      
      const disabilityInsuranceEl = document.getElementById('disabilityInsurance');
      const disabilityInsurance = disabilityInsuranceEl.options[disabilityInsuranceEl.selectedIndex].text;
      
      let disabilityInsuranceDetails = '';
      if (disabilityInsurance !== 'No Disability Insurance Provisions') {
        const disabilityInsuranceOwnerEl = document.getElementById('disabilityInsuranceOwner');
        const disabilityInsuranceOwner = disabilityInsuranceOwnerEl.options[disabilityInsuranceOwnerEl.selectedIndex].text;
        const disabilityInsuranceAmountEl = document.getElementById('disabilityInsuranceAmount');
        const disabilityInsuranceAmount = disabilityInsuranceAmountEl.options[disabilityInsuranceAmountEl.selectedIndex].text;
        
        let coverageDetail = '';
        if (disabilityInsuranceAmount === 'Percentage of Purchase Price') {
          coverageDetail = `${document.getElementById('disabilityInsurancePercentage').value}% of the purchase price`;
        } else if (disabilityInsuranceAmount === 'Fixed Dollar Amount') {
          coverageDetail = document.getElementById('disabilityInsuranceFixed').value;
        } else {
          coverageDetail = 'full purchase price';
        }
        
        disabilityInsuranceDetails = `${disabilityInsuranceOwner} with coverage of ${coverageDetail}`;
      }
      
      const insuranceMaintenanceEl = document.getElementById('insuranceMaintenance');
      const insuranceMaintenance = insuranceMaintenanceEl.options[insuranceMaintenanceEl.selectedIndex].text;
      
      // Get transfer restrictions
      const permittedTransfers = getSelectedPermittedTransfers();
      
      const spousalConsentEl = document.getElementById('spousalConsent');
      const spousalConsent = spousalConsentEl.options[spousalConsentEl.selectedIndex].text;
      
      const noncompeteRestrictionsEl = document.getElementById('noncompeteRestrictions');
      const noncompeteRestrictions = noncompeteRestrictionsEl.options[noncompeteRestrictionsEl.selectedIndex].text;
      const noncompeteDetails = document.getElementById('noncompeteDetails').value;
      
      const tagsAlongEl = document.getElementById('tagsAlong');
      const tagsAlong = tagsAlongEl.options[tagsAlongEl.selectedIndex].text;
      
      const dragAlongEl = document.getElementById('dragAlong');
      const dragAlong = dragAlongEl.options[dragAlongEl.selectedIndex].text;
      
      // Get legal provisions
      const disputeResolutionEl = document.getElementById('disputeResolution');
      const disputeResolution = disputeResolutionEl.options[disputeResolutionEl.selectedIndex].text;
      
      const attorneyFeesProvisionEl = document.getElementById('attorneyFeesProvision');
      const attorneyFeesProvision = attorneyFeesProvisionEl.options[attorneyFeesProvisionEl.selectedIndex].text;
      
      const transferRestrictionTimeEl = document.getElementById('transferRestrictionTime');
      const transferRestrictionTime = transferRestrictionTimeEl.options[transferRestrictionTimeEl.selectedIndex].text;
      
      let durationDetails = '';
      if (transferRestrictionTime === 'Fixed Term (Years)') {
        durationDetails = `${document.getElementById('fixedYearsNumber').value} years`;
      } else if (transferRestrictionTime === 'Until Specific Terminating Event') {
        durationDetails = document.getElementById('terminatingEventDescription').value;
      } else {
        durationDetails = 'indefinite until terminated by agreement of the Owners';
      }
      
      const confidentialityEl = document.getElementById('confidentiality');
      const confidentiality = confidentialityEl.options[confidentialityEl.selectedIndex].text;
      
      const amendmentProvisionsEl = document.getElementById('amendmentProvisions');
      const amendmentProvisions = amendmentProvisionsEl.options[amendmentProvisionsEl.selectedIndex].text;
      
      const additionalProvisions = document.getElementById('additionalProvisions').value;
      
      // Build the agreement preview
      let agreementHTML = `
        <div class="document-title">BUY-SELL AGREEMENT</div>
        
        <div class="document-section" id="section-intro">
          <p>This Buy-Sell Agreement (the "Agreement") is made and entered into as of ${effectiveDate} (the "Effective Date"), by and among the owners (individually an "Owner" and collectively the "Owners") of ${companyName}, a ${companyType} organized under the laws of the State of ${stateOfFormation} (the "Company").</p>
          
          <div class="section-title">RECITALS</div>
          <div class="section-content">
            <p>WHEREAS, the Owners own all of the issued and outstanding ownership interests of the Company;</p>
            
            <p>WHEREAS, the Company is engaged in the business of ${businessDescription};</p>
            
            <p>WHEREAS, the Owners wish to ensure continuity in the ownership and management of the Company in the event of certain occurrences, including the death, disability, retirement, or other withdrawal of an Owner; and</p>
            
            <p>WHEREAS, the Owners desire to establish terms and conditions for the sale and purchase of an Owner's interest in the Company upon the occurrence of certain events.</p>
            
            <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements hereinafter set forth and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the Owners agree as follows:</p>
          </div>
        </div>
        
        <div class="document-section" id="section-definitions">
          <div class="section-title">1. DEFINITIONS</div>
          <div class="section-content">
            <p><span class="field-label">1.1 "Company"</span> means ${companyName}, a ${companyType} organized under the laws of the State of ${stateOfFormation}.</p>
            
            <p><span class="field-label">1.2 "Disability" or "Disabled"</span> means the inability of an Owner, because of injury or illness, to perform the essential functions of their regular duties as determined by a licensed physician for a period of at least ${disabilityPeriod}.</p>
            
            <p><span class="field-label">1.3 "Fair Market Value"</span> means the value of the Company or an Owner's Interest as determined in accordance with Section 3 of this Agreement.</p>
            
            <p><span class="field-label">1.4 "Interest"</span> means an Owner's entire ownership interest in the Company, including all economic rights, voting rights, and any other rights associated with ownership.</p>
            
            <p><span class="field-label">1.5 "Purchase Price"</span> means the amount to be paid for an Owner's Interest as determined in accordance with Section 3 of this Agreement.</p>
            
            <p><span class="field-label">1.6 "Triggering Event"</span> means any event specified in Section 2 of this Agreement that triggers the option or obligation to purchase an Owner's Interest.</p>
          </div>
        </div>
        
        <div class="document-section" id="section-owners">
          <div class="section-title">2. OWNERS AND OWNERSHIP INTERESTS</div>
          <div class="section-content">
            <p><span class="field-label">2.1 Current Owners.</span> As of the Effective Date, the Owners of the Company and their respective ownership percentages are as follows:</p>
            
            <p>
              ${owners.map(owner => `${owner.name}: ${owner.percentage}%`).join('<br>')}
            </p>
            
            <p><span class="field-label">2.2 Modification of Agreement.</span> Any modification or amendment to this Agreement must be approved by ${votingRequirements}.</p>
          </div>
        </div>
        
        <div class="document-section" id="section-triggering-events">
          <div class="section-title">3. TRIGGERING EVENTS</div>
          <div class="section-content">
            <p><span class="field-label">3.1 Events Triggering Buy-Sell Provisions.</span> The following events shall trigger the buy-sell provisions of this Agreement:</p>
            
            <p>
              ${generateTriggeringEventsList(triggeringEvents)}
            </p>
          </div>
        </div>
        
        <div class="document-section" id="section-valuation">
          <div class="section-title">4. VALUATION</div>
          <div class="section-content">
            <p><span class="field-label">4.1 Valuation Method.</span> The value of the Company and the Purchase Price for an Owner's Interest shall be determined as follows: ${getValuationMethodText(valuationMethod)}</p>
            
            <p><span class="field-label">4.2 Valuation Details.</span> ${valuationDetails}</p>
            
            <p><span class="field-label">4.3 Binding Effect.</span> The value determined in accordance with this Section 4 shall be binding on all parties for purposes of transactions contemplated by this Agreement.</p>
          </div>
        </div>
        
        <div class="document-section" id="section-purchase-terms">
          <div class="section-title">5. PURCHASE TERMS</div>
          <div class="section-content">
            <p><span class="field-label">5.1 Right of First Refusal.</span> Upon the occurrence of a Triggering Event, the right to purchase the Interest of a selling or departing Owner shall be allocated as follows: ${rightOfFirstRefusal}.</p>
            
            <p><span class="field-label">5.2 Payment Terms.</span> The Purchase Price shall be paid as follows: ${paymentMethod}.</p>
            
            ${installmentTerms ? `<p><span class="field-label">5.3 Installment Terms.</span> ${installmentTerms}.</p>` : ''}
            
            <p><span class="field-label">${installmentTerms ? '5.4' : '5.3'} Closing Period.</span> Unless otherwise specified, the purchase and sale transaction shall close within ${closingPeriod} after the determination of the Purchase Price.</p>
          </div>
        </div>
        
        <div class="document-section" id="section-insurance">
          <div class="section-title">6. INSURANCE</div>
          <div class="section-content">
            <p><span class="field-label">6.1 Life Insurance.</span> ${lifeInsurance === 'No Insurance Provisions' ? 'This Agreement does not require life insurance policies to fund the purchase of an Owner\'s Interest upon death.' : `Life insurance shall be ${lifeInsurance.toLowerCase()}. ${lifeInsuranceDetails}.`}</p>
            
            <p><span class="field-label">6.2 Disability Insurance.</span> ${disabilityInsurance === 'No Disability Insurance Provisions' ? 'This Agreement does not require disability insurance policies to fund the purchase of a Disabled Owner\'s Interest.' : `Disability insurance shall be ${disabilityInsurance.toLowerCase()}. ${disabilityInsuranceDetails}.`}</p>
            
            <p><span class="field-label">6.3 Insurance Maintenance.</span> The insurance policies shall be maintained and reviewed ${insuranceMaintenance.toLowerCase()}.</p>
          </div>
        </div>
        
        <div class="document-section" id="section-transfer-restrictions">
          <div class="section-title">7. TRANSFER RESTRICTIONS</div>
          <div class="section-content">
            <p><span class="field-label">7.1 General Restriction.</span> Except as expressly permitted in this Agreement, no Owner shall sell, assign, transfer, pledge, encumber, hypothecate, or otherwise dispose of all or any part of their Interest in the Company.</p>
            
            <p><span class="field-label">7.2 Permitted Transfers.</span> Notwithstanding Section 7.1, an Owner may transfer all or part of their Interest without triggering the buy-sell provisions of this Agreement in the following circumstances:</p>
            
            <p>
              ${generatePermittedTransfersList(permittedTransfers)}
            </p>
            
            <p><span class="field-label">7.3 Spousal Consent.</span> ${getSpousalConsentText(spousalConsent)}</p>
            
            ${noncompeteRestrictions !== 'No Restrictions' ? `<p><span class="field-label">7.4 Non-Compete Restrictions.</span> ${noncompeteDetails}</p>` : ''}
            
            <p><span class="field-label">7.${noncompeteRestrictions !== 'No Restrictions' ? '5' : '4'} Tag-Along Rights.</span> ${getTagAlongText(tagsAlong)}</p>
            
            <p><span class="field-label">7.${noncompeteRestrictions !== 'No Restrictions' ? '6' : '5'} Drag-Along Rights.</span> ${getDragAlongText(dragAlong)}</p>
          </div>
        </div>
        
        <div class="document-section" id="section-legal">
          <div class="section-title">8. GENERAL PROVISIONS</div>
          <div class="section-content">
            <p><span class="field-label">8.1 Governing Law.</span> This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw} without giving effect to any choice or conflict of law provision or rule.</p>
            
            <p><span class="field-label">8.2 Dispute Resolution.</span> ${getDisputeResolutionText(disputeResolution)}</p>
            
            <p><span class="field-label">8.3 Attorney's Fees.</span> In the event of any dispute related to this Agreement, ${getAttorneyFeesText(attorneyFeesProvision)}</p>
            
            <p><span class="field-label">8.4 Term.</span> This Agreement shall remain in effect for ${durationDetails}.</p>
            
            <p><span class="field-label">8.5 Confidentiality.</span> ${getConfidentialityText(confidentiality)}</p>
            
            <p><span class="field-label">8.6 Amendment.</span> This Agreement may be amended only by ${amendmentProvisions.toLowerCase()}.</p>
            
            <p><span class="field-label">8.7 Notices.</span> All notices required or permitted under this Agreement shall be in writing and shall be deemed effectively given: (a) upon personal delivery to the party to be notified, (b) when sent by confirmed electronic mail if sent during normal business hours of the recipient, (c) five days after having been sent by registered or certified mail, return receipt requested, postage prepaid, or (d) one day after deposit with a nationally recognized overnight courier, specifying next day delivery, with written verification of receipt.</p>
            
            <p><span class="field-label">8.8 Entire Agreement.</span> This Agreement constitutes the entire agreement among the Owners with respect to the subject matter hereof and supersedes all prior agreements and understandings, both written and oral, with respect to such subject matter.</p>
            
            ${additionalProvisions ? `<p><span class="field-label">8.9 Additional Provisions.</span> ${additionalProvisions}</p>` : ''}
          </div>
        </div>
        
        <div class="document-section" id="section-signatures">
          <div class="section-title">9. EXECUTION</div>
          <div class="section-content">
            <p>IN WITNESS WHEREOF, the parties have executed this Buy-Sell Agreement as of the Effective Date first written above.</p>
            
            <p style="margin-top: 30px;">OWNERS:</p>
            
            ${owners.map(owner => `
            <p style="margin-top: 20px;">
              ____________________________<br>
              ${owner.name}<br>
              Ownership: ${owner.percentage}%
            </p>
            `).join('')}
            
            ${spousalConsent === 'Required' ? `
            <p style="margin-top: 30px;">SPOUSAL CONSENT:</p>
            
            ${owners.map(owner => `
            <p style="margin-top: 20px;">
              ____________________________<br>
              Spouse of ${owner.name}
            </p>
            `).join('')}
            ` : ''}
          </div>
        </div>
      `;
      
      // Update the preview with the agreement HTML
      document.getElementById('agreementPreview').innerHTML = agreementHTML;
      
      // If a specific field was changed, highlight the relevant section
      if (changedField) {
        highlightChangedContent(changedField);
      }
    }
    
    // Function to highlight changed content in the preview
    function highlightChangedContent(changedField) {
      // Clear any existing highlights
      clearHighlights();
      
      // Determine which section to highlight based on the changed field
      let sectionId = '';
      let elements = [];
      let textToFind = '';
      
      // Map fields to their corresponding sections
      if (['companyName', 'companyType', 'stateOfFormation', 'principalAddress', 'businessDescription', 'effectiveDate', 'governingLaw'].includes(changedField)) {
        sectionId = 'section-intro';
        
        if (changedField === 'companyName') {
          textToFind = document.getElementById('companyName').value;
        } else if (changedField === 'businessDescription') {
          textToFind = document.getElementById('businessDescription').value;
        } else if (changedField === 'effectiveDate') {
          textToFind = formatDate(document.getElementById('effectiveDate').value);
        }
      } else if (changedField === 'owners' || changedField === 'votingRequirements') {
        sectionId = 'section-owners';
        
        if (changedField === 'votingRequirements') {
          const votingRequirementsEl = document.getElementById('votingRequirements');
          textToFind = votingRequirementsEl.options[votingRequirementsEl.selectedIndex].text;
        }
      } else if (changedField === 'triggeringEvents' || changedField === 'disabilityPeriod') {
        sectionId = 'section-triggering-events';
        
        if (changedField === 'disabilityPeriod') {
          textToFind = document.getElementById('disabilityPeriod').options[document.getElementById('disabilityPeriod').selectedIndex].text;
        }
      } else if (changedField === 'valuationMethod' || changedField === 'fixedPriceAmount' || changedField === 'fixedPriceReview' || 
                changedField === 'bookValueMethod' || changedField === 'earningsType' || changedField === 'earningsPeriod' || 
                changedField === 'earningsMultiple' || changedField === 'appraiserSelection' || changedField === 'appraisalCosts' || 
                changedField === 'agreeValueInitial' || changedField === 'agreeValueReview' || changedField === 'agreeValueDefault') {
        sectionId = 'section-valuation';
      } else if (changedField === 'rightOfFirstRefusal' || changedField === 'paymentMethod' || changedField === 'downPaymentPercentage' ||
                changedField === 'installmentPeriod' || changedField === 'interestRate' || changedField === 'paymentFrequency' ||
                changedField === 'closingPeriod') {
        sectionId = 'section-purchase-terms';
      } else if (changedField === 'lifeInsurance' || changedField === 'lifeInsuranceOwner' || changedField === 'lifeInsuranceAmount' ||
                changedField === 'lifeInsurancePercentage' || changedField === 'lifeInsuranceFixed' || changedField === 'disabilityInsurance' ||
                changedField === 'disabilityInsuranceOwner' || changedField === 'disabilityInsuranceAmount' || changedField === 'disabilityInsurancePercentage' ||
                changedField === 'disabilityInsuranceFixed' || changedField === 'insuranceMaintenance') {
        sectionId = 'section-insurance';
      } else if (changedField === 'permittedTransfers' || changedField === 'spousalConsent' || changedField === 'noncompeteRestrictions' ||
                changedField === 'noncompeteDetails' || changedField === 'tagsAlong' || changedField === 'dragAlong') {
        sectionId = 'section-transfer-restrictions';
      } else if (changedField === 'disputeResolution' || changedField === 'attorneyFeesProvision' || changedField === 'transferRestrictionTime' ||
                changedField === 'fixedYearsNumber' || changedField === 'terminatingEventDescription' || changedField === 'confidentiality' ||
                changedField === 'amendmentProvisions' || changedField === 'additionalProvisions') {
        sectionId = 'section-legal';
      }
      
      // Find the section element
      if (sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
          // Find specific text or highlight the section
          if (textToFind) {
            const sectionContent = section.innerHTML;
            const index = sectionContent.indexOf(textToFind);
            
            if (index !== -1) {
              // Create a temporary element
              const tempElement = document.createElement('div');
              tempElement.innerHTML = sectionContent;
              
              // Find text nodes that contain our text
              const walkNodes = document.createTreeWalker(
                tempElement,
                NodeFilter.SHOW_TEXT,
                { acceptNode: function(node) { return node.nodeValue.includes(textToFind) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT; } },
                false
              );
              
              const matchingNodes = [];
              let currentNode;
              while (currentNode = walkNodes.nextNode()) {
                matchingNodes.push(currentNode);
              }
              
              if (matchingNodes.length > 0) {
                // Replace the first occurrence with highlighted text
                const node = matchingNodes[0];
                const nodeValue = node.nodeValue;
                const startIndex = nodeValue.indexOf(textToFind);
                
                if (startIndex !== -1) {
                  const beforeText = nodeValue.substring(0, startIndex);
                  const highlightedText = nodeValue.substring(startIndex, startIndex + textToFind.length);
                  const afterText = nodeValue.substring(startIndex + textToFind.length);
                  
                  const spanElement = document.createElement('span');
                  spanElement.className = 'highlight';
                  spanElement.textContent = highlightedText;
                  
                  const fragment = document.createDocumentFragment();
                  if (beforeText) {
                    fragment.appendChild(document.createTextNode(beforeText));
                  }
                  fragment.appendChild(spanElement);
                  if (afterText) {
                    fragment.appendChild(document.createTextNode(afterText));
                  }
                  
                  // Replace the node with our fragment
                  node.parentNode.replaceChild(fragment, node);
                  
                  // Update the section's HTML
                  section.innerHTML = tempElement.innerHTML;
                  
                  // Add the highlighted element to our tracking array
                  const highlightedElement = section.querySelector('.highlight');
                  if (highlightedElement) {
                    highlightedElements.push(highlightedElement);
                    
                    // Scroll to the highlighted element if it's not visible
                    const previewBox = document.querySelector('.preview-box');
                    const highlightRect = highlightedElement.getBoundingClientRect();
                    const previewRect = previewBox.getBoundingClientRect();
                    
                    if (highlightRect.top < previewRect.top || highlightRect.bottom > previewRect.bottom) {
                      highlightedElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                      });
                    }
                  }
                }
              } else {
                // If we couldn't find the text directly, highlight the whole section
                section.classList.add('highlight');
                highlightedElements.push(section);
              }
            } else {
              // If text not found, highlight the whole section
              section.classList.add('highlight');
              highlightedElements.push(section);
            }
          } else {
            // Highlight the whole section if no specific text
            section.classList.add('highlight');
            highlightedElements.push(section);
          }
        }
      }
      
      // Set timeout to remove highlight after some time
      highlightTimeout = setTimeout(() => {
        clearHighlights();
      }, 5000);
    }
    
    // Function to generate list of triggering events
    function generateTriggeringEventsList(events) {
      if (!events || events.length === 0) {
        return 'No triggering events selected.';
      }
      
      const eventTexts = [];
      
      if (events.includes('death')) {
        eventTexts.push('Death of an Owner');
      }
      
      if (events.includes('disability')) {
        eventTexts.push('Disability of an Owner');
      }
      
      if (events.includes('retirement')) {
        eventTexts.push('Retirement of an Owner');
      }
      
      if (events.includes('termination')) {
        eventTexts.push('Termination of an Owner\'s employment with the Company');
      }
      
      if (events.includes('bankruptcy')) {
        eventTexts.push('Bankruptcy or insolvency of an Owner');
      }
      
      if (events.includes('divorce')) {
        eventTexts.push('Divorce of an Owner where the Owner\'s Interest may be transferred to a former spouse');
      }
      
      if (events.includes('thirdPartyOffer')) {
        eventTexts.push('Receipt of a bona fide offer from a third party to purchase an Owner\'s Interest');
      }
      
      return eventTexts.map((text, index) => `${index + 1}. ${text}`).join('<br>');
    }
    
    // Function to generate list of permitted transfers
    function generatePermittedTransfersList(transfers) {
      if (!transfers || transfers.length === 0) {
        return 'No permitted transfers selected.';
      }
      
      const transferTexts = [];
      
      if (transfers.includes('familyMembers')) {
        transferTexts.push('Transfers to immediate family members (spouse, children, grandchildren, parents, or siblings)');
      }
      
      if (transfers.includes('trusts')) {
        transferTexts.push('Transfers to a trust for the benefit of the Owner or the Owner\'s immediate family members');
      }
      
      if (transfers.includes('otherOwners')) {
        transferTexts.push('Transfers to other existing Owners of the Company');
      }
      
      if (transfers.includes('affiliates')) {
        transferTexts.push('Transfers to entities controlled by, controlling, or under common control with the Owner');
      }
      
      return transferTexts.map((text, index) => `${index + 1}. ${text}`).join('<br>');
    }
    
    // Function to get valuation method text
    function getValuationMethodText(method) {
      switch (method) {
        case 'fixedPrice':
          return 'A fixed price agreed upon by all Owners';
        case 'bookValue':
          return 'The book value of the Company as determined by the Company\'s financial statements';
        case 'formulaMultiple':
          return 'A multiple of the Company\'s earnings';
        case 'appraisal':
          return 'An independent appraisal by a qualified business appraiser';
        case 'agreeValue':
          return 'A value periodically agreed upon by all Owners';
        default:
          return 'A value determined according to the terms of this Agreement';
      }
    }
    
    // Function to get spousal consent text
    function getSpousalConsentText(consent) {
      switch (consent) {
        case 'Required':
          return 'The spouse of each Owner shall execute a spousal consent to this Agreement, acknowledging their understanding of the terms and agreeing to be bound by the provisions that may affect their interests.';
        case 'Optional':
          return 'Owners are encouraged, but not required, to have their spouses execute a spousal consent to this Agreement.';
        case 'Not Required':
          return 'Spousal consent is not required for this Agreement.';
        default:
          return 'The requirement for spousal consent shall be determined on a case-by-case basis.';
      }
    }
    
    // Function to get tag along text
    function getTagAlongText(tagAlong) {
      switch (tagAlong) {
        case 'None':
          return 'No tag-along rights are provided under this Agreement.';
        case 'Limited (Majority Transactions Only)':
          return 'If an Owner or group of Owners holding a majority of the Company\'s ownership interests receives an offer from a third party to purchase their interests, the other Owners shall have the right to participate in the sale on the same terms and conditions in proportion to their ownership interests.';
        case 'Standard':
          return 'If any Owner receives an offer from a third party to purchase their Interest, the other Owners shall have the right to participate in the sale on the same terms and conditions in proportion to their ownership interests.';
        case 'Comprehensive':
          return 'If any Owner receives an offer from a third party to purchase their Interest, the other Owners shall have the right to require the third party to purchase all of their Interests on the same terms and conditions as offered to the selling Owner.';
        default:
          return 'Tag-along rights shall be as determined by the Owners at the time of a proposed sale.';
      }
    }
    
    // Function to get drag along text
    function getDragAlongText(dragAlong) {
      switch (dragAlong) {
        case 'None':
          return 'No drag-along rights are provided under this Agreement.';
        case 'Majority Owners':
          return 'If an Owner or group of Owners holding a majority of the Company\'s ownership interests receives an offer from a third party to purchase all interests in the Company, such Owner(s) may require all other Owners to sell their Interests to the third party on the same terms and conditions.';
        case 'Super Majority (2/3 or 3/4)':
          return 'If an Owner or group of Owners holding at least two-thirds (2/3) of the Company\'s ownership interests receives an offer from a third party to purchase all interests in the Company, such Owner(s) may require all other Owners to sell their Interests to the third party on the same terms and conditions.';
        case 'Unanimity Required':
          return 'All Owners must unanimously agree to any sale of the Company to a third party.';
        default:
          return 'Drag-along rights shall be as determined by the Owners at the time of a proposed sale.';
      }
    }
    
    // Function to get dispute resolution text
    function getDisputeResolutionText(disputeResolution) {
      switch (disputeResolution) {
        case 'Litigation':
          return 'Any disputes arising out of or relating to this Agreement shall be resolved through litigation in the appropriate courts of the State specified in Section 8.1.';
        case 'Binding Arbitration':
          return 'Any disputes arising out of or relating to this Agreement shall be resolved through binding arbitration administered by the American Arbitration Association under its Commercial Arbitration Rules. The arbitration shall take place in the State specified in Section 8.1, and judgment on the award rendered by the arbitrator(s) may be entered in any court having jurisdiction thereof.';
        case 'Mediation Before Arbitration':
          return 'Any disputes arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful, the dispute shall be resolved through binding arbitration administered by the American Arbitration Association under its Commercial Arbitration Rules.';
        case 'Mediation Only (Non-Binding)':
          return 'The parties shall attempt in good faith to resolve any disputes arising out of or relating to this Agreement through mediation before pursuing other legal remedies.';
        default:
          return 'Disputes shall be resolved according to the dispute resolution procedures agreed upon by the Owners.';
      }
    }
    
    // Function to get attorney fees text
    function getAttorneyFeesText(attorneyFees) {
      switch (attorneyFees) {
        case 'Prevailing Party Recovers Fees':
          return 'the prevailing party shall be entitled to recover its reasonable attorneys\' fees, costs, and expenses from the non-prevailing party.';
        case 'Each Party Bears Own Fees':
          return 'each party shall bear its own attorneys\' fees, costs, and expenses regardless of the outcome.';
        case 'Court/Arbitrator Discretion':
          return 'the court or arbitrator shall have discretion to award attorneys\' fees, costs, and expenses as deemed appropriate.';
        default:
          return 'attorneys\' fees shall be allocated as determined by the court or arbitrator.';
      }
    }
    
    // Function to get confidentiality text
    function getConfidentialityText(confidentiality) {
      switch (confidentiality) {
        case 'None':
          return 'This Agreement does not contain specific confidentiality provisions.';
        case 'Limited':
          return 'The Owners agree to maintain the confidentiality of the terms of this Agreement and not to disclose such terms to any third party without the consent of all Owners.';
        case 'Standard':
          return 'The Owners agree to maintain the confidentiality of the terms of this Agreement and all proprietary or confidential information of the Company, including but not limited to financial information, business plans, customer lists, and trade secrets.';
        case 'Comprehensive':
          return 'The Owners agree to maintain the strict confidentiality of the terms of this Agreement and all proprietary or confidential information of the Company, including but not limited to financial information, business plans, customer lists, trade secrets, and any other information not generally known to the public. This confidentiality obligation shall survive the termination of an Owner\'s association with the Company or the termination of this Agreement.';
        default:
          return 'The Owners shall maintain appropriate confidentiality regarding the terms of this Agreement and the Company\'s proprietary information.';
      }
    }
    
    // Function to copy agreement to clipboard
    function copyAgreement() {
      const agreementText = document.getElementById('agreementPreview').innerText;
      
      navigator.clipboard.writeText(agreementText).then(function() {
        document.getElementById('copyMessage').style.display = 'inline';
        
        setTimeout(function() {
          document.getElementById('copyMessage').style.display = 'none';
        }, 3000);
      }).catch(function(err) {
        console.error('Could not copy text: ', err);
        alert('Failed to copy to clipboard. Please try manually selecting the text and copying it.');
      });
    }
    
    // Function to download agreement as DOCX
    function downloadAgreement() {
      try {
        // Access docx library
        const docx = window.docx;
        if (!docx) {
          throw new Error("DOCX library not loaded");
        }
        
        const companyName = document.getElementById('companyName').value || 'Company';
        const companyType = document.getElementById('companyType').options[document.getElementById('companyType').selectedIndex].text;
        const effectiveDate = formatDate(document.getElementById('effectiveDate').value);
        
        // Get all sections from the preview
        const sectionElements = document.querySelectorAll('.document-section');
        const paragraphs = [];
        
        // Add title
        paragraphs.push(
          new docx.Paragraph({
            text: "BUY-SELL AGREEMENT",
            heading: docx.HeadingLevel.TITLE,
            alignment: docx.AlignmentType.CENTER,
            spacing: {
              before: 400,
              after: 400
            }
          })
        );
        
        // Process each section
        sectionElements.forEach(section => {
          const titleElement = section.querySelector('.section-title');
          const contentElement = section.querySelector('.section-content');
          
          if (titleElement) {
            // Add section title
            paragraphs.push(
              new docx.Paragraph({
                text: titleElement.textContent,
                heading: docx.HeadingLevel.HEADING_2,
                spacing: {
                  before: 300,
                  after: 100
                }
              })
            );
          }
          
          if (contentElement) {
            // Process paragraphs in content
            const contentParagraphs = contentElement.querySelectorAll('p');
            contentParagraphs.forEach(p => {
              const labelElement = p.querySelector('.field-label');
              
              if (labelElement) {
                // Paragraph with label-value format
                const label = labelElement.textContent;
                const valueText = p.textContent.replace(label, '').trim();
                
                paragraphs.push(
                  new docx.Paragraph({
                    children: [
                      new docx.TextRun({
                        text: label + " ",
                        bold: true
                      }),
                      new docx.TextRun({
                        text: valueText
                      })
                    ],
                    spacing: {
                      before: 100,
                      after: 100
                    }
                  })
                );
              } else {
                // Regular paragraph
                paragraphs.push(
                  new docx.Paragraph({
                    text: p.textContent,
                    spacing: {
                      before: 100,
                      after: 100
                    }
                  })
                );
              }
            });
          }
        });
        
        // Create document
        const doc = new docx.Document({
          sections: [{
            properties: {
              page: {
                margin: {
                  top: 1440, // 1 inch in twips
                  right: 1440,
                  bottom: 1440,
                  left: 1440
                }
              }
            },
            children: paragraphs
          }]
        });
        
        // Generate and save document
        docx.Packer.toBlob(doc)
          .then(blob => {
            const fileName = `${companyName.replace(/[^a-z0-9]/gi, '_')}_Buy_Sell_Agreement_${effectiveDate.replace(/,/g, '').replace(/ /g, '_')}.docx`;
            window.saveAs(blob, fileName);
          })
          .catch(error => {
            console.error("Error saving DOCX:", error);
            alert("Unable to download. Please try using the copy button instead.");
          });
      } catch (error) {
        console.error("DOCX generation error:", error);
        alert("Unable to download. Please try using the copy button instead.");
      }
    }
  </script>



<h1 class="wp-block-heading">Protecting Your Business When Ownership Changes</h1>



<p>As a business attorney with over 13 years of experience, I&#8217;ve seen too many successful partnerships and closely-held companies fall apart when ownership changes unexpectedly. Whether through death, disability, retirement, or simply an owner wanting to exit, these transitions can create chaos without proper planning. That&#8217;s why I&#8217;ve created this Buy-Sell Agreement Generator – to help you establish clear, legally sound rules for handling ownership transitions before they happen.</p>



<h2 class="wp-block-heading">What Is a Buy-Sell Agreement and Why You Need One</h2>



<p>A buy-sell agreement (sometimes called a buyout agreement) is essentially a prenuptial agreement for business owners. It creates legally binding rules for what happens when an owner wants to or must sell their ownership interest. This critical document should be created early in your business relationship, ideally when forming the company or bringing on new owners – when everyone is getting along and thinking rationally about the future.</p>



<p>Without a buy-sell agreement, your business could face numerous complications if an owner exits:</p>



<ul class="wp-block-list">
<li>The remaining owners might be forced to work with someone they didn&#8217;t choose (like an owner&#8217;s spouse or heir)</li>



<li>Disputes over business valuation can lead to litigation</li>



<li>Lack of available funding to purchase a departing owner&#8217;s interest</li>



<li>Tax consequences that could have been minimized with proper planning</li>



<li>Business operations disrupted during ownership transitions</li>
</ul>



<h2 class="wp-block-heading">How to Use the Buy-Sell Agreement Generator</h2>



<p>My generator walks you through each critical section of a buy-sell agreement, with easy-to-understand explanations for each option. Let me guide you through the key components and decisions you&#8217;ll need to make:</p>



<h3 class="wp-block-heading">Business Information</h3>



<p>Start by entering your company&#8217;s basic details. This includes your business name, entity type (corporation, LLC, partnership), state of formation, and principal address. The entity type matters because different legal structures have different ownership terminologies and transfer rules. For example, a corporation has shareholders and stock, while an LLC has members and membership interests.</p>



<p>The governing law selection is particularly important as it determines which state&#8217;s laws will apply to interpreting and enforcing your agreement. I generally recommend selecting the state where your business is formed, but there might be strategic reasons to choose a different jurisdiction in some cases.</p>



<h3 class="wp-block-heading">Owners Section</h3>



<p>Here, you&#8217;ll list all current owners and their respective ownership percentages. Accuracy is crucial here – ownership percentages should match your official corporate records, operating agreement, or partnership agreement.</p>



<p>You&#8217;ll also select the voting threshold required for modifying the buy-sell agreement in the future. While unanimous consent provides the most protection for minority owners, it can create operational difficulties if owners can&#8217;t agree. A supermajority requirement (like 2/3 or 3/4) often represents a reasonable middle ground.</p>



<h3 class="wp-block-heading">Triggering Events</h3>



<p>This section defines which specific events will activate the buy-sell provisions. Common triggering events include:</p>



<ul class="wp-block-list">
<li>Death of an owner – prevents ownership from transferring to heirs who may not be suitable business partners</li>



<li>Disability – addresses situations where an owner can no longer contribute to the business</li>



<li>Retirement – creates a path for aging owners to exit and receive value for their interest</li>



<li>Termination of employment – particularly important for businesses where owners are also employees</li>



<li>Divorce – prevents ex-spouses from becoming business owners through divorce settlements</li>



<li>Third-party offers – gives existing owners the right of first refusal if an owner receives an outside offer</li>
</ul>



<p>Select the events that make sense for your specific business. For professional service businesses, I typically recommend including all these triggers since personal relationships and ongoing contributions are vital to success.</p>



<h3 class="wp-block-heading">Valuation Method</h3>



<p>Determining a fair price for a business interest is often the most contentious aspect of ownership transitions. The generator offers several valuation methods:</p>



<ul class="wp-block-list">
<li>Fixed price – simple but requires regular updates to remain fair</li>



<li>Book value – based on accounting statements but often undervalues profitable businesses</li>



<li>Formula multiple – typically a multiple of earnings (EBITDA, net income)</li>



<li>Independent appraisal – most accurate but also most expensive</li>



<li>Agreed value – periodically determined by owners with a fallback method</li>
</ul>



<p>For technology companies or service businesses with significant goodwill value, I often recommend either a formula multiple of earnings or periodic agreed valuation. Asset-heavy businesses might benefit from adjusted book value approaches. The key is selecting a method that balances accuracy, cost, simplicity, and perceived fairness.</p>



<h3 class="wp-block-heading">Purchase Terms</h3>



<p>This section addresses how a departing owner will be paid for their interest. Few businesses or remaining owners have sufficient cash to pay the full purchase price upfront, so installment terms are common.</p>



<p>The right of first refusal provision determines the order in which the company and/or remaining owners can purchase a departing owner&#8217;s interest. This prevents ownership from being transferred to outsiders before existing stakeholders have an opportunity to maintain control.</p>



<p>For installment payments, carefully consider:</p>



<ul class="wp-block-list">
<li>Down payment percentage – balancing fairness to the departing owner with cash flow realities</li>



<li>Interest rate – should be reasonable and reflective of market rates</li>



<li>Payment period – longer periods reduce monthly payments but increase total interest costs</li>
</ul>



<p>Remember that excessively generous terms might financially strain the business, while terms too restrictive might seem unfair to departing owners.</p>



<h3 class="wp-block-heading">Insurance Provisions</h3>



<p>Life and disability insurance can provide the funding necessary to purchase an owner&#8217;s interest in case of death or disability. These policies can prevent financial strain on the business or remaining owners when a triggering event occurs.</p>



<p>In my experience, well-structured insurance provisions are often the difference between a smooth ownership transition and a financially devastating one. I generally recommend life insurance coverage for all owners, with the business or other owners named as beneficiaries specifically for funding the buy-sell agreement.</p>



<p>For insurance structure, you&#8217;ll need to choose between:</p>



<ul class="wp-block-list">
<li>Entity purchase (company-owned policies)</li>



<li>Cross-purchase (owners own policies on each other)</li>



<li>Insurance trust approach</li>
</ul>



<p>Each has different tax and administrative implications, so consultation with both legal and tax advisors is recommended here.</p>



<h3 class="wp-block-heading">Transfer Restrictions</h3>



<p>This section defines what ownership transfers are permitted without triggering the buy-sell provisions. Common exemptions include transfers to family members, trusts, or existing owners.</p>



<p>The non-compete provisions prevent departing owners from immediately competing with the business. These provisions must be reasonable in duration, geographic scope, and activities restricted to be enforceable. Requirements vary significantly by state – California, for example, generally prohibits non-compete agreements, while other states are more enforcement-friendly.</p>



<p>Tag-along and drag-along rights protect minority and majority owners, respectively, in sale scenarios involving outside parties. These provisions help align interests and prevent inequitable outcomes during company sales.</p>



<h3 class="wp-block-heading">Legal Provisions</h3>



<p>This final section addresses various legal matters including dispute resolution methods, attorney fee provisions, amendment requirements, and confidentiality obligations.</p>



<p>For dispute resolution, I typically recommend binding arbitration for most closely-held businesses. While litigation might seem like the default choice, arbitration often provides a faster, more private, and potentially less expensive resolution process. However, this decision should reflect your specific preferences and circumstances.</p>



<h2 class="wp-block-heading">Practical Tips for Maximum Protection</h2>



<p>Based on my years of experience drafting and implementing buy-sell agreements, here are some practical recommendations:</p>



<p>When determining business valuation, consider including discounts for lack of marketability and minority interests when appropriate. These can significantly impact the purchase price, especially for minority owners, so be thoughtful about whether they align with your fairness goals.</p>



<p>Review and update your buy-sell agreement regularly – especially the valuation provisions. I&#8217;ve seen numerous disputes arise from outdated fixed prices or formulas that no longer reflect the business&#8217;s reality. At minimum, I recommend annual reviews of valuation provisions.</p>



<p>Make sure all owners&#8217; spouses sign a spousal consent when required. This is particularly important in community property states where a spouse might claim partial ownership of business interests.</p>



<p>Fund the agreement appropriately, especially for death and disability triggers. Insurance is typically the most cost-effective approach, but should be reassessed regularly as business value changes.</p>



<p>Remember that a buy-sell agreement works best when integrated with your overall succession planning. Consider how it fits with your estate planning, retirement planning, and long-term business strategy.</p>



<p>Keep signed copies of the agreement with your important corporate documents and ensure all owners and their advisors have access to it. I&#8217;ve seen situations where no one could find the agreement when it was actually needed.</p>



<h2 class="wp-block-heading">FAQ About Buy-Sell Agreements</h2>



<h3 class="wp-block-heading">Should a buy-sell agreement be separate from our operating agreement or corporate bylaws?</h3>



<p>For corporations and LLCs, buy-sell provisions can either be incorporated into your operating agreement/bylaws or created as a standalone agreement. I generally recommend a separate buy-sell agreement because it&#8217;s easier to update independently and can include all owners across different entity structures in more complex business arrangements. It also allows for more specialized provisions focused solely on ownership transfer scenarios.</p>



<h3 class="wp-block-heading">How often should we update our business valuation for buy-sell purposes?</h3>



<p>For businesses experiencing significant growth or change, annual valuation updates are recommended. For more stable businesses, updates every 2-3 years may suffice. However, I suggest scheduling a specific date each year for all owners to review and affirm or update the valuation. This creates discipline and prevents the &#8220;we&#8217;ll get to it later&#8221; syndrome that often results in severely outdated valuations.</p>



<h3 class="wp-block-heading">Can we have different valuation methods for different triggering events?</h3>



<p>Yes, and in many cases, it makes good business sense. For instance, you might use insurance proceeds for death, a more discounted value for voluntary departures, and a punitive valuation for termination for cause. The generator allows you to create a baseline agreement, which you can further customize for these variations with professional assistance.</p>



<h3 class="wp-block-heading">How do we ensure our buy-sell agreement is actually enforced when the time comes?</h3>



<p>First, make sure all owners fully understand and genuinely agree to the terms – don&#8217;t just push it through. Second, properly fund the agreement, especially for death and disability scenarios. Third, include strong specific performance clauses that allow a court to enforce the actual transfers, not just award damages. Finally, review the agreement periodically with all owners to reaffirm commitment and address changing circumstances.</p>



<h3 class="wp-block-heading">What&#8217;s the biggest mistake you see in buy-sell agreements?</h3>



<p>Without question, it&#8217;s inadequate attention to funding mechanisms. Many agreements outline beautiful procedures for transfers but fail to address where the money will come from to execute the purchase. This is especially true for unexpected events like death or disability. Insurance is typically the most cost-effective solution, but establishing sinking funds or maintaining appropriate credit facilities can also work depending on your situation.</p>



<h3 class="wp-block-heading">How should we handle scenarios where an owner wants to transfer only part of their interest?</h3>



<p>This depends on your specific business needs. Some buy-sell agreements prohibit partial transfers entirely, while others allow them with majority approval or right of first refusal. If your concern is preventing fragmentation of ownership, consider requiring that partial transfers meet minimum size thresholds or that transferees meet certain qualifications. My generator creates a standard framework, but this is an area where customization might be needed.</p>



<h3 class="wp-block-heading">How does a buy-sell agreement interact with estate planning?</h3>



<p>A properly structured buy-sell agreement provides certainty about what happens to business interests upon an owner&#8217;s death, making it an essential component of comprehensive estate planning. It ensures business continuity while providing liquidity to the deceased owner&#8217;s estate. When coordinating with estate planning, pay particular attention to how the agreement affects valuation for estate tax purposes and consider including specific provisions addressing transfers to trusts or other estate planning vehicles.</p>



<h2 class="wp-block-heading">Final Thoughts</h2>



<p>A well-crafted buy-sell agreement is one of the most valuable legal documents any multi-owner business can create. It provides clarity during emotionally charged situations, protects the business from disruption, and ensures fair treatment for all parties. While my generator creates a solid foundation, every business has unique circumstances that might benefit from customization.</p>



<p>Remember that this generator creates a starting point – a professional template based on common scenarios. For businesses with complex ownership structures, significant asset values, or unusual circumstances, I recommend scheduling a consultation to ensure the agreement fully addresses your specific situation.</p>



<p>To create your buy-sell agreement, simply work through each section of the generator, making selections that align with your business goals. You&#8217;ll have a comprehensive document ready to review and implement with your business partners.</p>
</div>
    </article>
  </main>
  <footer><p>© 2025 Terms.Law. All rights reserved.</p></footer>
</body>
</html>