<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buyout / Repurchase Generator | Terms.Law</title>
    <meta name="description" content="Generate repurchase clause language with pricing methods, good/bad leaver treatment, and payment terms.">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-901N2Y3CDZ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-901N2Y3CDZ');
    </script>

    <style>
        :root {
            --bg-dark: #0a0f1a;
            --bg-card: #111827;
            --bg-card-hover: #1a2332;
            --bg-input: #1f2937;
            --accent-blue: #3b82f6;
            --accent-blue-hover: #2563eb;
            --accent-green: #10b981;
            --accent-purple: #8b5cf6;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --border-color: #1f2937;
            --border-focus: #3b82f6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-blue);
            text-decoration: none;
        }

        .logo span { color: var(--text-secondary); font-weight: 400; }

        .breadcrumbs {
            padding: 1rem 2rem;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
        }

        .breadcrumbs-content {
            max-width: 1400px;
            margin: 0 auto;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .breadcrumbs a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumbs a:hover { color: var(--accent-blue); }
        .breadcrumbs span { color: var(--text-primary); }

        .main-layout {
            display: flex;
            max-width: 1600px;
            margin: 0 auto;
            min-height: calc(100vh - 120px);
        }

        .sidebar {
            width: 280px;
            background: var(--bg-card);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            position: sticky;
            top: 120px;
            height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .sidebar-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .sidebar-nav { list-style: none; }
        .sidebar-nav li { margin-bottom: 0.25rem; }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover {
            background: var(--bg-input);
            color: var(--text-primary);
        }

        .sidebar-nav a.active {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
        }

        .sidebar-nav .icon { width: 20px; height: 20px; opacity: 0.7; }
        .sidebar-divider { height: 1px; background: var(--border-color); margin: 1.5rem 0; }

        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .page-header { margin-bottom: 2rem; }

        .page-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .page-subtitle { color: var(--text-secondary); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { padding: 1rem; }
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 1000px) {
            .form-grid { grid-template-columns: 1fr; }
        }

        .form-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .form-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-card-title .icon { color: var(--accent-purple); }

        .form-group { margin-bottom: 1.25rem; }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--border-focus);
        }

        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%239ca3af'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.25rem;
            padding-right: 2.5rem;
        }

        .form-hint { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem; }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 600px) {
            .form-row { grid-template-columns: 1fr; }
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.75rem 1rem;
            background: var(--bg-input);
            border-radius: 8px;
            transition: all 0.2s;
        }

        .radio-item:hover {
            background: var(--bg-card-hover);
        }

        .radio-item input {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-blue);
        }

        .radio-item .radio-label {
            flex: 1;
        }

        .radio-item .radio-title {
            font-size: 0.9rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .radio-item .radio-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .btn-primary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            background: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            width: 100%;
            margin-top: 1.5rem;
        }

        .btn-primary:hover { background: var(--accent-blue-hover); }

        .btn-secondary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: var(--bg-input);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
            color: var(--text-primary);
        }

        .output-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            display: none;
        }

        .output-section.visible { display: block; }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .output-title { font-size: 1.25rem; font-weight: 600; }
        .output-actions { display: flex; gap: 0.5rem; }

        .clause-section {
            background: var(--bg-input);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 3px solid var(--accent-purple);
        }

        .clause-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-purple);
            margin-bottom: 1rem;
        }

        .clause-text {
            font-family: 'Georgia', serif;
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .pricing-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }

        .pricing-table th,
        .pricing-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .pricing-table th {
            background: var(--bg-input);
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .pricing-table td {
            color: var(--text-primary);
        }

        .payment-terms {
            background: var(--bg-input);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .payment-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-orange);
            margin-bottom: 1rem;
        }

        .payment-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }

        .payment-icon {
            width: 20px;
            height: 20px;
            color: var(--accent-orange);
            flex-shrink: 0;
            margin-top: 2px;
        }

        .payment-text { color: var(--text-secondary); }

        .leaver-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 700px) {
            .leaver-comparison { grid-template-columns: 1fr; }
        }

        .leaver-box {
            background: var(--bg-input);
            border-radius: 8px;
            padding: 1.25rem;
        }

        .leaver-box.good {
            border-left: 3px solid var(--accent-green);
        }

        .leaver-box.bad {
            border-left: 3px solid var(--accent-red);
        }

        .leaver-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .leaver-box.good .leaver-title { color: var(--accent-green); }
        .leaver-box.bad .leaver-title { color: var(--accent-red); }

        .leaver-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="../../" class="logo">Terms<span>.Law</span></a>
        </div>
    </header>

    <nav class="breadcrumbs">
        <div class="breadcrumbs-content">
            <a href="../../">Home</a> &gt;
            <a href="../">Equity for Services</a> &gt;
            <a href="./">Tools</a> &gt;
            <span>Buyout Generator</span>
        </div>
    </nav>

    <div class="main-layout">
        <aside class="sidebar">
            <h3 class="sidebar-title">Tools</h3>
            <ul class="sidebar-nav">
                <li>
                    <a href="./deal-builder.html">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Deal Builder
                    </a>
                </li>
                <li>
                    <a href="./vesting-builder.html">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Vesting Builder
                    </a>
                </li>
                <li>
                    <a href="./buyout-generator.html" class="active">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Buyout Generator
                    </a>
                </li>
                <li>
                    <a href="./document-recommender.html">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                        </svg>
                        Document Recommender
                    </a>
                </li>
                <li>
                    <a href="./ip-addendum.html">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                        IP Addendum
                    </a>
                </li>
                <li>
                    <a href="./cross-border-spotter.html">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Cross-Border Spotter
                    </a>
                </li>
            </ul>

            <div class="sidebar-divider"></div>

            <h3 class="sidebar-title">Hub</h3>
            <ul class="sidebar-nav">
                <li>
                    <a href="../">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        Back to Hub
                    </a>
                </li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">Buyout / Repurchase Generator</h1>
                <p class="page-subtitle">Generate repurchase clause language with pricing methods and leaver treatment</p>
            </div>

            <div class="form-grid">
                <div class="form-card">
                    <h2 class="form-card-title">
                        <svg class="icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Equity & Pricing
                    </h2>

                    <div class="form-group">
                        <label class="form-label">Equity Type</label>
                        <select id="equityType" class="form-select">
                            <option value="">Select equity type...</option>
                            <option value="membership-units">Membership Units (LLC)</option>
                            <option value="profits-interest">Profits Interest (LLC)</option>
                            <option value="common-stock">Common Stock</option>
                            <option value="restricted-stock">Restricted Stock</option>
                            <option value="stock-options">Stock Options</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Pricing Method</label>
                        <div class="radio-group">
                            <label class="radio-item">
                                <input type="radio" name="pricingMethod" value="fmv">
                                <div class="radio-label">
                                    <div class="radio-title">Fair Market Value (FMV)</div>
                                    <div class="radio-desc">Independent appraisal or 409A valuation</div>
                                </div>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="pricingMethod" value="formula">
                                <div class="radio-label">
                                    <div class="radio-title">Formula-Based</div>
                                    <div class="radio-desc">Multiple of revenue, EBITDA, or book value</div>
                                </div>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="pricingMethod" value="book">
                                <div class="radio-label">
                                    <div class="radio-title">Book Value</div>
                                    <div class="radio-desc">Based on company's net asset value</div>
                                </div>
                            </label>
                            <label class="radio-item">
                                <input type="radio" name="pricingMethod" value="cost">
                                <div class="radio-label">
                                    <div class="radio-title">Original Cost / Grant Price</div>
                                    <div class="radio-desc">Price originally paid or granted at</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div id="formulaFields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Formula Basis</label>
                            <select id="formulaBasis" class="form-select">
                                <option value="revenue">Revenue Multiple</option>
                                <option value="ebitda">EBITDA Multiple</option>
                                <option value="earnings">Net Earnings Multiple</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Multiple</label>
                            <input type="text" id="formulaMultiple" class="form-input" placeholder="e.g., 3x">
                        </div>
                    </div>
                </div>

                <div class="form-card">
                    <h2 class="form-card-title">
                        <svg class="icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        Leaver Treatment
                    </h2>

                    <div class="form-group">
                        <label class="form-label">Good Leaver Pricing</label>
                        <select id="goodLeaverPrice" class="form-select">
                            <option value="fmv">100% of Fair Market Value</option>
                            <option value="fmv-90">90% of Fair Market Value</option>
                            <option value="fmv-80">80% of Fair Market Value</option>
                            <option value="formula">Formula Price</option>
                        </select>
                        <p class="form-hint">Good leaver: resignation with notice, termination without cause, death, disability</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Bad Leaver Pricing</label>
                        <select id="badLeaverPrice" class="form-select">
                            <option value="cost">Original Cost / $0 for granted equity</option>
                            <option value="book">Book Value</option>
                            <option value="fmv-50">50% of Fair Market Value</option>
                            <option value="formula-50">50% of Formula Price</option>
                        </select>
                        <p class="form-hint">Bad leaver: termination for cause, breach of agreement, competing activity</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Unvested Equity Treatment</label>
                        <select id="unvestedTreatment" class="form-select">
                            <option value="forfeit">Automatic Forfeiture (No Payment)</option>
                            <option value="cost">Repurchase at Original Cost</option>
                            <option value="fmv">Repurchase at FMV</option>
                        </select>
                    </div>
                </div>

                <div class="form-card" style="grid-column: 1 / -1;">
                    <h2 class="form-card-title">
                        <svg class="icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        Payment Terms
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Payment Structure</label>
                            <select id="paymentStructure" class="form-select">
                                <option value="lump-sum">Lump Sum at Closing</option>
                                <option value="installments">Installments</option>
                                <option value="deferred">Deferred Payment</option>
                                <option value="hybrid">Combination</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Payment Timeline</label>
                            <select id="paymentTimeline" class="form-select">
                                <option value="30">30 Days</option>
                                <option value="60">60 Days</option>
                                <option value="90">90 Days</option>
                                <option value="180">6 Months</option>
                                <option value="365">12 Months</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Interest on Deferred Payments</label>
                            <select id="interestRate" class="form-select">
                                <option value="0">No Interest</option>
                                <option value="afr">AFR (Applicable Federal Rate)</option>
                                <option value="prime">Prime Rate</option>
                                <option value="fixed">Fixed Rate</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Security / Collateral</label>
                            <select id="security" class="form-select">
                                <option value="none">None</option>
                                <option value="promissory">Promissory Note</option>
                                <option value="escrow">Escrow Account</option>
                                <option value="guarantee">Personal Guarantee</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn-primary" onclick="generateBuyout()">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                Generate Buyout Clause
            </button>

            <div id="outputSection" class="output-section">
                <div class="output-header">
                    <h2 class="output-title">Generated Buyout / Repurchase Terms</h2>
                    <div class="output-actions">
                        <button class="btn-secondary" onclick="copyOutput()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                            Copy
                        </button>
                        <button class="btn-secondary" onclick="downloadOutput()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                            Download
                        </button>
                    </div>
                </div>

                <div id="repurchaseClause" class="clause-section"></div>

                <div id="leaverComparison" class="leaver-comparison"></div>

                <div id="pricingSchedule"></div>

                <div id="paymentTerms" class="payment-terms"></div>
            </div>
        </main>
    </div>

    <script>
        // Show/hide formula fields based on pricing method
        document.querySelectorAll('input[name="pricingMethod"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.getElementById('formulaFields').style.display =
                    this.value === 'formula' ? 'block' : 'none';
            });
        });

        function generateBuyout() {
            const equityType = document.getElementById('equityType').value;
            const pricingMethod = document.querySelector('input[name="pricingMethod"]:checked')?.value;
            const goodLeaverPrice = document.getElementById('goodLeaverPrice').value;
            const badLeaverPrice = document.getElementById('badLeaverPrice').value;
            const unvestedTreatment = document.getElementById('unvestedTreatment').value;
            const paymentStructure = document.getElementById('paymentStructure').value;
            const paymentTimeline = document.getElementById('paymentTimeline').value;
            const interestRate = document.getElementById('interestRate').value;
            const security = document.getElementById('security').value;

            if (!equityType || !pricingMethod) {
                alert('Please select both equity type and pricing method');
                return;
            }

            const equityNames = {
                'membership-units': 'Membership Units',
                'profits-interest': 'Profits Interest',
                'common-stock': 'Common Stock',
                'restricted-stock': 'Restricted Stock',
                'stock-options': 'Stock Options'
            };

            const pricingNames = {
                'fmv': 'Fair Market Value',
                'formula': 'Formula-Based Valuation',
                'book': 'Book Value',
                'cost': 'Original Cost'
            };

            let pricingDescription = '';
            if (pricingMethod === 'fmv') {
                pricingDescription = 'determined by an independent third-party appraiser or the most recent 409A valuation, conducted within the prior twelve (12) months';
            } else if (pricingMethod === 'formula') {
                const basis = document.getElementById('formulaBasis').value;
                const multiple = document.getElementById('formulaMultiple').value || '3x';
                pricingDescription = `calculated as ${multiple} the Company's trailing twelve-month ${basis === 'revenue' ? 'revenue' : (basis === 'ebitda' ? 'EBITDA' : 'net earnings')}, multiplied by the Holder's pro-rata ownership percentage`;
            } else if (pricingMethod === 'book') {
                pricingDescription = 'equal to the Holder\'s pro-rata share of the Company\'s book value as of the most recent fiscal quarter end';
            } else if (pricingMethod === 'cost') {
                pricingDescription = 'equal to the original purchase price paid (or zero if granted for services)';
            }

            // Generate main repurchase clause
            const repurchaseClauseHTML = `
                <h3 class="clause-title">Repurchase Rights Clause</h3>
                <div class="clause-text">REPURCHASE RIGHTS

1. Company Repurchase Option. Upon termination of the Holder's service relationship with the Company for any reason (a "Termination Event"), the Company shall have the right, but not the obligation, to repurchase all or any portion of the ${equityNames[equityType] || 'Equity'} held by the Holder (the "Repurchase Option").

2. Repurchase Price.
   (a) Vested ${equityNames[equityType] || 'Equity'}. The repurchase price for vested ${equityNames[equityType] || 'Equity'} shall be ${pricingDescription} (the "Repurchase Price").

   (b) Unvested ${equityNames[equityType] || 'Equity'}. ${unvestedTreatment === 'forfeit'
       ? 'Any unvested ' + (equityNames[equityType] || 'Equity') + ' shall be automatically forfeited upon the Termination Event without payment.'
       : 'Unvested ' + (equityNames[equityType] || 'Equity') + ' shall be repurchased at ' + (unvestedTreatment === 'cost' ? 'the original cost' : 'Fair Market Value') + '.'}

3. Exercise of Repurchase Option. The Company may exercise its Repurchase Option by delivering written notice to the Holder within ninety (90) days following the Termination Event. If the Company does not exercise the Repurchase Option within such period, the Repurchase Option shall lapse.

4. Closing. The closing of any repurchase shall occur within ${paymentTimeline} days following the Company's exercise of its Repurchase Option.</div>
            `;

            document.getElementById('repurchaseClause').innerHTML = repurchaseClauseHTML;

            // Generate leaver comparison
            const goodLeaverDesc = {
                'fmv': '100% of Fair Market Value for all vested equity',
                'fmv-90': '90% of Fair Market Value for all vested equity',
                'fmv-80': '80% of Fair Market Value for all vested equity',
                'formula': 'Formula-based price for all vested equity'
            };

            const badLeaverDesc = {
                'cost': 'Original cost only (or zero for granted equity)',
                'book': 'Book value (typically lower than FMV)',
                'fmv-50': '50% of Fair Market Value',
                'formula-50': '50% of formula price'
            };

            const leaverHTML = `
                <div class="leaver-box good">
                    <h4 class="leaver-title">Good Leaver Treatment</h4>
                    <div class="leaver-text">
                        <strong>Triggers:</strong> Resignation with proper notice, termination without cause, death, disability, retirement (if applicable)
                        <br><br>
                        <strong>Pricing:</strong> ${goodLeaverDesc[goodLeaverPrice] || 'FMV'}
                        <br><br>
                        <strong>Vesting:</strong> May include acceleration provisions for certain events
                    </div>
                </div>
                <div class="leaver-box bad">
                    <h4 class="leaver-title">Bad Leaver Treatment</h4>
                    <div class="leaver-text">
                        <strong>Triggers:</strong> Termination for cause, material breach, competing activity, voluntary resignation without notice
                        <br><br>
                        <strong>Pricing:</strong> ${badLeaverDesc[badLeaverPrice] || 'Cost'}
                        <br><br>
                        <strong>Vesting:</strong> Unvested equity is typically forfeited; vested equity repurchased at penalty price
                    </div>
                </div>
            `;

            document.getElementById('leaverComparison').innerHTML = leaverHTML;

            // Generate pricing schedule
            const pricingHTML = `
                <table class="pricing-table">
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Vested Equity Price</th>
                            <th>Unvested Equity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Good Leaver - Resignation with Notice</td>
                            <td>${goodLeaverDesc[goodLeaverPrice]}</td>
                            <td>${unvestedTreatment === 'forfeit' ? 'Forfeited' : 'Repurchased'}</td>
                        </tr>
                        <tr>
                            <td>Good Leaver - Termination Without Cause</td>
                            <td>${goodLeaverDesc[goodLeaverPrice]}</td>
                            <td>${unvestedTreatment === 'forfeit' ? 'Forfeited' : 'Repurchased'}</td>
                        </tr>
                        <tr>
                            <td>Good Leaver - Death/Disability</td>
                            <td>${goodLeaverDesc[goodLeaverPrice]}</td>
                            <td>May accelerate (check agreement)</td>
                        </tr>
                        <tr>
                            <td>Bad Leaver - For Cause</td>
                            <td>${badLeaverDesc[badLeaverPrice]}</td>
                            <td>Forfeited</td>
                        </tr>
                        <tr>
                            <td>Bad Leaver - Competing Activity</td>
                            <td>${badLeaverDesc[badLeaverPrice]}</td>
                            <td>Forfeited</td>
                        </tr>
                    </tbody>
                </table>
            `;

            document.getElementById('pricingSchedule').innerHTML = pricingHTML;

            // Generate payment terms
            const paymentItems = [];

            if (paymentStructure === 'lump-sum') {
                paymentItems.push('Full payment due at closing (within ' + paymentTimeline + ' days)');
            } else if (paymentStructure === 'installments') {
                paymentItems.push('Payment in equal installments over ' + paymentTimeline + ' days');
            } else if (paymentStructure === 'deferred') {
                paymentItems.push('Payment deferred for ' + paymentTimeline + ' days from closing');
            } else {
                paymentItems.push('50% at closing, 50% over ' + paymentTimeline + ' days');
            }

            if (interestRate !== '0') {
                const interestDesc = {
                    'afr': 'Applicable Federal Rate (AFR)',
                    'prime': 'Prime Rate',
                    'fixed': 'Fixed Rate (specify in agreement)'
                };
                paymentItems.push('Interest on deferred amounts: ' + interestDesc[interestRate]);
            }

            if (security !== 'none') {
                const securityDesc = {
                    'promissory': 'Promissory note required for deferred amounts',
                    'escrow': 'Funds held in escrow until conditions met',
                    'guarantee': 'Personal guarantee from principals required'
                };
                paymentItems.push(securityDesc[security]);
            }

            paymentItems.push('Payment shall be made by wire transfer or certified check');
            paymentItems.push('Company may offset amounts owed by Holder against repurchase price');

            const paymentHTML = `
                <h3 class="payment-title">Payment Terms Summary</h3>
                ${paymentItems.map(item => `
                    <div class="payment-item">
                        <svg class="payment-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="payment-text">${item}</span>
                    </div>
                `).join('')}
            `;

            document.getElementById('paymentTerms').innerHTML = paymentHTML;

            document.getElementById('outputSection').classList.add('visible');
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
        }

        function copyOutput() {
            const clause = document.getElementById('repurchaseClause').innerText;
            const leaver = document.getElementById('leaverComparison').innerText;
            const pricing = document.getElementById('pricingSchedule').innerText;
            const payment = document.getElementById('paymentTerms').innerText;

            const fullText = `BUYOUT / REPURCHASE TERMS\n\n${clause}\n\n${leaver}\n\n${pricing}\n\n${payment}`;

            navigator.clipboard.writeText(fullText).then(() => {
                alert('Output copied to clipboard!');
            });
        }

        function downloadOutput() {
            const clause = document.getElementById('repurchaseClause').innerText;
            const leaver = document.getElementById('leaverComparison').innerText;
            const pricing = document.getElementById('pricingSchedule').innerText;
            const payment = document.getElementById('paymentTerms').innerText;

            const fullText = `BUYOUT / REPURCHASE TERMS\n\n${clause}\n\n${leaver}\n\n${pricing}\n\n${payment}`;

            const blob = new Blob([fullText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'buyout-repurchase-terms.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
