<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relationship Privacy NDA Generator | Terms.Law</title>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #f5f5f5;
            --text: #333333;
            --highlight: #ffeb3b;
            --border: #dddddd;
            --success: #4caf50;
            --gray-light: #f9f9f9;
            --gray: #e0e0e0;
            --red: #f44336;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            color: var(--text);
            line-height: 1.6;
            font-size: 16px;
        }
        
        .container {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }
        
        h1, h2, h3 {
            margin-bottom: 15px;
        }
        
        h1 {
            font-size: 24px;
            color: var(--primary-dark);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }
        
        h2 {
            font-size: 20px;
            margin-top: 20px;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        .form-section {
            flex: 1;
            min-width: 300px;
        }
        
        .preview-section {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .preview-container {
            border: 1px solid var(--border);
            padding: 20px;
            background-color: white;
            height: 600px;
            overflow-y: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tab-nav {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 15px;
        }
        
        .tab-btn {
            padding: 10px 15px;
            border: none;
            background: none;
            cursor: pointer;
            position: relative;
            font-weight: 500;
            color: var(--text);
        }
        
        .tab-btn.active {
            color: var(--primary);
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 16px;
        }
        
        input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .checkbox-group {
            margin-top: 10px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-weight: normal;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: var(--gray);
            color: var(--text);
        }
        
        .btn-secondary:hover {
            background-color: var(--gray-light);
        }
        
        .download-btn {
            margin-top: 15px;
            width: 100%;
            background-color: var(--success);
            color: white;
        }
        
        .download-btn:hover {
            background-color: #388e3c;
        }
        
        .highlight {
            background-color: var(--highlight);
            transition: background-color 0.5s;
        }
        
        .info-box {
            background-color: var(--gray-light);
            border-left: 4px solid var(--primary);
            padding: 10px 15px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .warning-box {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 10px 15px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        #previewFooter {
            margin-top: 30px;
            font-size: 14px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .preview-section {
                margin-top: 20px;
            }
        }
        
        .footer-info {
            margin-top: 30px;
            font-size: 14px;
            color: #666;
            text-align: center;
        }
        
        .footer-info a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .footer-info a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-section">
            <h1>Relationship Privacy NDA Generator</h1>
            <p>Create a legally sound non-disclosure agreement to protect your privacy in intimate relationships. This generator follows attorney-reviewed guidelines to help you create an enforceable document.</p>
            
            <div class="warning-box">
                <strong>Legal Disclaimer:</strong> This generator provides a template based on general legal principles. While designed by a licensed attorney, it is not a substitute for personalized legal advice. Consider consulting with an attorney before finalizing any legal document.
            </div>
            
            <div class="tab-container">
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="basics">1. Basics</button>
                    <button class="tab-btn" data-tab="confidential">2. Confidentiality</button>
                    <button class="tab-btn" data-tab="protection">3. Protections</button>
                    <button class="tab-btn" data-tab="remedies">4. Remedies</button>
                    <button class="tab-btn" data-tab="finalize">5. Finalize</button>
                </div>
                
                <div class="tab-content active" id="basics">
                    <h2>Basic Information</h2>
                    <div class="info-box">
                        Begin with the parties' information and basic contract terms.
                    </div>
                    
                    <div class="form-group">
                        <label for="party1Name">First Party's Full Legal Name:</label>
                        <input type="text" id="party1Name" placeholder="e.g., Jane A. Smith">
                    </div>
                    
                    <div class="form-group">
                        <label for="party2Name">Second Party's Full Legal Name:</label>
                        <input type="text" id="party2Name" placeholder="e.g., John B. Doe">
                    </div>
                    
                    <div class="form-group">
                        <label for="stateJurisdiction">Governing Law (State/Jurisdiction):</label>
                        <select id="stateJurisdiction">
                            <option value="">Select a State/Jurisdiction</option>
                            <option value="Alabama">Alabama</option>
                            <option value="Alaska">Alaska</option>
                            <option value="Arizona">Arizona</option>
                            <option value="Arkansas">Arkansas</option>
                            <option value="California">California</option>
                            <option value="Colorado">Colorado</option>
                            <option value="Connecticut">Connecticut</option>
                            <option value="Delaware">Delaware</option>
                            <option value="Florida">Florida</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Hawaii">Hawaii</option>
                            <option value="Idaho">Idaho</option>
                            <option value="Illinois">Illinois</option>
                            <option value="Indiana">Indiana</option>
                            <option value="Iowa">Iowa</option>
                            <option value="Kansas">Kansas</option>
                            <option value="Kentucky">Kentucky</option>
                            <option value="Louisiana">Louisiana</option>
                            <option value="Maine">Maine</option>
                            <option value="Maryland">Maryland</option>
                            <option value="Massachusetts">Massachusetts</option>
                            <option value="Michigan">Michigan</option>
                            <option value="Minnesota">Minnesota</option>
                            <option value="Mississippi">Mississippi</option>
                            <option value="Missouri">Missouri</option>
                            <option value="Montana">Montana</option>
                            <option value="Nebraska">Nebraska</option>
                            <option value="Nevada">Nevada</option>
                            <option value="New Hampshire">New Hampshire</option>
                            <option value="New Jersey">New Jersey</option>
                            <option value="New Mexico">New Mexico</option>
                            <option value="New York">New York</option>
                            <option value="North Carolina">North Carolina</option>
                            <option value="North Dakota">North Dakota</option>
                            <option value="Ohio">Ohio</option>
                            <option value="Oklahoma">Oklahoma</option>
                            <option value="Oregon">Oregon</option>
                            <option value="Pennsylvania">Pennsylvania</option>
                            <option value="Rhode Island">Rhode Island</option>
                            <option value="South Carolina">South Carolina</option>
                            <option value="South Dakota">South Dakota</option>
                            <option value="Tennessee">Tennessee</option>
                            <option value="Texas">Texas</option>
                            <option value="Utah">Utah</option>
                            <option value="Vermont">Vermont</option>
                            <option value="Virginia">Virginia</option>
                            <option value="Washington">Washington</option>
                            <option value="West Virginia">West Virginia</option>
                            <option value="Wisconsin">Wisconsin</option>
                            <option value="Wyoming">Wyoming</option>
                            <option value="District of Columbia">District of Columbia</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="effectiveDate">Effective Date:</label>
                        <input type="date" id="effectiveDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="duration">Duration of Agreement:</label>
                        <select id="duration">
                            <option value="1">1 year</option>
                            <option value="2">2 years</option>
                            <option value="3" selected>3 years</option>
                            <option value="5">5 years</option>
                            <option value="10">10 years</option>
                        </select>
                        <div class="info-box" style="margin-top: 10px">
                            Tip: Courts favor reasonable time limits. Perpetual NDAs face greater scrutiny.
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-secondary" disabled>Previous</button>
                        <button class="btn-primary" data-next="confidential">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="confidential">
                    <h2>Confidential Information</h2>
                    <div class="info-box">
                        Define what information is protected under this agreement. Be specific but comprehensive.
                    </div>
                    
                    <div class="form-group">
                        <label>Which types of information should be protected? (select all that apply)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectIdentity" checked> Personal identity information (name, address, workplace, etc.)
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectImages" checked> Photos, videos, and audio recordings
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectMessages" checked> Text messages, emails, and other written communications
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectRelationship" checked> Details about the nature of the relationship
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectActivities" checked> Specific activities engaged in together
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectMedical"> Medical or health information
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectFinancial"> Financial information
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="protectOther"> Other information (specify below)
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="otherConfidential">Other confidential information to protect (optional):</label>
                        <textarea id="otherConfidential" rows="3" placeholder="Describe any other information that should be protected..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Mutual Confidentiality:</label>
                        <select id="mutualConfidentiality">
                            <option value="mutual" selected>Mutual (both parties have same obligations)</option>
                            <option value="oneway">One-way (first party discloses, second party keeps confidential)</option>
                        </select>
                        <div class="info-box" style="margin-top: 10px">
                            Tip: Mutual agreements are generally more enforceable as they show balanced consideration.
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-secondary" data-prev="basics">Previous</button>
                        <button class="btn-primary" data-next="protection">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="protection">
                    <h2>Legal Protections & Exceptions</h2>
                    <div class="info-box">
                        Include legally required exceptions and define permitted disclosures.
                    </div>
                    
                    <div class="form-group">
                        <label>Include standard legal exceptions: (recommended)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="exceptionLegal" checked> Legal proceedings exception (court orders, subpoenas)
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="exceptionCrime" checked> Crime reporting exception (cannot restrict reporting crimes)
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="exceptionPublic" checked> Public domain exception (information already publicly available)
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="exceptionConsent" checked> Written consent exception (with the other party's permission)
                            </label>
                        </div>
                        <div class="warning-box" style="margin-top: 10px">
                            Note: Crime reporting exceptions are legally required in most jurisdictions. Removing this may invalidate the entire agreement.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Allow disclosure to the following without violation: (select all that apply)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="discloseLegal" checked> Legal counsel
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="discloseTherapist" checked> Licensed mental health professionals
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="discloseDoctor" checked> Medical providers when relevant to treatment
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="discloseFamily"> Family members
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="discloseFriends"> Close friends
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="digitalContent">Digital Content Handling:</label>
                        <select id="digitalContent">
                            <option value="deleteUponRequest" selected>Must be deleted upon request</option>
                            <option value="deleteUponTermination">Must be deleted upon termination of relationship</option>
                            <option value="noDistribution">May be kept but never distributed</option>
                            <option value="custom">Custom handling (specify below)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="customDigital">Custom digital content handling (if selected above):</label>
                        <textarea id="customDigital" rows="3" placeholder="Specify custom handling requirements..."></textarea>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-secondary" data-prev="confidential">Previous</button>
                        <button class="btn-primary" data-next="remedies">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="remedies">
                    <h2>Remedies & Dispute Resolution</h2>
                    <div class="info-box">
                        Define consequences for violations and how disputes will be resolved.
                    </div>
                    
                    <div class="form-group">
                        <label for="liquidatedDamages">Liquidated Damages Amount:</label>
                        <input type="number" id="liquidatedDamages" value="10000" min="0">
                        <div class="info-box" style="margin-top: 10px">
                            Tip: Courts favor reasonable amounts ($5k-$50k) that reflect actual potential harm. Excessive amounts may be viewed as unenforceable penalties.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="disputeResolution">Dispute Resolution Method:</label>
                        <select id="disputeResolution">
                            <option value="arbitration" selected>Private Arbitration</option>
                            <option value="mediation">Mediation then Arbitration</option>
                            <option value="court">Court Litigation</option>
                        </select>
                        <div class="info-box" style="margin-top: 10px">
                            Tip: Private arbitration helps keep disputes confidential, while court proceedings may become public record.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="injunctiveRelief">Include Injunctive Relief Clause:</label>
                        <select id="injunctiveRelief">
                            <option value="yes" selected>Yes (court can order immediate halt to disclosure)</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="attorneyFees">Attorney's Fees:</label>
                        <select id="attorneyFees">
                            <option value="prevailing" selected>Prevailing party recovers fees</option>
                            <option value="eachOwn">Each party pays own fees</option>
                        </select>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-secondary" data-prev="protection">Previous</button>
                        <button class="btn-primary" data-next="finalize">Next</button>
                    </div>
                </div>
                
                <div class="tab-content" id="finalize">
                    <h2>Finalize Agreement</h2>
                    <div class="info-box">
                        Review your choices and generate your agreement.
                    </div>
                    
                    <div class="form-group">
                        <label for="additionalTerms">Additional Terms or Special Provisions (optional):</label>
                        <textarea id="additionalTerms" rows="4" placeholder="Add any additional terms not covered by the form..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="severabilityClause" checked> Include Severability Clause (if one provision is invalid, others remain in force)
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="entireAgreementClause" checked> Include Entire Agreement Clause (this document supersedes prior understandings)
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="notarizationCheck"> Parties plan to have this document notarized
                        </label>
                        <div class="info-box" style="margin-top: 10px">
                            Tip: Notarization can help establish authenticity of signatures but does not affect the legal content or enforceability of terms.
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-secondary" data-prev="remedies">Previous</button>
                        <button class="btn-primary" id="generateBtn">Generate NDA</button>
                    </div>
                    
                    <button class="download-btn" id="downloadBtn" style="display: none;">Download NDA as Word Document</button>
                </div>
            </div>
        </div>
        
                    <div class="preview-section">
            <h2>Live Preview</h2>
            <div class="preview-container" id="previewContainer" style="height: 800px;">
                <div id="previewContent" style="font-family: Arial, sans-serif; font-size: 11pt;">
                    <h3 style="text-align: center; font-family: Arial, sans-serif; font-size: 11pt;">MUTUAL NON-DISCLOSURE AGREEMENT</h3>
                    <p>This Non-Disclosure Agreement (the "Agreement") is entered into by and between:</p>
                    <p>___________________ ("First Party") and ___________________ ("Second Party"), collectively referred to as the "Parties."</p>
                    
                    <p><strong>EFFECTIVE DATE:</strong> This Agreement is effective as of _______________ (the "Effective Date").</p>
                    
                    <p><strong>1. PURPOSE</strong></p>
                    <p>The Parties wish to protect the confidentiality of certain private information that may be disclosed between them during the course of their relationship. The Parties understand that maintaining the confidentiality of such information is essential to preserving privacy, dignity, and trust between them.</p>
                    
                    <p><strong>2. CONFIDENTIAL INFORMATION</strong></p>
                    <p>For purposes of this Agreement, "Confidential Information" includes, but is not limited to:</p>
                    <p>- Personal identity information, including but not limited to full names, addresses, contact information, places of employment, and personal identification numbers;<br>
                    - Photos, videos, and audio recordings of intimate or private nature;<br>
                    - Text messages, emails, voicemails, letters, notes, and other written or recorded communications between the Parties;<br>
                    - Details about the nature of the relationship between the Parties, including its existence;<br>
                    - Specific activities engaged in together, including locations, dates, and descriptions of such activities</p>
                    
                    <p><strong>3. PROTECTION OF CONFIDENTIAL INFORMATION</strong></p>
                    <p>Each Party agrees to keep confidential all Confidential Information received from the other Party. Each Party agrees not to disclose such Confidential Information to any third party, nor use it for any purpose other than as explicitly permitted by this Agreement. Each Party shall use the same degree of care to protect the other Party's Confidential Information as it uses to protect its own confidential information of similar nature and importance, but in no event less than reasonable care under the circumstances.</p>
                    
                    <p><strong>4. EXCEPTIONS</strong></p>
                    <p>This Agreement does not restrict disclosure of Confidential Information that:</p>
                    <p>a) Is or becomes publicly available through no fault of the receiving Party;<br>
                    b) Is disclosed in response to a valid order of a court or other governmental body, provided that the disclosing Party gives the other Party prompt written notice of such requirement prior to disclosure, and assists in obtaining a protective order if requested;<br>
                    c) Is disclosed to report a crime or respond to law enforcement when required by applicable law;<br>
                    d) Is disclosed with the prior written consent of the other Party, which consent shall be specific as to what information may be disclosed, to whom, and for what purpose.</p>
                    
                    <p><strong>5. PERMITTED DISCLOSURES</strong></p>
                    <p>Confidential Information may be disclosed to:</p>
                    <p>a) Legal counsel retained by a Party for purposes of legal advice in relation to this Agreement or the relationship;<br>
                    b) Licensed mental health professionals during the course of therapeutic treatment where such disclosure is deemed necessary for the Party's mental health;<br>
                    c) Medical providers when relevant to treatment of a medical condition where such information is material to proper diagnosis or treatment.</p>
                    
                    <p><strong>6. DIGITAL CONTENT</strong></p>
                    <p>Any digital content containing Confidential Information must be deleted upon request by the other Party. Such content shall be stored securely with password protection and not uploaded to any public or cloud-based platforms without explicit written consent. Upon termination of the Agreement or the relationship, any remaining digital content shall be permanently deleted using secure deletion methods.</p>
                    
                    <p><strong>7. TERM</strong></p>
                    <p>This Agreement shall remain in effect for 3 years from the Effective Date, provided that any Confidential Information disclosed during the term shall remain subject to the confidentiality obligations herein for the duration specified, even after the expiration of this Agreement.</p>
                    
                    <p><strong>8. REMEDIES</strong></p>
                    <p>In the event of a breach or threatened breach of this Agreement, the non-breaching Party shall be entitled to seek monetary damages in the amount of $10,000 as liquidated damages (which the Parties acknowledge represents a reasonable estimate of the potential damages and not a penalty), as well as injunctive relief to prevent further disclosure of Confidential Information. The Parties acknowledge that Confidential Information is valuable and unique and that disclosure in breach of this Agreement would result in irreparable injury to the non-breaching Party for which monetary damages alone would not be an adequate remedy.</p>
                    
                    <p><strong>9. DISPUTE RESOLUTION</strong></p>
                    <p>Any dispute arising out of or relating to this Agreement shall be resolved through binding arbitration in accordance with the rules of the American Arbitration Association. The arbitration shall take place in the county and state of the non-breaching Party's residence at the time the dispute arises, unless otherwise agreed to in writing. The arbitration shall be conducted by a single arbitrator with experience in confidentiality matters, and judgment on the award may be entered in any court having jurisdiction thereof.</p>
                    
                    <p><strong>10. GOVERNING LAW</strong></p>
                    <p>This Agreement shall be governed by the laws of the State of _______________, without regard to its conflict of laws principles. The Parties consent to the exclusive jurisdiction and venue in the state and federal courts sitting in the aforementioned state for the resolution of all disputes arising under this Agreement.</p>
                    
                    <p><strong>11. SEVERABILITY</strong></p>
                    <p>If any provision of this Agreement is found to be unenforceable, the remainder shall continue in full force and effect. The unenforceable provision shall be reformed to the extent possible to give effect to the Parties' intentions and to make the provision enforceable.</p>
                    
                    <p><strong>12. ENTIRE AGREEMENT</strong></p>
                    <p>This Agreement constitutes the entire understanding between the Parties concerning the subject matter hereof and supersedes all prior agreements, understandings, or negotiations. This Agreement may not be modified except in a writing signed by both Parties.</p>
                    
                    <p style="margin-top: 40px;">IN WITNESS WHEREOF, the Parties have executed this Agreement as of the Effective Date.</p>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 40px;">
                        <div style="width: 45%;">
                            <p>_______________________<br>
                            First Party Signature</p>
                            <p style="margin-top: 20px;">_______________________<br>
                            Date</p>
                        </div>
                        <div style="width: 45%;">
                            <p>_______________________<br>
                            Second Party Signature</p>
                            <p style="margin-top: 20px;">_______________________<br>
                            Date</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer-info">
        <p>Created by <a href="https://terms.law">Terms.Law</a> | California Attorney Sergei Tokmakov (CA Bar #279869)</p>
        <p>For personalized legal assistance, <a href="https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting" target="_blank">schedule a consultation</a></p>
    </div>
    
    <script>
        // Tab Navigation
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');
                
                // Deactivate all tabs
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Activate selected tab
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // Previous/Next buttons
        document.querySelectorAll('[data-next]').forEach(button => {
            button.addEventListener('click', () => {
                const nextTabId = button.getAttribute('data-next');
                
                // Deactivate all tabs
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Activate next tab
                document.querySelector(`[data-tab="${nextTabId}"]`).classList.add('active');
                document.getElementById(nextTabId).classList.add('active');
            });
        });
        
        document.querySelectorAll('[data-prev]').forEach(button => {
            button.addEventListener('click', () => {
                const prevTabId = button.getAttribute('data-prev');
                
                // Deactivate all tabs
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Activate previous tab
                document.querySelector(`[data-tab="${prevTabId}"]`).classList.add('active');
                document.getElementById(prevTabId).classList.add('active');
            });
        });
        
        // Function to highlight changed content
        function highlightElement(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.classList.add('highlight');
                
                // Check if element is in view
                const container = document.getElementById('previewContainer');
                const elementRect = element.getBoundingClientRect();
                const containerRect = container.getBoundingClientRect();
                
                if (elementRect.top < containerRect.top || elementRect.bottom > containerRect.bottom) {
                    // Element is not fully visible, scroll to it
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                
                // Remove highlight after 1.5 seconds
                setTimeout(() => {
                    element.classList.remove('highlight');
                }, 1500);
            }
        }
        
        // Function to update preview with new text and highlight changes
        function updatePreviewText(oldTextPattern, newText, elementId) {
            const previewContent = document.getElementById('previewContent');
            const oldHTML = previewContent.innerHTML;
            
            // Replace the text
            const newHTML = oldHTML.replace(oldTextPattern, newText);
            previewContent.innerHTML = newHTML;
            
            // Highlight the changed element
            highlightElement(elementId);
        }
        
        // Initialize form inputs with event listeners that update the preview
        document.getElementById('party1Name').addEventListener('input', function() {
            const party1Name = this.value.trim() || "___________________";
            updatePreviewText(/(.*)("First Party")/, `${party1Name} $2`, 'previewParty1');
        });
        
        document.getElementById('party2Name').addEventListener('input', function() {
            const party2Name = this.value.trim() || "___________________";
            updatePreviewText(/(.*)("Second Party")/, `${party2Name} $2`, 'previewParty2');
        });
        
        document.getElementById('stateJurisdiction').addEventListener('change', function() {
            const state = this.value || "_______________";
            updatePreviewText(/State of (.*)\./, `State of ${state}.`, 'previewState');
        });
        
        document.getElementById('effectiveDate').addEventListener('change', function() {
            let dateStr = "_______________";
            if (this.value) {
                const date = new Date(this.value);
                dateStr = date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            }
            updatePreviewText(/effective as of (.*)/, `effective as of ${dateStr}`, 'previewDate');
        });
        
        document.getElementById('duration').addEventListener('change', function() {
            const duration = this.value;
            updatePreviewText(/remain in effect for (.*) years/, `remain in effect for ${duration} years`, 'previewDuration');
        });
        
        // Checkbox event listeners for confidential information
        const confidentialInfoCheckboxes = [
            'protectIdentity', 'protectImages', 'protectMessages', 
            'protectRelationship', 'protectActivities', 'protectMedical', 
            'protectFinancial', 'protectOther'
        ];
        
        confidentialInfoCheckboxes.forEach(checkboxId => {
            document.getElementById(checkboxId).addEventListener('change', updateConfidentialInfoSection);
        });
        
        document.getElementById('otherConfidential').addEventListener('input', updateConfidentialInfoSection);
        
        function updateConfidentialInfoSection() {
            let confidentialItems = [];
            
            if (document.getElementById('protectIdentity').checked) {
                confidentialItems.push("Personal identity information");
            }
            if (document.getElementById('protectImages').checked) {
                confidentialItems.push("Photos, videos, and audio recordings");
            }
            if (document.getElementById('protectMessages').checked) {
                confidentialItems.push("Text messages, emails, and other written communications");
            }
            if (document.getElementById('protectRelationship').checked) {
                confidentialItems.push("Details about the nature of the relationship");
            }
            if (document.getElementById('protectActivities').checked) {
                confidentialItems.push("Specific activities engaged in together");
            }
            if (document.getElementById('protectMedical').checked) {
                confidentialItems.push("Medical or health information");
            }
            if (document.getElementById('protectFinancial').checked) {
                confidentialItems.push("Financial information");
            }
            
            const otherInfo = document.getElementById('otherConfidential').value.trim();
            if (document.getElementById('protectOther').checked && otherInfo) {
                confidentialItems.push(otherInfo);
            }
            
            // Build HTML for confidential information section
            let confidentialHTML = '';
            if (confidentialItems.length > 0) {
                confidentialHTML = confidentialItems.map(item => `- ${item}`).join('<br>');
            } else {
                confidentialHTML = "- [No confidential information selected]";
            }
            
            // Update in preview
            const previewContent = document.getElementById('previewContent');
            const regex = /<p>- Personal identity information(?:.|\n)*?<\/p>/;
            const newHTML = `<p>${confidentialHTML}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the section
            highlightElement('previewConfInfo');
        }
        
        // Mutual vs One-way Agreement
        document.getElementById('mutualConfidentiality').addEventListener('change', function() {
            const agreementType = this.value;
            let newTitle, newText;
            
            if (agreementType === 'mutual') {
                newTitle = "MUTUAL NON-DISCLOSURE AGREEMENT";
                newText = "Each Party agrees to keep confidential all Confidential Information received from the other Party. Each Party agrees not to disclose such Confidential Information to any third party, nor use it for any purpose other than as explicitly permitted by this Agreement.";
            } else {
                newTitle = "ONE-WAY NON-DISCLOSURE AGREEMENT";
                newText = "Second Party agrees to keep confidential all Confidential Information received from First Party. Second Party agrees not to disclose such Confidential Information to any third party, nor use it for any purpose other than as explicitly permitted by this Agreement.";
            }
            
            // Update title
            const previewContent = document.getElementById('previewContent');
            previewContent.innerHTML = previewContent.innerHTML.replace(/<h3 style="text-align: center;">.*?<\/h3>/, `<h3 style="text-align: center;">${newTitle}</h3>`);
            
            // Update protection clause
            const protectionRegex = /<p>Each Party agrees to keep confidential.*?Agreement\.<\/p>/;
            previewContent.innerHTML = previewContent.innerHTML.replace(protectionRegex, `<p>${newText}</p>`);
            
            // Highlight the changes
            highlightElement('previewTitle');
        });
        
        // Exceptions section
        const exceptionCheckboxes = ['exceptionLegal', 'exceptionCrime', 'exceptionPublic', 'exceptionConsent'];
        
        exceptionCheckboxes.forEach(checkboxId => {
            document.getElementById(checkboxId).addEventListener('change', updateExceptionsSection);
        });
        
        function updateExceptionsSection() {
            let exceptions = [];
            
            if (document.getElementById('exceptionPublic').checked) {
                exceptions.push("Is or becomes publicly available through no fault of the receiving Party");
            }
            if (document.getElementById('exceptionLegal').checked) {
                exceptions.push("Is disclosed in response to a valid order of a court or other governmental body");
            }
            if (document.getElementById('exceptionCrime').checked) {
                exceptions.push("Is disclosed to report a crime or respond to law enforcement");
            }
            if (document.getElementById('exceptionConsent').checked) {
                exceptions.push("Is disclosed with the prior written consent of the other Party");
            }
            
            // Build HTML for exceptions section
            let exceptionsHTML = '';
            if (exceptions.length > 0) {
                for (let i = 0; i < exceptions.length; i++) {
                    exceptionsHTML += `${String.fromCharCode(97 + i)}) ${exceptions[i]};<br>`;
                }
                // Replace last semicolon with period
                exceptionsHTML = exceptionsHTML.replace(/;<br>$/, ".");
            } else {
                exceptionsHTML = "[No exceptions apply]";
            }
            
            // Update in preview
            const previewContent = document.getElementById('previewContent');
            const regex = /<p>a\) Is or becomes publicly available(?:.|\n)*?<\/p>/;
            const newHTML = `<p>${exceptionsHTML}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the section
            highlightElement('previewExceptions');
        }
        
        // Permitted disclosures section
        const disclosureCheckboxes = ['discloseLegal', 'discloseTherapist', 'discloseDoctor', 'discloseFamily', 'discloseFriends'];
        
        disclosureCheckboxes.forEach(checkboxId => {
            document.getElementById(checkboxId).addEventListener('change', updateDisclosuresSection);
        });
        
        function updateDisclosuresSection() {
            let disclosures = [];
            
            if (document.getElementById('discloseLegal').checked) {
                disclosures.push("Legal counsel");
            }
            if (document.getElementById('discloseTherapist').checked) {
                disclosures.push("Licensed mental health professionals");
            }
            if (document.getElementById('discloseDoctor').checked) {
                disclosures.push("Medical providers when relevant to treatment");
            }
            if (document.getElementById('discloseFamily').checked) {
                disclosures.push("Family members");
            }
            if (document.getElementById('discloseFriends').checked) {
                disclosures.push("Close friends");
            }
            
            // Build HTML for disclosures section
            let disclosuresHTML = '';
            if (disclosures.length > 0) {
                for (let i = 0; i < disclosures.length; i++) {
                    disclosuresHTML += `${String.fromCharCode(97 + i)}) ${disclosures[i]};<br>`;
                }
                // Replace last semicolon with period
                disclosuresHTML = disclosuresHTML.replace(/;<br>$/, ".");
            } else {
                disclosuresHTML = "[No permitted disclosures]";
            }
            
            // Update in preview
            const previewContent = document.getElementById('previewContent');
            const regex = /<p>a\) Legal counsel(?:.|\n)*?<\/p>/;
            const newHTML = `<p>${disclosuresHTML}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the section
            highlightElement('previewDisclosures');
        }
        
        // Digital content handling
        document.getElementById('digitalContent').addEventListener('change', function() {
            const digitalChoice = this.value;
            let digitalText;
            
            switch (digitalChoice) {
                case 'deleteUponRequest':
                    digitalText = "Any digital content containing Confidential Information must be deleted upon request by the other Party.";
                    break;
                case 'deleteUponTermination':
                    digitalText = "Any digital content containing Confidential Information must be deleted upon termination of the relationship between the Parties.";
                    break;
                case 'noDistribution':
                    digitalText = "Any digital content containing Confidential Information may be kept but never distributed to any third party.";
                    break;
                case 'custom':
                    const customText = document.getElementById('customDigital').value.trim();
                    digitalText = customText || "Digital content will be handled as specifically agreed upon by the Parties.";
                    break;
            }
            
            // Update digital content section
            const previewContent = document.getElementById('previewContent');
            const regex = /<p><strong>6\. DIGITAL CONTENT<\/strong><\/p>\s*<p>.*?<\/p>/;
            const newHTML = `<p><strong>6. DIGITAL CONTENT</strong></p>\n<p>${digitalText}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the change
            highlightElement('previewDigital');
        });
        
        document.getElementById('customDigital').addEventListener('input', function() {
            if (document.getElementById('digitalContent').value === 'custom') {
                const customText = this.value.trim() || "Digital content will be handled as specifically agreed upon by the Parties.";
                
                // Update digital content section
                const previewContent = document.getElementById('previewContent');
                const regex = /<p><strong>6\. DIGITAL CONTENT<\/strong><\/p>\s*<p>.*?<\/p>/;
                const newHTML = `<p><strong>6. DIGITAL CONTENT</strong></p>\n<p>${customText}</p>`;
                
                const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
                previewContent.innerHTML = updatedContent;
                
                // Highlight the change
                highlightElement('previewDigital');
            }
        });
        
        // Liquidated damages
        document.getElementById('liquidatedDamages').addEventListener('input', function() {
            const damagesAmount = this.value || "10,000";
            const formattedAmount = parseInt(damagesAmount).toLocaleString();
            
            // Update damages amount in preview
            const previewContent = document.getElementById('previewContent');
            const regex = /monetary damages in the amount of \$([\d,]+)/;
            
            const updatedContent = previewContent.innerHTML.replace(regex, `monetary damages in the amount of $${formattedAmount}`);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the change
            highlightElement('previewDamages');
        });
        
        // Dispute resolution
        document.getElementById('disputeResolution').addEventListener('change', function() {
            const disputeMethod = this.value;
            let disputeText;
            
            switch (disputeMethod) {
                case 'arbitration':
                    disputeText = "Any dispute arising out of or relating to this Agreement shall be resolved through binding arbitration in accordance with the rules of the American Arbitration Association.";
                    break;
                case 'mediation':
                    disputeText = "Any dispute arising out of or relating to this Agreement shall first be submitted to mediation. If mediation is unsuccessful, the dispute shall then be resolved through binding arbitration in accordance with the rules of the American Arbitration Association.";
                    break;
                case 'court':
                    disputeText = "Any dispute arising out of or relating to this Agreement shall be resolved through litigation in the appropriate courts with jurisdiction over the matter.";
                    break;
            }
            
            // Update dispute resolution section
            const previewContent = document.getElementById('previewContent');
            const regex = /<p><strong>9\. DISPUTE RESOLUTION<\/strong><\/p>\s*<p>.*?<\/p>/;
            const newHTML = `<p><strong>9. DISPUTE RESOLUTION</strong></p>\n<p>${disputeText}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the change
            highlightElement('previewDispute');
        });
        
        // Injunctive relief
        document.getElementById('injunctiveRelief').addEventListener('change', function() {
            const includeInjunctive = this.value === 'yes';
            let damagesText;
            
            if (includeInjunctive) {
                const damagesAmount = document.getElementById('liquidatedDamages').value || "10,000";
                const formattedAmount = parseInt(damagesAmount).toLocaleString();
                damagesText = `In the event of a breach or threatened breach of this Agreement, the non-breaching Party shall be entitled to seek monetary damages in the amount of $${formattedAmount} as liquidated damages, as well as injunctive relief to prevent further disclosure of Confidential Information.`;
            } else {
                const damagesAmount = document.getElementById('liquidatedDamages').value || "10,000";
                const formattedAmount = parseInt(damagesAmount).toLocaleString();
                damagesText = `In the event of a breach of this Agreement, the non-breaching Party shall be entitled to seek monetary damages in the amount of $${formattedAmount} as liquidated damages.`;
            }
            
            // Update remedies section
            const previewContent = document.getElementById('previewContent');
            const regex = /<p><strong>8\. REMEDIES<\/strong><\/p>\s*<p>.*?<\/p>/;
            const newHTML = `<p><strong>8. REMEDIES</strong></p>\n<p>${damagesText}</p>`;
            
            const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the change
            highlightElement('previewRemedies');
        });
        
        // Attorney's fees
        document.getElementById('attorneyFees').addEventListener('change', function() {
            const feesOption = this.value;
            let feesText;
            
            if (feesOption === 'prevailing') {
                feesText = "In any action to enforce this Agreement, the prevailing Party shall be entitled to recover its reasonable attorney's fees and costs.";
            } else {
                feesText = "In any action to enforce this Agreement, each Party shall bear its own attorney's fees and costs.";
            }
            
            // Check if attorney fees section already exists
            const previewContent = document.getElementById('previewContent');
            if (previewContent.innerHTML.includes("<strong>13. ATTORNEY'S FEES</strong>")) {
                // Update existing section
                const regex = /<p><strong>13\. ATTORNEY'S FEES<\/strong><\/p>\s*<p>.*?<\/p>/;
                const newHTML = `<p><strong>13. ATTORNEY'S FEES</strong></p>\n<p>${feesText}</p>`;
                
                const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
                previewContent.innerHTML = updatedContent;
            } else {
                // Add new section before the signature block
                const signatureBlockRegex = /<p style="margin-top: 40px;">IN WITNESS WHEREOF/;
                const newSection = `<p><strong>13. ATTORNEY'S FEES</strong></p>\n<p>${feesText}</p>\n\n`;
                
                const updatedContent = previewContent.innerHTML.replace(signatureBlockRegex, newSection + '<p style="margin-top: 40px;">IN WITNESS WHEREOF');
                previewContent.innerHTML = updatedContent;
            }
            
            // Highlight the change
            highlightElement('previewFees');
        });
        
        // Additional terms
        document.getElementById('additionalTerms').addEventListener('input', function() {
            const additionalText = this.value.trim();
            
            if (additionalText) {
                // Check if additional terms section already exists
                const previewContent = document.getElementById('previewContent');
                if (previewContent.innerHTML.includes("<strong>14. ADDITIONAL TERMS</strong>")) {
                    // Update existing section
                    const regex = /<p><strong>14\. ADDITIONAL TERMS<\/strong><\/p>\s*<p>.*?<\/p>/;
                    const newHTML = `<p><strong>14. ADDITIONAL TERMS</strong></p>\n<p>${additionalText}</p>`;
                    
                    const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
                    previewContent.innerHTML = updatedContent;
                } else {
                    // Add new section before the signature block
                    const signatureBlockRegex = /<p style="margin-top: 40px;">IN WITNESS WHEREOF/;
                    const newSection = `<p><strong>14. ADDITIONAL TERMS</strong></p>\n<p>${additionalText}</p>\n\n`;
                    
                    const updatedContent = previewContent.innerHTML.replace(signatureBlockRegex, newSection + '<p style="margin-top: 40px;">IN WITNESS WHEREOF');
                    previewContent.innerHTML = updatedContent;
                }
                
                // Highlight the change
                highlightElement('previewAdditional');
            } else {
                // Remove the section if it exists and input is empty
                const previewContent = document.getElementById('previewContent');
                if (previewContent.innerHTML.includes("<strong>14. ADDITIONAL TERMS</strong>")) {
                    const regex = /<p><strong>14\. ADDITIONAL TERMS<\/strong><\/p>\s*<p>.*?<\/p>\s*\n*/;
                    
                    const updatedContent = previewContent.innerHTML.replace(regex, '');
                    previewContent.innerHTML = updatedContent;
                }
            }
        });
        
        // Severability clause
        document.getElementById('severabilityClause').addEventListener('change', function() {
            const includeSeverability = this.checked;
            
            // Find section 11 in the preview
            const previewContent = document.getElementById('previewContent');
            const regex = /<p><strong>11\. SEVERABILITY<\/strong><\/p>\s*<p>.*?<\/p>/;
            
            if (includeSeverability) {
                const severabilityText = "If any provision of this Agreement is found to be unenforceable, the remainder shall continue in full force and effect.";
                const newHTML = `<p><strong>11. SEVERABILITY</strong></p>\n<p>${severabilityText}</p>`;
                
                if (previewContent.innerHTML.includes("<strong>11. SEVERABILITY</strong>")) {
                    // Update existing section
                    const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
                    previewContent.innerHTML = updatedContent;
                } else {
                    // Add section if it doesn't exist
                    const entireAgreementRegex = /<p><strong>12\. ENTIRE AGREEMENT<\/strong><\/p>/;
                    const newSection = `<p><strong>11. SEVERABILITY</strong></p>\n<p>${severabilityText}</p>\n\n`;
                    
                    const updatedContent = previewContent.innerHTML.replace(entireAgreementRegex, newSection + '<p><strong>12. ENTIRE AGREEMENT</strong></p>');
                    previewContent.innerHTML = updatedContent;
                }
            } else {
                // Remove the section if unchecked
                if (previewContent.innerHTML.includes("<strong>11. SEVERABILITY</strong>")) {
                    const updatedContent = previewContent.innerHTML.replace(regex, '');
                    previewContent.innerHTML = updatedContent;
                    
                    // Renumber remaining sections
                    renumberSections();
                }
            }
            
            // Highlight the change
            highlightElement('previewSeverability');
        });
        
        // Entire agreement clause
        document.getElementById('entireAgreementClause').addEventListener('change', function() {
            const includeEntire = this.checked;
            
            // Find section in the preview
            const previewContent = document.getElementById('previewContent');
            
            if (includeEntire) {
                const entireText = "This Agreement constitutes the entire understanding between the Parties concerning the subject matter hereof.";
                
                if (previewContent.innerHTML.includes("<strong>12. ENTIRE AGREEMENT</strong>") || 
                    previewContent.innerHTML.includes("<strong>11. ENTIRE AGREEMENT</strong>")) {
                    // Update existing section
                    const regex = /<p><strong>(\d+)\. ENTIRE AGREEMENT<\/strong><\/p>\s*<p>.*?<\/p>/;
                    const match = previewContent.innerHTML.match(regex);
                    const sectionNum = match ? match[1] : "12";
                    
                    const newHTML = `<p><strong>${sectionNum}. ENTIRE AGREEMENT</strong></p>\n<p>${entireText}</p>`;
                    const updatedContent = previewContent.innerHTML.replace(regex, newHTML);
                    previewContent.innerHTML = updatedContent;
                } else {
                    // Add section if it doesn't exist
                    // Determine the number for the new section
                    let sectionNum = "12";
                    if (!previewContent.innerHTML.includes("<strong>11. SEVERABILITY</strong>")) {
                        sectionNum = "11";
                    }
                    
                    const signatureBlockRegex = /<p style="margin-top: 40px;">IN WITNESS WHEREOF/;
                    const newSection = `<p><strong>${sectionNum}. ENTIRE AGREEMENT</strong></p>\n<p>${entireText}</p>\n\n`;
                    
                    const updatedContent = previewContent.innerHTML.replace(signatureBlockRegex, newSection + '<p style="margin-top: 40px;">IN WITNESS WHEREOF');
                    previewContent.innerHTML = updatedContent;
                }
            } else {
                // Remove the section if unchecked
                const regex = /<p><strong>(\d+)\. ENTIRE AGREEMENT<\/strong><\/p>\s*<p>.*?<\/p>/;
                if (regex.test(previewContent.innerHTML)) {
                    const updatedContent = previewContent.innerHTML.replace(regex, '');
                    previewContent.innerHTML = updatedContent;
                    
                    // Renumber remaining sections
                    renumberSections();
                }
            }
            
            // Highlight the change
            highlightElement('previewEntire');
        });
        
        // Notarization check
        document.getElementById('notarizationCheck').addEventListener('change', function() {
            const includeNotary = this.checked;
            
            // Find the signature block in the preview
            const previewContent = document.getElementById('previewContent');
            const signatureBlockRegex = /<div style="display: flex; justify-content: space-between; margin-top: 40px;">[\s\S]*?<\/div>/;
            
            let newSignatureBlock;
            if (includeNotary) {
                newSignatureBlock = `<div style="display: flex; justify-content: space-between; margin-top: 40px;">
                    <div style="width: 45%;">
                        <p>_______________________<br>
                        First Party Signature</p>
                        <p style="margin-top: 20px;">_______________________<br>
                        Date</p>
                        <p style="margin-top: 40px;">STATE OF _____________ )<br>
                        COUNTY OF ___________ )</p>
                        <p style="margin-top: 10px;">On _____________ before me, _____________, Notary Public, personally appeared _____________, who proved to me on the basis of satisfactory evidence to be the person whose name is subscribed to the within instrument and acknowledged to me that he/she executed the same.</p>
                        <p style="margin-top: 10px;">_______________________<br>
                        Notary Public Signature</p>
                    </div>
                    <div style="width: 45%;">
                        <p>_______________________<br>
                        Second Party Signature</p>
                        <p style="margin-top: 20px;">_______________________<br>
                        Date</p>
                        <p style="margin-top: 40px;">STATE OF _____________ )<br>
                        COUNTY OF ___________ )</p>
                        <p style="margin-top: 10px;">On _____________ before me, _____________, Notary Public, personally appeared _____________, who proved to me on the basis of satisfactory evidence to be the person whose name is subscribed to the within instrument and acknowledged to me that he/she executed the same.</p>
                        <p style="margin-top: 10px;">_______________________<br>
                        Notary Public Signature</p>
                    </div>
                </div>`;
            } else {
                newSignatureBlock = `<div style="display: flex; justify-content: space-between; margin-top: 40px;">
                    <div style="width: 45%;">
                        <p>_______________________<br>
                        First Party Signature</p>
                        <p style="margin-top: 20px;">_______________________<br>
                        Date</p>
                    </div>
                    <div style="width: 45%;">
                        <p>_______________________<br>
                        Second Party Signature</p>
                        <p style="margin-top: 20px;">_______________________<br>
                        Date</p>
                    </div>
                </div>`;
            }
            
            const updatedContent = previewContent.innerHTML.replace(signatureBlockRegex, newSignatureBlock);
            previewContent.innerHTML = updatedContent;
            
            // Highlight the change
            highlightElement('previewSignatures');
        });
        
        // Helper function to renumber sections after removing one
        function renumberSections() {
            const previewContent = document.getElementById('previewContent');
            const html = previewContent.innerHTML;
            
            // Extract all section headers
            const sectionRegex = /<p><strong>(\d+)\. ([A-Z\s]+)<\/strong><\/p>/g;
            const sections = [];
            let match;
            
            while ((match = sectionRegex.exec(html)) !== null) {
                sections.push({
                    num: parseInt(match[1]),
                    title: match[2],
                    fullMatch: match[0]
                });
            }
            
            // Sort by current number
            sections.sort((a, b) => a.num - b.num);
            
            // Create a new HTML with renumbered sections
            let newHTML = html;
            for (let i = 0; i < sections.length; i++) {
                const newNum = i + 1;
                const oldSection = sections[i];
                
                if (oldSection.num !== newNum) {
                    const oldPattern = `<p><strong>${oldSection.num}. ${oldSection.title}</strong></p>`;
                    const newPattern = `<p><strong>${newNum}. ${oldSection.title}</strong></p>`;
                    newHTML = newHTML.replace(new RegExp(oldPattern, 'g'), newPattern);
                }
            }
            
            previewContent.innerHTML = newHTML;
        }
        
        // Generate final document
        document.getElementById('generateBtn').addEventListener('click', function() {
            // Final validation could be added here
            
            // Show download button
            document.getElementById('downloadBtn').style.display = 'block';
            
            // Scroll to download button
            document.getElementById('downloadBtn').scrollIntoView({ behavior: 'smooth' });
            
            // Add IDs to sections for highlighting
            addSectionIds();
        });
        
        // Helper function to add IDs to preview sections for highlighting
        function addSectionIds() {
            const previewContent = document.getElementById('previewContent');
            
            // Add ID to parties section
            let html = previewContent.innerHTML;
            html = html.replace(
                /<p>This Non-Disclosure Agreement/,
                '<p id="previewParty1">This Non-Disclosure Agreement'
            );
            
            html = html.replace(
                /("First Party") and (.*?) ("Second Party")/,
                '"First Party") and <span id="previewParty2">$2</span> $3'
            );
            
            // Add ID to effective date
            html = html.replace(
                /<p><strong>EFFECTIVE DATE:<\/strong> This Agreement is effective as of/,
                '<p id="previewDate"><strong>EFFECTIVE DATE:</strong> This Agreement is effective as of'
            );
            
            // Add ID to confidential info section
            html = html.replace(
                /<p>- Personal identity information/,
                '<p id="previewConfInfo">- Personal identity information'
            );
            
            // Add ID to exceptions section
            html = html.replace(
                /<p>a\) Is or becomes publicly available/,
                '<p id="previewExceptions">a) Is or becomes publicly available'
            );
            
            // Add ID to disclosures section
            html = html.replace(
                /<p>a\) Legal counsel/,
                '<p id="previewDisclosures">a) Legal counsel'
            );
            
            // Add ID to digital content section
            html = html.replace(
                /<p><strong>6\. DIGITAL CONTENT<\/strong><\/p>\s*<p>/,
                '<p><strong>6. DIGITAL CONTENT</strong></p>\n<p id="previewDigital">'
            );
            
            // Add ID to duration section
            html = html.replace(
                /<p>This Agreement shall remain in effect for/,
                '<p id="previewDuration">This Agreement shall remain in effect for'
            );
            
            // Add ID to remedies section
            html = html.replace(
                /<p>In the event of a breach/,
                '<p id="previewRemedies">In the event of a breach'
            );
            
            // Add ID to dispute resolution section
            html = html.replace(
                /<p>Any dispute arising out of/,
                '<p id="previewDispute">Any dispute arising out of'
            );
            
            // Add ID to state section
            html = html.replace(
                /<p>This Agreement shall be governed by the laws of the State of/,
                '<p id="previewState">This Agreement shall be governed by the laws of the State of'
            );
            
            // Add ID to severability section
            html = html.replace(
                /<p>If any provision of this Agreement is found/,
                '<p id="previewSeverability">If any provision of this Agreement is found'
            );
            
            // Add ID to entire agreement section
            html = html.replace(
                /<p>This Agreement constitutes the entire understanding/,
                '<p id="previewEntire">This Agreement constitutes the entire understanding'
            );
            
            // Add ID to damages amount
            html = html.replace(
                /monetary damages in the amount of \$([\d,]+)/,
                'monetary damages in the amount of <span id="previewDamages">$$$1</span>'
            );
            
            previewContent.innerHTML = html;
        }
        
        // Download button
        document.getElementById('downloadBtn').addEventListener('click', function() {
            // In a real implementation, you would generate a proper Word document
            // For this demo, we'll use a data URI to initiate a download of the HTML content
            
            const previewHTML = document.getElementById('previewContent').innerHTML;
            
            // Create a cleaned version of the HTML for download (remove highlight spans, etc.)
            let cleanHTML = previewHTML;
            cleanHTML = cleanHTML.replace(/<span id="[^"]*">/g, '');
            cleanHTML = cleanHTML.replace(/<\/span>/g, '');
            cleanHTML = cleanHTML.replace(/ id="[^"]*"/g, '');
            
            // Create a simple HTML document
            const htmlDoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>Relationship Privacy Non-Disclosure Agreement</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 1in; line-height: 1.5; }
                    h3 { text-align: center; }
                </style>
            </head>
            <body>
                ${cleanHTML}
            </body>
            </html>
            `;
            
            // Create a Blob with the HTML content
            const blob = new Blob([htmlDoc], { type: 'application/msword' });
            
            // Create a temporary link element
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            
            // Get file name based on parties' names
            let fileName = 'Relationship-Privacy-NDA.doc';
            const party1 = document.getElementById('party1Name').value.trim();
            const party2 = document.getElementById('party2Name').value.trim();
            
            if (party1 && party2) {
                const party1Short = party1.split(' ')[0];
                const party2Short = party2.split(' ')[0];
                fileName = `NDA-${party1Short}-${party2Short}.doc`;
            }
            
            link.download = fileName;
            
            // Trigger download
            document.body.appendChild(link);
            link.click();
            
            // Clean up
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        });
    </script>
</body>
</html>
