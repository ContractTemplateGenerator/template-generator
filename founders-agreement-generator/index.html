<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Founders Agreement Generator</title>
  <style>
    /* Base Styles */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #27ae60;
      --warning-color: #e74c3c;
      --info-color: #f39c12;
      --bg-color: #f9fafb;
      --card-bg: #ffffff;
      --text-primary: #333333;
      --text-secondary: #666666;
      --border-color: #e0e0e0;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition: all 0.3s ease;
      --highlight-color: #ffff8d;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    body {
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
    }
    
    /* Container Styles */
    .generator-container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    
    /* Header Styles */
    .generator-header {
      background-color: var(--primary-color);
      color: white;
      padding: 25px;
      text-align: center;
    }
    
    .generator-header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .generator-header p {
      font-size: 16px;
      opacity: 0.9;
    }
    
    /* Content Layout */
    .generator-content {
      display: flex;
      min-height: 600px;
    }
    
    /* Form Styles */
    .form-container {
      flex: 1;
      padding: 25px;
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      max-height: 800px;
    }
    
    .form-section {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .form-section:last-child {
      border-bottom: none;
    }
    
    .form-section-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .form-group {
      margin-bottom: 15px;
      position: relative;
    }
    
    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 5px;
      color: var(--text-primary);
    }
    
    .form-input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-primary);
      background-color: white;
      transition: var(--transition);
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }
    
    textarea.form-input {
      min-height: 80px;
      resize: vertical;
    }
    
    .form-helper {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    /* Warning and Info Messages */
    .warning-message {
      background-color: rgba(231, 76, 60, 0.1);
      border-left: 3px solid var(--warning-color);
      color: var(--warning-color);
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      font-size: 13px;
      display: none;
    }
    
    .info-message {
      background-color: rgba(243, 156, 18, 0.1);
      border-left: 3px solid var(--info-color);
      color: var(--info-color);
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    /* Tooltip Styles */
    .tooltip-icon {
      display: inline-block;
      margin-left: 5px;
      width: 16px;
      height: 16px;
      background-color: var(--secondary-color);
      color: white;
      border-radius: 50%;
      text-align: center;
      font-size: 12px;
      font-weight: bold;
      cursor: help;
      position: relative;
      vertical-align: middle;
    }
    
    .tooltip-content {
      position: absolute;
      width: 280px;
      background-color: var(--primary-color);
      color: white;
      padding: 10px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 100;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      text-align: left;
      font-weight: normal;
      top: 25px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      /* Center-aligned tooltips to avoid being cut off */
      left: 50%;
      transform: translateX(-50%);
    }
    
    .tooltip-content::before {
      content: '';
      position: absolute;
      top: -5px;
      left: 50%;
      margin-left: -5px;
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 5px solid var(--primary-color);
    }
    
    .tooltip-icon:hover .tooltip-content {
      visibility: visible;
      opacity: 1;
    }
    
    /* Radio and Checkbox Styles */
    .options-group {
      margin-bottom: 15px;
    }
    
    .option-item {
      display: flex;
      align-items: flex-start;
      padding: 8px 10px;
      margin-bottom: 8px;
      background-color: #f5f7fa;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .option-item:hover {
      background-color: #eef2f7;
    }
    
    .option-item.selected {
      background-color: #e8f6f3;
      border-color: var(--accent-color);
    }
    
    .option-item input[type="radio"],
    .option-item input[type="checkbox"] {
      margin-right: 10px;
      margin-top: 3px;
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-label {
      font-weight: 500;
      display: block;
      margin-bottom: 2px;
    }
    
    .option-description {
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    /* Form Actions */
    .form-actions {
      display: flex;
      justify-content: center;
      margin-top: 25px;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .btn {
      padding: 10px 16px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      text-align: center;
    }
    
    .btn-reset {
      background-color: #f1f1f1;
      color: var(--text-primary);
    }
    
    .btn-reset:hover {
      background-color: #e4e4e4;
    }
    
    .btn-copy {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .btn-copy:hover {
      background-color: #2980b9;
    }
    
    .btn-download {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-download:hover {
      background-color: #219653;
    }
    
    .copy-message {
      display: none;
      font-size: 14px;
      color: #27ae60;
      background-color: white;
      padding: 3px 8px;
      border-radius: 4px;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      margin-left: 10px;
      border: 1px solid #e0e0e0;
    }
    
    .btn-consult {
      display: block;
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background-color: var(--primary-color);
      color: white;
      text-decoration: none;
      text-align: center;
      border-radius: 4px;
      font-weight: 500;
      transition: var(--transition);
    }
    
    .btn-consult:hover {
      background-color: #1e2a37;
    }
    
    /* Top Buttons Bar */
    .top-buttons-bar {
      display: flex;
      justify-content: center;
      margin: 0 0 20px 0;
      padding: 15px;
      border-bottom: 1px solid var(--border-color);
      position: relative;
    }
    
    /* Preview Styles */
    .preview-container {
      flex: 1;
      padding: 25px;
      position: relative;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .preview-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .preview-note {
      font-size: 12px;
      color: var(--text-secondary);
      font-style: italic;
    }
    
    .preview-box {
      height: 700px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      padding: 25px;
      background-color: white;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-primary);
    }
    
    /* Document Styles */
    .document-template {
      font-family: Arial, sans-serif;
    }
    
    .document-title {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    
    .document-section {
      margin-bottom: 20px;
    }
    
    .section-title {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 10px;
      color: var(--primary-color);
    }
    
    .section-content {
      margin-bottom: 15px;
    }
    
    .field-label {
      font-weight: bold;
      display: inline-block;
      margin-right: 5px;
    }
    
    /* Highlight Effect */
    .highlight {
      background-color: var(--highlight-color);
      transition: background-color 0.5s ease;
    }
    
    /* Add another founder button */
    .add-founder-btn {
      display: inline-flex;
      align-items: center;
      margin-bottom: 15px;
      padding: 8px 12px;
      background-color: var(--secondary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
    }
    
    .add-founder-btn:hover {
      background-color: #2980b9;
    }
    
    .add-founder-icon {
      margin-right: 5px;
      font-weight: bold;
    }
    
    /* Equity Warning Styles */
    .equity-warning {
      color: #e74c3c;
      font-size: 12px;
      margin-top: 4px;
      display: none;
    }
    
    /* Main Tabs Navigation */
    .main-tabs {
      border-bottom: 1px solid var(--border-color);
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 20px;
      position: relative;
    }
    
    .main-tab-button {
      padding: 10px 15px;
      background-color: transparent;
      border: none;
      cursor: pointer;
      font-weight: 500;
      color: var(--text-secondary);
      border-bottom: 3px solid transparent;
      transition: var(--transition);
      white-space: nowrap;
      font-size: 14px;
    }
    
    .main-tab-button:hover {
      color: var(--primary-color);
    }
    
    .main-tab-button.active {
      color: var(--secondary-color);
      border-bottom-color: var(--secondary-color);
    }
    
    /* Scrollable tabs container */
    .tabs-wrapper {
      position: relative;
      overflow: hidden;
      width: 100%;
    }
    
    .tabs-container {
      display: flex;
      overflow-x: auto;
      scroll-behavior: smooth;
      -ms-overflow-style: none; /* Hide scrollbar in IE and Edge */
      scrollbar-width: none; /* Hide scrollbar in Firefox */
      padding-bottom: 5px; /* Space for the bottom border */
    }
    
    .tabs-container::-webkit-scrollbar {
      display: none; /* Hide scrollbar in Chrome, Safari, Opera */
    }
    
    /* Tab scroll buttons */
    .tab-scroll-button {
      position: absolute;
      top: 0;
      height: 100%;
      width: 25px;
      background-color: rgba(255, 255, 255, 0.8);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--primary-color);
      font-weight: bold;
    }
    
    .tab-scroll-left {
      left: 0;
      border-top-left-radius: 4px;
      border-bottom-left-radius: 4px;
    }
    
    .tab-scroll-right {
      right: 0;
      border-top-right-radius: 4px;
      border-bottom-right-radius: 4px;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .tab-navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    
    /* Custom Checkbox Styling */
    .custom-checkbox {
      position: relative;
      padding-left: 30px;
      cursor: pointer;
      user-select: none;
      display: block;
      margin-bottom: 10px;
    }
    
    .custom-checkbox input {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      height: 0;
      width: 0;
    }
    
    .checkmark {
      position: absolute;
      top: 0;
      left: 0;
      height: 20px;
      width: 20px;
      background-color: #f5f7fa;
      border: 1px solid var(--border-color);
      border-radius: 3px;
    }
    
    .custom-checkbox:hover input ~ .checkmark {
      background-color: #eef2f7;
    }
    
    .custom-checkbox input:checked ~ .checkmark {
      background-color: var(--accent-color);
      border-color: var(--accent-color);
    }
    
    .checkmark:after {
      content: "";
      position: absolute;
      display: none;
    }
    
    .custom-checkbox input:checked ~ .checkmark:after {
      display: block;
    }
    
    .custom-checkbox .checkmark:after {
      left: 7px;
      top: 3px;
      width: 5px;
      height: 10px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
    
    /* Total equity display */
    .total-equity-section {
      margin-top: 15px; 
      padding: 10px; 
      background-color: #f8f9fa; 
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }
    
    /* Signature section styles */
    .signature-row {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-top: 40px;
    }
    
    .signature-block {
      flex: 0 0 48%;
      margin-bottom: 30px;
    }
    
    .signature-line {
      margin-top: 20px;
      margin-bottom: 5px;
      border-bottom: 1px solid #000;
      width: 80%;
    }
    
    /* Responsive Styles */
    @media (max-width: 1024px) {
      .generator-content {
        flex-direction: column;
      }
      
      .form-container {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        max-height: none;
      }
      
      .preview-box {
        height: 500px;
      }
      
      .signature-block {
        flex: 0 0 100%;
      }
    }
    
    @media (max-width: 768px) {
      .generator-container {
        margin: 0;
        border-radius: 0;
      }
      
      .generator-header {
        padding: 20px;
      }
      
      .main-tab-button {
        padding: 8px 12px;
        font-size: 13px;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .copy-message {
        position: static;
        margin-left: 0;
        margin-top: 10px;
        text-align: center;
        transform: none;
      }
    }
    
    @media print {
      body {
        background-color: white;
        padding: 0;
      }
      
      .generator-container {
        box-shadow: none;
        border-radius: 0;
      }
      
      .generator-header,
      .form-container,
      .preview-header,
      .form-actions,
      .btn-consult {
        display: none;
      }
      
      .generator-content {
        display: block;
      }
      
      .preview-container {
        padding: 0;
      }
      
      .preview-box {
        height: auto;
        overflow: visible;
        border: none;
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <div class="generator-container">
    <div class="generator-header">
      <h1>Founders Agreement Generator</h1>
      <p>Create a customized agreement to formalize the relationship between company founders</p>
    </div>
    
    <div class="generator-content">
      <!-- Form Container -->
      <div class="form-container">
        <!-- Global Action Buttons -->
        <div class="top-buttons-bar">
          <button type="button" id="globalCopyBtn" class="btn btn-copy">Copy Agreement</button>
          <span id="globalCopyMessage" class="copy-message">Agreement copied!</span>
          <button type="button" id="globalDownloadBtn" class="btn btn-download" style="margin-left: 15px;">Download as DOCX</button>
          <button type="reset" form="foundersForm" class="btn btn-reset" style="margin-left: 15px;">Reset Form</button>
        </div>
        
        <!-- Main Tabs - Simplified to 5 key sections -->
        <div class="main-tabs">
          <div class="tabs-wrapper">
            <button class="tab-scroll-button tab-scroll-left" id="scrollLeft">&#9664;</button>
            <div class="tabs-container">
              <button class="main-tab-button active" data-tab="company-tab">Company Info</button>
              <button class="main-tab-button" data-tab="founders-tab">Founders</button>
              <button class="main-tab-button" data-tab="equity-tab">Equity & Vesting</button>
              <button class="main-tab-button" data-tab="roles-tab">Roles & Terms</button>
              <button class="main-tab-button" data-tab="legal-tab">Legal Provisions</button>
            </div>
            <button class="tab-scroll-button tab-scroll-right" id="scrollRight">&#9654;</button>
          </div>
        </div>
        
        <form id="foundersForm">
          <!-- Company Information Section -->
          <div id="company-tab" class="tab-content active">
            <div class="form-section">
              <h2 class="form-section-title">Company Information</h2>
              
              <div class="form-group">
                <label for="companyName">
                  Company Name
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Enter the legal name of the company if incorporated, or the intended name if not yet incorporated.</span>
                  </span>
                </label>
                <input type="text" id="companyName" class="form-input" placeholder="Enter company name" value="New Venture, Inc.">
              </div>
              
              <div class="form-group">
                <label for="companyAddress">
                  Company Address
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">The primary business address where the company operates or will operate.</span>
                  </span>
                </label>
                <input type="text" id="companyAddress" class="form-input" placeholder="Enter company address" value="123 Innovation Way, San Francisco, CA 94107">
              </div>
              
              <div class="form-group">
                <label for="businessPurpose">
                  Business Purpose
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">A concise statement describing what the company does or intends to do. This helps define the scope of operations and non-compete provisions.</span>
                  </span>
                </label>
                <textarea id="businessPurpose" class="form-input" placeholder="Describe the purpose of the company">To develop and market innovative software solutions for the healthcare industry.</textarea>
              </div>
              
              <div class="form-group">
                <label for="incorporationStatus">
                  Incorporation Status
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Indicates whether the company is already incorporated and what type of entity it is or will become.</span>
                  </span>
                </label>
                <select id="incorporationStatus" class="form-input">
                  <option value="notIncorporated" selected>Not Yet Incorporated</option>
                  <option value="llc">LLC</option>
                  <option value="cCorp">C Corporation</option>
                  <option value="sCorp">S Corporation</option>
                  <option value="benefit">Benefit Corporation</option>
                </select>
              </div>
              
              <div class="form-group" id="incorporationDateGroup" style="display: none;">
                <label for="incorporationDate">
                  Date of Incorporation
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">The date when the company was officially incorporated. If using a future date, ensure this reflects your actual incorporation timeline.</span>
                  </span>
                </label>
                <input type="date" id="incorporationDate" class="form-input" value="">
                <div id="futureDateWarning" class="warning-message">Warning: You've selected a future date for incorporation. Please ensure this accurately reflects your incorporation plans.</div>
              </div>
              
              <div class="form-group">
                <label for="agreementDate">
                  Agreement Date
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">The effective date when this founders agreement will take effect.</span>
                  </span>
                </label>
                <input type="date" id="agreementDate" class="form-input" value="">
              </div>
              
              <div class="form-group">
                <label for="governingLaw">
                  Governing Law (State)
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">The state whose laws will govern the interpretation and enforcement of this agreement. Often the state of incorporation or primary business location.</span>
                  </span>
                </label>
                <select id="governingLaw" class="form-input">
                  <option value="california">California</option>
                  <option value="delaware" selected>Delaware</option>
                  <option value="new-york">New York</option>
                  <option value="texas">Texas</option>
                  <option value="florida">Florida</option>
                  <option value="massachusetts">Massachusetts</option>
                  <option value="other">Other State</option>
                </select>
                <div id="californiaLawWarning" class="warning-message" style="display: none;">Note: California has strict limitations on non-compete agreements. The non-compete provisions in this agreement may not be enforceable in California.</div>
              </div>
              
              <div class="form-group" id="otherStateGroup" style="display: none;">
                <label for="otherState">Specify Other State</label>
                <input type="text" id="otherState" class="form-input" placeholder="Enter state name">
              </div>
            </div>
            
            <div class="tab-navigation">
              <div></div>
              <button type="button" class="btn btn-next" data-next="founders-tab">Next: Founders</button>
            </div>
          </div>
          
          <!-- Founder Information Section -->
          <div id="founders-tab" class="tab-content">
            <div class="form-section">
              <h2 class="form-section-title">Founder Information</h2>
              
              <div id="foundersContainer">
                <!-- Founder 1 -->
                <div class="founder-section" id="founder1Section">
                  <h3 style="font-size: 16px; color: var(--secondary-color); margin-bottom: 10px;">Founder 1</h3>
                  
                  <div class="form-group">
                    <label for="founder1Name">
                      Full Name
                      <span class="tooltip-icon">?
                        <span class="tooltip-content">Legal name of the founder, which will be used for contract purposes.</span>
                      </span>
                    </label>
                    <input type="text" id="founder1Name" class="form-input" placeholder="Enter founder name" value="John Smith">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder1Address">Address</label>
                    <input type="text" id="founder1Address" class="form-input" placeholder="Enter address" value="456 Tech Street, San Francisco, CA 94107">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder1Email">Email Address</label>
                    <input type="email" id="founder1Email" class="form-input" placeholder="Enter email address" value="john@example.com">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder1Equity">
                      Equity Percentage
                      <span class="tooltip-icon">?
                        <span class="tooltip-content">The percentage of ownership in the company. Total across all founders must equal 100%.</span>
                      </span>
                    </label>
                    <input type="number" id="founder1Equity" class="form-input equity-input" placeholder="Enter percentage" value="50" min="1" max="100">
                    <div class="form-helper">Percentage of ownership in the company</div>
                    <div class="equity-warning" id="founder1EquityWarning">Equity percentages across all founders must equal 100%</div>
                  </div>
                  
                  <div class="form-group">
                    <label for="founder1Role">
                      Role / Position
                      <span class="tooltip-icon">?
                        <span class="tooltip-content">The founder's title and position within the company.</span>
                      </span>
                    </label>
                    <select id="founder1Role" class="form-input founder-role-select">
                      <option value="CEO" selected>Chief Executive Officer (CEO)</option>
                      <option value="CTO">Chief Technology Officer (CTO)</option>
                      <option value="CFO">Chief Financial Officer (CFO)</option>
                      <option value="COO">Chief Operating Officer (COO)</option>
                      <option value="CPO">Chief Product Officer (CPO)</option>
                      <option value="CMO">Chief Marketing Officer (CMO)</option>
                      <option value="President">President</option>
                      <option value="Co-Founder">Co-Founder</option>
                      <option value="other">Other (Specify)</option>
                    </select>
                  </div>
                  
                  <div class="form-group" id="founder1CustomRoleGroup" style="display: none;">
                    <label for="founder1CustomRole">Specify Role</label>
                    <input type="text" id="founder1CustomRole" class="form-input" placeholder="Enter custom role">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder1Responsibilities">
                      Key Responsibilities
                      <span class="tooltip-icon">?
                        <span class="tooltip-content">Describe the founder's main duties and areas of responsibility within the company.</span>
                      </span>
                    </label>
                    <textarea id="founder1Responsibilities" class="form-input" placeholder="Describe responsibilities">Overall company strategy, fundraising, and business development.</textarea>
                  </div>
                </div>
                
                <!-- Founder 2 -->
                <div class="founder-section" id="founder2Section">
                  <h3 style="font-size: 16px; color: var(--secondary-color); margin-bottom: 10px;">Founder 2</h3>
                  
                  <div class="form-group">
                    <label for="founder2Name">Full Name</label>
                    <input type="text" id="founder2Name" class="form-input" placeholder="Enter founder name" value="Jane Doe">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder2Address">Address</label>
                    <input type="text" id="founder2Address" class="form-input" placeholder="Enter address" value="789 Innovation Avenue, San Francisco, CA 94107">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder2Email">Email Address</label>
                    <input type="email" id="founder2Email" class="form-input" placeholder="Enter email address" value="jane@example.com">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder2Equity">
                      Equity Percentage
                      <span class="tooltip-icon">?
                        <span class="tooltip-content">The percentage of ownership in the company. Total across all founders must equal 100%.</span>
                      </span>
                    </label>
                    <input type="number" id="founder2Equity" class="form-input equity-input" placeholder="Enter percentage" value="50" min="1" max="100">
                    <div class="form-helper">Percentage of ownership in the company</div>
                    <div class="equity-warning" id="founder2EquityWarning">Equity percentages across all founders must equal 100%</div>
                  </div>
                  
                  <div class="form-group">
                    <label for="founder2Role">Role / Position</label>
                    <select id="founder2Role" class="form-input founder-role-select">
                      <option value="CTO" selected>Chief Technology Officer (CTO)</option>
                      <option value="CEO">Chief Executive Officer (CEO)</option>
                      <option value="CFO">Chief Financial Officer (CFO)</option>
                      <option value="COO">Chief Operating Officer (COO)</option>
                      <option value="CPO">Chief Product Officer (CPO)</option>
                      <option value="CMO">Chief Marketing Officer (CMO)</option>
                      <option value="President">President</option>
                      <option value="Co-Founder">Co-Founder</option>
                      <option value="other">Other (Specify)</option>
                    </select>
                  </div>
                  
                  <div class="form-group" id="founder2CustomRoleGroup" style="display: none;">
                    <label for="founder2CustomRole">Specify Role</label>
                    <input type="text" id="founder2CustomRole" class="form-input" placeholder="Enter custom role">
                  </div>
                  
                  <div class="form-group">
                    <label for="founder2Responsibilities">Key Responsibilities</label>
                    <textarea id="founder2Responsibilities" class="form-input" placeholder="Describe responsibilities">Product development, technology strategy, and engineering team management.</textarea>
                  </div>
                </div>
              </div>
              
              <button type="button" id="addFounderBtn" class="add-founder-btn">
                <span class="add-founder-icon">+</span> Add Another Founder
              </button>
              
              <div class="total-equity-section">
                <div style="font-weight: 500; margin-bottom: 5px;">Total Equity: <span id="totalEquityDisplay">100</span>%</div>
                <div id="totalEquityWarning" style="color: #e74c3c; font-size: 12px; display: none;">
                  Total equity must equal exactly 100%. Please adjust the equity percentages.
                </div>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-prev" data-prev="company-tab">Previous: Company Info</button>
              <button type="button" class="btn btn-next" data-next="equity-tab">Next: Equity & Vesting</button>
            </div>
          </div>
          
          <!-- Equity & Vesting Section -->
          <div id="equity-tab" class="tab-content">
            <div class="form-section">
              <h2 class="form-section-title">Equity & Vesting</h2>
              
              <div class="form-group">
                <label for="equityForm">
                  Equity Form
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">The type of ownership interest that founders will hold in the company. Depends on company structure.</span>
                  </span>
                </label>
                <select id="equityForm" class="form-input">
                  <option value="commonStock" selected>Common Stock</option>
                  <option value="preferredStock">Preferred Stock</option>
                  <option value="membershipInterest">Membership Interest (LLC)</option>
                  <option value="future">Future Equity upon Incorporation</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="vestingSchedule">
                  Vesting Schedule
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Vesting determines how founders earn their equity over time. A vesting schedule protects the company if a founder leaves early. With a "cliff," no equity vests until that cliff date is reached.</span>
                  </span>
                </label>
                <select id="vestingSchedule" class="form-input">
                  <option value="none">No Vesting (Fully Vested)</option>
                  <option value="standard" selected>Standard 4-Year Vesting with 1-Year Cliff</option>
                  <option value="noCliff">4-Year Vesting without Cliff</option>
                  <option value="fastTrack">3-Year Vesting with 1-Year Cliff</option>
                  <option value="custom">Custom Schedule</option>
                </select>
                
                <div class="info-message" id="vestingInfo">
                  <strong>Standard 4-Year Vesting with 1-Year Cliff:</strong> No equity vests for the first year ("cliff period"). After 1 year, 25% vests immediately, then the remaining 75% vests in equal monthly installments over the next 3 years.
                </div>
              </div>
              
              <div class="form-group" id="customVestingGroup" style="display: none;">
                <label for="customVestingDescription">
                  Custom Vesting Schedule
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Describe your custom vesting schedule in detail, including timeframes and any special conditions.</span>
                  </span>
                </label>
                <textarea id="customVestingDescription" class="form-input" placeholder="Describe the custom vesting schedule"></textarea>
              </div>
              
              <div class="form-group">
                <label for="acceleratedVesting">
                  Accelerated Vesting
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Determines if unvested equity vests early upon certain triggering events. Single Trigger means the event itself causes acceleration (e.g., company acquisition). Double Trigger requires two events (e.g., acquisition followed by founder termination).</span>
                  </span>
                </label>
                <select id="acceleratedVesting" class="form-input">
                  <option value="none">No Acceleration</option>
                  <option value="singleTrigger" selected>Single Trigger (Change of Control)</option>
                  <option value="doubleTrigger">Double Trigger (Change of Control + Termination)</option>
                  <option value="custom">Custom Acceleration</option>
                </select>
                
                <div class="info-message" id="accelerationInfo">
                  <strong>Single Trigger:</strong> All unvested equity immediately vests upon a change of control event (such as acquisition or merger).
                </div>
              </div>
              
              <div class="form-group" id="customAccelerationGroup" style="display: none;">
                <label for="customAccelerationDescription">Custom Acceleration Terms</label>
                <textarea id="customAccelerationDescription" class="form-input" placeholder="Describe the custom acceleration terms"></textarea>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-prev" data-prev="founders-tab">Previous: Founders</button>
              <button type="button" class="btn btn-next" data-next="roles-tab">Next: Roles & Terms</button>
            </div>
          </div>
          
          <!-- Roles & Commitment Section -->
          <div id="roles-tab" class="tab-content">
            <div class="form-section">
              <h2 class="form-section-title">Roles & Commitment Terms</h2>
              
              <div class="form-group">
                <label for="decisionMaking">
                  Decision Making Structure
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Defines how day-to-day company decisions will be made among founders.</span>
                  </span>
                </label>
                <select id="decisionMaking" class="form-input">
                  <option value="majority" selected>Majority Vote (One Vote Per Founder)</option>
                  <option value="unanimous">Unanimous Agreement</option>
                  <option value="weighted">Weighted by Equity Percentage</option>
                  <option value="designated">Designated Decision Maker</option>
                  <option value="custom">Custom Structure</option>
                </select>
              </div>
              
              <div class="form-group" id="designatedDecisionMakerGroup" style="display: none;">
                <label for="designatedDecisionMaker">
                  Designated Decision Maker
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Select the founder who will have primary decision-making authority for day-to-day company operations.</span>
                  </span>
                </label>
                <select id="designatedDecisionMaker" class="form-input">
                  <option value="founder1" selected>John Smith</option>
                  <option value="founder2">Jane Doe</option>
                </select>
              </div>
              
              <div class="form-group" id="customDecisionGroup" style="display: none;">
                <label for="customDecisionDescription">Custom Decision Making Structure</label>
                <textarea id="customDecisionDescription" class="form-input" placeholder="Describe the custom decision making structure"></textarea>
              </div>
              
              <div class="form-group">
                <label for="timeCommitment">
                  Time Commitment
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Specifies how much time each founder is expected to commit to the company.</span>
                  </span>
                </label>
                <select id="timeCommitment" class="form-input">
                  <option value="fullTime" selected>Full-Time (40+ hours/week)</option>
                  <option value="partTime">Part-Time (Specified Hours)</option>
                  <option value="flexible">Flexible Arrangement</option>
                  <option value="custom">Custom Time Commitment</option>
                </select>
              </div>
              
              <div class="form-group" id="customTimeGroup" style="display: none;">
                <label for="customTimeDescription">Custom Time Commitment</label>
                <textarea id="customTimeDescription" class="form-input" placeholder="Describe the custom time commitment"></textarea>
              </div>
              
              <div class="form-group">
                <label for="salariesCompensation">
                  Initial Salaries/Compensation
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">How founders will be compensated financially in the early stages of the company.</span>
                  </span>
                </label>
                <select id="salariesCompensation" class="form-input">
                  <option value="none" selected>No Initial Salary</option>
                  <option value="equal">Equal Salaries</option>
                  <option value="proportional">Proportional to Contribution</option>
                  <option value="role">Based on Role/Market Rate</option>
                  <option value="custom">Custom Compensation Plan</option>
                </select>
              </div>
              
              <div class="form-group" id="customSalaryGroup" style="display: none;">
                <label for="customSalaryDescription">Custom Compensation Details</label>
                <textarea id="customSalaryDescription" class="form-input" placeholder="Describe the custom compensation details"></textarea>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-prev" data-prev="equity-tab">Previous: Equity & Vesting</button>
              <button type="button" class="btn btn-next" data-next="legal-tab">Next: Legal Provisions</button>
            </div>
          </div>
          
          <!-- Legal Provisions Section (Combined IP, Covenants, Exit, Additional) -->
          <div id="legal-tab" class="tab-content">
            <div class="form-section">
              <h2 class="form-section-title">Intellectual Property</h2>
              
              <div class="form-group">
                <label for="ipAssignment">
                  IP Assignment
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Determines how intellectual property created by founders is assigned or licensed to the company.</span>
                  </span>
                </label>
                <select id="ipAssignment" class="form-input">
                  <option value="full" selected>Full Assignment to Company</option>
                  <option value="limited">Limited Assignment (Specified IP Only)</option>
                  <option value="license">License to Company (Founder Retains Ownership)</option>
                  <option value="custom">Custom IP Arrangement</option>
                </select>
              </div>
              
              <div class="form-group" id="customIpGroup" style="display: none;">
                <label for="customIpDescription">Custom IP Arrangement</label>
                <textarea id="customIpDescription" class="form-input" placeholder="Describe the custom IP arrangement"></textarea>
              </div>
              
              <div class="form-group">
                <label for="priorIp">
                  Prior IP Exclusions
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Intellectual property developed by founders before joining the company that should be excluded from assignment to the company.</span>
                  </span>
                </label>
                <select id="priorIp" class="form-input">
                  <option value="none" selected>No Prior IP Exclusions</option>
                  <option value="specified">Specified Prior IP Exclusions</option>
                </select>
              </div>
              
              <div class="form-group" id="priorIpDetailsGroup" style="display: none;">
                <label for="priorIpDetails">Prior IP Details</label>
                <textarea id="priorIpDetails" class="form-input" placeholder="Describe any prior IP that is excluded from assignment to the company"></textarea>
              </div>
            </div>
            
            <div class="form-section">
              <h2 class="form-section-title">Restrictive Covenants</h2>
              
              <div class="form-group">
                <label for="nonCompete">
                  Non-Compete Provision
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Restricts founders from working with competitors during and after their involvement with the company. Note that non-compete provisions may have limited enforceability in some states, particularly California.</span>
                  </span>
                </label>
                <select id="nonCompete" class="form-input">
                  <option value="none">No Non-Compete</option>
                  <option value="limited" selected>Limited Non-Compete (1 Year, Geographic Restrictions)</option>
                  <option value="extensive">Extensive Non-Compete (2+ Years, Broader Restrictions)</option>
                  <option value="custom">Custom Non-Compete</option>
                </select>
                <div id="nonCompeteWarning" class="warning-message" style="display: none;">Note: Non-compete provisions have limited enforceability in some states. In California, they are generally unenforceable except in very limited circumstances like business sales.</div>
              </div>
              
              <div class="form-group" id="nonCompeteDetailsGroup">
                <label for="nonCompeteDetails">Non-Compete Details</label>
                <textarea id="nonCompeteDetails" class="form-input" placeholder="Specify non-compete terms">During the term of their involvement with the Company and for a period of one (1) year following separation, Founders shall not directly or indirectly engage in a business that competes with the Company within the same geographic regions where the Company operates.</textarea>
              </div>
              
              <div class="form-group">
                <label for="confidentiality">
                  Confidentiality Provision
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Defines how founders must protect company confidential information during and after their involvement.</span>
                  </span>
                </label>
                <select id="confidentiality" class="form-input">
                  <option value="standard" selected>Standard Confidentiality</option>
                  <option value="extensive">Extensive Confidentiality</option>
                  <option value="limited">Limited Confidentiality</option>
                  <option value="custom">Custom Confidentiality</option>
                </select>
              </div>
              
              <div class="form-group" id="confidentialityDetailsGroup" style="display: none;">
                <label for="confidentialityDetails">Confidentiality Details</label>
                <textarea id="confidentialityDetails" class="form-input" placeholder="Specify confidentiality terms"></textarea>
              </div>
            </div>
            
            <div class="form-section">
              <h2 class="form-section-title">Exit & Termination</h2>
              
              <div class="form-group">
                <label for="voluntaryExit">
                  Voluntary Exit
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">What happens to a founder's equity when they voluntarily leave the company.</span>
                  </span>
                </label>
                <select id="voluntaryExit" class="form-input">
                  <option value="stockRetention" selected>Retain Vested Stock Only</option>
                  <option value="companyRepurchase">Company Option to Repurchase</option>
                  <option value="foundersRepurchase">Other Founders Option to Purchase</option>
                  <option value="fullForfeiture">Full Forfeiture of Equity</option>
                  <option value="custom">Custom Exit Terms</option>
                </select>
              </div>
              
              <div class="form-group" id="customExitGroup" style="display: none;">
                <label for="customExitDescription">Custom Exit Terms</label>
                <textarea id="customExitDescription" class="form-input" placeholder="Describe the custom exit terms"></textarea>
              </div>
              
              <div class="form-group">
                <label for="founderTermination">
                  Founder Termination
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Process for terminating a founder and what happens to their equity in that event.</span>
                  </span>
                </label>
                <select id="founderTermination" class="form-input">
                  <option value="majority" selected>By Majority of Other Founders</option>
                  <option value="supermajority">By Supermajority (e.g., 2/3) of Other Founders</option>
                  <option value="unanimous">By Unanimous Vote of Other Founders</option>
                  <option value="board">By Board Decision</option>
                  <option value="custom">Custom Termination Process</option>
                </select>
              </div>
              
              <div class="form-group" id="customTerminationGroup" style="display: none;">
                <label for="customTerminationDescription">Custom Termination Process</label>
                <textarea id="customTerminationDescription" class="form-input" placeholder="Describe the custom termination process"></textarea>
              </div>
              
              <div class="form-group">
                <label for="disputeResolution">
                  Dispute Resolution
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">How conflicts between founders will be resolved, whether through mediation, arbitration, or courts.</span>
                  </span>
                </label>
                <select id="disputeResolution" class="form-input">
                  <option value="mediation" selected>Mediation First, Then Binding Arbitration</option>
                  <option value="arbitration">Binding Arbitration</option>
                  <option value="courts">Courts Only</option>
                  <option value="custom">Custom Dispute Resolution</option>
                </select>
              </div>
              
              <div class="form-group" id="customDisputeGroup" style="display: none;">
                <label for="customDisputeDescription">Custom Dispute Resolution</label>
                <textarea id="customDisputeDescription" class="form-input" placeholder="Describe the custom dispute resolution process"></textarea>
              </div>
            </div>
            
            <div class="form-section">
              <h2 class="form-section-title">Additional Provisions</h2>
              
              <div class="form-group">
                <label for="additionalProvisions">
                  Other Additional Provisions
                  <span class="tooltip-icon">?
                    <span class="tooltip-content">Any other terms or conditions not covered in previous sections that should be included in the agreement.</span>
                  </span>
                </label>
                <textarea id="additionalProvisions" class="form-input" placeholder="Enter any additional provisions">1. The Company will reimburse reasonable business expenses incurred by the Founders.
2. Each Founder agrees to comply with all applicable laws and regulations.
3. This Agreement may only be amended with the written consent of all Founders.
4. This Agreement constitutes the entire understanding among the Founders regarding the subject matter hereof.</textarea>
              </div>
            </div>
            
            <div class="tab-navigation">
              <button type="button" class="btn btn-prev" data-prev="roles-tab">Previous: Roles & Terms</button>
              <div></div>
            </div>
            
            <a href="#" class="btn-consult" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/sergei-tokmakov/30-minute-zoom-meeting'});return false;">
              Schedule Legal Consultation
            </a>
          </div>
        </form>
      </div>
      
      <!-- Preview Container -->
      <div class="preview-container">
        <div class="preview-header">
          <div class="preview-title">Agreement Preview</div>
          <div class="preview-note">Updates as you complete the form</div>
        </div>
        
        <div class="preview-box">
          <div class="document-template" id="agreementPreview">
            <!-- Document content will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Libraries for DOCX download -->
  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- Calendly Integration -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('foundersForm');
      const preview = document.getElementById('agreementPreview');
      const copyBtn = document.getElementById('globalCopyBtn');
      const copyMessage = document.getElementById('globalCopyMessage');
      const downloadBtn = document.getElementById('globalDownloadBtn');
      const previewBox = document.querySelector('.preview-box');
      const addFounderBtn = document.getElementById('addFounderBtn');
      const foundersContainer = document.getElementById('foundersContainer');
      const totalEquityDisplay = document.getElementById('totalEquityDisplay');
      const totalEquityWarning = document.getElementById('totalEquityWarning');
      const scrollLeft = document.getElementById('scrollLeft');
      const scrollRight = document.getElementById('scrollRight');
      const tabsContainer = document.querySelector('.tabs-container');
      
      // Tab scroll functionality
      scrollLeft.addEventListener('click', () => {
        tabsContainer.scrollBy({ left: -200, behavior: 'smooth' });
      });
      
      scrollRight.addEventListener('click', () => {
        tabsContainer.scrollBy({ left: 200, behavior: 'smooth' });
      });
      
      // Current date for agreement
      const today = new Date();
      document.getElementById('agreementDate').value = today.toISOString().split('T')[0];
      
      // Set up incorporation date warning
      const incorporationDateInput = document.getElementById('incorporationDate');
      incorporationDateInput.addEventListener('change', function() {
        checkFutureDate(this.value);
      });
      
      function checkFutureDate(dateValue) {
        const warningElement = document.getElementById('futureDateWarning');
        if (!dateValue) return;
        
        const selectedDate = new Date(dateValue);
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1); // Set to tomorrow to avoid timezone issues
        
        if (selectedDate >= tomorrow) {
          warningElement.style.display = 'block';
        } else {
          warningElement.style.display = 'none';
        }
      }
      
      // Setup California law warning
      const governingLawSelect = document.getElementById('governingLaw');
      governingLawSelect.addEventListener('change', function() {
        const warningElement = document.getElementById('californiaLawWarning');
        if (this.value === 'california') {
          warningElement.style.display = 'block';
        } else {
          warningElement.style.display = 'none';
        }
      });
      
      // Setup non-compete warning based on state selection
      function updateNonCompeteWarning() {
        const governingLaw = document.getElementById('governingLaw').value;
        const nonCompete = document.getElementById('nonCompete').value;
        const warningElement = document.getElementById('nonCompeteWarning');
        
        if (nonCompete !== 'none' && (governingLaw === 'california' || governingLaw === 'north-dakota' || governingLaw === 'oklahoma')) {
          warningElement.style.display = 'block';
        } else {
          warningElement.style.display = 'none';
        }
      }
      
      // Add listeners for non-compete warning
      document.getElementById('governingLaw').addEventListener('change', updateNonCompeteWarning);
      document.getElementById('nonCompete').addEventListener('change', updateNonCompeteWarning);
      
      // Initial check for non-compete warning
      updateNonCompeteWarning();
      
      // Update vesting info text based on selection
      const vestingSelect = document.getElementById('vestingSchedule');
      vestingSelect.addEventListener('change', function() {
        const infoElement = document.getElementById('vestingInfo');
        switch(this.value) {
          case 'none':
            infoElement.innerHTML = '<strong>No Vesting:</strong> All equity is fully vested from the start. Founders own their full equity stake immediately with no risk of forfeiture if they leave.';
            break;
          case 'standard':
            infoElement.innerHTML = '<strong>Standard 4-Year Vesting with 1-Year Cliff:</strong> No equity vests for the first year ("cliff period"). After 1 year, 25% vests immediately, then the remaining 75% vests in equal monthly installments over the next 3 years.';
            break;
          case 'noCliff':
            infoElement.innerHTML = '<strong>4-Year Vesting without Cliff:</strong> Equity vests in equal monthly installments over 4 years, starting from month one. No cliff period means founders begin earning equity right away.';
            break;
          case 'fastTrack':
            infoElement.innerHTML = '<strong>3-Year Vesting with 1-Year Cliff:</strong> No equity vests for the first year. After 1 year, 33.33% vests immediately, then the remaining 66.67% vests in equal monthly installments over the next 2 years.';
            break;
          case 'custom':
            infoElement.innerHTML = '<strong>Custom Vesting Schedule:</strong> Please describe your custom vesting arrangement in detail.';
            break;
        }
      });
      
      // Update acceleration info text
      const accelerationSelect = document.getElementById('acceleratedVesting');
      accelerationSelect.addEventListener('change', function() {
        const infoElement = document.getElementById('accelerationInfo');
        switch(this.value) {
          case 'none':
            infoElement.innerHTML = '<strong>No Acceleration:</strong> Vesting continues according to the normal schedule regardless of any change of control or termination events.';
            break;
          case 'singleTrigger':
            infoElement.innerHTML = '<strong>Single Trigger:</strong> All unvested equity immediately vests upon a change of control event (such as acquisition or merger).';
            break;
          case 'doubleTrigger':
            infoElement.innerHTML = '<strong>Double Trigger:</strong> All unvested equity vests only if two events occur: (1) a change of control event AND (2) the founder is terminated without cause or resigns for good reason within a specified period (typically 12 months) after the change of control.';
            break;
          case 'custom':
            infoElement.innerHTML = '<strong>Custom Acceleration:</strong> Please describe your custom acceleration arrangement in detail.';
            break;
        }
      });
      
      // Counter for additional founders
      let founderCount = 2;
      
      // Main Tab Navigation
      const mainTabButtons = document.querySelectorAll('.main-tab-button');
      const tabContents = document.querySelectorAll('.tab-content');
      const nextButtons = document.querySelectorAll('.btn-next');
      const prevButtons = document.querySelectorAll('.btn-prev');
      
      // Update tab function
      function updateTabs(tabId) {
        // Hide all tabs
        tabContents.forEach(tab => {
          tab.classList.remove('active');
        });
        
        // Deactivate all buttons
        mainTabButtons.forEach(button => {
          button.classList.remove('active');
        });
        
        // Show selected tab
        document.getElementById(tabId).classList.add('active');
        
        // Activate button
        document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
        
        // Scroll tab into view if necessary
        const activeTabButton = document.querySelector(`[data-tab="${tabId}"]`);
        if (activeTabButton) {
          activeTabButton.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }
      }
      
      // Setup tab button clicks
      mainTabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const tabId = button.getAttribute('data-tab');
          updateTabs(tabId);
        });
      });
      
      // Next button functionality
      nextButtons.forEach(button => {
        button.addEventListener('click', () => {
          const nextTabId = button.getAttribute('data-next');
          if (nextTabId) {
            updateTabs(nextTabId);
          }
        });
      });
      
      // Previous button functionality
      prevButtons.forEach(button => {
        button.addEventListener('click', () => {
          const prevTabId = button.getAttribute('data-prev');
          if (prevTabId) {
            updateTabs(prevTabId);
          }
        });
      });
      
      // Format date from YYYY-MM-DD to readable format
      function formatDate(dateString) {
        if (!dateString) return today.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
        
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
      }
      
      // Update total equity calculation
      function updateTotalEquity() {
        let total = 0;
        const equityInputs = document.querySelectorAll('.equity-input');
        
        equityInputs.forEach(input => {
          total += parseInt(input.value) || 0;
        });
        
        // Update display
        totalEquityDisplay.textContent = total;
        
        // Show warning if not 100%
        if (total !== 100) {
          totalEquityWarning.style.display = 'block';
          // Also show individual warnings
          equityInputs.forEach(input => {
            const warningId = input.id + 'Warning';
            const warningElement = document.getElementById(warningId);
            if (warningElement) {
              warningElement.style.display = 'block';
            }
          });
          return false;
        } else {
          totalEquityWarning.style.display = 'none';
          // Hide individual warnings
          equityInputs.forEach(input => {
            const warningId = input.id + 'Warning';
            const warningElement = document.getElementById(warningId);
            if (warningElement) {
              warningElement.style.display = 'none';
            }
          });
          return true;
        }
      }
      
      // Add event listeners for equity inputs with automatic balancing
      document.querySelectorAll('.equity-input').forEach(input => {
        input.addEventListener('input', function() {
          // If we have exactly two founders, automatically balance
          const equityInputs = document.querySelectorAll('.equity-input');
          if (equityInputs.length === 2) {
            const otherInput = (this.id === 'founder1Equity') ? 
                               document.getElementById('founder2Equity') : 
                               document.getElementById('founder1Equity');
            
            // Calculate what the other founder should have
            const thisValue = parseInt(this.value) || 0;
            otherInput.value = 100 - thisValue;
          }
          
          updateTotalEquity();
        });
      });
      
      // Initial equity calculation
      updateTotalEquity();
      
      // Handle role selection change
      document.querySelectorAll('.founder-role-select').forEach(select => {
        select.addEventListener('change', function() {
          const founderId = this.id.match(/founder(\d+)Role/)[1];
          const customRoleGroup = document.getElementById(`founder${founderId}CustomRoleGroup`);
          
          if (this.value === 'other') {
            customRoleGroup.style.display = 'block';
          } else {
            customRoleGroup.style.display = 'none';
          }
          
          updatePreview();
        });
      });
      
      // Handle designated decision maker selection
      document.getElementById('decisionMaking').addEventListener('change', function() {
        const designatedGroup = document.getElementById('designatedDecisionMakerGroup');
        const customGroup = document.getElementById('customDecisionGroup');
        
        if (this.value === 'designated') {
          designatedGroup.style.display = 'block';
          customGroup.style.display = 'none';
        } else if (this.value === 'custom') {
          designatedGroup.style.display = 'none';
          customGroup.style.display = 'block';
        } else {
          designatedGroup.style.display = 'none';
          customGroup.style.display = 'none';
        }
        
        updatePreview();
      });
      
      // Update designated decision maker dropdown options when founders change
      function updateDesignatedDecisionMakerOptions() {
        const select = document.getElementById('designatedDecisionMaker');
        select.innerHTML = ''; // Clear existing options
        
        let founderNumber = 1;
        let founderInput = document.getElementById(`founder${founderNumber}Name`);
        
        while (founderInput) {
          const name = founderInput.value || `Founder ${founderNumber}`;
          const option = document.createElement('option');
          option.value = `founder${founderNumber}`;
          option.textContent = name;
          select.appendChild(option);
          
          founderNumber++;
          founderInput = document.getElementById(`founder${founderNumber}Name`);
        }
      }
      
      // Add another founder
      addFounderBtn.addEventListener('click', function() {
        founderCount++;
        
        const newFounderSection = document.createElement('div');
        newFounderSection.className = 'founder-section';
        newFounderSection.id = `founder${founderCount}Section`;
        newFounderSection.innerHTML = `
          <h3 style="font-size: 16px; color: var(--secondary-color); margin-bottom: 10px;">Founder ${founderCount}</h3>
          
          <div class="form-group">
            <label for="founder${founderCount}Name">Full Name</label>
            <input type="text" id="founder${founderCount}Name" class="form-input" placeholder="Enter founder name" value="">
          </div>
          
          <div class="form-group">
            <label for="founder${founderCount}Address">Address</label>
            <input type="text" id="founder${founderCount}Address" class="form-input" placeholder="Enter address" value="">
          </div>
          
          <div class="form-group">
            <label for="founder${founderCount}Email">Email Address</label>
            <input type="email" id="founder${founderCount}Email" class="form-input" placeholder="Enter email address" value="">
          </div>
          
          <div class="form-group">
            <label for="founder${founderCount}Equity">
              Equity Percentage
              <span class="tooltip-icon">?
                <span class="tooltip-content">The percentage of ownership in the company. Total across all founders must equal 100%.</span>
              </span>
            </label>
            <input type="number" id="founder${founderCount}Equity" class="form-input equity-input" placeholder="Enter percentage" value="" min="1" max="100">
            <div class="form-helper">Percentage of ownership in the company</div>
            <div class="equity-warning" id="founder${founderCount}EquityWarning">Equity percentages across all founders must equal 100%</div>
          </div>
          
          <div class="form-group">
            <label for="founder${founderCount}Role">Role / Position</label>
            <select id="founder${founderCount}Role" class="form-input founder-role-select">
              <option value="Co-Founder" selected>Co-Founder</option>
              <option value="CEO">Chief Executive Officer (CEO)</option>
              <option value="CTO">Chief Technology Officer (CTO)</option>
              <option value="CFO">Chief Financial Officer (CFO)</option>
              <option value="COO">Chief Operating Officer (COO)</option>
              <option value="CPO">Chief Product Officer (CPO)</option>
              <option value="CMO">Chief Marketing Officer (CMO)</option>
              <option value="President">President</option>
              <option value="other">Other (Specify)</option>
            </select>
          </div>
          
          <div class="form-group" id="founder${founderCount}CustomRoleGroup" style="display: none;">
            <label for="founder${founderCount}CustomRole">Specify Role</label>
            <input type="text" id="founder${founderCount}CustomRole" class="form-input" placeholder="Enter custom role">
          </div>
          
          <div class="form-group">
            <label for="founder${founderCount}Responsibilities">Key Responsibilities</label>
            <textarea id="founder${founderCount}Responsibilities" class="form-input" placeholder="Describe responsibilities"></textarea>
          </div>
          
          <div style="text-align: right; margin-bottom: 20px;">
            <button type="button" class="btn btn-reset remove-founder-btn" data-founder="${founderCount}">Remove Founder</button>
          </div>
        `;
        
        foundersContainer.appendChild(newFounderSection);
        
        // Add event listeners to the new founder's inputs
        newFounderSection.querySelectorAll('.form-input').forEach(input => {
          input.addEventListener('input', function() {
            clearHighlights();
            updatePreview(this.id);
            copyMessage.style.display = 'none';
          });
        });
        
        // Add equity input event listener
        const newEquityInput = newFounderSection.querySelector('.equity-input');
        newEquityInput.addEventListener('input', function() {
          // For more than 2 founders, we don't auto-balance
          updateTotalEquity();
        });
        
        // Add event listener for role selector
        const roleSelect = newFounderSection.querySelector('.founder-role-select');
        roleSelect.addEventListener('change', function() {
          const founderId = this.id.match(/founder(\d+)Role/)[1];
          const customRoleGroup = document.getElementById(`founder${founderId}CustomRoleGroup`);
          
          if (this.value === 'other') {
            customRoleGroup.style.display = 'block';
          } else {
            customRoleGroup.style.display = 'none';
          }
          
          updatePreview();
        });
        
        // Add event listener to remove button
        newFounderSection.querySelector('.remove-founder-btn').addEventListener('click', function() {
          const founderId = this.getAttribute('data-founder');
          const founderSection = document.getElementById(`founder${founderId}Section`);
          if (founderSection) {
            founderSection.remove();
            // Adjust equity for 2 founders if needed
            const remainingEquityInputs = document.querySelectorAll('.equity-input');
            if (remainingEquityInputs.length === 2) {
              // Reset to 50/50 split for simplicity when going back to 2 founders
              remainingEquityInputs[0].value = 50;
              remainingEquityInputs[1].value = 50;
            }
            updateTotalEquity();
            updateDesignatedDecisionMakerOptions();
            updatePreview();
          }
        });
        
        // Update equity percentages
        updateEquityPercentages();
        
        // Update the total equity calculation
        updateTotalEquity();
        
        // Update dropdown of designated decision maker
        updateDesignatedDecisionMakerOptions();
        
        // Update preview
        updatePreview();
      });
      
      // Update equity percentages based on number of founders
      function updateEquityPercentages() {
        const founderSections = document.querySelectorAll('.founder-section');
        const equalPercentage = Math.floor(100 / founderSections.length);
        let remainder = 100 - (equalPercentage * founderSections.length);
        
        founderSections.forEach((section, index) => {
          const equityInput = section.querySelector('input[id$="Equity"]');
          if (equityInput && equityInput.value === '') {
            let percentage = equalPercentage;
            if (index === 0 && remainder > 0) {
              percentage += remainder;
            }
            equityInput.value = percentage;
          }
        });
        
        // Update the total equity calculation
        updateTotalEquity();
      }
      
      // Initialize preview
      updatePreview();
      updateDesignatedDecisionMakerOptions();
      
      // Track currently highlighted elements
      let highlightedElements = [];
      let highlightTimeout;
      
      // Update preview when form inputs change
      form.addEventListener('input', function(e) {
        clearHighlights();
        updatePreview(e.target.id);
        copyMessage.style.display = 'none';
        
        // Handle special form dependencies
        handleFormDependencies(e.target);
      });
      
      // Handle conditional form elements visibility
      function handleFormDependencies(target) {
        if (!target) return;
        
        const id = target.id;
        const value = target.value;
        
        // Company Information dependencies
        if (id === 'incorporationStatus') {
          document.getElementById('incorporationDateGroup').style.display = value !== 'notIncorporated' ? 'block' : 'none';
        }
        
        if (id === 'governingLaw') {
          document.getElementById('otherStateGroup').style.display = value === 'other' ? 'block' : 'none';
          
          // Update California law warning
          const warningElement = document.getElementById('californiaLawWarning');
          if (value === 'california') {
            warningElement.style.display = 'block';
          } else {
            warningElement.style.display = 'none';
          }
          
          // Update non-compete warning
          updateNonCompeteWarning();
        }
        
        // Founder Role dependencies (for any founder)
        if (id.match(/founder\d+Role/)) {
          const founderId = id.match(/founder(\d+)Role/)[1];
          document.getElementById(`founder${founderId}CustomRoleGroup`).style.display = value === 'other' ? 'block' : 'none';
        }
        
        // Equity & Vesting dependencies
        if (id === 'vestingSchedule') {
          document.getElementById('customVestingGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'acceleratedVesting') {
          document.getElementById('customAccelerationGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        // Roles & Commitment dependencies
        if (id === 'decisionMaking') {
          document.getElementById('designatedDecisionMakerGroup').style.display = value === 'designated' ? 'block' : 'none';
          document.getElementById('customDecisionGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'timeCommitment') {
          document.getElementById('customTimeGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'salariesCompensation') {
          document.getElementById('customSalaryGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        // Intellectual Property dependencies
        if (id === 'ipAssignment') {
          document.getElementById('customIpGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'priorIp') {
          document.getElementById('priorIpDetailsGroup').style.display = value === 'specified' ? 'block' : 'none';
        }
        
        // Restrictive Covenants dependencies
        if (id === 'nonCompete') {
          document.getElementById('nonCompeteDetailsGroup').style.display = value === 'none' ? 'none' : 'block';
          
          // Clear and update non-compete details based on selection
          const nonCompeteDetails = document.getElementById('nonCompeteDetails');
          if (value === 'limited') {
            nonCompeteDetails.value = 'During the term of their involvement with the Company and for a period of one (1) year following separation, Founders shall not directly or indirectly engage in a business that competes with the Company within the same geographic regions where the Company operates.';
          } else if (value === 'extensive') {
            nonCompeteDetails.value = 'During the term of their involvement with the Company and for a period of two (2) years following separation, Founders shall not directly or indirectly engage in, own, manage, operate, join, control, finance, invest in, or participate in the ownership, management, operation, or control of, or be connected as an officer, director, employee, partner, principal, agent, representative, consultant, or otherwise with, any business that competes with or engages in business similar to the Company, regardless of geographic location.';
          } else if (value === 'custom') {
            if (nonCompeteDetails.value.includes('During the term of their involvement')) {
              nonCompeteDetails.value = '';
            }
          }
          
          // Update non-compete warning
          updateNonCompeteWarning();
        }
        
        if (id === 'confidentiality') {
          document.getElementById('confidentialityDetailsGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        // Exit & Termination dependencies
        if (id === 'voluntaryExit') {
          document.getElementById('customExitGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'founderTermination') {
          document.getElementById('customTerminationGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
        
        if (id === 'disputeResolution') {
          document.getElementById('customDisputeGroup').style.display = value === 'custom' ? 'block' : 'none';
        }
      }
      
      // Initialize form dependencies
      function initFormDependencies() {
        // Call with each select element to set initial visibility
        handleFormDependencies(document.getElementById('incorporationStatus'));
        handleFormDependencies(document.getElementById('governingLaw'));
        
        // Initialize founder role dependencies
        document.querySelectorAll('.founder-role-select').forEach(select => {
          handleFormDependencies(select);
        });
        
        handleFormDependencies(document.getElementById('vestingSchedule'));
        handleFormDependencies(document.getElementById('acceleratedVesting'));
        handleFormDependencies(document.getElementById('decisionMaking'));
        handleFormDependencies(document.getElementById('timeCommitment'));
        handleFormDependencies(document.getElementById('salariesCompensation'));
        handleFormDependencies(document.getElementById('ipAssignment'));
        handleFormDependencies(document.getElementById('priorIp'));
        handleFormDependencies(document.getElementById('nonCompete'));
        handleFormDependencies(document.getElementById('confidentiality'));
        handleFormDependencies(document.getElementById('voluntaryExit'));
        handleFormDependencies(document.getElementById('founderTermination'));
        handleFormDependencies(document.getElementById('disputeResolution'));
      }
      
      // Initialize dependencies
      initFormDependencies();
      
      // Fire events to initialize info messages
      const vestingChange = new Event('change');
      document.getElementById('vestingSchedule').dispatchEvent(vestingChange);
      
      const accelerationChange = new Event('change');
      document.getElementById('acceleratedVesting').dispatchEvent(accelerationChange);
      
      // Handle form reset
      form.addEventListener('reset', function() {
        // Give time for the form to reset before updating preview
        setTimeout(() => {
          // Remove additional founders
          const additionalFounders = document.querySelectorAll('.founder-section[id^="founder"]:not(#founder1Section):not(#founder2Section)');
          additionalFounders.forEach(section => {
            section.remove();
          });
          
          // Reset to original founder count
          founderCount = 2;
          
          // Reinitialize dependencies
          initFormDependencies();
          
          // Update designated decision maker dropdown
          updateDesignatedDecisionMakerOptions();
          
          // Fire events to initialize info messages
          document.getElementById('vestingSchedule').dispatchEvent(vestingChange);
          document.getElementById('acceleratedVesting').dispatchEvent(accelerationChange);
          
          clearHighlights();
          updateTotalEquity();
          updatePreview();
          copyMessage.style.display = 'none';
        }, 10);
      });
      
      // Handle copy button click (global copy button)
      copyBtn.addEventListener('click', function() {
        const documentText = preview.innerText;
        
        // Create a temporary textarea element
        const textArea = document.createElement('textarea');
        textArea.value = documentText;
        textArea.style.position = 'absolute';
        textArea.style.left = '-999999px';
        document.body.appendChild(textArea);
        
        // Select and copy the text
        textArea.select();
        document.execCommand('copy');
        
        // Remove the temporary element
        document.body.removeChild(textArea);
        
        // Show success message
        copyMessage.style.display = 'inline-block';
        
        // Hide message after 3 seconds
        setTimeout(() => {
          copyMessage.style.display = 'none';
        }, 3000);
      });
      
      // Handle download button click (global download button)
      downloadBtn.addEventListener('click', function() {
        try {
          // First check if equity adds up to 100%
          if (!updateTotalEquity()) {
            alert('Please ensure the total equity equals 100% before downloading the agreement.');
            return;
          }
          
          // Access docx library
          const docx = window.docx;
          if (!docx) {
            throw new Error("DOCX library not loaded");
          }
          
          // Get company name for filename
          const companyName = document.getElementById('companyName').value || 'Company';
          const filename = `${companyName.replace(/[^a-z0-9]/gi, '_')}_Founders_Agreement.docx`;
          
          // Create document sections from preview content
          const sections = [];
          
          // Document title (single, centered)
          const titleParagraph = new docx.Paragraph({
            alignment: docx.AlignmentType.CENTER,
            spacing: {
              before: 300,
              after: 300
            },
            children: [
              new docx.TextRun({
                text: "FOUNDERS AGREEMENT",
                bold: true,
                size: 28
              })
            ]
          });
          sections.push(titleParagraph);
          
          // Add spacing after title
          sections.push(new docx.Paragraph({
            text: "",
            spacing: {
              before: 120,
              after: 120
            }
          }));
          
          // Add introduction
          const formattedAgreementDate = formatDate(document.getElementById('agreementDate').value);
          const companyNameText = document.getElementById('companyName').value;
          
          const introText1 = new docx.Paragraph({
            spacing: {
              before: 120,
              after: 120
            },
            text: `This Founders Agreement (the "Agreement") is made and entered into on ${formattedAgreementDate} by and between the undersigned founders (collectively referred to as the "Founders" and individually as a "Founder") of ${companyNameText} (the "Company").`
          });
          sections.push(introText1);
          
          const introText2 = new docx.Paragraph({
            spacing: {
              before: 120,
              after: 120
            },
            text: `WHEREAS, the Founders wish to formalize their business relationship and establish clear rights and responsibilities with respect to the Company;`
          });
          sections.push(introText2);
          
          const introText3 = new docx.Paragraph({
            spacing: {
              before: 120,
              after: 120
            },
            text: `NOW, THEREFORE, in consideration of the mutual covenants and agreements set forth herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:`
          });
          sections.push(introText3);
          
          // Add main sections
          const sectionElements = document.querySelectorAll('.document-section');
          
          sectionElements.forEach(sectionElement => {
            // Get section title
            const titleElement = sectionElement.querySelector('.section-title');
            if (titleElement) {
              // Add section title
              const sectionTitle = new docx.Paragraph({
                spacing: {
                  before: 300,
                  after: 120
                },
                children: [
                  new docx.TextRun({
                    text: titleElement.textContent,
                    bold: true,
                    size: 28
                  })
                ]
              });
              sections.push(sectionTitle);
              
              // Get content paragraphs
              const contentElement = sectionElement.querySelector('.section-content');
              if (contentElement) {
                const paragraphs = contentElement.querySelectorAll('p');
                paragraphs.forEach(p => {
                  // Check if paragraph has a label
                  const label = p.querySelector('.field-label');
                  if (label) {
                    const labelText = label.textContent;
                    const valueText = p.textContent.replace(labelText, '').trim();
                    
                    // Create paragraph with bold label
                    const paragraph = new docx.Paragraph({
                      spacing: {
                        before: 120,
                        after: 120
                      },
                      children: [
                        new docx.TextRun({
                          text: labelText + " ",
                          bold: true
                        }),
                        new docx.TextRun({
                          text: valueText
                        })
                      ]
                    });
                    sections.push(paragraph);
                  } else {
                    // Regular paragraph without label
                    const paragraph = new docx.Paragraph({
                      text: p.textContent,
                      spacing: {
                        before: 120,
                        after: 120
                      }
                    });
                    sections.push(paragraph);
                  }
                });
              }
            }
          });
          
          // Signature block in table format
          const signaturesTitle = new docx.Paragraph({
            spacing: {
              before: 300,
              after: 120
            },
            pageBreakBefore: true,
            children: [
              new docx.TextRun({
                text: "SIGNATURES",
                bold: true,
                size: 28
              })
            ]
          });
          sections.push(signaturesTitle);
          
          // Date text
          const dateParagraph = new docx.Paragraph({
            spacing: {
              before: 200,
              after: 200
            },
            children: [
              new docx.TextRun({
                text: `IN WITNESS WHEREOF, the parties have executed this Founders Agreement on ${formattedAgreementDate}.`
              })
            ]
          });
          sections.push(dateParagraph);
          
          // Get all founders for signature lines
          const founderElements = document.querySelectorAll('.founder-section');
          
          // Create rows of 2 founders each for signatures
          for (let i = 0; i < founderElements.length; i += 2) {
            const founder1 = founderElements[i];
            const founder2 = i + 1 < founderElements.length ? founderElements[i + 1] : null;
            
            // Create a 2-column table row for signatures
            const signatureRows = [];
            
            // Create signature line row
            const signatureLineRow = new docx.TableRow({
              children: [
                new docx.TableCell({
                  width: {
                    size: 50,
                    type: docx.WidthType.PERCENTAGE,
                  },
                  margins: {
                    top: 120,
                    bottom: 0,
                    left: 120,
                    right: 120,
                  },
                  children: [
                    new docx.Paragraph({
                      text: "________________________________",
                      spacing: {
                        before: 300,
                        after: 60,
                      },
                    }),
                  ],
                }),
                new docx.TableCell({
                  width: {
                    size: 50,
                    type: docx.WidthType.PERCENTAGE,
                  },
                  margins: {
                    top: 120,
                    bottom: 0,
                    left: 120,
                    right: 120,
                  },
                  children: founder2 ? [
                    new docx.Paragraph({
                      text: "________________________________",
                      spacing: {
                        before: 300,
                        after: 60,
                      },
                    }),
                  ] : [new docx.Paragraph("")],
                }),
              ],
            });
            signatureRows.push(signatureLineRow);
            
            // Extract founder names
            const founder1Id = founder1.id.match(/founder(\d+)Section/)[1];
            const founder1Name = document.getElementById(`founder${founder1Id}Name`).value || `Founder ${founder1Id}`;
            
            let founder2Name = "";
            if (founder2) {
              const founder2Id = founder2.id.match(/founder(\d+)Section/)[1];
              founder2Name = document.getElementById(`founder${founder2Id}Name`).value || `Founder ${founder2Id}`;
            }
            
            // Create name row
            const nameRow = new docx.TableRow({
              children: [
                new docx.TableCell({
                  width: {
                    size: 50,
                    type: docx.WidthType.PERCENTAGE,
                  },
                  margins: {
                    top: 0,
                    bottom: 120,
                    left: 120,
                    right: 120,
                  },
                  children: [
                    new docx.Paragraph({
                      children: [
                        new docx.TextRun({
                          text: founder1Name,
                          bold: true,
                        }),
                      ],
                      spacing: {
                        before: 60,
                        after: 200,
                      },
                    }),
                  ],
                }),
                new docx.TableCell({
                  width: {
                    size: 50,
                    type: docx.WidthType.PERCENTAGE,
                  },
                  margins: {
                    top: 0,
                    bottom: 120,
                    left: 120,
                    right: 120,
                  },
                  children: founder2 ? [
                    new docx.Paragraph({
                      children: [
                        new docx.TextRun({
                          text: founder2Name,
                          bold: true,
                        }),
                      ],
                      spacing: {
                        before: 60,
                        after: 200,
                      },
                    }),
                  ] : [new docx.Paragraph("")],
                }),
              ],
            });
            signatureRows.push(nameRow);
            
            // Create table for this row of signatures
            const signatureTable = new docx.Table({
              width: {
                size: 100,
                type: docx.WidthType.PERCENTAGE,
              },
              borders: {
                top: { style: docx.BorderStyle.NONE },
                bottom: { style: docx.BorderStyle.NONE },
                left: { style: docx.BorderStyle.NONE },
                right: { style: docx.BorderStyle.NONE },
                insideHorizontal: { style: docx.BorderStyle.NONE },
                insideVertical: { style: docx.BorderStyle.NONE },
              },
              rows: signatureRows,
            });
            
            sections.push(signatureTable);
            
            // Add spacing between founder rows if not the last row
            if (i + 2 < founderElements.length) {
              sections.push(new docx.Paragraph({
                text: "",
                spacing: {
                  before: 120,
                  after: 120,
                },
              }));
            }
          }
          
          // Create document
          const doc = new docx.Document({
            styles: {
              default: {
                document: {
                  run: {
                    size: 11 * 2, // 11pt font size (in half-points)
                    font: "Calibri"
                  },
                  paragraph: {
                    spacing: {
                      line: 240, // 1.0x line spacing
                      before: 0,
                      after: 0,
                      afterAutoSpacing: false,
                      beforeAutoSpacing: false
                    }
                  }
                }
              }
            },
            sections: [{
              properties: {
                page: {
                  margin: {
                    top: 1440, // 1 inch in twips
                    right: 1440,
                    bottom: 1440,
                    left: 1440
                  }
                }
              },
              children: sections
            }]
          });
          
          // Generate and save document
          docx.Packer.toBlob(doc)
            .then(blob => {
              window.saveAs(blob, filename);
            })
            .catch(error => {
              console.error("Error saving DOCX:", error);
              alert("Unable to download. Please try using the copy button instead.");
            });
        } catch (error) {
          console.error("DOCX generation error:", error);
          alert("Unable to download. Please try using the copy button instead.");
        }
      });
      
      // Function to clear highlights
      function clearHighlights() {
        if (highlightTimeout) {
          clearTimeout(highlightTimeout);
        }
        
        highlightedElements.forEach(element => {
          element.classList.remove('highlight');
        });
        highlightedElements = [];
      }
      
      // Function to update the agreement preview
      function updatePreview(changedField = null) {
        // Get company information
        const companyName = document.getElementById('companyName').value;
        const companyAddress = document.getElementById('companyAddress').value;
        const businessPurpose = document.getElementById('businessPurpose').value;
        const incorporationStatusEl = document.getElementById('incorporationStatus');
        const incorporationStatus = incorporationStatusEl.options[incorporationStatusEl.selectedIndex].text;
        const incorporationDate = formatDate(document.getElementById('incorporationDate').value);
        const agreementDate = formatDate(document.getElementById('agreementDate').value);
        
        // Get governing law
        let governingLaw = '';
        if (document.getElementById('governingLaw').value === 'other') {
          governingLaw = document.getElementById('otherState').value;
        } else {
          const governingLawEl = document.getElementById('governingLaw');
          governingLaw = governingLawEl.options[governingLawEl.selectedIndex].text;
        }
        
        // Get founder information
        const founderInfoHtml = getFoundersHtml();
        
        // Get equity and vesting information
        const equityFormEl = document.getElementById('equityForm');
        const equityForm = equityFormEl.options[equityFormEl.selectedIndex].text;
        
        const vestingScheduleEl = document.getElementById('vestingSchedule');
        const vestingSchedule = vestingScheduleEl.options[vestingScheduleEl.selectedIndex].text;
        const customVestingDescription = document.getElementById('customVestingDescription').value;
        
        const acceleratedVestingEl = document.getElementById('acceleratedVesting');
        const acceleratedVesting = acceleratedVestingEl.options[acceleratedVestingEl.selectedIndex].text;
        const customAccelerationDescription = document.getElementById('customAccelerationDescription').value;
        
        // Get roles and commitment information
        const decisionMakingEl = document.getElementById('decisionMaking');
        const decisionMaking = decisionMakingEl.options[decisionMakingEl.selectedIndex].text;
        const customDecisionDescription = document.getElementById('customDecisionDescription').value;
        
        // Get designated decision maker if applicable
        let designatedDecisionMaker = '';
        if (decisionMakingEl.value === 'designated') {
          const designatedDecisionMakerEl = document.getElementById('designatedDecisionMaker');
          if (designatedDecisionMakerEl && designatedDecisionMakerEl.selectedIndex >= 0) {
            designatedDecisionMaker = designatedDecisionMakerEl.options[designatedDecisionMakerEl.selectedIndex].text;
          }
        }
        
        const timeCommitmentEl = document.getElementById('timeCommitment');
        const timeCommitment = timeCommitmentEl.options[timeCommitmentEl.selectedIndex].text;
        const customTimeDescription = document.getElementById('customTimeDescription').value;
        
        const salariesCompensationEl = document.getElementById('salariesCompensation');
        const salariesCompensation = salariesCompensationEl.options[salariesCompensationEl.selectedIndex].text;
        const customSalaryDescription = document.getElementById('customSalaryDescription').value;
        
        // Get IP information
        const ipAssignmentEl = document.getElementById('ipAssignment');
        const ipAssignment = ipAssignmentEl.options[ipAssignmentEl.selectedIndex].text;
        const customIpDescription = document.getElementById('customIpDescription').value;
        
        const priorIpEl = document.getElementById('priorIp');
        const priorIp = priorIpEl.options[priorIpEl.selectedIndex].text;
        const priorIpDetails = document.getElementById('priorIpDetails').value;
        
        // Get restrictive covenants information
        const nonCompeteEl = document.getElementById('nonCompete');
        const nonCompete = nonCompeteEl.options[nonCompeteEl.selectedIndex].text;
        const nonCompeteDetails = document.getElementById('nonCompeteDetails').value;
        
        const confidentialityEl = document.getElementById('confidentiality');
        const confidentiality = confidentialityEl.options[confidentialityEl.selectedIndex].text;
        const confidentialityDetails = document.getElementById('confidentialityDetails').value;
        
        // Get exit and termination information
        const voluntaryExitEl = document.getElementById('voluntaryExit');
        const voluntaryExit = voluntaryExitEl.options[voluntaryExitEl.selectedIndex].text;
        const customExitDescription = document.getElementById('customExitDescription').value;
        
        const founderTerminationEl = document.getElementById('founderTermination');
        const founderTermination = founderTerminationEl.options[founderTerminationEl.selectedIndex].text;
        const customTerminationDescription = document.getElementById('customTerminationDescription').value;
        
        const disputeResolutionEl = document.getElementById('disputeResolution');
        const disputeResolution = disputeResolutionEl.options[disputeResolutionEl.selectedIndex].text;
        const customDisputeDescription = document.getElementById('customDisputeDescription').value;
        
        // Get additional provisions
        const additionalProvisions = document.getElementById('additionalProvisions').value;
        
        // Build the agreement HTML
        let agreementHtml = `
          <div class="document-title">FOUNDERS AGREEMENT</div>
          
          <div class="document-section" id="section-intro">
            <div class="section-content">
              <p>This Founders Agreement (the "Agreement") is made and entered into on ${agreementDate} by and between the undersigned founders (collectively referred to as the "Founders" and individually as a "Founder") of ${companyName} (the "Company").</p>
              
              <p>WHEREAS, the Founders wish to formalize their business relationship and establish clear rights and responsibilities with respect to the Company;</p>
              
              <p>NOW, THEREFORE, in consideration of the mutual covenants and agreements set forth herein, and for other good and valuable consideration, the receipt and sufficiency of which are hereby acknowledged, the parties agree as follows:</p>
            </div>
          </div>
          
          <div class="document-section" id="section-company-info">
            <div class="section-title">1. COMPANY INFORMATION</div>
            <div class="section-content">
              <p><span class="field-label">1.1 Company Name:</span> ${companyName}</p>
              
              <p><span class="field-label">1.2 Principal Place of Business:</span> ${companyAddress}</p>
              
              <p><span class="field-label">1.3 Business Purpose:</span> ${businessPurpose}</p>
              
              <p><span class="field-label">1.4 Incorporation Status:</span> The Company is ${incorporationStatus === 'Not Yet Incorporated' ? 'not yet incorporated but intends to incorporate as a suitable entity in the future' : `incorporated as a ${incorporationStatus} as of ${incorporationDate}`}.</p>
              
              <p><span class="field-label">1.5 Governing Law:</span> This Agreement shall be governed by and construed in accordance with the laws of the State of ${governingLaw}, without giving effect to any choice of law or conflict of law provisions.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-founders">
            <div class="section-title">2. FOUNDERS</div>
            <div class="section-content">
              ${founderInfoHtml}
            </div>
          </div>
          
          <div class="document-section" id="section-equity">
            <div class="section-title">3. EQUITY & VESTING</div>
            <div class="section-content">
              <p><span class="field-label">3.1 Equity Form:</span> Each Founder's equity shall be in the form of ${equityForm}.</p>
              
              <p><span class="field-label">3.2 Vesting Schedule:</span> ${vestingSchedule === 'No Vesting (Fully Vested)' ? 'All equity interests shall be fully vested upon issuance.' : vestingSchedule === 'Custom Schedule' ? customVestingDescription : vestingSchedule === 'Standard 4-Year Vesting with 1-Year Cliff' ? 'The equity interests shall vest over a period of four (4) years, with a one-year cliff. This means that 25% of each Founder\'s equity will vest on the first anniversary of the vesting commencement date, and the remaining 75% will vest in equal monthly installments over the following three (3) years.' : vestingSchedule === '4-Year Vesting without Cliff' ? 'The equity interests shall vest over a period of four (4) years in equal monthly installments, with no cliff period.' : 'The equity interests shall vest over a period of three (3) years, with a one-year cliff. This means that 33.33% of each Founder\'s equity will vest on the first anniversary of the vesting commencement date, and the remaining 66.67% will vest in equal monthly installments over the following two (2) years.'}</p>
              
              <p><span class="field-label">3.3 Accelerated Vesting:</span> ${acceleratedVesting === 'No Acceleration' ? 'There shall be no accelerated vesting of equity under any circumstances.' : acceleratedVesting === 'Custom Acceleration' ? customAccelerationDescription : acceleratedVesting === 'Single Trigger (Change of Control)' ? 'In the event of a Change of Control of the Company (as defined below), all unvested equity interests of each Founder shall immediately vest in full.' : 'In the event of a Change of Control of the Company (as defined below) followed by the termination of a Founder without Cause or resignation for Good Reason within twelve (12) months of such event, all unvested equity interests of such Founder shall immediately vest in full.'}</p>
              
              <p><span class="field-label">3.4 Change of Control Definition:</span> For purposes of this Agreement, a "Change of Control" shall mean: (i) the acquisition of the Company by another entity by means of any transaction or series of related transactions (including, without limitation, any stock transfer, merger, or consolidation); (ii) a sale of all or substantially all of the assets of the Company; or (iii) any other transaction resulting in the effective transfer of the Company's decision-making authority to a third party.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-roles">
            <div class="section-title">4. ROLES & COMMITMENT</div>
            <div class="section-content">
              <p><span class="field-label">4.1 Decision Making:</span> ${decisionMaking === 'Custom Structure' ? customDecisionDescription : decisionMaking === 'Majority Vote (One Vote Per Founder)' ? 'Decisions regarding the Company\'s business shall be made by a majority vote of the Founders, with each Founder having one vote.' : decisionMaking === 'Unanimous Agreement' ? 'Decisions regarding the Company\'s business shall require unanimous agreement of all Founders.' : decisionMaking === 'Weighted by Equity Percentage' ? 'Decisions regarding the Company\'s business shall be made by a vote of the Founders weighted according to their respective equity percentages.' : `Decisions regarding the Company's business shall be made by ${designatedDecisionMaker} as the designated decision maker, after reasonable consultation with the other Founders.`}</p>
              
              <p><span class="field-label">4.2 Time Commitment:</span> ${timeCommitment === 'Custom Time Commitment' ? customTimeDescription : timeCommitment === 'Full-Time (40+ hours/week)' ? 'Each Founder agrees to devote their full business time, attention, and efforts to the Company (defined as at least 40 hours per week).' : timeCommitment === 'Part-Time (Specified Hours)' ? 'Each Founder agrees to devote significant part-time efforts to the Company as specified in their individual role descriptions above.' : 'Each Founder shall devote such time and attention to the business of the Company as mutually agreed upon by the Founders, which may vary based on the needs of the Company and the individual circumstances of each Founder.'}</p>
              
              <p><span class="field-label">4.3 Initial Salaries/Compensation:</span> ${salariesCompensation === 'Custom Compensation Plan' ? customSalaryDescription : salariesCompensation === 'No Initial Salary' ? 'The Founders agree that they will not receive any salary or other monetary compensation until the Company has secured sufficient funding or generated adequate revenue, as determined by decision-making procedures outlined in Section 4.1.' : salariesCompensation === 'Equal Salaries' ? 'The Founders shall receive equal salaries once the Company has secured sufficient funding or generated adequate revenue.' : salariesCompensation === 'Proportional to Contribution' ? 'The Founders shall receive salaries proportional to their respective contributions, as determined through the decision-making process described above.' : 'The Founders shall receive salaries based on their respective roles and market rates for comparable positions, once the Company has secured sufficient funding or generated adequate revenue.'}</p>
            </div>
          </div>
          
          <div class="document-section" id="section-ip">
            <div class="section-title">5. INTELLECTUAL PROPERTY</div>
            <div class="section-content">
              <p><span class="field-label">5.1 IP Assignment:</span> ${ipAssignment === 'Custom IP Arrangement' ? customIpDescription : ipAssignment === 'Full Assignment to Company' ? 'Each Founder hereby irrevocably assigns to the Company all right, title, and interest in and to all intellectual property, including but not limited to inventions, discoveries, designs, developments, improvements, copyrightable materials, trade secrets, and other intellectual property, conceived, developed, or reduced to practice by such Founder, either alone or in conjunction with others, during the term of their relationship with the Company and related to the Company\'s business or using the Company\'s resources.' : ipAssignment === 'Limited Assignment (Specified IP Only)' ? 'Each Founder hereby irrevocably assigns to the Company all right, title, and interest in and to intellectual property directly related to the Company\'s core business as specified in Section 1.3, conceived, developed, or reduced to practice by such Founder during the term of their relationship with the Company and using the Company\'s resources.' : 'Each Founder hereby grants to the Company an exclusive, worldwide, royalty-free, irrevocable license to use all intellectual property conceived, developed, or reduced to practice by such Founder, either alone or in conjunction with others, during the term of their relationship with the Company and related to the Company\'s business, but the Founder shall retain ownership of such intellectual property.'}</p>
              
              <p><span class="field-label">5.2 Prior IP Exclusions:</span> ${priorIp === 'No Prior IP Exclusions' ? 'The Founders represent that they have no prior intellectual property that they wish to exclude from assignment to the Company.' : `The following intellectual property owned by Founders prior to entering into this Agreement is excluded from assignment to the Company: ${priorIpDetails}`}</p>
              
              <p><span class="field-label">5.3 Further Assurances:</span> Each Founder agrees to execute all documents and take all actions as may be reasonably requested by the Company to accomplish the IP assignment and licensing provisions of this Agreement.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-covenants">
            <div class="section-title">6. RESTRICTIVE COVENANTS</div>
            <div class="section-content">
              ${nonCompete === 'No Non-Compete' ? 
                '<p><span class="field-label">6.1 Non-Compete:</span> This Agreement does not include a non-compete provision.</p>' : 
                `<p><span class="field-label">6.1 Non-Compete:</span> ${nonCompeteDetails}</p>`
              }
              
              <p><span class="field-label">6.2 Confidentiality:</span> ${confidentiality === 'Custom Confidentiality' ? confidentialityDetails : confidentiality === 'Standard Confidentiality' ? 'Each Founder agrees to maintain the confidentiality of all non-public information relating to the Company, including but not limited to business plans, financial information, customer data, trade secrets, and proprietary technology. This obligation shall continue during the Founder\'s relationship with the Company and for a period of two (2) years thereafter.' : confidentiality === 'Extensive Confidentiality' ? 'Each Founder agrees to maintain strict confidentiality of all non-public information relating to the Company, including but not limited to business plans, financial information, customer data, trade secrets, proprietary technology, marketing strategies, and any other information not generally known to the public. This obligation shall continue indefinitely, with no expiration date, even after the Founder\'s relationship with the Company has ended.' : 'Each Founder agrees to maintain the confidentiality of specifically designated confidential information relating to the Company\'s core trade secrets and proprietary technology. This obligation shall continue during the Founder\'s relationship with the Company and for a period of one (1) year thereafter.'}</p>
              
              <p><span class="field-label">6.3 Non-Solicitation:</span> Each Founder agrees that during their relationship with the Company and for a period of one (1) year thereafter, they will not directly or indirectly solicit, induce, recruit, or encourage any employee, contractor, or consultant of the Company to leave their position, nor will they solicit any customer, client, or business partner of the Company for the purpose of diminishing or otherwise interfering with the Company's relationship with such parties.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-exit">
            <div class="section-title">7. EXIT & TERMINATION</div>
            <div class="section-content">
              <p><span class="field-label">7.1 Voluntary Exit:</span> ${voluntaryExit === 'Custom Exit Terms' ? customExitDescription : voluntaryExit === 'Retain Vested Stock Only' ? 'In the event that a Founder voluntarily exits the Company, such Founder shall retain only their vested equity as of the date of departure. Any unvested equity shall be forfeited and returned to the Company.' : voluntaryExit === 'Company Repurchase' ? 'In the event that a Founder voluntarily exits the Company, the Company shall have the right, but not the obligation, to repurchase all or a portion of the Founder\'s vested equity at Fair Market Value as determined by an independent valuation.' : voluntaryExit === 'Founders Repurchase' ? 'In the event that a Founder voluntarily exits the Company, the remaining Founders shall have the right, but not the obligation, to purchase all or a portion of the departing Founder\'s vested equity at Fair Market Value as determined by an independent valuation.' : 'In the event that a Founder voluntarily exits the Company, such Founder shall forfeit all equity, whether vested or unvested.'}</p>
              
              <p><span class="field-label">7.2 Founder Termination:</span> ${founderTermination === 'Custom Termination Process' ? customTerminationDescription : founderTermination === 'By Majority of Other Founders' ? 'A Founder may be terminated from their role and duties with the Company upon the affirmative vote of a majority of the other Founders. Upon such termination, the terminated Founder\'s rights to unvested equity shall cease, and the Company shall have the option to repurchase vested equity at Fair Market Value.' : founderTermination === 'By Supermajority (e.g., 2/3) of Other Founders' ? 'A Founder may be terminated from their role and duties with the Company upon the affirmative vote of at least two-thirds (2/3) of the other Founders. Upon such termination, the terminated Founder\'s rights to unvested equity shall cease, and the Company shall have the option to repurchase vested equity at Fair Market Value.' : founderTermination === 'By Unanimous Vote of Other Founders' ? 'A Founder may be terminated from their role and duties with the Company only upon the unanimous vote of all other Founders. Upon such termination, the terminated Founder\'s rights to unvested equity shall cease, and the Company shall have the option to repurchase vested equity at Fair Market Value.' : 'A Founder may be terminated from their role and duties with the Company upon the decision of the Board of Directors. Upon such termination, the terminated Founder\'s rights to unvested equity shall cease, and the Company shall have the option to repurchase vested equity at Fair Market Value.'}</p>
              
              <p><span class="field-label">7.3 Dispute Resolution:</span> ${disputeResolution === 'Custom Dispute Resolution' ? customDisputeDescription : disputeResolution === 'Mediation First, Then Binding Arbitration' ? 'Any dispute arising out of or relating to this Agreement shall first be submitted to confidential mediation in accordance with the rules of a mutually agreeable mediation service. If the dispute is not resolved through mediation within sixty (60) days from the date of submission to mediation, the dispute shall be submitted to binding arbitration in accordance with the rules of the American Arbitration Association. The costs of mediation and arbitration shall be shared equally by the parties involved in the dispute.' : disputeResolution === 'Binding Arbitration' ? 'Any dispute arising out of or relating to this Agreement shall be submitted to binding arbitration in accordance with the rules of the American Arbitration Association. The costs of arbitration shall be shared equally by the parties involved in the dispute.' : `Any dispute arising out of or relating to this Agreement shall be resolved exclusively through the federal and state courts located in the State of ${governingLaw}.`}</p>
              
              <p><span class="field-label">7.4 Death or Disability:</span> In the event of a Founder's death or disability (defined as the inability to perform their duties for a period of 180 consecutive days), such Founder or their estate shall retain all vested equity as of the date of death or disability determination. Any unvested equity shall be forfeited unless otherwise decided by the remaining Founders or Board of Directors.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-additional">
            <div class="section-title">8. ADDITIONAL PROVISIONS</div>
            <div class="section-content">
              <p><span class="field-label">8.1 Additional Provisions:</span></p>
              <p>${additionalProvisions}</p>
              
              <p><span class="field-label">8.2 Entire Agreement:</span> This Agreement constitutes the entire agreement among the Founders regarding the subject matter hereof and supersedes all prior agreements and understandings, whether written or oral.</p>
              
              <p><span class="field-label">8.3 Amendment:</span> This Agreement may be amended only by a written instrument executed by all Founders.</p>
              
              <p><span class="field-label">8.4 Severability:</span> If any provision of this Agreement is held to be invalid or unenforceable, such provision shall be struck, and the remaining provisions shall be enforced to the fullest extent possible.</p>
              
              <p><span class="field-label">8.5 Notices:</span> All notices required or permitted under this Agreement shall be in writing and shall be delivered to the addresses set forth above or to such other address as may be specified by any party in writing.</p>
            </div>
          </div>
          
          <div class="document-section" id="section-signatures">
            <div class="section-title">9. SIGNATURES</div>
            <div class="section-content">
              <p>IN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.</p>
              
              <div class="signature-row">
                ${getFounderSignatureBlocks()}
              </div>
            </div>
          </div>
        `;
        
        // Update the preview with the agreement HTML
        preview.innerHTML = agreementHtml;
        
        // If a specific field was changed, highlight the relevant section
        if (changedField) {
          highlightChangedContent(changedField);
        }
      }
      
      // Get HTML for all founders' information
      function getFoundersHtml() {
        let html = '';
        let founderNumber = 1;
        let founderInput = document.getElementById(`founder${founderNumber}Name`);
        
        while (founderInput) {
          const name = document.getElementById(`founder${founderNumber}Name`).value;
          const address = document.getElementById(`founder${founderNumber}Address`).value;
          const email = document.getElementById(`founder${founderNumber}Email`).value;
          const equity = document.getElementById(`founder${founderNumber}Equity`).value;
          
          // Get role based on selection or custom input
          let role = '';
          const roleSelect = document.getElementById(`founder${founderNumber}Role`);
          if (roleSelect.value === 'other') {
            role = document.getElementById(`founder${founderNumber}CustomRole`).value;
          } else {
            // Extract just the role name without the acronym in parentheses
            const selectedText = roleSelect.options[roleSelect.selectedIndex].text;
            role = selectedText.includes('(') ? selectedText.split('(')[0].trim() : selectedText;
          }
          
          const responsibilities = document.getElementById(`founder${founderNumber}Responsibilities`).value;
          
          if (name) {
            html += `
              <p><span class="field-label">2.${founderNumber} Founder ${founderNumber}:</span> ${name}, residing at ${address}, with email address ${email}.</p>
              
              <p><span class="field-label">Equity Percentage:</span> ${equity}%</p>
              
              <p><span class="field-label">Role / Position:</span> ${role}</p>
              
              <p><span class="field-label">Key Responsibilities:</span> ${responsibilities}</p>
              
            `;
          }
          
          founderNumber++;
          founderInput = document.getElementById(`founder${founderNumber}Name`);
        }
        
        return html;
      }
      
      // Get HTML for founder signature blocks - side by side
      function getFounderSignatureBlocks() {
        let html = '';
        const founderSections = document.querySelectorAll('.founder-section');
        
        founderSections.forEach((section, index) => {
          const founderId = section.id.match(/founder(\d+)Section/)[1];
          const name = document.getElementById(`founder${founderId}Name`).value || `Founder ${founderId}`;
          
          html += `
            <div class="signature-block">
              <div class="signature-line"></div>
              <p><strong>${name}</strong></p>
            </div>
          `;
        });
        
        return html;
      }
      
      // Function to highlight changed content in the preview
      function highlightChangedContent(changedField) {
        // Clear any existing highlights
        clearHighlights();
        
        // Determine which section to highlight based on the changed field
        let sectionId = '';
        let elements = [];
        
        // Map fields to their corresponding sections
        if (['companyName', 'companyAddress', 'businessPurpose', 'incorporationStatus', 'incorporationDate', 'agreementDate', 'governingLaw', 'otherState'].includes(changedField)) {
          sectionId = 'section-company-info';
        } else if (changedField.startsWith('founder') && (changedField.includes('Name') || changedField.includes('Address') || 
                 changedField.includes('Email') || changedField.includes('Equity') || changedField.includes('Role') || 
                 changedField.includes('CustomRole') || changedField.includes('Responsibilities'))) {
          sectionId = 'section-founders';
        } else if (['equityForm', 'vestingSchedule', 'customVestingDescription', 'acceleratedVesting', 'customAccelerationDescription'].includes(changedField)) {
          sectionId = 'section-equity';
        } else if (['decisionMaking', 'designatedDecisionMaker', 'customDecisionDescription', 'timeCommitment', 'customTimeDescription', 'salariesCompensation', 'customSalaryDescription'].includes(changedField)) {
          sectionId = 'section-roles';
        } else if (['ipAssignment', 'customIpDescription', 'priorIp', 'priorIpDetails'].includes(changedField)) {
          sectionId = 'section-ip';
        } else if (['nonCompete', 'nonCompeteDetails', 'confidentiality', 'confidentialityDetails'].includes(changedField)) {
          sectionId = 'section-covenants';
        } else if (['voluntaryExit', 'customExitDescription', 'founderTermination', 'customTerminationDescription', 'disputeResolution', 'customDisputeDescription'].includes(changedField)) {
          sectionId = 'section-exit';
        } else if (['additionalProvisions'].includes(changedField)) {
          sectionId = 'section-additional';
        }
        
        if (sectionId) {
          const section = document.getElementById(sectionId);
          if (section) {
            // Find the specific paragraph that contains the changed field
            let fieldLabel = '';
            
            // Map changedField to fieldLabel
            switch (changedField) {
              case 'companyName':
                fieldLabel = '1.1 Company Name:';
                break;
              case 'companyAddress':
                fieldLabel = '1.2 Principal Place of Business:';
                break;
              case 'businessPurpose':
                fieldLabel = '1.3 Business Purpose:';
                break;
              case 'incorporationStatus':
              case 'incorporationDate':
                fieldLabel = '1.4 Incorporation Status:';
                break;
              case 'governingLaw':
              case 'otherState':
                fieldLabel = '1.5 Governing Law:';
                break;
              case 'equityForm':
                fieldLabel = '3.1 Equity Form:';
                break;
              case 'vestingSchedule':
              case 'customVestingDescription':
                fieldLabel = '3.2 Vesting Schedule:';
                break;
              case 'acceleratedVesting':
              case 'customAccelerationDescription':
                fieldLabel = '3.3 Accelerated Vesting:';
                break;
              case 'decisionMaking':
              case 'designatedDecisionMaker':
              case 'customDecisionDescription':
                fieldLabel = '4.1 Decision Making:';
                break;
              case 'timeCommitment':
              case 'customTimeDescription':
                fieldLabel = '4.2 Time Commitment:';
                break;
              case 'salariesCompensation':
              case 'customSalaryDescription':
                fieldLabel = '4.3 Initial Salaries/Compensation:';
                break;
              case 'ipAssignment':
              case 'customIpDescription':
                fieldLabel = '5.1 IP Assignment:';
                break;
              case 'priorIp':
              case 'priorIpDetails':
                fieldLabel = '5.2 Prior IP Exclusions:';
                break;
              case 'nonCompete':
              case 'nonCompeteDetails':
                fieldLabel = '6.1 Non-Compete:';
                break;
              case 'confidentiality':
              case 'confidentialityDetails':
                fieldLabel = '6.2 Confidentiality:';
                break;
              case 'voluntaryExit':
              case 'customExitDescription':
                fieldLabel = '7.1 Voluntary Exit:';
                break;
              case 'founderTermination':
              case 'customTerminationDescription':
                fieldLabel = '7.2 Founder Termination:';
                break;
              case 'disputeResolution':
              case 'customDisputeDescription':
                fieldLabel = '7.3 Dispute Resolution:';
                break;
              case 'additionalProvisions':
                fieldLabel = '8.1 Additional Provisions:';
                break;
              default:
                // For founder fields, handle specially
                if (changedField.startsWith('founder')) {
                  const matches = changedField.match(/founder(\d+)([A-Za-z]+)/);
                  if (matches && matches.length >= 3) {
                    const founderNum = matches[1];
                    const fieldType = matches[2];
                    
                    if (fieldType === 'Name' || fieldType === 'Address' || fieldType === 'Email') {
                      fieldLabel = `2.${founderNum} Founder ${founderNum}:`;
                    } else if (fieldType === 'Equity') {
                      fieldLabel = 'Equity Percentage:';
                    } else if (fieldType === 'Role' || fieldType === 'CustomRole') {
                      fieldLabel = 'Role / Position:';
                    } else if (fieldType === 'Responsibilities') {
                      fieldLabel = 'Key Responsibilities:';
                    }
                  }
                }
            }
            
            // If we didn't find a specific field label, highlight the whole section
            if (fieldLabel === '') {
              elements = [section];
            } else {
              // Find the specific paragraph with the field label
              const contentDiv = section.querySelector('.section-content');
              if (contentDiv) {
                const paragraphs = contentDiv.querySelectorAll('p');
                paragraphs.forEach(p => {
                  const labelElement = p.querySelector('.field-label');
                  if (labelElement && labelElement.textContent === fieldLabel) {
                    // For most fields, highlight the entire paragraph
                    elements.push(p);
                  }
                });
              }
              
              // If no specific paragraph found, highlight the section
              if (elements.length === 0) {
                elements = [section];
              }
            }
            
            // Apply highlight class to found elements
            elements.forEach(element => {
              element.classList.add('highlight');
              highlightedElements.push(element);
            });
            
            // Ensure the highlighted element is visible in the preview
            if (elements.length > 0) {
              const firstElement = elements[0];
              const elementRect = firstElement.getBoundingClientRect();
              const previewRect = previewBox.getBoundingClientRect();
              
              // If element is not fully visible in the preview box
              if (elementRect.top < previewRect.top || elementRect.bottom > previewRect.bottom) {
                // Scroll to the element
                firstElement.scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
            
            // Set timeout to remove highlight after some time (user's next click will clear this anyway)
            highlightTimeout = setTimeout(() => {
              clearHighlights();
            }, 5000);
          }
        }
      }
    });
  </script>
</body>
</html>
